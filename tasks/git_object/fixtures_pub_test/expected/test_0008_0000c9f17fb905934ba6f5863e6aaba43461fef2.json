{
  "content": {
    "base64": "IyEvYmluL3NoCgp0ZXN0X2Rlc2NyaXB0aW9uPSdiYXNpYyBjbG9uZSBvcHRpb25zJwpHSVRfVEVTVF9ERUZBVUxUX0lOSVRJQUxfQlJBTkNIX05BTUU9bWFpbgpleHBvcnQgR0lUX1RFU1RfREVGQVVMVF9JTklUSUFMX0JSQU5DSF9OQU1FCgouIC4vdGVzdC1saWIuc2gKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NldHVwJyAnCgoJbWtkaXIgcGFyZW50ICYmCgkoY2QgcGFyZW50ICYmIGdpdCBpbml0ICYmCgkgZWNobyBvbmUgPmZpbGUgJiYgZ2l0IGFkZCBmaWxlICYmCgkgZ2l0IGNvbW1pdCAtbSBvbmUpICYmCglnaXQgY2xvbmUgLS1kZXB0aD0xIC0tbm8tbG9jYWwgcGFyZW50IHNoYWxsb3ctcmVwbwoKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3VibW9kdWxlLnN0aWNreVJlY3Vyc2l2ZUNsb25lIGZsYWcgbWFuaXB1bGF0ZXMgc3VibW9kdWxlLnJlY3Vyc2UgdmFsdWUnICcKCgl0ZXN0X2NvbmZpZ19nbG9iYWwgc3VibW9kdWxlLnN0aWNreVJlY3Vyc2l2ZUNsb25lIHRydWUgJiYKCWdpdCBjbG9uZSAtLXJlY3Vyc2Utc3VibW9kdWxlcyBwYXJlbnQgY2xvbmVfcmVjdXJzZV90cnVlICYmCgl0ZXN0X2NtcF9jb25maWcgLUMgY2xvbmVfcmVjdXJzZV90cnVlIHRydWUgc3VibW9kdWxlLnJlY3Vyc2UgJiYKCgl0ZXN0X2NvbmZpZ19nbG9iYWwgc3VibW9kdWxlLnN0aWNreVJlY3Vyc2l2ZUNsb25lIGZhbHNlICYmCglnaXQgY2xvbmUgLS1yZWN1cnNlLXN1Ym1vZHVsZXMgcGFyZW50IGNsb25lX3JlY3Vyc2VfZmFsc2UgJiYKCXRlc3RfZXhwZWN0X2NvZGUgMSBnaXQgLUMgY2xvbmVfcmVjdXJzZV9mYWxzZSBjb25maWcgLS1nZXQgc3VibW9kdWxlLnJlY3Vyc2UKCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2Nsb25lIC1vJyAnCgoJZ2l0IGNsb25lIC1vIGZvbyBwYXJlbnQgY2xvbmUtbyAmJgoJZ2l0IC1DIGNsb25lLW8gcmV2LXBhcnNlIC0tdmVyaWZ5IHJlZnMvcmVtb3Rlcy9mb28vbWFpbgoKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAncmVqZWN0cyBpbnZhbGlkIC1vLy0tb3JpZ2luJyAnCgoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNsb25lIC1vICJiYWQuLi5uYW1lIiBwYXJlbnQgY2xvbmUtYmFkLW5hbWUgMj5lcnIgJiYKCXRlc3RfaTE4bmdyZXAgIidcJydiYWQuLi5uYW1lJ1wnJyBpcyBub3QgYSB2YWxpZCByZW1vdGUgbmFtZSIgZXJyCgonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdjbG9uZSAtLWJhcmUgLW8nICcKCglnaXQgY2xvbmUgLW8gZm9vIC0tYmFyZSBwYXJlbnQgY2xvbmUtYmFyZS1vICYmCgkoY2QgcGFyZW50ICYmIHB3ZCkgPmV4cGVjdCAmJgoJZ2l0IC1DIGNsb25lLWJhcmUtbyBjb25maWcgcmVtb3RlLmZvby51cmwgPmFjdHVhbCAmJgoJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbAoKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnZGlzYWxsb3dzIC0tYmFyZSB3aXRoIC0tc2VwYXJhdGUtZ2l0LWRpcicgJwoKCXRlc3RfbXVzdF9mYWlsIGdpdCBjbG9uZSAtLWJhcmUgLS1zZXBhcmF0ZS1naXQtZGlyIGRvdC1naXQtZGVzdGlhdGlvbiBwYXJlbnQgY2xvbmUtYmFyZS1zZ2QgMj5lcnIgJiYKCXRlc3RfZGVidWcgImNhdCBlcnIiICYmCgl0ZXN0X2kxOG5ncmVwIC1lICJvcHRpb25zIC4tLWJhcmUuIGFuZCAuLS1zZXBhcmF0ZS1naXQtZGlyLiBjYW5ub3QgYmUgdXNlZCB0b2dldGhlciIgZXJyCgonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdyZWplY3QgY2xvbmluZyBzaGFsbG93IHJlcG9zaXRvcnknICcKCXRlc3Rfd2hlbl9maW5pc2hlZCAicm0gLXJmIHJlcG8iICYmCgl0ZXN0X211c3RfZmFpbCBnaXQgY2xvbmUgLS1yZWplY3Qtc2hhbGxvdyBzaGFsbG93LXJlcG8gb3V0IDI+ZXJyICYmCgl0ZXN0X2kxOG5ncmVwIC1lICJzb3VyY2UgcmVwb3NpdG9yeSBpcyBzaGFsbG93LCByZWplY3QgdG8gY2xvbmUuIiBlcnIgJiYKCglnaXQgY2xvbmUgLS1uby1yZWplY3Qtc2hhbGxvdyBzaGFsbG93LXJlcG8gcmVwbwonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdyZWplY3QgY2xvbmluZyBub24tbG9jYWwgc2hhbGxvdyByZXBvc2l0b3J5JyAnCgl0ZXN0X3doZW5fZmluaXNoZWQgInJtIC1yZiByZXBvIiAmJgoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNsb25lIC0tcmVqZWN0LXNoYWxsb3cgLS1uby1sb2NhbCBzaGFsbG93LXJlcG8gb3V0IDI+ZXJyICYmCgl0ZXN0X2kxOG5ncmVwIC1lICJzb3VyY2UgcmVwb3NpdG9yeSBpcyBzaGFsbG93LCByZWplY3QgdG8gY2xvbmUuIiBlcnIgJiYKCglnaXQgY2xvbmUgLS1uby1yZWplY3Qtc2hhbGxvdyAtLW5vLWxvY2FsIHNoYWxsb3ctcmVwbyByZXBvCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3N1Y2NlZWQgY2xvbmluZyBub3JtYWwgcmVwb3NpdG9yeScgJwoJdGVzdF93aGVuX2ZpbmlzaGVkICJybSAtcmYgY2hpbGFkMSBjaGlsZDIgY2hpbGQzIGNoaWxkNCAiICYmCglnaXQgY2xvbmUgLS1yZWplY3Qtc2hhbGxvdyBwYXJlbnQgY2hpbGQxICYmCglnaXQgY2xvbmUgLS1yZWplY3Qtc2hhbGxvdyAtLW5vLWxvY2FsIHBhcmVudCBjaGlsZDIgJiYKCWdpdCBjbG9uZSAtLW5vLXJlamVjdC1zaGFsbG93IHBhcmVudCBjaGlsZDMgJiYKCWdpdCBjbG9uZSAtLW5vLXJlamVjdC1zaGFsbG93IC0tbm8tbG9jYWwgcGFyZW50IGNoaWxkNAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICd1c2VzICJvcmlnaW4iIGZvciBkZWZhdWx0IHJlbW90ZSBuYW1lJyAnCgoJZ2l0IGNsb25lIHBhcmVudCBjbG9uZS1kZWZhdWx0LW9yaWdpbiAmJgoJZ2l0IC1DIGNsb25lLWRlZmF1bHQtb3JpZ2luIHJldi1wYXJzZSAtLXZlcmlmeSByZWZzL3JlbW90ZXMvb3JpZ2luL21haW4KCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3ByZWZlcnMgLS10ZW1wbGF0ZSBjb25maWcgb3ZlciBub3JtYWwgY29uZmlnJyAnCgoJdGVtcGxhdGU9IiRUUkFTSF9ESVJFQ1RPUlkvdGVtcGxhdGUtd2l0aC1jb25maWciICYmCglta2RpciAiJHRlbXBsYXRlIiAmJgoJZ2l0IGNvbmZpZyAtLWZpbGUgIiR0ZW1wbGF0ZS9jb25maWciIGZvby5iYXIgZnJvbV90ZW1wbGF0ZSAmJgoJdGVzdF9jb25maWdfZ2xvYmFsIGZvby5iYXIgZnJvbV9nbG9iYWwgJiYKCWdpdCBjbG9uZSAiLS10ZW1wbGF0ZT0kdGVtcGxhdGUiIHBhcmVudCBjbG9uZS10ZW1wbGF0ZS1jb25maWcgJiYKCXRlc3QgIiQoZ2l0IC1DIGNsb25lLXRlbXBsYXRlLWNvbmZpZyBjb25maWcgLS1sb2NhbCBmb28uYmFyKSIgPSAiZnJvbV90ZW1wbGF0ZSIKCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3ByZWZlcnMgLWMgY29uZmlnIG92ZXIgLS10ZW1wbGF0ZSBjb25maWcnICcKCgl0ZW1wbGF0ZT0iJFRSQVNIX0RJUkVDVE9SWS90ZW1wbGF0ZS13aXRoLWlnbm9yZWQtY29uZmlnIiAmJgoJbWtkaXIgIiR0ZW1wbGF0ZSIgJiYKCWdpdCBjb25maWcgLS1maWxlICIkdGVtcGxhdGUvY29uZmlnIiBmb28uYmFyIGZyb21fdGVtcGxhdGUgJiYKCWdpdCBjbG9uZSAiLS10ZW1wbGF0ZT0kdGVtcGxhdGUiIC1jIGZvby5iYXI9aW5saW5lIHBhcmVudCBjbG9uZS10ZW1wbGF0ZS1pbmxpbmUtY29uZmlnICYmCgl0ZXN0ICIkKGdpdCAtQyBjbG9uZS10ZW1wbGF0ZS1pbmxpbmUtY29uZmlnIGNvbmZpZyAtLWxvY2FsIGZvby5iYXIpIiA9ICJpbmxpbmUiCgonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdwcmVmZXJzIGNvbmZpZyAiY2xvbmUuZGVmYXVsdFJlbW90ZU5hbWUiIG92ZXIgZGVmYXVsdCcgJwoKCXRlc3RfY29uZmlnX2dsb2JhbCBjbG9uZS5kZWZhdWx0UmVtb3RlTmFtZSBmcm9tX2NvbmZpZyAmJgoJZ2l0IGNsb25lIHBhcmVudCBjbG9uZS1jb25maWctb3JpZ2luICYmCglnaXQgLUMgY2xvbmUtY29uZmlnLW9yaWdpbiByZXYtcGFyc2UgLS12ZXJpZnkgcmVmcy9yZW1vdGVzL2Zyb21fY29uZmlnL21haW4KCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3ByZWZlcnMgLS1vcmlnaW4gb3ZlciAtYyBjb25maWcnICcKCglnaXQgY2xvbmUgLWMgY2xvbmUuZGVmYXVsdFJlbW90ZU5hbWU9aW5saW5lIC0tb3JpZ2luIGZyb21fb3B0aW9uIHBhcmVudCBjbG9uZS1vLWFuZC1pbmxpbmUtY29uZmlnICYmCglnaXQgLUMgY2xvbmUtby1hbmQtaW5saW5lLWNvbmZpZyByZXYtcGFyc2UgLS12ZXJpZnkgcmVmcy9yZW1vdGVzL2Zyb21fb3B0aW9uL21haW4KCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3JlZGlyZWN0ZWQgY2xvbmUgZG9lcyBub3Qgc2hvdyBwcm9ncmVzcycgJwoKCWdpdCBjbG9uZSAiZmlsZTovLyQocHdkKS9wYXJlbnQiIGNsb25lLXJlZGlyZWN0ZWQgPm91dCAyPmVyciAmJgoJISBncmVwICUgZXJyICYmCgl0ZXN0X2kxOG5ncmVwICEgIkNoZWNraW5nIGNvbm5lY3Rpdml0eSIgZXJyCgonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdyZWRpcmVjdGVkIGNsb25lIC12IGRvZXMgc2hvdyBwcm9ncmVzcycgJwoKCWdpdCBjbG9uZSAtLXByb2dyZXNzICJmaWxlOi8vJChwd2QpL3BhcmVudCIgY2xvbmUtcmVkaXJlY3RlZC1wcm9ncmVzcyBcCgkJPm91dCAyPmVyciAmJgoJZ3JlcCAlIGVycgoKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2xvbmUgZG9lcyBub3Qgc2VnZmF1bHQgd2l0aCAtLWJhcmUgYW5kIGNvcmUuYmFyZT1mYWxzZScgJwoJdGVzdF9jb25maWdfZ2xvYmFsIGNvcmUuYmFyZSBmYWxzZSAmJgoJZ2l0IGNsb25lIC0tYmFyZSBwYXJlbnQgY2xvbmUtYmFyZSAmJgoJZWNobyB0cnVlID5leHBlY3QgJiYKCWdpdCAtQyBjbG9uZS1iYXJlIHJldi1wYXJzZSAtLWlzLWJhcmUtcmVwb3NpdG9yeSA+YWN0dWFsICYmCgl0ZXN0X2NtcCBleHBlY3QgYWN0dWFsCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2Nob29zZXMgY29ycmVjdCBkZWZhdWx0IGluaXRpYWwgYnJhbmNoIG5hbWUnICcKCUdJVF9URVNUX0RFRkFVTFRfSU5JVElBTF9CUkFOQ0hfTkFNRT0gXAoJZ2l0IC1jIGluaXQuZGVmYXVsdEJyYW5jaD1mb28gaW5pdCAtLWJhcmUgZW1wdHkgJiYKCXRlc3RfY29uZmlnIC1DIGVtcHR5IGxzcmVmcy51bmJvcm4gYWR2ZXJ0aXNlICYmCglHSVRfVEVTVF9ERUZBVUxUX0lOSVRJQUxfQlJBTkNIX05BTUU9IFwKCWdpdCAtYyBpbml0LmRlZmF1bHRCcmFuY2g9dXAgLWMgcHJvdG9jb2wudmVyc2lvbj0yIGNsb25lIGVtcHR5IHdoYXRzLXVwICYmCgl0ZXN0IHJlZnMvaGVhZHMvZm9vID0gJChnaXQgLUMgd2hhdHMtdXAgc3ltYm9saWMtcmVmIEhFQUQpICYmCgl0ZXN0IHJlZnMvaGVhZHMvZm9vID0gJChnaXQgLUMgd2hhdHMtdXAgY29uZmlnIGJyYW5jaC5mb28ubWVyZ2UpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2d1ZXNzZXMgaW5pdGlhbCBicmFuY2ggbmFtZSBjb3JyZWN0bHknICcKCWdpdCBpbml0IC0taW5pdGlhbC1icmFuY2g9Z3Vlc3MgaW5pdGlhbC1icmFuY2ggJiYKCXRlc3RfY29tbWl0IC1DIGluaXRpYWwtYnJhbmNoIG5vLXNwb2lsZXJzICYmCglnaXQgLUMgaW5pdGlhbC1icmFuY2ggYnJhbmNoIGFiYyBndWVzcyAmJgoJZ2l0IGNsb25lIGluaXRpYWwtYnJhbmNoIGlzLWl0ICYmCgl0ZXN0IHJlZnMvaGVhZHMvZ3Vlc3MgPSAkKGdpdCAtQyBpcy1pdCBzeW1ib2xpYy1yZWYgSEVBRCkgJiYKCglnaXQgLWMgaW5pdC5kZWZhdWx0QnJhbmNoPW5vbmUgaW5pdCAtLWJhcmUgbm8taGVhZCAmJgoJZ2l0IC1DIGluaXRpYWwtYnJhbmNoIHB1c2ggLi4vbm8taGVhZCBndWVzcyBhYmMgJiYKCUdJVF9URVNUX0RFRkFVTFRfSU5JVElBTF9CUkFOQ0hfTkFNRT0gXAoJZ2l0IGNsb25lIG5vLWhlYWQgaXMtaXQyICYmCgl0ZXN0X211c3RfZmFpbCBnaXQgLUMgaXMtaXQyIHN5bWJvbGljLXJlZiByZWZzL3JlbW90ZXMvb3JpZ2luL0hFQUQgJiYKCWdpdCAtQyBuby1oZWFkIHVwZGF0ZS1yZWYgLS1uby1kZXJlZiBIRUFEIHJlZnMvaGVhZHMvZ3Vlc3MgJiYKCUdJVF9URVNUX0RFRkFVTFRfSU5JVElBTF9CUkFOQ0hfTkFNRT0gXAoJZ2l0IC1jIGluaXQuZGVmYXVsdEJyYW5jaD1ndWVzcyBjbG9uZSBuby1oZWFkIGlzLWl0MyAmJgoJdGVzdCByZWZzL3JlbW90ZXMvb3JpZ2luL2d1ZXNzID0gXAoJCSQoZ2l0IC1DIGlzLWl0MyBzeW1ib2xpYy1yZWYgcmVmcy9yZW1vdGVzL29yaWdpbi9IRUFEKQonCgp0ZXN0X2RvbmUK",
    "text": "#!/bin/sh\n\ntest_description='basic clone options'\nGIT_TEST_DEFAULT_INITIAL_BRANCH_NAME=main\nexport GIT_TEST_DEFAULT_INITIAL_BRANCH_NAME\n\n. ./test-lib.sh\n\ntest_expect_success 'setup' '\n\n\tmkdir parent &&\n\t(cd parent && git init &&\n\t echo one >file && git add file &&\n\t git commit -m one) &&\n\tgit clone --depth=1 --no-local parent shallow-repo\n\n'\n\ntest_expect_success 'submodule.stickyRecursiveClone flag manipulates submodule.recurse value' '\n\n\ttest_config_global submodule.stickyRecursiveClone true &&\n\tgit clone --recurse-submodules parent clone_recurse_true &&\n\ttest_cmp_config -C clone_recurse_true true submodule.recurse &&\n\n\ttest_config_global submodule.stickyRecursiveClone false &&\n\tgit clone --recurse-submodules parent clone_recurse_false &&\n\ttest_expect_code 1 git -C clone_recurse_false config --get submodule.recurse\n\n'\n\ntest_expect_success 'clone -o' '\n\n\tgit clone -o foo parent clone-o &&\n\tgit -C clone-o rev-parse --verify refs/remotes/foo/main\n\n'\n\ntest_expect_success 'rejects invalid -o/--origin' '\n\n\ttest_must_fail git clone -o \"bad...name\" parent clone-bad-name 2>err &&\n\ttest_i18ngrep \"'\\''bad...name'\\'' is not a valid remote name\" err\n\n'\n\ntest_expect_success 'clone --bare -o' '\n\n\tgit clone -o foo --bare parent clone-bare-o &&\n\t(cd parent && pwd) >expect &&\n\tgit -C clone-bare-o config remote.foo.url >actual &&\n\ttest_cmp expect actual\n\n'\n\ntest_expect_success 'disallows --bare with --separate-git-dir' '\n\n\ttest_must_fail git clone --bare --separate-git-dir dot-git-destiation parent clone-bare-sgd 2>err &&\n\ttest_debug \"cat err\" &&\n\ttest_i18ngrep -e \"options .--bare. and .--separate-git-dir. cannot be used together\" err\n\n'\n\ntest_expect_success 'reject cloning shallow repository' '\n\ttest_when_finished \"rm -rf repo\" &&\n\ttest_must_fail git clone --reject-shallow shallow-repo out 2>err &&\n\ttest_i18ngrep -e \"source repository is shallow, reject to clone.\" err &&\n\n\tgit clone --no-reject-shallow shallow-repo repo\n'\n\ntest_expect_success 'reject cloning non-local shallow repository' '\n\ttest_when_finished \"rm -rf repo\" &&\n\ttest_must_fail git clone --reject-shallow --no-local shallow-repo out 2>err &&\n\ttest_i18ngrep -e \"source repository is shallow, reject to clone.\" err &&\n\n\tgit clone --no-reject-shallow --no-local shallow-repo repo\n'\n\ntest_expect_success 'succeed cloning normal repository' '\n\ttest_when_finished \"rm -rf chilad1 child2 child3 child4 \" &&\n\tgit clone --reject-shallow parent child1 &&\n\tgit clone --reject-shallow --no-local parent child2 &&\n\tgit clone --no-reject-shallow parent child3 &&\n\tgit clone --no-reject-shallow --no-local parent child4\n'\n\ntest_expect_success 'uses \"origin\" for default remote name' '\n\n\tgit clone parent clone-default-origin &&\n\tgit -C clone-default-origin rev-parse --verify refs/remotes/origin/main\n\n'\n\ntest_expect_success 'prefers --template config over normal config' '\n\n\ttemplate=\"$TRASH_DIRECTORY/template-with-config\" &&\n\tmkdir \"$template\" &&\n\tgit config --file \"$template/config\" foo.bar from_template &&\n\ttest_config_global foo.bar from_global &&\n\tgit clone \"--template=$template\" parent clone-template-config &&\n\ttest \"$(git -C clone-template-config config --local foo.bar)\" = \"from_template\"\n\n'\n\ntest_expect_success 'prefers -c config over --template config' '\n\n\ttemplate=\"$TRASH_DIRECTORY/template-with-ignored-config\" &&\n\tmkdir \"$template\" &&\n\tgit config --file \"$template/config\" foo.bar from_template &&\n\tgit clone \"--template=$template\" -c foo.bar=inline parent clone-template-inline-config &&\n\ttest \"$(git -C clone-template-inline-config config --local foo.bar)\" = \"inline\"\n\n'\n\ntest_expect_success 'prefers config \"clone.defaultRemoteName\" over default' '\n\n\ttest_config_global clone.defaultRemoteName from_config &&\n\tgit clone parent clone-config-origin &&\n\tgit -C clone-config-origin rev-parse --verify refs/remotes/from_config/main\n\n'\n\ntest_expect_success 'prefers --origin over -c config' '\n\n\tgit clone -c clone.defaultRemoteName=inline --origin from_option parent clone-o-and-inline-config &&\n\tgit -C clone-o-and-inline-config rev-parse --verify refs/remotes/from_option/main\n\n'\n\ntest_expect_success 'redirected clone does not show progress' '\n\n\tgit clone \"file://$(pwd)/parent\" clone-redirected >out 2>err &&\n\t! grep % err &&\n\ttest_i18ngrep ! \"Checking connectivity\" err\n\n'\n\ntest_expect_success 'redirected clone -v does show progress' '\n\n\tgit clone --progress \"file://$(pwd)/parent\" clone-redirected-progress \\\n\t\t>out 2>err &&\n\tgrep % err\n\n'\n\ntest_expect_success 'clone does not segfault with --bare and core.bare=false' '\n\ttest_config_global core.bare false &&\n\tgit clone --bare parent clone-bare &&\n\techo true >expect &&\n\tgit -C clone-bare rev-parse --is-bare-repository >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success 'chooses correct default initial branch name' '\n\tGIT_TEST_DEFAULT_INITIAL_BRANCH_NAME= \\\n\tgit -c init.defaultBranch=foo init --bare empty &&\n\ttest_config -C empty lsrefs.unborn advertise &&\n\tGIT_TEST_DEFAULT_INITIAL_BRANCH_NAME= \\\n\tgit -c init.defaultBranch=up -c protocol.version=2 clone empty whats-up &&\n\ttest refs/heads/foo = $(git -C whats-up symbolic-ref HEAD) &&\n\ttest refs/heads/foo = $(git -C whats-up config branch.foo.merge)\n'\n\ntest_expect_success 'guesses initial branch name correctly' '\n\tgit init --initial-branch=guess initial-branch &&\n\ttest_commit -C initial-branch no-spoilers &&\n\tgit -C initial-branch branch abc guess &&\n\tgit clone initial-branch is-it &&\n\ttest refs/heads/guess = $(git -C is-it symbolic-ref HEAD) &&\n\n\tgit -c init.defaultBranch=none init --bare no-head &&\n\tgit -C initial-branch push ../no-head guess abc &&\n\tGIT_TEST_DEFAULT_INITIAL_BRANCH_NAME= \\\n\tgit clone no-head is-it2 &&\n\ttest_must_fail git -C is-it2 symbolic-ref refs/remotes/origin/HEAD &&\n\tgit -C no-head update-ref --no-deref HEAD refs/heads/guess &&\n\tGIT_TEST_DEFAULT_INITIAL_BRANCH_NAME= \\\n\tgit -c init.defaultBranch=guess clone no-head is-it3 &&\n\ttest refs/remotes/origin/guess = \\\n\t\t$(git -C is-it3 symbolic-ref refs/remotes/origin/HEAD)\n'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "0000c9f17fb905934ba6f5863e6aaba43461fef2",
  "sha1_ok": false,
  "size": 5976
}
