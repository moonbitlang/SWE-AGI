{
  "content": {
    "base64": "IyEvYmluL3NoCgp0ZXN0X2Rlc2NyaXB0aW9uPSdjb21iaW5lZCBkaWZmJwoKR0lUX1RFU1RfREVGQVVMVF9JTklUSUFMX0JSQU5DSF9OQU1FPW1haW4KZXhwb3J0IEdJVF9URVNUX0RFRkFVTFRfSU5JVElBTF9CUkFOQ0hfTkFNRQoKVEVTVF9QQVNTRVNfU0FOSVRJWkVfTEVBSz10cnVlCi4gLi90ZXN0LWxpYi5zaAouICIkVEVTVF9ESVJFQ1RPUlkiL2xpYi1kaWZmLnNoCgpzZXR1cF9oZWxwZXIgKCkgewoJb25lPSQxIGJyYW5jaD0kMiBzaWRlPSQzICYmCgoJZ2l0IGJyYW5jaCAkc2lkZSAkYnJhbmNoICYmCglmb3IgbCBpbiAkb25lIHR3byB0aHJlZSBmeXJhCglkbwoJCWVjaG8gJGwKCWRvbmUgPmZpbGUgJiYKCWdpdCBhZGQgZmlsZSAmJgoJdGVzdF90aWNrICYmCglnaXQgY29tbWl0IC1tICRicmFuY2ggJiYKCWdpdCBjaGVja291dCAkc2lkZSAmJgoJZm9yIGwgaW4gJG9uZSB0d28gdGhyZWUgcXVhdHJvCglkbwoJCWVjaG8gJGwKCWRvbmUgPmZpbGUgJiYKCWdpdCBhZGQgZmlsZSAmJgoJdGVzdF90aWNrICYmCglnaXQgY29tbWl0IC1tICRzaWRlICYmCgl0ZXN0X211c3RfZmFpbCBnaXQgbWVyZ2UgJGJyYW5jaCAmJgoJZm9yIGwgaW4gJG9uZSB0aHJlZSBmb3VyCglkbwoJCWVjaG8gJGwKCWRvbmUgPmZpbGUgJiYKCWdpdCBhZGQgZmlsZSAmJgoJdGVzdF90aWNrICYmCglnaXQgY29tbWl0IC1tICJtZXJnZSAkYnJhbmNoIGludG8gJHNpZGUiCn0KCnZlcmlmeV9oZWxwZXIgKCkgewoJaXQ9JDEgJiYKCgkjIElnbm9yZSBsaW5lcyB0aGF0IHdlcmUgcmVtb3ZlZCBvbmx5IGZyb20gdGhlIG90aGVyIHBhcmVudAoJc2VkIC1lICcKCQkxLC9eQEBAL2QKCQkvXiAtL2QKCQlzL15cKC5cKS4vXDEvCgknICIkaXQiID4iJGl0LmFjdHVhbC4xIiAmJgoJc2VkIC1lICcKCQkxLC9eQEBAL2QKCQkvXi0gL2QKCQlzL14uXCguXCkvXDEvCgknICIkaXQiID4iJGl0LmFjdHVhbC4yIiAmJgoKCWdpdCBkaWZmICIkaXReIiAiJGl0IiAtLSB8IHNlZCAtZSAnMSwvXkBAL2QnID4iJGl0LmV4cGVjdC4xIiAmJgoJdGVzdF9jbXAgIiRpdC5leHBlY3QuMSIgIiRpdC5hY3R1YWwuMSIgJiYKCglnaXQgZGlmZiAiJGl0XjIiICIkaXQiIC0tIHwgc2VkIC1lICcxLC9eQEAvZCcgPiIkaXQuZXhwZWN0LjIiICYmCgl0ZXN0X2NtcCAiJGl0LmV4cGVjdC4yIiAiJGl0LmFjdHVhbC4yIgp9Cgp0ZXN0X2V4cGVjdF9zdWNjZXNzIHNldHVwICcKCT5maWxlICYmCglnaXQgYWRkIGZpbGUgJiYKCXRlc3RfdGljayAmJgoJZ2l0IGNvbW1pdCAtbSBpbml0aWFsICYmCgoJZ2l0IGJyYW5jaCB3aXRob25lICYmCglnaXQgYnJhbmNoIHNhbnNvbmUgJiYKCglnaXQgY2hlY2tvdXQgd2l0aG9uZSAmJgoJc2V0dXBfaGVscGVyIG9uZSB3aXRob25lIHNpZGV3aXRob25lICYmCgoJZ2l0IGNoZWNrb3V0IHNhbnNvbmUgJiYKCXNldHVwX2hlbHBlciAiIiBzYW5zb25lIHNpZGVzYW5zb25lCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2NoZWNrIGNvbWJpbmVkIG91dHB1dCAoMSknICcKCWdpdCBzaG93IHNpZGV3aXRob25lIC0tID5zaWRld2l0aG9uZSAmJgoJdmVyaWZ5X2hlbHBlciBzaWRld2l0aG9uZQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdjaGVjayBjb21iaW5lZCBvdXRwdXQgKDEpIHdpdGggZ2l0IGRpZmYgPHJldj5eIScgJwoJZ2l0IGRpZmYgc2lkZXdpdGhvbmVeISAtLSA+c2lkZXdpdGhvbmUgJiYKCXZlcmlmeV9oZWxwZXIgc2lkZXdpdGhvbmUKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2hlY2sgY29tYmluZWQgb3V0cHV0ICgyKScgJwoJZ2l0IHNob3cgc2lkZXNhbnNvbmUgLS0gPnNpZGVzYW5zb25lICYmCgl2ZXJpZnlfaGVscGVyIHNpZGVzYW5zb25lCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2NoZWNrIGNvbWJpbmVkIG91dHB1dCAoMikgd2l0aCBnaXQgZGlmZiA8cmV2Pl4hJyAnCglnaXQgZGlmZiBzaWRlc2Fuc29uZV4hIC0tID5zaWRlc2Fuc29uZSAmJgoJdmVyaWZ5X2hlbHBlciBzaWRlc2Fuc29uZQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdkaWFnbm9zZSB0cnVuY2F0ZWQgZmlsZScgJwoJPmZpbGUgJiYKCWdpdCBhZGQgZmlsZSAmJgoJZ2l0IGNvbW1pdCAtLWFtZW5kIC1DIEhFQUQgJiYKCWdpdCBzaG93ID5vdXQgJiYKCWdyZXAgImRpZmYgLS1jYyBmaWxlIiBvdXQKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2V0dXAgZm9yIC0tY2MgLS1yYXcnICcKCWJsb2I9JChlY2hvIGZpbGUgfCBnaXQgaGFzaC1vYmplY3QgLS1zdGRpbiAtdykgJiYKCWJhc2VfdHJlZT0kKGVjaG8gIjEwMDY0NCBibG9iICRibG9iCWZpbGUiIHwgZ2l0IG1rdHJlZSkgJiYKCXRyZWVzPSAmJgoJZm9yIGkgaW4gJCh0ZXN0X3NlcSAxIDQwKQoJZG8KCQlibG9iPSQoZWNobyBmaWxlJGkgfCBnaXQgaGFzaC1vYmplY3QgLS1zdGRpbiAtdykgJiYKCQl0cmVlcz0iJHRyZWVzJChlY2hvICIxMDA2NDQgYmxvYiAkYmxvYglmaWxlIiB8IGdpdCBta3RyZWUpJExGIiB8fCByZXR1cm4gMQoJZG9uZQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdjaGVjayAtLWNjIC0tcmF3IHdpdGggZm91ciB0cmVlcycgJwoJZm91cl90cmVlcz0kKGVjaG8gIiR0cmVlcyIgfCBzZWQgLWUgNHEpICYmCglnaXQgZGlmZiAtLWNjIC0tcmF3ICRmb3VyX3RyZWVzICRiYXNlX3RyZWUgPm91dCAmJgoJIyBDaGVjayBmb3IgZm91ciBsZWFkaW5nIGNvbG9ucyBpbiB0aGUgb3V0cHV0OgoJZ3JlcCAiXjo6OjpbXjpdIiBvdXQKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2hlY2sgLS1jYyAtLXJhdyB3aXRoIGZvcnR5IHRyZWVzJyAnCglnaXQgZGlmZiAtLWNjIC0tcmF3ICR0cmVlcyAkYmFzZV90cmVlID5vdXQgJiYKCSMgQ2hlY2sgZm9yIGZvcnR5IGxlYWRpbmcgY29sb25zIGluIHRoZSBvdXRwdXQ6CglncmVwICJeOjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6OlteOl0iIG91dAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzZXR1cCBjb21iaW5lZCBpZ25vcmUgc3BhY2VzJyAnCglnaXQgY2hlY2tvdXQgbWFpbiAmJgoJPnRlc3QgJiYKCWdpdCBhZGQgdGVzdCAmJgoJZ2l0IGNvbW1pdCAtbSBpbml0aWFsICYmCgoJdHIgLWQgUSA8PC1cRU9GID50ZXN0ICYmCglhbHdheXMgY29hbGVzY2UKCWVvbCBzcGFjZSBjb2FsZXNjZSBRCglzcGFjZSAgY2hhbmdlIGNvYWxlc2NlCglhbGwgc3BhIGNlcyBjb2FsZXNjZQoJZW9sIHNwYWNlcyBRCglzcGFjZSAgY2hhbmdlCglhbGwgc3BhIGNlcwoJRU9GCglnaXQgY29tbWl0IC1tICJ0ZXN0IHNwYWNlIGNoYW5nZSIgLWEgJiYKCglnaXQgY2hlY2tvdXQgLWIgc2lkZSBIRUFEXiAmJgoJdHIgLWQgUSA8PC1cRU9GID50ZXN0ICYmCglhbHdheXMgY29hbGVzY2UKCWVvbCBzcGFjZSBjb2FsZXNjZQoJc3BhY2UgY2hhbmdlIGNvYWxlc2NlCglhbGwgc3BhY2VzIGNvYWxlc2NlCgllb2wgc3BhY2VzCglzcGFjZSBjaGFuZ2UKCWFsbCBzcGFjZXMKCUVPRgoJZ2l0IGNvbW1pdCAtbSAidGVzdCBvdGhlciBzcGFjZSBjaGFuZ2VzIiAtYSAmJgoKCXRlc3RfbXVzdF9mYWlsIGdpdCBtZXJnZSBtYWluICYmCgl0ciAtZCBRIDw8LVxFT0YgPnRlc3QgJiYKCWVvbCBzcGFjZXMgUQoJc3BhY2UgIGNoYW5nZQoJYWxsIHNwYSBjZXMKCUVPRgoJZ2l0IGNvbW1pdCAtbSBtZXJnZWQgLWEKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2hlY2sgY29tYmluZWQgb3V0cHV0IChubyBpZ25vcmUgc3BhY2UpJyAnCglnaXQgc2hvdyA+YWN0dWFsLnRtcCAmJgoJc2VkIC1lICIxLC9eQEBAL2QiIDwgYWN0dWFsLnRtcCA+YWN0dWFsICYmCgl0ciAtZCBRIDw8LVxFT0YgPmV4cGVjdGVkICYmCgktLWFsd2F5cyBjb2FsZXNjZQoJLSBlb2wgc3BhY2UgY29hbGVzY2UKCS0gc3BhY2UgY2hhbmdlIGNvYWxlc2NlCgktIGFsbCBzcGFjZXMgY29hbGVzY2UKCS0gZW9sIHNwYWNlcwoJLSBzcGFjZSBjaGFuZ2UKCS0gYWxsIHNwYWNlcwoJIC1lb2wgc3BhY2UgY29hbGVzY2UgUQoJIC1zcGFjZSAgY2hhbmdlIGNvYWxlc2NlCgkgLWFsbCBzcGEgY2VzIGNvYWxlc2NlCgkrIGVvbCBzcGFjZXMgUQoJKyBzcGFjZSAgY2hhbmdlCgkrIGFsbCBzcGEgY2VzCglFT0YKCWNvbXBhcmVfZGlmZl9wYXRjaCBleHBlY3RlZCBhY3R1YWwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2hlY2sgY29tYmluZWQgb3V0cHV0IChpZ25vcmUgc3BhY2UgYXQgZW9sKScgJwoJZ2l0IHNob3cgLS1pZ25vcmUtc3BhY2UtYXQtZW9sID5hY3R1YWwudG1wICYmCglzZWQgLWUgIjEsL15AQEAvZCIgPCBhY3R1YWwudG1wID5hY3R1YWwgJiYKCXRyIC1kIFEgPDwtXEVPRiA+ZXhwZWN0ZWQgJiYKCS0tYWx3YXlzIGNvYWxlc2NlCgktLWVvbCBzcGFjZSBjb2FsZXNjZQoJLSBzcGFjZSBjaGFuZ2UgY29hbGVzY2UKCS0gYWxsIHNwYWNlcyBjb2FsZXNjZQoJIC1zcGFjZSAgY2hhbmdlIGNvYWxlc2NlCgkgLWFsbCBzcGEgY2VzIGNvYWxlc2NlCgkgIGVvbCBzcGFjZXMgUQoJLSBzcGFjZSBjaGFuZ2UKCS0gYWxsIHNwYWNlcwoJKyBzcGFjZSAgY2hhbmdlCgkrIGFsbCBzcGEgY2VzCglFT0YKCWNvbXBhcmVfZGlmZl9wYXRjaCBleHBlY3RlZCBhY3R1YWwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2hlY2sgY29tYmluZWQgb3V0cHV0IChpZ25vcmUgc3BhY2UgY2hhbmdlKScgJwoJZ2l0IHNob3cgLWIgPmFjdHVhbC50bXAgJiYKCXNlZCAtZSAiMSwvXkBAQC9kIiA8IGFjdHVhbC50bXAgPmFjdHVhbCAmJgoJdHIgLWQgUSA8PC1cRU9GID5leHBlY3RlZCAmJgoJLS1hbHdheXMgY29hbGVzY2UKCS0tZW9sIHNwYWNlIGNvYWxlc2NlCgktLXNwYWNlIGNoYW5nZSBjb2FsZXNjZQoJLSBhbGwgc3BhY2VzIGNvYWxlc2NlCgkgLWFsbCBzcGEgY2VzIGNvYWxlc2NlCgkgIGVvbCBzcGFjZXMgUQoJICBzcGFjZSAgY2hhbmdlCgktIGFsbCBzcGFjZXMKCSsgYWxsIHNwYSBjZXMKCUVPRgoJY29tcGFyZV9kaWZmX3BhdGNoIGV4cGVjdGVkIGFjdHVhbAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdjaGVjayBjb21iaW5lZCBvdXRwdXQgKGlnbm9yZSBhbGwgc3BhY2VzKScgJwoJZ2l0IHNob3cgLXcgPmFjdHVhbC50bXAgJiYKCXNlZCAtZSAiMSwvXkBAQC9kIiA8IGFjdHVhbC50bXAgPmFjdHVhbCAmJgoJdHIgLWQgUSA8PC1cRU9GID5leHBlY3RlZCAmJgoJLS1hbHdheXMgY29hbGVzY2UKCS0tZW9sIHNwYWNlIGNvYWxlc2NlCgktLXNwYWNlIGNoYW5nZSBjb2FsZXNjZQoJLS1hbGwgc3BhY2VzIGNvYWxlc2NlCgkgIGVvbCBzcGFjZXMgUQoJICBzcGFjZSAgY2hhbmdlCgkgIGFsbCBzcGEgY2VzCglFT0YKCWNvbXBhcmVfZGlmZl9wYXRjaCBleHBlY3RlZCBhY3R1YWwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY29tYmluZSBkaWZmIGNvYWxlc2NlIHNpbXBsZScgJwoJPnRlc3QgJiYKCWdpdCBhZGQgdGVzdCAmJgoJZ2l0IGNvbW1pdCAtbSBpbml0aWFsICYmCgl0ZXN0X3NlcSA0ID50ZXN0ICYmCglnaXQgY29tbWl0IC1hIC1tIGVtcHR5MSAmJgoJZ2l0IGJyYW5jaCBzaWRlMSAmJgoJZ2l0IGNoZWNrb3V0IEhFQUReICYmCgl0ZXN0X3NlcSA1ID50ZXN0ICYmCglnaXQgY29tbWl0IC1hIC1tIGVtcHR5MiAmJgoJdGVzdF9tdXN0X2ZhaWwgZ2l0IG1lcmdlIHNpZGUxICYmCgk+dGVzdCAmJgoJZ2l0IGNvbW1pdCAtYSAtbSBtZXJnZSAmJgoJZ2l0IHNob3cgPmFjdHVhbC50bXAgJiYKCXNlZCAtZSAiMSwvXkBAQC9kIiA8IGFjdHVhbC50bXAgPmFjdHVhbCAmJgoJdHIgLWQgUSA8PC1cRU9GID5leHBlY3RlZCAmJgoJLS0xCgktLTIKCS0tMwoJLS00CgktIDUKCUVPRgoJY29tcGFyZV9kaWZmX3BhdGNoIGV4cGVjdGVkIGFjdHVhbAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdjb21iaW5lIGRpZmYgY29hbGVzY2UgdHJpY2t5JyAnCgk+dGVzdCAmJgoJZ2l0IGFkZCB0ZXN0ICYmCglnaXQgY29tbWl0IC1tIGluaXRpYWwgLS1hbGxvdy1lbXB0eSAmJgoJY2F0IDw8LVxFT0YgPnRlc3QgJiYKCTMKCTEKCTIKCTMKCTQKCUVPRgoJZ2l0IGNvbW1pdCAtYSAtbSBlbXB0eTEgJiYKCWdpdCBicmFuY2ggLWYgc2lkZTEgJiYKCWdpdCBjaGVja291dCBIRUFEXiAmJgoJY2F0IDw8LVxFT0YgPnRlc3QgJiYKCTEKCTMKCTUKCTQKCUVPRgoJZ2l0IGNvbW1pdCAtYSAtbSBlbXB0eTIgJiYKCWdpdCBicmFuY2ggLWYgc2lkZTIgJiYKCXRlc3RfbXVzdF9mYWlsIGdpdCBtZXJnZSBzaWRlMSAmJgoJPnRlc3QgJiYKCWdpdCBjb21taXQgLWEgLW0gbWVyZ2UgJiYKCWdpdCBzaG93ID5hY3R1YWwudG1wICYmCglzZWQgLWUgIjEsL15AQEAvZCIgPCBhY3R1YWwudG1wID5hY3R1YWwgJiYKCXRyIC1kIFEgPDwtXEVPRiA+ZXhwZWN0ZWQgJiYKCSAtMwoJLS0xCgkgLTIKCS0tMwoJLSA1CgktLTQKCUVPRgoJY29tcGFyZV9kaWZmX3BhdGNoIGV4cGVjdGVkIGFjdHVhbCAmJgoJZ2l0IGNoZWNrb3V0IC1mIHNpZGUxICYmCgl0ZXN0X211c3RfZmFpbCBnaXQgbWVyZ2Ugc2lkZTIgJiYKCT50ZXN0ICYmCglnaXQgY29tbWl0IC1hIC1tIG1lcmdlICYmCglnaXQgc2hvdyA+YWN0dWFsLnRtcCAmJgoJc2VkIC1lICIxLC9eQEBAL2QiIDwgYWN0dWFsLnRtcCA+YWN0dWFsICYmCgl0ciAtZCBRIDw8LVxFT0YgPmV4cGVjdGVkICYmCgktIDMKCS0tMQoJLSAyCgktLTMKCSAtNQoJLS00CglFT0YKCWNvbXBhcmVfZGlmZl9wYXRjaCBleHBlY3RlZCBhY3R1YWwKJwoKdGVzdF9leHBlY3RfZmFpbHVyZSAnY29tYmluZSBkaWZmIGNvYWxlc2NlIHRocmVlIHBhcmVudHMnICcKCT50ZXN0ICYmCglnaXQgYWRkIHRlc3QgJiYKCWdpdCBjb21taXQgLW0gaW5pdGlhbCAtLWFsbG93LWVtcHR5ICYmCgljYXQgPDwtXEVPRiA+dGVzdCAmJgoJMwoJMQoJMgoJMwoJNAoJRU9GCglnaXQgY29tbWl0IC1hIC1tIGVtcHR5MSAmJgoJZ2l0IGNoZWNrb3V0IC1CIHNpZGUxICYmCglnaXQgY2hlY2tvdXQgSEVBRF4gJiYKCWNhdCA8PC1cRU9GID50ZXN0ICYmCgkxCgkzCgk3Cgk1Cgk0CglFT0YKCWdpdCBjb21taXQgLWEgLW0gZW1wdHkyICYmCglnaXQgYnJhbmNoIC1mIHNpZGUyICYmCglnaXQgY2hlY2tvdXQgSEVBRF4gJiYKCWNhdCA8PC1cRU9GID50ZXN0ICYmCgkzCgkxCgk2Cgk1Cgk0CglFT0YKCWdpdCBjb21taXQgLWEgLW0gZW1wdHkzICYmCgk+dGVzdCAmJgoJZ2l0IGFkZCB0ZXN0ICYmCglUUkVFPSQoZ2l0IHdyaXRlLXRyZWUpICYmCglDT01NSVQ9JChnaXQgY29tbWl0LXRyZWUgLXAgSEVBRCAtcCBzaWRlMSAtcCBzaWRlMiAtbSBtZXJnZSAkVFJFRSkgJiYKCWdpdCBzaG93ICRDT01NSVQgPmFjdHVhbC50bXAgJiYKCXNlZCAtZSAiMSwvXkBAQC9kIiA8IGFjdHVhbC50bXAgPmFjdHVhbCAmJgoJdHIgLWQgUSA8PC1cRU9GID5leHBlY3RlZCAmJgoJLS0gMwoJLS0tMQoJLSAgNgoJIC0gMgoJIC0tMwoJICAtNwoJLSAtNQoJLS0tNAoJRU9GCgljb21wYXJlX2RpZmZfcGF0Y2ggZXhwZWN0ZWQgYWN0dWFsCicKCiMgVGVzdCBmb3IgYSBidWcgcmVwb3J0ZWQgYXQKIyBodHRwczovL2xvcmUua2VybmVsLm9yZy9naXQvMjAxMzA1MTUxNDM1MDguR08yNTc0MkBsb2dpbi5kcnNudWdnbGVzLnN0ZGVyci5ubC8KIyB3aGVyZSBhIGRlbGV0ZSBsaW5lcyB3ZXJlIG1pc3NpbmcgZnJvbSBjb21iaW5lZCBkaWZmIG91dHB1dCB3aGVuIHRoZXkKIyBvY2N1cnJlZCBleGFjdGx5IGJlZm9yZSB0aGUgY29udGV4dCBsaW5lcyBvZiBhIGxhdGVyIGNoYW5nZS4KdGVzdF9leHBlY3Rfc3VjY2VzcyAnY29tYmluZSBkaWZmIG1pc3NpbmcgZGVsZXRlIGJ1ZycgJwoJZ2l0IGNvbW1pdCAtbSBpbml0aWFsIC0tYWxsb3ctZW1wdHkgJiYKCWNhdCA8PC1cRU9GID50ZXN0ICYmCgkxCgkyCgkzCgk0CglFT0YKCWdpdCBhZGQgdGVzdCAmJgoJZ2l0IGNvbW1pdCAtYSAtbSBzaWRlMSAmJgoJZ2l0IGNoZWNrb3V0IC1CIHNpZGUxICYmCglnaXQgY2hlY2tvdXQgSEVBRF4gJiYKCWNhdCA8PC1cRU9GID50ZXN0ICYmCgkwCgkxCgkyCgkzCgk0bW9kaWZpZWQKCUVPRgoJZ2l0IGFkZCB0ZXN0ICYmCglnaXQgY29tbWl0IC1tIHNpZGUyICYmCglnaXQgYnJhbmNoIC1mIHNpZGUyICYmCgl0ZXN0X211c3RfZmFpbCBnaXQgbWVyZ2UgLS1uby1jb21taXQgc2lkZTEgJiYKCWNhdCA8PC1cRU9GID50ZXN0ICYmCgkxCgkyCgkzCgk0bW9kaWZpZWQKCUVPRgoJZ2l0IGFkZCB0ZXN0ICYmCglnaXQgY29tbWl0IC1hIC1tIG1lcmdlICYmCglnaXQgZGlmZi10cmVlIC1jIC1wIEhFQUQgPmFjdHVhbC50bXAgJiYKCXNlZCAtZSAiMSwvXkBAQC9kIiA8IGFjdHVhbC50bXAgPmFjdHVhbCAmJgoJdHIgLWQgUSA8PC1cRU9GID5leHBlY3RlZCAmJgoJLSAwCgkgIDEKCSAgMgoJICAzCgkgLTQKCSArNG1vZGlmaWVkCglFT0YKCWNvbXBhcmVfZGlmZl9wYXRjaCBleHBlY3RlZCBhY3R1YWwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY29tYmluZSBkaWZmIGdldHMgdHJlZSBzb3J0aW5nIHJpZ2h0JyAnCgkjIGNyZWF0ZSBhIGRpcmVjdG9yeSBhbmQgYSBmaWxlIHRoYXQgc29ydCBkaWZmZXJlbnRseSBpbiB0cmVlcwoJIyB2ZXJzdXMgYnl0ZS13aXNlIChpbXBsaWVkICIvIiBzb3J0cyBhZnRlciAiLiIpCglnaXQgY2hlY2tvdXQgLWYgbWFpbiAmJgoJbWtkaXIgZm9vICYmCgllY2hvIGJhc2UgPmZvby9vbmUgJiYKCWVjaG8gYmFzZSA+Zm9vL3R3byAmJgoJZWNobyBiYXNlID5mb28uZXh0ICYmCglnaXQgYWRkIGZvbyBmb28uZXh0ICYmCglnaXQgY29tbWl0IC1tIGJhc2UgJiYKCgkjIG9uZSBzaWRlIG1vZGlmaWVzIGEgZmlsZSBpbiB0aGUgZGlyZWN0b3J5LCBhbG9uZyB3aXRoIHRoZSByb290CgkjIGZpbGUuLi4KCWVjaG8gbWFpbiA+Zm9vL29uZSAmJgoJZWNobyBtYWluID5mb28uZXh0ICYmCglnaXQgY29tbWl0IC1hIC1tIG1haW4gJiYKCgkjIHRoZSBvdGhlciBzaWRlIG1vZGlmaWVzIHRoZSBvdGhlciBmaWxlIGluIHRoZSBkaXJlY3RvcnkKCWdpdCBjaGVja291dCAtYiBvdGhlciBIRUFEXiAmJgoJZWNobyBvdGhlciA+Zm9vL3R3byAmJgoJZ2l0IGNvbW1pdCAtYSAtbSBvdGhlciAmJgoKCSMgQW5kIG5vdyB3ZSBtZXJnZS4gVGhlIGZpbGVzIGluIHRoZSBzdWJkaXJlY3Rvcnkgd2lsbCByZXNvbHZlIGNsZWFubHksCgkjIG1lYW5pbmcgdGhhdCBhIGNvbWJpbmVkIGRpZmYgd2lsbCBub3QgZmluZCB0aGVtIGludGVyZXN0aW5nLiBCdXQgaXQKCSMgd2lsbCBmaW5kIHRoZSB0cmVlIGl0c2VsZiBpbnRlcmVzdGluZywgYmVjYXVzZSBpdCBoYWQgdG8gYmUgbWVyZ2VkLgoJZ2l0IGNoZWNrb3V0IG1haW4gJiYKCWdpdCBtZXJnZSBvdGhlciAmJgoKCXByaW50ZiAiTU1cdGZvb1xuIiA+ZXhwZWN0ICYmCglnaXQgZGlmZi10cmVlIC1jIC0tbmFtZS1zdGF0dXMgLXQgSEVBRCA+YWN0dWFsLnRtcCAmJgoJc2VkIDFkIDxhY3R1YWwudG1wID5hY3R1YWwgJiYKCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2V0dXAgZm9yIC0tY29tYmluZWQtYWxsLXBhdGhzJyAnCglnaXQgYnJhbmNoIHNpZGUxYyAmJgoJZ2l0IGJyYW5jaCBzaWRlMmMgJiYKCWdpdCBjaGVja291dCBzaWRlMWMgJiYKCXRlc3Rfc2VxIDEgMTAgPmZpbGVuYW1lLXNpZGUxYyAmJgoJc2lkZTFjZj0kKGdpdCBoYXNoLW9iamVjdCBmaWxlbmFtZS1zaWRlMWMpICYmCglnaXQgYWRkIGZpbGVuYW1lLXNpZGUxYyAmJgoJZ2l0IGNvbW1pdCAtbSB3aXRoICYmCglnaXQgY2hlY2tvdXQgc2lkZTJjICYmCgl0ZXN0X3NlcSAxIDkgPmZpbGVuYW1lLXNpZGUyYyAmJgoJZWNobyB0ZW4gPj5maWxlbmFtZS1zaWRlMmMgJiYKCXNpZGUyY2Y9JChnaXQgaGFzaC1vYmplY3QgZmlsZW5hbWUtc2lkZTJjKSAmJgoJZ2l0IGFkZCBmaWxlbmFtZS1zaWRlMmMgJiYKCWdpdCBjb21taXQgLW0gaWFtICYmCglnaXQgY2hlY2tvdXQgLWIgbWVyZ2VyeSBzaWRlMWMgJiYKCWdpdCBtZXJnZSAtLW5vLWNvbW1pdCBzaWRlMmMgJiYKCWdpdCBybSBmaWxlbmFtZS1zaWRlMWMgJiYKCWVjaG8gZWxldmVuID4+ZmlsZW5hbWUtc2lkZTJjICYmCglnaXQgbXYgZmlsZW5hbWUtc2lkZTJjIGZpbGVuYW1lLW1lcmdlZCAmJgoJbWVyZ2VkZj0kKGdpdCBoYXNoLW9iamVjdCBmaWxlbmFtZS1tZXJnZWQpICYmCglnaXQgYWRkIGZpbGVuYW1lLW1lcmdlZCAmJgoJZ2l0IGNvbW1pdAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICctLWNvbWJpbmVkLWFsbC1wYXRocyBhbmQgLS1yYXcnICcKCWNhdCA8PC1FT0YgPmV4cGVjdCAmJgoJOjoxMDA2NDQgMTAwNjQ0IDEwMDY0NCAkc2lkZTFjZiAkc2lkZTJjZiAkbWVyZ2VkZiBSUglmaWxlbmFtZS1zaWRlMWMJZmlsZW5hbWUtc2lkZTJjCWZpbGVuYW1lLW1lcmdlZAoJRU9GCglnaXQgZGlmZi10cmVlIC1jIC1NIC0tcmF3IC0tY29tYmluZWQtYWxsLXBhdGhzIEhFQUQgPmFjdHVhbC50bXAgJiYKCXNlZCAxZCA8YWN0dWFsLnRtcCA+YWN0dWFsICYmCgl0ZXN0X2NtcCBleHBlY3QgYWN0dWFsCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJy0tY29tYmluZWQtYWxsLXBhdGhzIGFuZCAtLWNjJyAnCgljYXQgPDwtXEVPRiA+ZXhwZWN0ICYmCgktLS0gYS9maWxlbmFtZS1zaWRlMWMKCS0tLSBhL2ZpbGVuYW1lLXNpZGUyYwoJKysrIGIvZmlsZW5hbWUtbWVyZ2VkCglFT0YKCWdpdCBkaWZmLXRyZWUgLS1jYyAtTSAtLWNvbWJpbmVkLWFsbC1wYXRocyBIRUFEID5hY3R1YWwudG1wICYmCglncmVwIF5bLStdWy0rXVstK10gPGFjdHVhbC50bXAgPmFjdHVhbCAmJgoJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIEZVTk5ZTkFNRVMgJ3NldHVwIGZvciAtLWNvbWJpbmVkLWFsbC1wYXRocyB3aXRoIGZ1bm55IG5hbWVzJyAnCglnaXQgYnJhbmNoIHNpZGUxZCAmJgoJZ2l0IGJyYW5jaCBzaWRlMmQgJiYKCWdpdCBjaGVja291dCBzaWRlMWQgJiYKCXRlc3Rfc2VxIDEgMTAgPiIkKHByaW50ZiAiZmlsZVx0d2l0aFx0dGFicyIpIiAmJgoJZ2l0IGFkZCBmaWxlKiAmJgoJc2lkZTFkZj0kKGdpdCBoYXNoLW9iamVjdCAqdGFicykgJiYKCWdpdCBjb21taXQgLW0gd2l0aCAmJgoJZ2l0IGNoZWNrb3V0IHNpZGUyZCAmJgoJdGVzdF9zZXEgMSA5ID4iJChwcmludGYgImlcdGFtXHR0YWJiZWQiKSIgJiYKCWVjaG8gdGVuID4+IiQocHJpbnRmICJpXHRhbVx0dGFiYmVkIikiICYmCglnaXQgYWRkICp0YWJiZWQgJiYKCXNpZGUyZGY9JChnaXQgaGFzaC1vYmplY3QgKnRhYmJlZCkgJiYKCWdpdCBjb21taXQgLW0gaWFtICYmCglnaXQgY2hlY2tvdXQgLWIgZnVubnktbmFtZXMtbWVyZ2VyeSBzaWRlMWQgJiYKCWdpdCBtZXJnZSAtLW5vLWNvbW1pdCBzaWRlMmQgJiYKCWdpdCBybSAqdGFicyAmJgoJZWNobyBlbGV2ZW4gPj4iJChwcmludGYgImlcdGFtXHR0YWJiZWQiKSIgJiYKCWdpdCBtdiAiJChwcmludGYgImlcdGFtXHR0YWJiZWQiKSIgIiQocHJpbnRmICJmaWNrbGVcdG5hbWluZyIpIiAmJgoJZ2l0IGFkZCBmaWNrbGUqICYmCgloZWFkZj0kKGdpdCBoYXNoLW9iamVjdCBmaWNrbGUqKSAmJgoJZ2l0IGNvbW1pdCAmJgoJaGVhZD0kKGdpdCByZXYtcGFyc2UgSEVBRCkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBGVU5OWU5BTUVTICctLWNvbWJpbmVkLWFsbC1wYXRocyBhbmQgLS1yYXcgYW5kIGZ1bm55IG5hbWVzJyAnCgljYXQgPDwtRU9GID5leHBlY3QgJiYKCTo6MTAwNjQ0IDEwMDY0NCAxMDA2NDQgJHNpZGUxZGYgJHNpZGUyZGYgJGhlYWRmIFJSCSJmaWxlXHR3aXRoXHR0YWJzIgkiaVx0YW1cdHRhYmJlZCIJImZpY2tsZVx0bmFtaW5nIgoJRU9GCglnaXQgZGlmZi10cmVlIC1jIC1NIC0tcmF3IC0tY29tYmluZWQtYWxsLXBhdGhzIEhFQUQgPmFjdHVhbC50bXAgJiYKCXNlZCAxZCA8YWN0dWFsLnRtcCA+YWN0dWFsICYmCgl0ZXN0X2NtcCBleHBlY3QgYWN0dWFsCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgRlVOTllOQU1FUyAnLS1jb21iaW5lZC1hbGwtcGF0aHMgYW5kIC0tcmF3IC1hbmQgLXogYW5kIGZ1bm55IG5hbWVzJyAnCglwcmludGYgIiRoZWFkXDA6OjEwMDY0NCAxMDA2NDQgMTAwNjQ0ICRzaWRlMWRmICRzaWRlMmRmICRoZWFkZiBSUlwwZmlsZVx0d2l0aFx0dGFic1wwaVx0YW1cdHRhYmJlZFwwZmlja2xlXHRuYW1pbmdcMCIgPmV4cGVjdCAmJgoJZ2l0IGRpZmYtdHJlZSAtYyAtTSAtLXJhdyAtLWNvbWJpbmVkLWFsbC1wYXRocyAteiBIRUFEID5hY3R1YWwgJiYKCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBGVU5OWU5BTUVTICctLWNvbWJpbmVkLWFsbC1wYXRocyBhbmQgLS1jYyBhbmQgZnVubnkgbmFtZXMnICcKCWNhdCA8PC1cRU9GID5leHBlY3QgJiYKCS0tLSAiYS9maWxlXHR3aXRoXHR0YWJzIgoJLS0tICJhL2lcdGFtXHR0YWJiZWQiCgkrKysgImIvZmlja2xlXHRuYW1pbmciCglFT0YKCWdpdCBkaWZmLXRyZWUgLS1jYyAtTSAtLWNvbWJpbmVkLWFsbC1wYXRocyBIRUFEID5hY3R1YWwudG1wICYmCglncmVwIF5bLStdWy0rXVstK10gPGFjdHVhbC50bXAgPmFjdHVhbCAmJgoJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbAonCgp0ZXN0X2RvbmUK",
    "text": "#!/bin/sh\n\ntest_description='combined diff'\n\nGIT_TEST_DEFAULT_INITIAL_BRANCH_NAME=main\nexport GIT_TEST_DEFAULT_INITIAL_BRANCH_NAME\n\nTEST_PASSES_SANITIZE_LEAK=true\n. ./test-lib.sh\n. \"$TEST_DIRECTORY\"/lib-diff.sh\n\nsetup_helper () {\n\tone=$1 branch=$2 side=$3 &&\n\n\tgit branch $side $branch &&\n\tfor l in $one two three fyra\n\tdo\n\t\techo $l\n\tdone >file &&\n\tgit add file &&\n\ttest_tick &&\n\tgit commit -m $branch &&\n\tgit checkout $side &&\n\tfor l in $one two three quatro\n\tdo\n\t\techo $l\n\tdone >file &&\n\tgit add file &&\n\ttest_tick &&\n\tgit commit -m $side &&\n\ttest_must_fail git merge $branch &&\n\tfor l in $one three four\n\tdo\n\t\techo $l\n\tdone >file &&\n\tgit add file &&\n\ttest_tick &&\n\tgit commit -m \"merge $branch into $side\"\n}\n\nverify_helper () {\n\tit=$1 &&\n\n\t# Ignore lines that were removed only from the other parent\n\tsed -e '\n\t\t1,/^@@@/d\n\t\t/^ -/d\n\t\ts/^\\(.\\)./\\1/\n\t' \"$it\" >\"$it.actual.1\" &&\n\tsed -e '\n\t\t1,/^@@@/d\n\t\t/^- /d\n\t\ts/^.\\(.\\)/\\1/\n\t' \"$it\" >\"$it.actual.2\" &&\n\n\tgit diff \"$it^\" \"$it\" -- | sed -e '1,/^@@/d' >\"$it.expect.1\" &&\n\ttest_cmp \"$it.expect.1\" \"$it.actual.1\" &&\n\n\tgit diff \"$it^2\" \"$it\" -- | sed -e '1,/^@@/d' >\"$it.expect.2\" &&\n\ttest_cmp \"$it.expect.2\" \"$it.actual.2\"\n}\n\ntest_expect_success setup '\n\t>file &&\n\tgit add file &&\n\ttest_tick &&\n\tgit commit -m initial &&\n\n\tgit branch withone &&\n\tgit branch sansone &&\n\n\tgit checkout withone &&\n\tsetup_helper one withone sidewithone &&\n\n\tgit checkout sansone &&\n\tsetup_helper \"\" sansone sidesansone\n'\n\ntest_expect_success 'check combined output (1)' '\n\tgit show sidewithone -- >sidewithone &&\n\tverify_helper sidewithone\n'\n\ntest_expect_success 'check combined output (1) with git diff <rev>^!' '\n\tgit diff sidewithone^! -- >sidewithone &&\n\tverify_helper sidewithone\n'\n\ntest_expect_success 'check combined output (2)' '\n\tgit show sidesansone -- >sidesansone &&\n\tverify_helper sidesansone\n'\n\ntest_expect_success 'check combined output (2) with git diff <rev>^!' '\n\tgit diff sidesansone^! -- >sidesansone &&\n\tverify_helper sidesansone\n'\n\ntest_expect_success 'diagnose truncated file' '\n\t>file &&\n\tgit add file &&\n\tgit commit --amend -C HEAD &&\n\tgit show >out &&\n\tgrep \"diff --cc file\" out\n'\n\ntest_expect_success 'setup for --cc --raw' '\n\tblob=$(echo file | git hash-object --stdin -w) &&\n\tbase_tree=$(echo \"100644 blob $blob\tfile\" | git mktree) &&\n\ttrees= &&\n\tfor i in $(test_seq 1 40)\n\tdo\n\t\tblob=$(echo file$i | git hash-object --stdin -w) &&\n\t\ttrees=\"$trees$(echo \"100644 blob $blob\tfile\" | git mktree)$LF\" || return 1\n\tdone\n'\n\ntest_expect_success 'check --cc --raw with four trees' '\n\tfour_trees=$(echo \"$trees\" | sed -e 4q) &&\n\tgit diff --cc --raw $four_trees $base_tree >out &&\n\t# Check for four leading colons in the output:\n\tgrep \"^::::[^:]\" out\n'\n\ntest_expect_success 'check --cc --raw with forty trees' '\n\tgit diff --cc --raw $trees $base_tree >out &&\n\t# Check for forty leading colons in the output:\n\tgrep \"^::::::::::::::::::::::::::::::::::::::::[^:]\" out\n'\n\ntest_expect_success 'setup combined ignore spaces' '\n\tgit checkout main &&\n\t>test &&\n\tgit add test &&\n\tgit commit -m initial &&\n\n\ttr -d Q <<-\\EOF >test &&\n\talways coalesce\n\teol space coalesce Q\n\tspace  change coalesce\n\tall spa ces coalesce\n\teol spaces Q\n\tspace  change\n\tall spa ces\n\tEOF\n\tgit commit -m \"test space change\" -a &&\n\n\tgit checkout -b side HEAD^ &&\n\ttr -d Q <<-\\EOF >test &&\n\talways coalesce\n\teol space coalesce\n\tspace change coalesce\n\tall spaces coalesce\n\teol spaces\n\tspace change\n\tall spaces\n\tEOF\n\tgit commit -m \"test other space changes\" -a &&\n\n\ttest_must_fail git merge main &&\n\ttr -d Q <<-\\EOF >test &&\n\teol spaces Q\n\tspace  change\n\tall spa ces\n\tEOF\n\tgit commit -m merged -a\n'\n\ntest_expect_success 'check combined output (no ignore space)' '\n\tgit show >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t--always coalesce\n\t- eol space coalesce\n\t- space change coalesce\n\t- all spaces coalesce\n\t- eol spaces\n\t- space change\n\t- all spaces\n\t -eol space coalesce Q\n\t -space  change coalesce\n\t -all spa ces coalesce\n\t+ eol spaces Q\n\t+ space  change\n\t+ all spa ces\n\tEOF\n\tcompare_diff_patch expected actual\n'\n\ntest_expect_success 'check combined output (ignore space at eol)' '\n\tgit show --ignore-space-at-eol >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t--always coalesce\n\t--eol space coalesce\n\t- space change coalesce\n\t- all spaces coalesce\n\t -space  change coalesce\n\t -all spa ces coalesce\n\t  eol spaces Q\n\t- space change\n\t- all spaces\n\t+ space  change\n\t+ all spa ces\n\tEOF\n\tcompare_diff_patch expected actual\n'\n\ntest_expect_success 'check combined output (ignore space change)' '\n\tgit show -b >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t--always coalesce\n\t--eol space coalesce\n\t--space change coalesce\n\t- all spaces coalesce\n\t -all spa ces coalesce\n\t  eol spaces Q\n\t  space  change\n\t- all spaces\n\t+ all spa ces\n\tEOF\n\tcompare_diff_patch expected actual\n'\n\ntest_expect_success 'check combined output (ignore all spaces)' '\n\tgit show -w >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t--always coalesce\n\t--eol space coalesce\n\t--space change coalesce\n\t--all spaces coalesce\n\t  eol spaces Q\n\t  space  change\n\t  all spa ces\n\tEOF\n\tcompare_diff_patch expected actual\n'\n\ntest_expect_success 'combine diff coalesce simple' '\n\t>test &&\n\tgit add test &&\n\tgit commit -m initial &&\n\ttest_seq 4 >test &&\n\tgit commit -a -m empty1 &&\n\tgit branch side1 &&\n\tgit checkout HEAD^ &&\n\ttest_seq 5 >test &&\n\tgit commit -a -m empty2 &&\n\ttest_must_fail git merge side1 &&\n\t>test &&\n\tgit commit -a -m merge &&\n\tgit show >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t--1\n\t--2\n\t--3\n\t--4\n\t- 5\n\tEOF\n\tcompare_diff_patch expected actual\n'\n\ntest_expect_success 'combine diff coalesce tricky' '\n\t>test &&\n\tgit add test &&\n\tgit commit -m initial --allow-empty &&\n\tcat <<-\\EOF >test &&\n\t3\n\t1\n\t2\n\t3\n\t4\n\tEOF\n\tgit commit -a -m empty1 &&\n\tgit branch -f side1 &&\n\tgit checkout HEAD^ &&\n\tcat <<-\\EOF >test &&\n\t1\n\t3\n\t5\n\t4\n\tEOF\n\tgit commit -a -m empty2 &&\n\tgit branch -f side2 &&\n\ttest_must_fail git merge side1 &&\n\t>test &&\n\tgit commit -a -m merge &&\n\tgit show >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t -3\n\t--1\n\t -2\n\t--3\n\t- 5\n\t--4\n\tEOF\n\tcompare_diff_patch expected actual &&\n\tgit checkout -f side1 &&\n\ttest_must_fail git merge side2 &&\n\t>test &&\n\tgit commit -a -m merge &&\n\tgit show >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t- 3\n\t--1\n\t- 2\n\t--3\n\t -5\n\t--4\n\tEOF\n\tcompare_diff_patch expected actual\n'\n\ntest_expect_failure 'combine diff coalesce three parents' '\n\t>test &&\n\tgit add test &&\n\tgit commit -m initial --allow-empty &&\n\tcat <<-\\EOF >test &&\n\t3\n\t1\n\t2\n\t3\n\t4\n\tEOF\n\tgit commit -a -m empty1 &&\n\tgit checkout -B side1 &&\n\tgit checkout HEAD^ &&\n\tcat <<-\\EOF >test &&\n\t1\n\t3\n\t7\n\t5\n\t4\n\tEOF\n\tgit commit -a -m empty2 &&\n\tgit branch -f side2 &&\n\tgit checkout HEAD^ &&\n\tcat <<-\\EOF >test &&\n\t3\n\t1\n\t6\n\t5\n\t4\n\tEOF\n\tgit commit -a -m empty3 &&\n\t>test &&\n\tgit add test &&\n\tTREE=$(git write-tree) &&\n\tCOMMIT=$(git commit-tree -p HEAD -p side1 -p side2 -m merge $TREE) &&\n\tgit show $COMMIT >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t-- 3\n\t---1\n\t-  6\n\t - 2\n\t --3\n\t  -7\n\t- -5\n\t---4\n\tEOF\n\tcompare_diff_patch expected actual\n'\n\n# Test for a bug reported at\n# https://lore.kernel.org/git/20130515143508.GO25742@login.drsnuggles.stderr.nl/\n# where a delete lines were missing from combined diff output when they\n# occurred exactly before the context lines of a later change.\ntest_expect_success 'combine diff missing delete bug' '\n\tgit commit -m initial --allow-empty &&\n\tcat <<-\\EOF >test &&\n\t1\n\t2\n\t3\n\t4\n\tEOF\n\tgit add test &&\n\tgit commit -a -m side1 &&\n\tgit checkout -B side1 &&\n\tgit checkout HEAD^ &&\n\tcat <<-\\EOF >test &&\n\t0\n\t1\n\t2\n\t3\n\t4modified\n\tEOF\n\tgit add test &&\n\tgit commit -m side2 &&\n\tgit branch -f side2 &&\n\ttest_must_fail git merge --no-commit side1 &&\n\tcat <<-\\EOF >test &&\n\t1\n\t2\n\t3\n\t4modified\n\tEOF\n\tgit add test &&\n\tgit commit -a -m merge &&\n\tgit diff-tree -c -p HEAD >actual.tmp &&\n\tsed -e \"1,/^@@@/d\" < actual.tmp >actual &&\n\ttr -d Q <<-\\EOF >expected &&\n\t- 0\n\t  1\n\t  2\n\t  3\n\t -4\n\t +4modified\n\tEOF\n\tcompare_diff_patch expected actual\n'\n\ntest_expect_success 'combine diff gets tree sorting right' '\n\t# create a directory and a file that sort differently in trees\n\t# versus byte-wise (implied \"/\" sorts after \".\")\n\tgit checkout -f main &&\n\tmkdir foo &&\n\techo base >foo/one &&\n\techo base >foo/two &&\n\techo base >foo.ext &&\n\tgit add foo foo.ext &&\n\tgit commit -m base &&\n\n\t# one side modifies a file in the directory, along with the root\n\t# file...\n\techo main >foo/one &&\n\techo main >foo.ext &&\n\tgit commit -a -m main &&\n\n\t# the other side modifies the other file in the directory\n\tgit checkout -b other HEAD^ &&\n\techo other >foo/two &&\n\tgit commit -a -m other &&\n\n\t# And now we merge. The files in the subdirectory will resolve cleanly,\n\t# meaning that a combined diff will not find them interesting. But it\n\t# will find the tree itself interesting, because it had to be merged.\n\tgit checkout main &&\n\tgit merge other &&\n\n\tprintf \"MM\\tfoo\\n\" >expect &&\n\tgit diff-tree -c --name-status -t HEAD >actual.tmp &&\n\tsed 1d <actual.tmp >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success 'setup for --combined-all-paths' '\n\tgit branch side1c &&\n\tgit branch side2c &&\n\tgit checkout side1c &&\n\ttest_seq 1 10 >filename-side1c &&\n\tside1cf=$(git hash-object filename-side1c) &&\n\tgit add filename-side1c &&\n\tgit commit -m with &&\n\tgit checkout side2c &&\n\ttest_seq 1 9 >filename-side2c &&\n\techo ten >>filename-side2c &&\n\tside2cf=$(git hash-object filename-side2c) &&\n\tgit add filename-side2c &&\n\tgit commit -m iam &&\n\tgit checkout -b mergery side1c &&\n\tgit merge --no-commit side2c &&\n\tgit rm filename-side1c &&\n\techo eleven >>filename-side2c &&\n\tgit mv filename-side2c filename-merged &&\n\tmergedf=$(git hash-object filename-merged) &&\n\tgit add filename-merged &&\n\tgit commit\n'\n\ntest_expect_success '--combined-all-paths and --raw' '\n\tcat <<-EOF >expect &&\n\t::100644 100644 100644 $side1cf $side2cf $mergedf RR\tfilename-side1c\tfilename-side2c\tfilename-merged\n\tEOF\n\tgit diff-tree -c -M --raw --combined-all-paths HEAD >actual.tmp &&\n\tsed 1d <actual.tmp >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success '--combined-all-paths and --cc' '\n\tcat <<-\\EOF >expect &&\n\t--- a/filename-side1c\n\t--- a/filename-side2c\n\t+++ b/filename-merged\n\tEOF\n\tgit diff-tree --cc -M --combined-all-paths HEAD >actual.tmp &&\n\tgrep ^[-+][-+][-+] <actual.tmp >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success FUNNYNAMES 'setup for --combined-all-paths with funny names' '\n\tgit branch side1d &&\n\tgit branch side2d &&\n\tgit checkout side1d &&\n\ttest_seq 1 10 >\"$(printf \"file\\twith\\ttabs\")\" &&\n\tgit add file* &&\n\tside1df=$(git hash-object *tabs) &&\n\tgit commit -m with &&\n\tgit checkout side2d &&\n\ttest_seq 1 9 >\"$(printf \"i\\tam\\ttabbed\")\" &&\n\techo ten >>\"$(printf \"i\\tam\\ttabbed\")\" &&\n\tgit add *tabbed &&\n\tside2df=$(git hash-object *tabbed) &&\n\tgit commit -m iam &&\n\tgit checkout -b funny-names-mergery side1d &&\n\tgit merge --no-commit side2d &&\n\tgit rm *tabs &&\n\techo eleven >>\"$(printf \"i\\tam\\ttabbed\")\" &&\n\tgit mv \"$(printf \"i\\tam\\ttabbed\")\" \"$(printf \"fickle\\tnaming\")\" &&\n\tgit add fickle* &&\n\theadf=$(git hash-object fickle*) &&\n\tgit commit &&\n\thead=$(git rev-parse HEAD)\n'\n\ntest_expect_success FUNNYNAMES '--combined-all-paths and --raw and funny names' '\n\tcat <<-EOF >expect &&\n\t::100644 100644 100644 $side1df $side2df $headf RR\t\"file\\twith\\ttabs\"\t\"i\\tam\\ttabbed\"\t\"fickle\\tnaming\"\n\tEOF\n\tgit diff-tree -c -M --raw --combined-all-paths HEAD >actual.tmp &&\n\tsed 1d <actual.tmp >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success FUNNYNAMES '--combined-all-paths and --raw -and -z and funny names' '\n\tprintf \"$head\\0::100644 100644 100644 $side1df $side2df $headf RR\\0file\\twith\\ttabs\\0i\\tam\\ttabbed\\0fickle\\tnaming\\0\" >expect &&\n\tgit diff-tree -c -M --raw --combined-all-paths -z HEAD >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success FUNNYNAMES '--combined-all-paths and --cc and funny names' '\n\tcat <<-\\EOF >expect &&\n\t--- \"a/file\\twith\\ttabs\"\n\t--- \"a/i\\tam\\ttabbed\"\n\t+++ \"b/fickle\\tnaming\"\n\tEOF\n\tgit diff-tree --cc -M --combined-all-paths HEAD >actual.tmp &&\n\tgrep ^[-+][-+][-+] <actual.tmp >actual &&\n\ttest_cmp expect actual\n'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "00190802d831f032fd936b3fe11ad5661dfb6ca5",
  "sha1_ok": true,
  "size": 12363
}
