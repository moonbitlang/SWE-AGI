{
  "content": {
    "base64": "IyEvYmluL3NoCiMKIyBDb3B5cmlnaHQgKGMpIDIwMDYgSm9oYW5uZXMgRS4gU2NoaW5kZWxpbgoKIyBTSE9SVCBERVNDUklQVElPTgojCiMgVGhpcyBzY3JpcHQgbWFrZXMgaXQgZWFzeSB0byBmaXggdXAgY29tbWl0cyBpbiB0aGUgbWlkZGxlIG9mIGEgc2VyaWVzLAojIGFuZCByZWFycmFuZ2UgY29tbWl0cy4KIwojIFRoZSBvcmlnaW5hbCBpZGVhIGNvbWVzIGZyb20gRXJpYyBXLiBCaWVkZXJtYW4sIGluCiMgaHR0cDovL2FydGljbGUuZ21hbmUub3JnL2dtYW5lLmNvbXAudmVyc2lvbi1jb250cm9sLmdpdC8yMjQwNwoKT1BUSU9OU19LRUVQREFTSERBU0g9Ck9QVElPTlNfU1BFQz0iXApnaXQtcmViYXNlIFstaV0gW29wdGlvbnNdIFstLV0gPHVwc3RyZWFtPiBbPGJyYW5jaD5dCmdpdC1yZWJhc2UgWy1pXSAoLS1jb250aW51ZSB8IC0tYWJvcnQgfCAtLXNraXApCi0tCiBBdmFpbGFibGUgb3B0aW9ucyBhcmUKdix2ZXJib3NlICAgICAgICAgIGRpc3BsYXkgYSBkaWZmc3RhdCBvZiB3aGF0IGNoYW5nZWQgdXBzdHJlYW0Kb250bz0gICAgICAgICAgICAgIHJlYmFzZSBvbnRvIGdpdmVuIGJyYW5jaCBpbnN0ZWFkIG9mIHVwc3RyZWFtCnAscHJlc2VydmUtbWVyZ2VzICB0cnkgdG8gcmVjcmVhdGUgbWVyZ2VzIGluc3RlYWQgb2YgaWdub3JpbmcgdGhlbQpzLHN0cmF0ZWd5PSAgICAgICAgdXNlIHRoZSBnaXZlbiBtZXJnZSBzdHJhdGVneQptLG1lcmdlICAgICAgICAgICAgYWx3YXlzIHVzZWQgKG5vLW9wKQppLGludGVyYWN0aXZlICAgICAgYWx3YXlzIHVzZWQgKG5vLW9wKQogQWN0aW9uczoKY29udGludWUgICAgICAgICAgIGNvbnRpbnVlIHJlYmFzaW5nIHByb2Nlc3MKYWJvcnQgICAgICAgICAgICAgIGFib3J0IHJlYmFzaW5nIHByb2Nlc3MgYW5kIHJlc3RvcmUgb3JpZ2luYWwgYnJhbmNoCnNraXAgICAgICAgICAgICAgICBza2lwIGN1cnJlbnQgcGF0Y2ggYW5kIGNvbnRpbnVlIHJlYmFzaW5nIHByb2Nlc3MKbm8tdmVyaWZ5ICAgICAgICAgIG92ZXJyaWRlIHByZS1yZWJhc2UgaG9vayBmcm9tIHN0b3BwaW5nIHRoZSBvcGVyYXRpb24Kcm9vdCAgICAgICAgICAgICAgIHJlYmFzZSBhbGwgcmVhY2hhYmxlIGNvbW1taXRzIHVwIHRvIHRoZSByb290KHMpCiIKCi4gZ2l0LXNoLXNldHVwCnJlcXVpcmVfd29ya190cmVlCgpET1RFU1Q9IiRHSVRfRElSL3JlYmFzZS1tZXJnZSIKVE9ETz0iJERPVEVTVCIvZ2l0LXJlYmFzZS10b2RvCkRPTkU9IiRET1RFU1QiL2RvbmUKTVNHPSIkRE9URVNUIi9tZXNzYWdlClNRVUFTSF9NU0c9IiRET1RFU1QiL21lc3NhZ2Utc3F1YXNoClJFV1JJVFRFTj0iJERPVEVTVCIvcmV3cml0dGVuCkRST1BQRUQ9IiRET1RFU1QiL2Ryb3BwZWQKUFJFU0VSVkVfTUVSR0VTPQpTVFJBVEVHWT0KT05UTz0KVkVSQk9TRT0KT0tfVE9fU0tJUF9QUkVfUkVCQVNFPQpSRUJBU0VfUk9PVD0KCkdJVF9DSEVSUllfUElDS19IRUxQPSIgIEFmdGVyIHJlc29sdmluZyB0aGUgY29uZmxpY3RzLAptYXJrIHRoZSBjb3JyZWN0ZWQgcGF0aHMgd2l0aCAnZ2l0IGFkZCA8cGF0aHM+JywgYW5kCnJ1biAnZ2l0IHJlYmFzZSAtLWNvbnRpbnVlJyIKZXhwb3J0IEdJVF9DSEVSUllfUElDS19IRUxQCgp3YXJuICgpIHsKCWVjaG8gIiQqIiA+JjIKfQoKb3V0cHV0ICgpIHsKCWNhc2UgIiRWRVJCT1NFIiBpbgoJJycpCgkJb3V0cHV0PSQoIiRAIiAyPiYxICkKCQlzdGF0dXM9JD8KCQl0ZXN0ICRzdGF0dXMgIT0gMCAmJiBwcmludGYgIiVzXG4iICIkb3V0cHV0IgoJCXJldHVybiAkc3RhdHVzCgkJOzsKCSopCgkJIiRAIgoJCTs7Cgllc2FjCn0KCnJ1bl9wcmVfcmViYXNlX2hvb2sgKCkgewoJaWYgdGVzdCAteiAiJE9LX1RPX1NLSVBfUFJFX1JFQkFTRSIgJiYKCSAgIHRlc3QgLXggIiRHSVRfRElSL2hvb2tzL3ByZS1yZWJhc2UiCgl0aGVuCgkJIiRHSVRfRElSL2hvb2tzL3ByZS1yZWJhc2UiICR7MSsiJEAifSB8fCB7CgkJCWVjaG8gPiYyICJUaGUgcHJlLXJlYmFzZSBob29rIHJlZnVzZWQgdG8gcmViYXNlLiIKCQkJZXhpdCAxCgkJfQoJZmkKfQoKcmVxdWlyZV9jbGVhbl93b3JrX3RyZWUgKCkgewoJIyB0ZXN0IGlmIHdvcmtpbmcgdHJlZSBpcyBkaXJ0eQoJZ2l0IHJldi1wYXJzZSAtLXZlcmlmeSBIRUFEID4gL2Rldi9udWxsICYmCglnaXQgdXBkYXRlLWluZGV4IC0taWdub3JlLXN1Ym1vZHVsZXMgLS1yZWZyZXNoICYmCglnaXQgZGlmZi1maWxlcyAtLXF1aWV0IC0taWdub3JlLXN1Ym1vZHVsZXMgJiYKCWdpdCBkaWZmLWluZGV4IC0tY2FjaGVkIC0tcXVpZXQgSEVBRCAtLWlnbm9yZS1zdWJtb2R1bGVzIC0tIHx8CglkaWUgIldvcmtpbmcgdHJlZSBpcyBkaXJ0eSIKfQoKT1JJR19SRUZMT0dfQUNUSU9OPSIkR0lUX1JFRkxPR19BQ1RJT04iCgpjb21tZW50X2Zvcl9yZWZsb2cgKCkgewoJY2FzZSAiJE9SSUdfUkVGTE9HX0FDVElPTiIgaW4KCScnfHJlYmFzZSopCgkJR0lUX1JFRkxPR19BQ1RJT049InJlYmFzZSAtaSAoJDEpIgoJCWV4cG9ydCBHSVRfUkVGTE9HX0FDVElPTgoJCTs7Cgllc2FjCn0KCmxhc3RfY291bnQ9Cm1hcmtfYWN0aW9uX2RvbmUgKCkgewoJc2VkIC1lIDFxIDwgIiRUT0RPIiA+PiAiJERPTkUiCglzZWQgLWUgMWQgPCAiJFRPRE8iID4+ICIkVE9ETyIubmV3CgltdiAtZiAiJFRPRE8iLm5ldyAiJFRPRE8iCgljb3VudD0kKGdyZXAgLWMgJ15bXiNdJyA8ICIkRE9ORSIpCgl0b3RhbD0kKCgkY291bnQrJChncmVwIC1jICdeW14jXScgPCAiJFRPRE8iKSkpCglpZiB0ZXN0ICIkbGFzdF9jb3VudCIgIT0gIiRjb3VudCIKCXRoZW4KCQlsYXN0X2NvdW50PSRjb3VudAoJCXByaW50ZiAiUmViYXNpbmcgKCVkLyVkKVxyIiAkY291bnQgJHRvdGFsCgkJdGVzdCAteiAiJFZFUkJPU0UiIHx8IGVjaG8KCWZpCn0KCm1ha2VfcGF0Y2ggKCkgewoJc2hhMV9hbmRfcGFyZW50cz0iJChnaXQgcmV2LWxpc3QgLS1wYXJlbnRzIC0xICIkMSIpIgoJY2FzZSAiJHNoYTFfYW5kX3BhcmVudHMiIGluCgk/KicgJz8qJyAnPyopCgkJZ2l0IGRpZmYgLS1jYyAkc2hhMV9hbmRfcGFyZW50cwoJCTs7Cgk/KicgJz8qKQoJCWdpdCBkaWZmLXRyZWUgLXAgIiQxXiEiCgkJOzsKCSopCgkJZWNobyAiUm9vdCBjb21taXQiCgkJOzsKCWVzYWMgPiAiJERPVEVTVCIvcGF0Y2gKCXRlc3QgLWYgIiRET1RFU1QiL21lc3NhZ2UgfHwKCQlnaXQgY2F0LWZpbGUgY29tbWl0ICIkMSIgfCBzZWQgIjEsL14kL2QiID4gIiRET1RFU1QiL21lc3NhZ2UKCXRlc3QgLWYgIiRET1RFU1QiL2F1dGhvci1zY3JpcHQgfHwKCQlnZXRfYXV0aG9yX2lkZW50X2Zyb21fY29tbWl0ICIkMSIgPiAiJERPVEVTVCIvYXV0aG9yLXNjcmlwdAp9CgpkaWVfd2l0aF9wYXRjaCAoKSB7CgltYWtlX3BhdGNoICIkMSIKCWdpdCByZXJlcmUKCWRpZSAiJDIiCn0KCmRpZV9hYm9ydCAoKSB7CglybSAtcmYgIiRET1RFU1QiCglkaWUgIiQxIgp9CgpoYXNfYWN0aW9uICgpIHsKCWdyZXAgJ15bXiNdJyAiJDEiID4vZGV2L251bGwKfQoKcGlja19vbmUgKCkgewoJbm9fZmY9CgljYXNlICIkMSIgaW4gLW4pIHNoYTE9JDI7IG5vX2ZmPXQgOzsgKikgc2hhMT0kMSA7OyBlc2FjCglvdXRwdXQgZ2l0IHJldi1wYXJzZSAtLXZlcmlmeSAkc2hhMSB8fCBkaWUgIkludmFsaWQgY29tbWl0IG5hbWU6ICRzaGExIgoJdGVzdCAtZCAiJFJFV1JJVFRFTiIgJiYKCQlwaWNrX29uZV9wcmVzZXJ2aW5nX21lcmdlcyAiJEAiICYmIHJldHVybgoJaWYgdGVzdCAhIC16ICIkUkVCQVNFX1JPT1QiCgl0aGVuCgkJb3V0cHV0IGdpdCBjaGVycnktcGljayAiJEAiCgkJcmV0dXJuCglmaQoJcGFyZW50X3NoYTE9JChnaXQgcmV2LXBhcnNlIC0tdmVyaWZ5ICRzaGExXikgfHwKCQlkaWUgIkNvdWxkIG5vdCBnZXQgdGhlIHBhcmVudCBvZiAkc2hhMSIKCWN1cnJlbnRfc2hhMT0kKGdpdCByZXYtcGFyc2UgLS12ZXJpZnkgSEVBRCkKCWlmIHRlc3QgIiRub19mZiRjdXJyZW50X3NoYTEiID0gIiRwYXJlbnRfc2hhMSI7IHRoZW4KCQlvdXRwdXQgZ2l0IHJlc2V0IC0taGFyZCAkc2hhMQoJCXRlc3QgImEkMSIgPSBhLW4gJiYgb3V0cHV0IGdpdCByZXNldCAtLXNvZnQgJGN1cnJlbnRfc2hhMQoJCXNoYTE9JChnaXQgcmV2LXBhcnNlIC0tc2hvcnQgJHNoYTEpCgkJb3V0cHV0IHdhcm4gRmFzdCBmb3J3YXJkIHRvICRzaGExCgllbHNlCgkJb3V0cHV0IGdpdCBjaGVycnktcGljayAiJEAiCglmaQp9CgpwaWNrX29uZV9wcmVzZXJ2aW5nX21lcmdlcyAoKSB7CglmYXN0X2ZvcndhcmQ9dAoJY2FzZSAiJDEiIGluCgktbikKCQlmYXN0X2ZvcndhcmQ9ZgoJCXNoYTE9JDIKCQk7OwoJKikKCQlzaGExPSQxCgkJOzsKCWVzYWMKCXNoYTE9JChnaXQgcmV2LXBhcnNlICRzaGExKQoKCWlmIHRlc3QgLWYgIiRET1RFU1QiL2N1cnJlbnQtY29tbWl0Cgl0aGVuCgkJaWYgdGVzdCAiJGZhc3RfZm9yd2FyZCIgPSB0CgkJdGhlbgoJCQljYXQgIiRET1RFU1QiL2N1cnJlbnQtY29tbWl0IHwgd2hpbGUgcmVhZCBjdXJyZW50X2NvbW1pdAoJCQlkbwoJCQkJZ2l0IHJldi1wYXJzZSBIRUFEID4gIiRSRVdSSVRURU4iLyRjdXJyZW50X2NvbW1pdAoJCQlkb25lCgkJCXJtICIkRE9URVNUIi9jdXJyZW50LWNvbW1pdCB8fAoJCQlkaWUgIkNhbm5vdCB3cml0ZSBjdXJyZW50IGNvbW1pdCdzIHJlcGxhY2VtZW50IHNoYTEiCgkJZmkKCWZpCgoJZWNobyAkc2hhMSA+PiAiJERPVEVTVCIvY3VycmVudC1jb21taXQKCgkjIHJld3JpdGUgcGFyZW50czsgaWYgbm9uZSB3ZXJlIHJld3JpdHRlbiwgd2UgY2FuIGZhc3QtZm9yd2FyZC4KCW5ld19wYXJlbnRzPQoJcGVuZD0iICQoZ2l0IHJldi1saXN0IC0tcGFyZW50cyAtMSAkc2hhMSB8IGN1dCAtZCcgJyAtcyAtZjItKSIKCWlmIHRlc3QgIiRwZW5kIiA9ICIgIgoJdGhlbgoJCXBlbmQ9IiByb290IgoJZmkKCXdoaWxlIFsgIiRwZW5kIiAhPSAiIiBdCglkbwoJCXA9JChleHByICIkcGVuZCIgOiAnIFwoW14gXSpcKScpCgkJcGVuZD0iJHtwZW5kIyAkcH0iCgoJCWlmIHRlc3QgLWYgIiRSRVdSSVRURU4iLyRwCgkJdGhlbgoJCQluZXdfcD0kKGNhdCAiJFJFV1JJVFRFTiIvJHApCgoJCQkjIElmIHRoZSB0b2RvIHJlb3JkZXJlZCBjb21taXRzLCBhbmQgb3VyIHBhcmVudCBpcyBtYXJrZWQgZm9yCgkJCSMgcmV3cml0aW5nLCBidXQgaGFzbid0IGJlZW4gZ290dGVuIHRvIHlldCwgYXNzdW1lIHRoZSB1c2VyIG1lYW50IHRvCgkJCSMgZHJvcCBpdCBvbiB0b3Agb2YgdGhlIGN1cnJlbnQgSEVBRAoJCQlpZiB0ZXN0IC16ICIkbmV3X3AiCgkJCXRoZW4KCQkJCW5ld19wPSQoZ2l0IHJldi1wYXJzZSBIRUFEKQoJCQlmaQoKCQkJdGVzdCAkcCAhPSAkbmV3X3AgJiYgZmFzdF9mb3J3YXJkPWYKCQkJY2FzZSAiJG5ld19wYXJlbnRzIiBpbgoJCQkqJG5ld19wKikKCQkJCTs7ICMgZG8gbm90aGluZzsgdGhhdCBwYXJlbnQgaXMgYWxyZWFkeSB0aGVyZQoJCQkqKQoJCQkJbmV3X3BhcmVudHM9IiRuZXdfcGFyZW50cyAkbmV3X3AiCgkJCQk7OwoJCQllc2FjCgkJZWxzZQoJCQlpZiB0ZXN0IC1mICIkRFJPUFBFRCIvJHAKCQkJdGhlbgoJCQkJZmFzdF9mb3J3YXJkPWYKCQkJCXJlcGxhY2VtZW50PSIkKGNhdCAiJERST1BQRUQiLyRwKSIKCQkJCXRlc3QgLXogIiRyZXBsYWNlbWVudCIgJiYgcmVwbGFjZW1lbnQ9cm9vdAoJCQkJcGVuZD0iICRyZXBsYWNlbWVudCRwZW5kIgoJCQllbHNlCgkJCQluZXdfcGFyZW50cz0iJG5ld19wYXJlbnRzICRwIgoJCQlmaQoJCWZpCglkb25lCgljYXNlICRmYXN0X2ZvcndhcmQgaW4KCXQpCgkJb3V0cHV0IHdhcm4gIkZhc3QgZm9yd2FyZCB0byAkc2hhMSIKCQlvdXRwdXQgZ2l0IHJlc2V0IC0taGFyZCAkc2hhMSB8fAoJCQlkaWUgIkNhbm5vdCBmYXN0IGZvcndhcmQgdG8gJHNoYTEiCgkJOzsKCWYpCgkJZmlyc3RfcGFyZW50PSQoZXhwciAiJG5ld19wYXJlbnRzIiA6ICcgXChbXiBdKlwpJykKCgkJaWYgWyAiJDEiICE9ICItbiIgXQoJCXRoZW4KCQkJIyBkZXRhY2ggSEVBRCB0byBjdXJyZW50IHBhcmVudAoJCQlvdXRwdXQgZ2l0IGNoZWNrb3V0ICRmaXJzdF9wYXJlbnQgMj4gL2Rldi9udWxsIHx8CgkJCQlkaWUgIkNhbm5vdCBtb3ZlIEhFQUQgdG8gJGZpcnN0X3BhcmVudCIKCQlmaQoKCQljYXNlICIkbmV3X3BhcmVudHMiIGluCgkJJyAnKicgJyopCgkJCXRlc3QgImEkMSIgPSBhLW4gJiYgZGllICJSZWZ1c2luZyB0byBzcXVhc2ggYSBtZXJnZTogJHNoYTEiCgoJCQkjIHJlZG8gbWVyZ2UKCQkJYXV0aG9yX3NjcmlwdD0kKGdldF9hdXRob3JfaWRlbnRfZnJvbV9jb21taXQgJHNoYTEpCgkJCWV2YWwgIiRhdXRob3Jfc2NyaXB0IgoJCQltc2c9IiQoZ2l0IGNhdC1maWxlIGNvbW1pdCAkc2hhMSB8IHNlZCAtZSAnMSwvXiQvZCcpIgoJCQkjIE5vIHBvaW50IGluIG1lcmdpbmcgdGhlIGZpcnN0IHBhcmVudCwgdGhhdCdzIEhFQUQKCQkJbmV3X3BhcmVudHM9JHtuZXdfcGFyZW50cyMgJGZpcnN0X3BhcmVudH0KCQkJaWYgISBHSVRfQVVUSE9SX05BTUU9IiRHSVRfQVVUSE9SX05BTUUiIFwKCQkJCUdJVF9BVVRIT1JfRU1BSUw9IiRHSVRfQVVUSE9SX0VNQUlMIiBcCgkJCQlHSVRfQVVUSE9SX0RBVEU9IiRHSVRfQVVUSE9SX0RBVEUiIFwKCQkJCW91dHB1dCBnaXQgbWVyZ2UgJFNUUkFURUdZIC1tICIkbXNnIiBcCgkJCQkJJG5ld19wYXJlbnRzCgkJCXRoZW4KCQkJCXByaW50ZiAiJXNcbiIgIiRtc2ciID4gIiRHSVRfRElSIi9NRVJHRV9NU0cKCQkJCWRpZV93aXRoX3BhdGNoICRzaGExICJFcnJvciByZWRvaW5nIG1lcmdlICRzaGExIgoJCQlmaQoJCQk7OwoJCSopCgkJCW91dHB1dCBnaXQgY2hlcnJ5LXBpY2sgIiRAIiB8fAoJCQkJZGllX3dpdGhfcGF0Y2ggJHNoYTEgIkNvdWxkIG5vdCBwaWNrICRzaGExIgoJCQk7OwoJCWVzYWMKCQk7OwoJZXNhYwp9CgpudGhfc3RyaW5nICgpIHsKCWNhc2UgIiQxIiBpbgoJKjFbMC05XXwqWzA0LTldKSBlY2hvICIkMSJ0aDs7CgkqMSkgZWNobyAiJDEic3Q7OwoJKjIpIGVjaG8gIiQxIm5kOzsKCSozKSBlY2hvICIkMSJyZDs7Cgllc2FjCn0KCm1ha2Vfc3F1YXNoX21lc3NhZ2UgKCkgewoJaWYgdGVzdCAtZiAiJFNRVUFTSF9NU0ciOyB0aGVuCgkJQ09VTlQ9JCgoJChzZWQgLW4gInMvXiMgVGhpcyBpcyBbXjAtOV0qXChbMS05XVswLTldKlwpLiovXDEvcCIgXAoJCQk8ICIkU1FVQVNIX01TRyIgfCBzZWQgLW5lICckcCcpKzEpKQoJCWVjaG8gIiMgVGhpcyBpcyBhIGNvbWJpbmF0aW9uIG9mICRDT1VOVCBjb21taXRzLiIKCQlzZWQgLWUgMWQgLWUgJzIsL14uL3sKCQkJL14kL2QKCQl9JyA8IiRTUVVBU0hfTVNHIgoJZWxzZQoJCUNPVU5UPTIKCQllY2hvICIjIFRoaXMgaXMgYSBjb21iaW5hdGlvbiBvZiB0d28gY29tbWl0cy4iCgkJZWNobyAiIyBUaGUgZmlyc3QgY29tbWl0J3MgbWVzc2FnZSBpczoiCgkJZWNobwoJCWdpdCBjYXQtZmlsZSBjb21taXQgSEVBRCB8IHNlZCAtZSAnMSwvXiQvZCcKCWZpCgllY2hvCgllY2hvICIjIFRoaXMgaXMgdGhlICQobnRoX3N0cmluZyAkQ09VTlQpIGNvbW1pdCBtZXNzYWdlOiIKCWVjaG8KCWdpdCBjYXQtZmlsZSBjb21taXQgJDEgfCBzZWQgLWUgJzEsL14kL2QnCn0KCnBlZWtfbmV4dF9jb21tYW5kICgpIHsKCXNlZCAtbiAiMXMvIC4qJC8vcCIgPCAiJFRPRE8iCn0KCmRvX25leHQgKCkgewoJcm0gLWYgIiRET1RFU1QiL21lc3NhZ2UgIiRET1RFU1QiL2F1dGhvci1zY3JpcHQgXAoJCSIkRE9URVNUIi9hbWVuZCB8fCBleGl0CglyZWFkIGNvbW1hbmQgc2hhMSByZXN0IDwgIiRUT0RPIgoJY2FzZSAiJGNvbW1hbmQiIGluCgknIycqfCcnfG5vb3ApCgkJbWFya19hY3Rpb25fZG9uZQoJCTs7CglwaWNrfHApCgkJY29tbWVudF9mb3JfcmVmbG9nIHBpY2sKCgkJbWFya19hY3Rpb25fZG9uZQoJCXBpY2tfb25lICRzaGExIHx8CgkJCWRpZV93aXRoX3BhdGNoICRzaGExICJDb3VsZCBub3QgYXBwbHkgJHNoYTEuLi4gJHJlc3QiCgkJOzsKCWVkaXR8ZSkKCQljb21tZW50X2Zvcl9yZWZsb2cgZWRpdAoKCQltYXJrX2FjdGlvbl9kb25lCgkJcGlja19vbmUgJHNoYTEgfHwKCQkJZGllX3dpdGhfcGF0Y2ggJHNoYTEgIkNvdWxkIG5vdCBhcHBseSAkc2hhMS4uLiAkcmVzdCIKCQltYWtlX3BhdGNoICRzaGExCgkJZ2l0IHJldi1wYXJzZSAtLXZlcmlmeSBIRUFEID4gIiRET1RFU1QiL2FtZW5kCgkJd2FybiAiU3RvcHBlZCBhdCAkc2hhMS4uLiAkcmVzdCIKCQl3YXJuICJZb3UgY2FuIGFtZW5kIHRoZSBjb21taXQgbm93LCB3aXRoIgoJCXdhcm4KCQl3YXJuICIJZ2l0IGNvbW1pdCAtLWFtZW5kIgoJCXdhcm4KCQl3YXJuICJPbmNlIHlvdSBhcmUgc2F0aXNmaWVkIHdpdGggeW91ciBjaGFuZ2VzLCBydW4iCgkJd2FybgoJCXdhcm4gIglnaXQgcmViYXNlIC0tY29udGludWUiCgkJd2FybgoJCWV4aXQgMAoJCTs7CglzcXVhc2h8cykKCQljb21tZW50X2Zvcl9yZWZsb2cgc3F1YXNoCgoJCXRlc3QgLWYgIiRET05FIiAmJiBoYXNfYWN0aW9uICIkRE9ORSIgfHwKCQkJZGllICJDYW5ub3QgJ3NxdWFzaCcgd2l0aG91dCBhIHByZXZpb3VzIGNvbW1pdCIKCgkJbWFya19hY3Rpb25fZG9uZQoJCW1ha2Vfc3F1YXNoX21lc3NhZ2UgJHNoYTEgPiAiJE1TRyIKCQlmYWlsZWQ9ZgoJCWF1dGhvcl9zY3JpcHQ9JChnZXRfYXV0aG9yX2lkZW50X2Zyb21fY29tbWl0IEhFQUQpCgkJb3V0cHV0IGdpdCByZXNldCAtLXNvZnQgSEVBRF4KCQlwaWNrX29uZSAtbiAkc2hhMSB8fCBmYWlsZWQ9dAoJCWNhc2UgIiQocGVla19uZXh0X2NvbW1hbmQpIiBpbgoJCXNxdWFzaHxzKQoJCQlFRElUX0NPTU1JVD0KCQkJVVNFX09VVFBVVD1vdXRwdXQKCQkJTVNHX09QVD0tRgoJCQlNU0dfRklMRT0iJE1TRyIKCQkJY3AgIiRNU0ciICIkU1FVQVNIX01TRyIKCQkJOzsKCQkqKQoJCQlFRElUX0NPTU1JVD0tZQoJCQlVU0VfT1VUUFVUPQoJCQlNU0dfT1BUPQoJCQlNU0dfRklMRT0KCQkJcm0gLWYgIiRTUVVBU0hfTVNHIiB8fCBleGl0CgkJCWNwICIkTVNHIiAiJEdJVF9ESVIiL1NRVUFTSF9NU0cKCQkJcm0gLWYgIiRHSVRfRElSIi9NRVJHRV9NU0cgfHwgZXhpdAoJCQk7OwoJCWVzYWMKCQllY2hvICIkYXV0aG9yX3NjcmlwdCIgPiAiJERPVEVTVCIvYXV0aG9yLXNjcmlwdAoJCWlmIHRlc3QgJGZhaWxlZCA9IGYKCQl0aGVuCgkJCSMgVGhpcyBpcyBsaWtlIC0tYW1lbmQsIGJ1dCB3aXRoIGEgZGlmZmVyZW50IG1lc3NhZ2UKCQkJZXZhbCAiJGF1dGhvcl9zY3JpcHQiCgkJCUdJVF9BVVRIT1JfTkFNRT0iJEdJVF9BVVRIT1JfTkFNRSIgXAoJCQlHSVRfQVVUSE9SX0VNQUlMPSIkR0lUX0FVVEhPUl9FTUFJTCIgXAoJCQlHSVRfQVVUSE9SX0RBVEU9IiRHSVRfQVVUSE9SX0RBVEUiIFwKCQkJJFVTRV9PVVRQVVQgZ2l0IGNvbW1pdCAtLW5vLXZlcmlmeSAkTVNHX09QVCAiJE1TR19GSUxFIiAkRURJVF9DT01NSVQgfHwgZmFpbGVkPXQKCQlmaQoJCWlmIHRlc3QgJGZhaWxlZCA9IHQKCQl0aGVuCgkJCWNwICIkTVNHIiAiJEdJVF9ESVIiL01FUkdFX01TRwoJCQl3YXJuCgkJCXdhcm4gIkNvdWxkIG5vdCBhcHBseSAkc2hhMS4uLiAkcmVzdCIKCQkJZGllX3dpdGhfcGF0Y2ggJHNoYTEgIiIKCQlmaQoJCTs7CgkqKQoJCXdhcm4gIlVua25vd24gY29tbWFuZDogJGNvbW1hbmQgJHNoYTEgJHJlc3QiCgkJZGllX3dpdGhfcGF0Y2ggJHNoYTEgIlBsZWFzZSBmaXggdGhpcyBpbiB0aGUgZmlsZSAkVE9ETy4iCgkJOzsKCWVzYWMKCXRlc3QgLXMgIiRUT0RPIiAmJiByZXR1cm4KCgljb21tZW50X2Zvcl9yZWZsb2cgZmluaXNoICYmCglIRUFETkFNRT0kKGNhdCAiJERPVEVTVCIvaGVhZC1uYW1lKSAmJgoJT0xESEVBRD0kKGNhdCAiJERPVEVTVCIvaGVhZCkgJiYKCVNIT1JUT05UTz0kKGdpdCByZXYtcGFyc2UgLS1zaG9ydCAkKGNhdCAiJERPVEVTVCIvb250bykpICYmCglORVdIRUFEPSQoZ2l0IHJldi1wYXJzZSBIRUFEKSAmJgoJY2FzZSAkSEVBRE5BTUUgaW4KCXJlZnMvKikKCQltZXNzYWdlPSIkR0lUX1JFRkxPR19BQ1RJT046ICRIRUFETkFNRSBvbnRvICRTSE9SVE9OVE8pIiAmJgoJCWdpdCB1cGRhdGUtcmVmIC1tICIkbWVzc2FnZSIgJEhFQUROQU1FICRORVdIRUFEICRPTERIRUFEICYmCgkJZ2l0IHN5bWJvbGljLXJlZiBIRUFEICRIRUFETkFNRQoJCTs7Cgllc2FjICYmIHsKCQl0ZXN0ICEgLWYgIiRET1RFU1QiL3ZlcmJvc2UgfHwKCQkJZ2l0IGRpZmYtdHJlZSAtLXN0YXQgJChjYXQgIiRET1RFU1QiL2hlYWQpLi5IRUFECgl9ICYmCglybSAtcmYgIiRET1RFU1QiICYmCglnaXQgZ2MgLS1hdXRvICYmCgl3YXJuICJTdWNjZXNzZnVsbHkgcmViYXNlZCBhbmQgdXBkYXRlZCAkSEVBRE5BTUUuIgoKCWV4aXQKfQoKZG9fcmVzdCAoKSB7Cgl3aGlsZSA6CglkbwoJCWRvX25leHQKCWRvbmUKfQoKIyBjaGVjayBpZiBubyBvdGhlciBvcHRpb25zIGFyZSBzZXQKaXNfc3RhbmRhbG9uZSAoKSB7Cgl0ZXN0ICQjIC1lcSAyIC1hICIkMiIgPSAnLS0nICYmCgl0ZXN0IC16ICIkT05UTyIgJiYKCXRlc3QgLXogIiRQUkVTRVJWRV9NRVJHRVMiICYmCgl0ZXN0IC16ICIkU1RSQVRFR1kiICYmCgl0ZXN0IC16ICIkVkVSQk9TRSIKfQoKZ2V0X3NhdmVkX29wdGlvbnMgKCkgewoJdGVzdCAtZCAiJFJFV1JJVFRFTiIgJiYgUFJFU0VSVkVfTUVSR0VTPXQKCXRlc3QgLWYgIiRET1RFU1QiL3N0cmF0ZWd5ICYmIFNUUkFURUdZPSIkKGNhdCAiJERPVEVTVCIvc3RyYXRlZ3kpIgoJdGVzdCAtZiAiJERPVEVTVCIvdmVyYm9zZSAmJiBWRVJCT1NFPXQKCXRlc3QgISAtcyAiJERPVEVTVCIvdXBzdHJlYW0gJiYgUkVCQVNFX1JPT1Q9dAp9Cgp3aGlsZSB0ZXN0ICQjICE9IDAKZG8KCWNhc2UgIiQxIiBpbgoJLS1uby12ZXJpZnkpCgkJT0tfVE9fU0tJUF9QUkVfUkVCQVNFPXllcwoJCTs7CgktLXZlcmlmeSkKCQk7OwoJLS1jb250aW51ZSkKCQlpc19zdGFuZGFsb25lICIkQCIgfHwgdXNhZ2UKCQlnZXRfc2F2ZWRfb3B0aW9ucwoJCWNvbW1lbnRfZm9yX3JlZmxvZyBjb250aW51ZQoKCQl0ZXN0IC1kICIkRE9URVNUIiB8fCBkaWUgIk5vIGludGVyYWN0aXZlIHJlYmFzZSBydW5uaW5nIgoKCQkjIFNhbml0eSBjaGVjawoJCWdpdCByZXYtcGFyc2UgLS12ZXJpZnkgSEVBRCA+L2Rldi9udWxsIHx8CgkJCWRpZSAiQ2Fubm90IHJlYWQgSEVBRCIKCQlnaXQgdXBkYXRlLWluZGV4IC0taWdub3JlLXN1Ym1vZHVsZXMgLS1yZWZyZXNoICYmCgkJCWdpdCBkaWZmLWZpbGVzIC0tcXVpZXQgLS1pZ25vcmUtc3VibW9kdWxlcyB8fAoJCQlkaWUgIldvcmtpbmcgdHJlZSBpcyBkaXJ0eSIKCgkJIyBkbyB3ZSBoYXZlIGFueXRoaW5nIHRvIGNvbW1pdD8KCQlpZiBnaXQgZGlmZi1pbmRleCAtLWNhY2hlZCAtLXF1aWV0IC0taWdub3JlLXN1Ym1vZHVsZXMgSEVBRCAtLQoJCXRoZW4KCQkJOiBOb3RoaW5nIHRvIGNvbW1pdCAtLSBza2lwIHRoaXMKCQllbHNlCgkJCS4gIiRET1RFU1QiL2F1dGhvci1zY3JpcHQgfHwKCQkJCWRpZSAiQ2Fubm90IGZpbmQgdGhlIGF1dGhvciBpZGVudGl0eSIKCQkJYW1lbmQ9CgkJCWlmIHRlc3QgLWYgIiRET1RFU1QiL2FtZW5kCgkJCXRoZW4KCQkJCWFtZW5kPSQoZ2l0IHJldi1wYXJzZSAtLXZlcmlmeSBIRUFEKQoJCQkJdGVzdCAiJGFtZW5kIiA9ICQoY2F0ICIkRE9URVNUIi9hbWVuZCkgfHwKCQkJCWRpZSAiXApZb3UgaGF2ZSB1bmNvbW1pdHRlZCBjaGFuZ2VzIGluIHlvdXIgd29ya2luZyB0cmVlLiBQbGVhc2UsIGNvbW1pdCB0aGVtCmZpcnN0IGFuZCB0aGVuIHJ1biAnZ2l0IHJlYmFzZSAtLWNvbnRpbnVlJyBhZ2Fpbi4iCgkJCQlnaXQgcmVzZXQgLS1zb2Z0IEhFQUReIHx8CgkJCQlkaWUgIkNhbm5vdCByZXdpbmQgdGhlIEhFQUQiCgkJCWZpCgkJCWV4cG9ydCBHSVRfQVVUSE9SX05BTUUgR0lUX0FVVEhPUl9FTUFJTCBHSVRfQVVUSE9SX0RBVEUgJiYKCQkJZ2l0IGNvbW1pdCAtLW5vLXZlcmlmeSAtRiAiJERPVEVTVCIvbWVzc2FnZSAtZSB8fCB7CgkJCQl0ZXN0IC1uICIkYW1lbmQiICYmIGdpdCByZXNldCAtLXNvZnQgJGFtZW5kCgkJCQlkaWUgIkNvdWxkIG5vdCBjb21taXQgc3RhZ2VkIGNoYW5nZXMuIgoJCQl9CgkJZmkKCgkJcmVxdWlyZV9jbGVhbl93b3JrX3RyZWUKCQlkb19yZXN0CgkJOzsKCS0tYWJvcnQpCgkJaXNfc3RhbmRhbG9uZSAiJEAiIHx8IHVzYWdlCgkJZ2V0X3NhdmVkX29wdGlvbnMKCQljb21tZW50X2Zvcl9yZWZsb2cgYWJvcnQKCgkJZ2l0IHJlcmVyZSBjbGVhcgoJCXRlc3QgLWQgIiRET1RFU1QiIHx8IGRpZSAiTm8gaW50ZXJhY3RpdmUgcmViYXNlIHJ1bm5pbmciCgoJCUhFQUROQU1FPSQoY2F0ICIkRE9URVNUIi9oZWFkLW5hbWUpCgkJSEVBRD0kKGNhdCAiJERPVEVTVCIvaGVhZCkKCQljYXNlICRIRUFETkFNRSBpbgoJCXJlZnMvKikKCQkJZ2l0IHN5bWJvbGljLXJlZiBIRUFEICRIRUFETkFNRQoJCQk7OwoJCWVzYWMgJiYKCQlvdXRwdXQgZ2l0IHJlc2V0IC0taGFyZCAkSEVBRCAmJgoJCXJtIC1yZiAiJERPVEVTVCIKCQlleGl0CgkJOzsKCS0tc2tpcCkKCQlpc19zdGFuZGFsb25lICIkQCIgfHwgdXNhZ2UKCQlnZXRfc2F2ZWRfb3B0aW9ucwoJCWNvbW1lbnRfZm9yX3JlZmxvZyBza2lwCgoJCWdpdCByZXJlcmUgY2xlYXIKCQl0ZXN0IC1kICIkRE9URVNUIiB8fCBkaWUgIk5vIGludGVyYWN0aXZlIHJlYmFzZSBydW5uaW5nIgoKCQlvdXRwdXQgZ2l0IHJlc2V0IC0taGFyZCAmJiBkb19yZXN0CgkJOzsKCS1zKQoJCWNhc2UgIiQjLCQxIiBpbgoJCSosKj0qKQoJCQlTVFJBVEVHWT0iLXMgIiQoZXhwciAieiQxIiA6ICd6LVtePV0qPVwoLipcKScpIDs7CgkJMSwqKQoJCQl1c2FnZSA7OwoJCSopCgkJCVNUUkFURUdZPSItcyAkMiIKCQkJc2hpZnQgOzsKCQllc2FjCgkJOzsKCS1tKQoJCSMgd2UgdXNlIG1lcmdlIGFueXdheQoJCTs7CgktdikKCQlWRVJCT1NFPXQKCQk7OwoJLXApCgkJUFJFU0VSVkVfTUVSR0VTPXQKCQk7OwoJLWkpCgkJIyB5ZWFoLCB3ZSBrbm93CgkJOzsKCS0tcm9vdCkKCQlSRUJBU0VfUk9PVD10CgkJOzsKCS0tb250bykKCQlzaGlmdAoJCU9OVE89JChnaXQgcmV2LXBhcnNlIC0tdmVyaWZ5ICIkMSIpIHx8CgkJCWRpZSAiRG9lcyBub3QgcG9pbnQgdG8gYSB2YWxpZCBjb21taXQ6ICQxIgoJCTs7CgktLSkKCQlzaGlmdAoJCXRlc3QgLXogIiRSRUJBU0VfUk9PVCIgLWEgJCMgLWdlIDEgLWEgJCMgLWxlIDIgfHwKCQl0ZXN0ICEgLXogIiRSRUJBU0VfUk9PVCIgLWEgJCMgLWxlIDEgfHwgdXNhZ2UKCQl0ZXN0IC1kICIkRE9URVNUIiAmJgoJCQlkaWUgIkludGVyYWN0aXZlIHJlYmFzZSBhbHJlYWR5IHN0YXJ0ZWQiCgoJCWdpdCB2YXIgR0lUX0NPTU1JVFRFUl9JREVOVCA+L2Rldi9udWxsIHx8CgkJCWRpZSAiWW91IG5lZWQgdG8gc2V0IHlvdXIgY29tbWl0dGVyIGluZm8gZmlyc3QiCgoJCWlmIHRlc3QgLXogIiRSRUJBU0VfUk9PVCIKCQl0aGVuCgkJCVVQU1RSRUFNX0FSRz0iJDEiCgkJCVVQU1RSRUFNPSQoZ2l0IHJldi1wYXJzZSAtLXZlcmlmeSAiJDEiKSB8fCBkaWUgIkludmFsaWQgYmFzZSIKCQkJdGVzdCAteiAiJE9OVE8iICYmIE9OVE89JFVQU1RSRUFNCgkJCXNoaWZ0CgkJZWxzZQoJCQlVUFNUUkVBTV9BUkc9LS1yb290CgkJCXRlc3QgLXogIiRPTlRPIiAmJgoJCQkJZGllICJZb3UgbXVzdCBzcGVjaWZ5IC0tb250byB3aGVuIHVzaW5nIC0tcm9vdCIKCQlmaQoJCXJ1bl9wcmVfcmViYXNlX2hvb2sgIiRVUFNUUkVBTV9BUkciICIkQCIKCgkJY29tbWVudF9mb3JfcmVmbG9nIHN0YXJ0CgoJCXJlcXVpcmVfY2xlYW5fd29ya190cmVlCgoJCWlmIHRlc3QgISAteiAiJDEiCgkJdGhlbgoJCQlvdXRwdXQgZ2l0IHNob3ctcmVmIC0tdmVyaWZ5IC0tcXVpZXQgInJlZnMvaGVhZHMvJDEiIHx8CgkJCQlkaWUgIkludmFsaWQgYnJhbmNobmFtZTogJDEiCgkJCW91dHB1dCBnaXQgY2hlY2tvdXQgIiQxIiB8fAoJCQkJZGllICJDb3VsZCBub3QgY2hlY2tvdXQgJDEiCgkJZmkKCgkJSEVBRD0kKGdpdCByZXYtcGFyc2UgLS12ZXJpZnkgSEVBRCkgfHwgZGllICJObyBIRUFEPyIKCQlta2RpciAiJERPVEVTVCIgfHwgZGllICJDb3VsZCBub3QgY3JlYXRlIHRlbXBvcmFyeSAkRE9URVNUIgoKCQk6ID4gIiRET1RFU1QiL2ludGVyYWN0aXZlIHx8IGRpZSAiQ291bGQgbm90IG1hcmsgYXMgaW50ZXJhY3RpdmUiCgkJZ2l0IHN5bWJvbGljLXJlZiBIRUFEID4gIiRET1RFU1QiL2hlYWQtbmFtZSAyPiAvZGV2L251bGwgfHwKCQkJZWNobyAiZGV0YWNoZWQgSEVBRCIgPiAiJERPVEVTVCIvaGVhZC1uYW1lCgoJCWVjaG8gJEhFQUQgPiAiJERPVEVTVCIvaGVhZAoJCWVjaG8gJFVQU1RSRUFNID4gIiRET1RFU1QiL3Vwc3RyZWFtCgkJZWNobyAkT05UTyA+ICIkRE9URVNUIi9vbnRvCgkJdGVzdCAteiAiJFNUUkFURUdZIiB8fCBlY2hvICIkU1RSQVRFR1kiID4gIiRET1RFU1QiL3N0cmF0ZWd5CgkJdGVzdCB0ID0gIiRWRVJCT1NFIiAmJiA6ID4gIiRET1RFU1QiL3ZlcmJvc2UKCQlpZiB0ZXN0IHQgPSAiJFBSRVNFUlZFX01FUkdFUyIKCQl0aGVuCgkJCSMgJFJFV1JJVFRFTiBjb250YWlucyBmaWxlcyBmb3IgZWFjaCBjb21taXQgdGhhdCBpcwoJCQkjIHJlYWNoYWJsZSBieSBhdCBsZWFzdCBvbmUgbWVyZ2UgYmFzZSBvZiAkSEVBRCBhbmQKCQkJIyAkVVBTVFJFQU0uIFRoZXkgYXJlIG5vdCBuZWNlc3NhcmlseSByZXdyaXR0ZW4sIGJ1dAoJCQkjIHRoZWlyIGNoaWxkcmVuIG1pZ2h0IGJlLgoJCQkjIFRoaXMgZW5zdXJlcyB0aGF0IGNvbW1pdHMgb24gbWVyZ2VkLCBidXQgb3RoZXJ3aXNlCgkJCSMgdW5yZWxhdGVkIHNpZGUgYnJhbmNoZXMgYXJlIGxlZnQgYWxvbmUuIChUaGluayAiWCIKCQkJIyBpbiB0aGUgbWFuIHBhZ2UncyBleGFtcGxlLikKCQkJaWYgdGVzdCAteiAiJFJFQkFTRV9ST09UIgoJCQl0aGVuCgkJCQlta2RpciAiJFJFV1JJVFRFTiIgJiYKCQkJCWZvciBjIGluICQoZ2l0IG1lcmdlLWJhc2UgLS1hbGwgJEhFQUQgJFVQU1RSRUFNKQoJCQkJZG8KCQkJCQllY2hvICRPTlRPID4gIiRSRVdSSVRURU4iLyRjIHx8CgkJCQkJCWRpZSAiQ291bGQgbm90IGluaXQgcmV3cml0dGVuIGNvbW1pdHMiCgkJCQlkb25lCgkJCWVsc2UKCQkJCW1rZGlyICIkUkVXUklUVEVOIiAmJgoJCQkJZWNobyAkT05UTyA+ICIkUkVXUklUVEVOIi9yb290IHx8CgkJCQkJZGllICJDb3VsZCBub3QgaW5pdCByZXdyaXR0ZW4gY29tbWl0cyIKCQkJZmkKCQkJIyBObyBjaGVycnktcGljayBiZWNhdXNlIG91ciBmaXJzdCBwYXNzIGlzIHRvIGRldGVybWluZQoJCQkjIHBhcmVudHMgdG8gcmV3cml0ZSBhbmQgc2tpcHBpbmcgZHJvcHBlZCBjb21taXRzIHdvdWxkCgkJCSMgcHJlbWF0dXJlbHkgZW5kIG91ciBwcm9iZQoJCQlNRVJHRVNfT1BUSU9OPQoJCQlmaXJzdF9hZnRlcl91cHN0cmVhbT0iJChnaXQgcmV2LWxpc3QgLS1yZXZlcnNlIC0tZmlyc3QtcGFyZW50ICRVUFNUUkVBTS4uJEhFQUQgfCBoZWFkIC1uIDEpIgoJCWVsc2UKCQkJTUVSR0VTX09QVElPTj0iLS1uby1tZXJnZXMgLS1jaGVycnktcGljayIKCQlmaQoKCQlTSE9SVEhFQUQ9JChnaXQgcmV2LXBhcnNlIC0tc2hvcnQgJEhFQUQpCgkJU0hPUlRPTlRPPSQoZ2l0IHJldi1wYXJzZSAtLXNob3J0ICRPTlRPKQoJCWlmIHRlc3QgLXogIiRSRUJBU0VfUk9PVCIKCQkJIyB0aGlzIGlzIG5vdyBlcXVpdmFsZW50IHRvICEgLXogIiRVUFNUUkVBTSIKCQl0aGVuCgkJCVNIT1JUVVBTVFJFQU09JChnaXQgcmV2LXBhcnNlIC0tc2hvcnQgJFVQU1RSRUFNKQoJCQlSRVZJU0lPTlM9JFVQU1RSRUFNLi4uJEhFQUQKCQkJU0hPUlRSRVZJU0lPTlM9JFNIT1JUVVBTVFJFQU0uLiRTSE9SVEhFQUQKCQllbHNlCgkJCVJFVklTSU9OUz0kT05UTy4uLiRIRUFECgkJCVNIT1JUUkVWSVNJT05TPSRTSE9SVEhFQUQKCQlmaQoJCWdpdCByZXYtbGlzdCAkTUVSR0VTX09QVElPTiAtLXByZXR0eT1vbmVsaW5lIC0tYWJicmV2LWNvbW1pdCBcCgkJCS0tYWJicmV2PTcgLS1yZXZlcnNlIC0tbGVmdC1yaWdodCAtLXRvcG8tb3JkZXIgXAoJCQkkUkVWSVNJT05TIHwgXAoJCQlzZWQgLW4gInMvXj4vL3AiIHwgd2hpbGUgcmVhZCBzaG9ydHNoYTEgcmVzdAoJCWRvCgkJCWlmIHRlc3QgdCAhPSAiJFBSRVNFUlZFX01FUkdFUyIKCQkJdGhlbgoJCQkJZWNobyAicGljayAkc2hvcnRzaGExICRyZXN0IiA+PiAiJFRPRE8iCgkJCWVsc2UKCQkJCXNoYTE9JChnaXQgcmV2LXBhcnNlICRzaG9ydHNoYTEpCgkJCQlpZiB0ZXN0IC16ICIkUkVCQVNFX1JPT1QiCgkJCQl0aGVuCgkJCQkJcHJlc2VydmU9dAoJCQkJCWZvciBwIGluICQoZ2l0IHJldi1saXN0IC0tcGFyZW50cyAtMSAkc2hhMSB8IGN1dCAtZCcgJyAtcyAtZjItKQoJCQkJCWRvCgkJCQkJCWlmIHRlc3QgLWYgIiRSRVdSSVRURU4iLyRwIC1hIFwoICRwICE9ICRVUFNUUkVBTSAtbyAkc2hhMSA9ICRmaXJzdF9hZnRlcl91cHN0cmVhbSBcKQoJCQkJCQl0aGVuCgkJCQkJCQlwcmVzZXJ2ZT1mCgkJCQkJCWZpCgkJCQkJZG9uZQoJCQkJZWxzZQoJCQkJCXByZXNlcnZlPWYKCQkJCWZpCgkJCQlpZiB0ZXN0IGYgPSAiJHByZXNlcnZlIgoJCQkJdGhlbgoJCQkJCXRvdWNoICIkUkVXUklUVEVOIi8kc2hhMQoJCQkJCWVjaG8gInBpY2sgJHNob3J0c2hhMSAkcmVzdCIgPj4gIiRUT0RPIgoJCQkJZmkKCQkJZmkKCQlkb25lCgoJCSMgV2F0Y2ggZm9yIGNvbW1pdHMgdGhhdCBiZWVuIGRyb3BwZWQgYnkgLS1jaGVycnktcGljawoJCWlmIHRlc3QgdCA9ICIkUFJFU0VSVkVfTUVSR0VTIgoJCXRoZW4KCQkJbWtkaXIgIiREUk9QUEVEIgoJCQkjIFNhdmUgYWxsIG5vbi1jaGVycnktcGlja2VkIGNoYW5nZXMKCQkJZ2l0IHJldi1saXN0ICRSRVZJU0lPTlMgLS1sZWZ0LXJpZ2h0IC0tY2hlcnJ5LXBpY2sgfCBcCgkJCQlzZWQgLW4gInMvXj4vL3AiID4gIiRET1RFU1QiL25vdC1jaGVycnktcGlja3MKCQkJIyBOb3cgYWxsIGNvbW1pdHMgYW5kIG5vdGUgd2hpY2ggb25lcyBhcmUgbWlzc2luZyBpbgoJCQkjIG5vdC1jaGVycnktcGlja3MgYW5kIGhlbmNlIGJlaW5nIGRyb3BwZWQKCQkJZ2l0IHJldi1saXN0ICRSRVZJU0lPTlMgfAoJCQl3aGlsZSByZWFkIHJldgoJCQlkbwoJCQkJaWYgdGVzdCAtZiAiJFJFV1JJVFRFTiIvJHJldiAtYSAiJChncmVwICIkcmV2IiAiJERPVEVTVCIvbm90LWNoZXJyeS1waWNrcykiID0gIiIKCQkJCXRoZW4KCQkJCQkjIFVzZSAtZjIgYmVjYXVzZSBpZiByZXYtbGlzdCBpcyB0ZWxsaW5nIHVzIHRoaXMgY29tbWl0IGlzCgkJCQkJIyBub3Qgd29ydGh3aGlsZSwgd2UgZG9uJ3Qgd2FudCB0byB0cmFjayBpdHMgbXVsdGlwbGUgaGVhZHMsCgkJCQkJIyBqdXN0IHRoZSBoaXN0b3J5IG9mIGl0cyBmaXJzdC1wYXJlbnQgZm9yIG90aGVycyB0aGF0IHdpbGwKCQkJCQkjIGJlIHJlYmFzaW5nIG9uIHRvcCBvZiBpdAoJCQkJCWdpdCByZXYtbGlzdCAtLXBhcmVudHMgLTEgJHJldiB8IGN1dCAtZCcgJyAtcyAtZjIgPiAiJERST1BQRUQiLyRyZXYKCQkJCQlzaG9ydD0kKGdpdCByZXYtbGlzdCAtMSAtLWFiYnJldi1jb21taXQgLS1hYmJyZXY9NyAkcmV2KQoJCQkJCWdyZXAgLXYgIl5bYS16XVthLXpdKiAkc2hvcnQiIDwiJFRPRE8iID4gIiR7VE9ET30yIiA7IG12ICIke1RPRE99MiIgIiRUT0RPIgoJCQkJCXJtICIkUkVXUklUVEVOIi8kcmV2CgkJCQlmaQoJCQlkb25lCgkJZmkKCgkJdGVzdCAtcyAiJFRPRE8iIHx8IGVjaG8gbm9vcCA+PiAiJFRPRE8iCgkJY2F0ID4+ICIkVE9ETyIgPDwgRU9GCgojIFJlYmFzZSAkU0hPUlRSRVZJU0lPTlMgb250byAkU0hPUlRPTlRPCiMKIyBDb21tYW5kczoKIyAgcCwgcGljayA9IHVzZSBjb21taXQKIyAgZSwgZWRpdCA9IHVzZSBjb21taXQsIGJ1dCBzdG9wIGZvciBhbWVuZGluZwojICBzLCBzcXVhc2ggPSB1c2UgY29tbWl0LCBidXQgbWVsZCBpbnRvIHByZXZpb3VzIGNvbW1pdAojCiMgSWYgeW91IHJlbW92ZSBhIGxpbmUgaGVyZSBUSEFUIENPTU1JVCBXSUxMIEJFIExPU1QuCiMgSG93ZXZlciwgaWYgeW91IHJlbW92ZSBldmVyeXRoaW5nLCB0aGUgcmViYXNlIHdpbGwgYmUgYWJvcnRlZC4KIwpFT0YKCgkJaGFzX2FjdGlvbiAiJFRPRE8iIHx8CgkJCWRpZV9hYm9ydCAiTm90aGluZyB0byBkbyIKCgkJY3AgIiRUT0RPIiAiJFRPRE8iLmJhY2t1cAoJCWdpdF9lZGl0b3IgIiRUT0RPIiB8fAoJCQlkaWUgIkNvdWxkIG5vdCBleGVjdXRlIGVkaXRvciIKCgkJaGFzX2FjdGlvbiAiJFRPRE8iIHx8CgkJCWRpZV9hYm9ydCAiTm90aGluZyB0byBkbyIKCgkJZ2l0IHVwZGF0ZS1yZWYgT1JJR19IRUFEICRIRUFECgkJb3V0cHV0IGdpdCBjaGVja291dCAkT05UTyAmJiBkb19yZXN0CgkJOzsKCWVzYWMKCXNoaWZ0CmRvbmUK",
    "text": "#!/bin/sh\n#\n# Copyright (c) 2006 Johannes E. Schindelin\n\n# SHORT DESCRIPTION\n#\n# This script makes it easy to fix up commits in the middle of a series,\n# and rearrange commits.\n#\n# The original idea comes from Eric W. Biederman, in\n# http://article.gmane.org/gmane.comp.version-control.git/22407\n\nOPTIONS_KEEPDASHDASH=\nOPTIONS_SPEC=\"\\\ngit-rebase [-i] [options] [--] <upstream> [<branch>]\ngit-rebase [-i] (--continue | --abort | --skip)\n--\n Available options are\nv,verbose          display a diffstat of what changed upstream\nonto=              rebase onto given branch instead of upstream\np,preserve-merges  try to recreate merges instead of ignoring them\ns,strategy=        use the given merge strategy\nm,merge            always used (no-op)\ni,interactive      always used (no-op)\n Actions:\ncontinue           continue rebasing process\nabort              abort rebasing process and restore original branch\nskip               skip current patch and continue rebasing process\nno-verify          override pre-rebase hook from stopping the operation\nroot               rebase all reachable commmits up to the root(s)\n\"\n\n. git-sh-setup\nrequire_work_tree\n\nDOTEST=\"$GIT_DIR/rebase-merge\"\nTODO=\"$DOTEST\"/git-rebase-todo\nDONE=\"$DOTEST\"/done\nMSG=\"$DOTEST\"/message\nSQUASH_MSG=\"$DOTEST\"/message-squash\nREWRITTEN=\"$DOTEST\"/rewritten\nDROPPED=\"$DOTEST\"/dropped\nPRESERVE_MERGES=\nSTRATEGY=\nONTO=\nVERBOSE=\nOK_TO_SKIP_PRE_REBASE=\nREBASE_ROOT=\n\nGIT_CHERRY_PICK_HELP=\"  After resolving the conflicts,\nmark the corrected paths with 'git add <paths>', and\nrun 'git rebase --continue'\"\nexport GIT_CHERRY_PICK_HELP\n\nwarn () {\n\techo \"$*\" >&2\n}\n\noutput () {\n\tcase \"$VERBOSE\" in\n\t'')\n\t\toutput=$(\"$@\" 2>&1 )\n\t\tstatus=$?\n\t\ttest $status != 0 && printf \"%s\\n\" \"$output\"\n\t\treturn $status\n\t\t;;\n\t*)\n\t\t\"$@\"\n\t\t;;\n\tesac\n}\n\nrun_pre_rebase_hook () {\n\tif test -z \"$OK_TO_SKIP_PRE_REBASE\" &&\n\t   test -x \"$GIT_DIR/hooks/pre-rebase\"\n\tthen\n\t\t\"$GIT_DIR/hooks/pre-rebase\" ${1+\"$@\"} || {\n\t\t\techo >&2 \"The pre-rebase hook refused to rebase.\"\n\t\t\texit 1\n\t\t}\n\tfi\n}\n\nrequire_clean_work_tree () {\n\t# test if working tree is dirty\n\tgit rev-parse --verify HEAD > /dev/null &&\n\tgit update-index --ignore-submodules --refresh &&\n\tgit diff-files --quiet --ignore-submodules &&\n\tgit diff-index --cached --quiet HEAD --ignore-submodules -- ||\n\tdie \"Working tree is dirty\"\n}\n\nORIG_REFLOG_ACTION=\"$GIT_REFLOG_ACTION\"\n\ncomment_for_reflog () {\n\tcase \"$ORIG_REFLOG_ACTION\" in\n\t''|rebase*)\n\t\tGIT_REFLOG_ACTION=\"rebase -i ($1)\"\n\t\texport GIT_REFLOG_ACTION\n\t\t;;\n\tesac\n}\n\nlast_count=\nmark_action_done () {\n\tsed -e 1q < \"$TODO\" >> \"$DONE\"\n\tsed -e 1d < \"$TODO\" >> \"$TODO\".new\n\tmv -f \"$TODO\".new \"$TODO\"\n\tcount=$(grep -c '^[^#]' < \"$DONE\")\n\ttotal=$(($count+$(grep -c '^[^#]' < \"$TODO\")))\n\tif test \"$last_count\" != \"$count\"\n\tthen\n\t\tlast_count=$count\n\t\tprintf \"Rebasing (%d/%d)\\r\" $count $total\n\t\ttest -z \"$VERBOSE\" || echo\n\tfi\n}\n\nmake_patch () {\n\tsha1_and_parents=\"$(git rev-list --parents -1 \"$1\")\"\n\tcase \"$sha1_and_parents\" in\n\t?*' '?*' '?*)\n\t\tgit diff --cc $sha1_and_parents\n\t\t;;\n\t?*' '?*)\n\t\tgit diff-tree -p \"$1^!\"\n\t\t;;\n\t*)\n\t\techo \"Root commit\"\n\t\t;;\n\tesac > \"$DOTEST\"/patch\n\ttest -f \"$DOTEST\"/message ||\n\t\tgit cat-file commit \"$1\" | sed \"1,/^$/d\" > \"$DOTEST\"/message\n\ttest -f \"$DOTEST\"/author-script ||\n\t\tget_author_ident_from_commit \"$1\" > \"$DOTEST\"/author-script\n}\n\ndie_with_patch () {\n\tmake_patch \"$1\"\n\tgit rerere\n\tdie \"$2\"\n}\n\ndie_abort () {\n\trm -rf \"$DOTEST\"\n\tdie \"$1\"\n}\n\nhas_action () {\n\tgrep '^[^#]' \"$1\" >/dev/null\n}\n\npick_one () {\n\tno_ff=\n\tcase \"$1\" in -n) sha1=$2; no_ff=t ;; *) sha1=$1 ;; esac\n\toutput git rev-parse --verify $sha1 || die \"Invalid commit name: $sha1\"\n\ttest -d \"$REWRITTEN\" &&\n\t\tpick_one_preserving_merges \"$@\" && return\n\tif test ! -z \"$REBASE_ROOT\"\n\tthen\n\t\toutput git cherry-pick \"$@\"\n\t\treturn\n\tfi\n\tparent_sha1=$(git rev-parse --verify $sha1^) ||\n\t\tdie \"Could not get the parent of $sha1\"\n\tcurrent_sha1=$(git rev-parse --verify HEAD)\n\tif test \"$no_ff$current_sha1\" = \"$parent_sha1\"; then\n\t\toutput git reset --hard $sha1\n\t\ttest \"a$1\" = a-n && output git reset --soft $current_sha1\n\t\tsha1=$(git rev-parse --short $sha1)\n\t\toutput warn Fast forward to $sha1\n\telse\n\t\toutput git cherry-pick \"$@\"\n\tfi\n}\n\npick_one_preserving_merges () {\n\tfast_forward=t\n\tcase \"$1\" in\n\t-n)\n\t\tfast_forward=f\n\t\tsha1=$2\n\t\t;;\n\t*)\n\t\tsha1=$1\n\t\t;;\n\tesac\n\tsha1=$(git rev-parse $sha1)\n\n\tif test -f \"$DOTEST\"/current-commit\n\tthen\n\t\tif test \"$fast_forward\" = t\n\t\tthen\n\t\t\tcat \"$DOTEST\"/current-commit | while read current_commit\n\t\t\tdo\n\t\t\t\tgit rev-parse HEAD > \"$REWRITTEN\"/$current_commit\n\t\t\tdone\n\t\t\trm \"$DOTEST\"/current-commit ||\n\t\t\tdie \"Cannot write current commit's replacement sha1\"\n\t\tfi\n\tfi\n\n\techo $sha1 >> \"$DOTEST\"/current-commit\n\n\t# rewrite parents; if none were rewritten, we can fast-forward.\n\tnew_parents=\n\tpend=\" $(git rev-list --parents -1 $sha1 | cut -d' ' -s -f2-)\"\n\tif test \"$pend\" = \" \"\n\tthen\n\t\tpend=\" root\"\n\tfi\n\twhile [ \"$pend\" != \"\" ]\n\tdo\n\t\tp=$(expr \"$pend\" : ' \\([^ ]*\\)')\n\t\tpend=\"${pend# $p}\"\n\n\t\tif test -f \"$REWRITTEN\"/$p\n\t\tthen\n\t\t\tnew_p=$(cat \"$REWRITTEN\"/$p)\n\n\t\t\t# If the todo reordered commits, and our parent is marked for\n\t\t\t# rewriting, but hasn't been gotten to yet, assume the user meant to\n\t\t\t# drop it on top of the current HEAD\n\t\t\tif test -z \"$new_p\"\n\t\t\tthen\n\t\t\t\tnew_p=$(git rev-parse HEAD)\n\t\t\tfi\n\n\t\t\ttest $p != $new_p && fast_forward=f\n\t\t\tcase \"$new_parents\" in\n\t\t\t*$new_p*)\n\t\t\t\t;; # do nothing; that parent is already there\n\t\t\t*)\n\t\t\t\tnew_parents=\"$new_parents $new_p\"\n\t\t\t\t;;\n\t\t\tesac\n\t\telse\n\t\t\tif test -f \"$DROPPED\"/$p\n\t\t\tthen\n\t\t\t\tfast_forward=f\n\t\t\t\treplacement=\"$(cat \"$DROPPED\"/$p)\"\n\t\t\t\ttest -z \"$replacement\" && replacement=root\n\t\t\t\tpend=\" $replacement$pend\"\n\t\t\telse\n\t\t\t\tnew_parents=\"$new_parents $p\"\n\t\t\tfi\n\t\tfi\n\tdone\n\tcase $fast_forward in\n\tt)\n\t\toutput warn \"Fast forward to $sha1\"\n\t\toutput git reset --hard $sha1 ||\n\t\t\tdie \"Cannot fast forward to $sha1\"\n\t\t;;\n\tf)\n\t\tfirst_parent=$(expr \"$new_parents\" : ' \\([^ ]*\\)')\n\n\t\tif [ \"$1\" != \"-n\" ]\n\t\tthen\n\t\t\t# detach HEAD to current parent\n\t\t\toutput git checkout $first_parent 2> /dev/null ||\n\t\t\t\tdie \"Cannot move HEAD to $first_parent\"\n\t\tfi\n\n\t\tcase \"$new_parents\" in\n\t\t' '*' '*)\n\t\t\ttest \"a$1\" = a-n && die \"Refusing to squash a merge: $sha1\"\n\n\t\t\t# redo merge\n\t\t\tauthor_script=$(get_author_ident_from_commit $sha1)\n\t\t\teval \"$author_script\"\n\t\t\tmsg=\"$(git cat-file commit $sha1 | sed -e '1,/^$/d')\"\n\t\t\t# No point in merging the first parent, that's HEAD\n\t\t\tnew_parents=${new_parents# $first_parent}\n\t\t\tif ! GIT_AUTHOR_NAME=\"$GIT_AUTHOR_NAME\" \\\n\t\t\t\tGIT_AUTHOR_EMAIL=\"$GIT_AUTHOR_EMAIL\" \\\n\t\t\t\tGIT_AUTHOR_DATE=\"$GIT_AUTHOR_DATE\" \\\n\t\t\t\toutput git merge $STRATEGY -m \"$msg\" \\\n\t\t\t\t\t$new_parents\n\t\t\tthen\n\t\t\t\tprintf \"%s\\n\" \"$msg\" > \"$GIT_DIR\"/MERGE_MSG\n\t\t\t\tdie_with_patch $sha1 \"Error redoing merge $sha1\"\n\t\t\tfi\n\t\t\t;;\n\t\t*)\n\t\t\toutput git cherry-pick \"$@\" ||\n\t\t\t\tdie_with_patch $sha1 \"Could not pick $sha1\"\n\t\t\t;;\n\t\tesac\n\t\t;;\n\tesac\n}\n\nnth_string () {\n\tcase \"$1\" in\n\t*1[0-9]|*[04-9]) echo \"$1\"th;;\n\t*1) echo \"$1\"st;;\n\t*2) echo \"$1\"nd;;\n\t*3) echo \"$1\"rd;;\n\tesac\n}\n\nmake_squash_message () {\n\tif test -f \"$SQUASH_MSG\"; then\n\t\tCOUNT=$(($(sed -n \"s/^# This is [^0-9]*\\([1-9][0-9]*\\).*/\\1/p\" \\\n\t\t\t< \"$SQUASH_MSG\" | sed -ne '$p')+1))\n\t\techo \"# This is a combination of $COUNT commits.\"\n\t\tsed -e 1d -e '2,/^./{\n\t\t\t/^$/d\n\t\t}' <\"$SQUASH_MSG\"\n\telse\n\t\tCOUNT=2\n\t\techo \"# This is a combination of two commits.\"\n\t\techo \"# The first commit's message is:\"\n\t\techo\n\t\tgit cat-file commit HEAD | sed -e '1,/^$/d'\n\tfi\n\techo\n\techo \"# This is the $(nth_string $COUNT) commit message:\"\n\techo\n\tgit cat-file commit $1 | sed -e '1,/^$/d'\n}\n\npeek_next_command () {\n\tsed -n \"1s/ .*$//p\" < \"$TODO\"\n}\n\ndo_next () {\n\trm -f \"$DOTEST\"/message \"$DOTEST\"/author-script \\\n\t\t\"$DOTEST\"/amend || exit\n\tread command sha1 rest < \"$TODO\"\n\tcase \"$command\" in\n\t'#'*|''|noop)\n\t\tmark_action_done\n\t\t;;\n\tpick|p)\n\t\tcomment_for_reflog pick\n\n\t\tmark_action_done\n\t\tpick_one $sha1 ||\n\t\t\tdie_with_patch $sha1 \"Could not apply $sha1... $rest\"\n\t\t;;\n\tedit|e)\n\t\tcomment_for_reflog edit\n\n\t\tmark_action_done\n\t\tpick_one $sha1 ||\n\t\t\tdie_with_patch $sha1 \"Could not apply $sha1... $rest\"\n\t\tmake_patch $sha1\n\t\tgit rev-parse --verify HEAD > \"$DOTEST\"/amend\n\t\twarn \"Stopped at $sha1... $rest\"\n\t\twarn \"You can amend the commit now, with\"\n\t\twarn\n\t\twarn \"\tgit commit --amend\"\n\t\twarn\n\t\twarn \"Once you are satisfied with your changes, run\"\n\t\twarn\n\t\twarn \"\tgit rebase --continue\"\n\t\twarn\n\t\texit 0\n\t\t;;\n\tsquash|s)\n\t\tcomment_for_reflog squash\n\n\t\ttest -f \"$DONE\" && has_action \"$DONE\" ||\n\t\t\tdie \"Cannot 'squash' without a previous commit\"\n\n\t\tmark_action_done\n\t\tmake_squash_message $sha1 > \"$MSG\"\n\t\tfailed=f\n\t\tauthor_script=$(get_author_ident_from_commit HEAD)\n\t\toutput git reset --soft HEAD^\n\t\tpick_one -n $sha1 || failed=t\n\t\tcase \"$(peek_next_command)\" in\n\t\tsquash|s)\n\t\t\tEDIT_COMMIT=\n\t\t\tUSE_OUTPUT=output\n\t\t\tMSG_OPT=-F\n\t\t\tMSG_FILE=\"$MSG\"\n\t\t\tcp \"$MSG\" \"$SQUASH_MSG\"\n\t\t\t;;\n\t\t*)\n\t\t\tEDIT_COMMIT=-e\n\t\t\tUSE_OUTPUT=\n\t\t\tMSG_OPT=\n\t\t\tMSG_FILE=\n\t\t\trm -f \"$SQUASH_MSG\" || exit\n\t\t\tcp \"$MSG\" \"$GIT_DIR\"/SQUASH_MSG\n\t\t\trm -f \"$GIT_DIR\"/MERGE_MSG || exit\n\t\t\t;;\n\t\tesac\n\t\techo \"$author_script\" > \"$DOTEST\"/author-script\n\t\tif test $failed = f\n\t\tthen\n\t\t\t# This is like --amend, but with a different message\n\t\t\teval \"$author_script\"\n\t\t\tGIT_AUTHOR_NAME=\"$GIT_AUTHOR_NAME\" \\\n\t\t\tGIT_AUTHOR_EMAIL=\"$GIT_AUTHOR_EMAIL\" \\\n\t\t\tGIT_AUTHOR_DATE=\"$GIT_AUTHOR_DATE\" \\\n\t\t\t$USE_OUTPUT git commit --no-verify $MSG_OPT \"$MSG_FILE\" $EDIT_COMMIT || failed=t\n\t\tfi\n\t\tif test $failed = t\n\t\tthen\n\t\t\tcp \"$MSG\" \"$GIT_DIR\"/MERGE_MSG\n\t\t\twarn\n\t\t\twarn \"Could not apply $sha1... $rest\"\n\t\t\tdie_with_patch $sha1 \"\"\n\t\tfi\n\t\t;;\n\t*)\n\t\twarn \"Unknown command: $command $sha1 $rest\"\n\t\tdie_with_patch $sha1 \"Please fix this in the file $TODO.\"\n\t\t;;\n\tesac\n\ttest -s \"$TODO\" && return\n\n\tcomment_for_reflog finish &&\n\tHEADNAME=$(cat \"$DOTEST\"/head-name) &&\n\tOLDHEAD=$(cat \"$DOTEST\"/head) &&\n\tSHORTONTO=$(git rev-parse --short $(cat \"$DOTEST\"/onto)) &&\n\tNEWHEAD=$(git rev-parse HEAD) &&\n\tcase $HEADNAME in\n\trefs/*)\n\t\tmessage=\"$GIT_REFLOG_ACTION: $HEADNAME onto $SHORTONTO)\" &&\n\t\tgit update-ref -m \"$message\" $HEADNAME $NEWHEAD $OLDHEAD &&\n\t\tgit symbolic-ref HEAD $HEADNAME\n\t\t;;\n\tesac && {\n\t\ttest ! -f \"$DOTEST\"/verbose ||\n\t\t\tgit diff-tree --stat $(cat \"$DOTEST\"/head)..HEAD\n\t} &&\n\trm -rf \"$DOTEST\" &&\n\tgit gc --auto &&\n\twarn \"Successfully rebased and updated $HEADNAME.\"\n\n\texit\n}\n\ndo_rest () {\n\twhile :\n\tdo\n\t\tdo_next\n\tdone\n}\n\n# check if no other options are set\nis_standalone () {\n\ttest $# -eq 2 -a \"$2\" = '--' &&\n\ttest -z \"$ONTO\" &&\n\ttest -z \"$PRESERVE_MERGES\" &&\n\ttest -z \"$STRATEGY\" &&\n\ttest -z \"$VERBOSE\"\n}\n\nget_saved_options () {\n\ttest -d \"$REWRITTEN\" && PRESERVE_MERGES=t\n\ttest -f \"$DOTEST\"/strategy && STRATEGY=\"$(cat \"$DOTEST\"/strategy)\"\n\ttest -f \"$DOTEST\"/verbose && VERBOSE=t\n\ttest ! -s \"$DOTEST\"/upstream && REBASE_ROOT=t\n}\n\nwhile test $# != 0\ndo\n\tcase \"$1\" in\n\t--no-verify)\n\t\tOK_TO_SKIP_PRE_REBASE=yes\n\t\t;;\n\t--verify)\n\t\t;;\n\t--continue)\n\t\tis_standalone \"$@\" || usage\n\t\tget_saved_options\n\t\tcomment_for_reflog continue\n\n\t\ttest -d \"$DOTEST\" || die \"No interactive rebase running\"\n\n\t\t# Sanity check\n\t\tgit rev-parse --verify HEAD >/dev/null ||\n\t\t\tdie \"Cannot read HEAD\"\n\t\tgit update-index --ignore-submodules --refresh &&\n\t\t\tgit diff-files --quiet --ignore-submodules ||\n\t\t\tdie \"Working tree is dirty\"\n\n\t\t# do we have anything to commit?\n\t\tif git diff-index --cached --quiet --ignore-submodules HEAD --\n\t\tthen\n\t\t\t: Nothing to commit -- skip this\n\t\telse\n\t\t\t. \"$DOTEST\"/author-script ||\n\t\t\t\tdie \"Cannot find the author identity\"\n\t\t\tamend=\n\t\t\tif test -f \"$DOTEST\"/amend\n\t\t\tthen\n\t\t\t\tamend=$(git rev-parse --verify HEAD)\n\t\t\t\ttest \"$amend\" = $(cat \"$DOTEST\"/amend) ||\n\t\t\t\tdie \"\\\nYou have uncommitted changes in your working tree. Please, commit them\nfirst and then run 'git rebase --continue' again.\"\n\t\t\t\tgit reset --soft HEAD^ ||\n\t\t\t\tdie \"Cannot rewind the HEAD\"\n\t\t\tfi\n\t\t\texport GIT_AUTHOR_NAME GIT_AUTHOR_EMAIL GIT_AUTHOR_DATE &&\n\t\t\tgit commit --no-verify -F \"$DOTEST\"/message -e || {\n\t\t\t\ttest -n \"$amend\" && git reset --soft $amend\n\t\t\t\tdie \"Could not commit staged changes.\"\n\t\t\t}\n\t\tfi\n\n\t\trequire_clean_work_tree\n\t\tdo_rest\n\t\t;;\n\t--abort)\n\t\tis_standalone \"$@\" || usage\n\t\tget_saved_options\n\t\tcomment_for_reflog abort\n\n\t\tgit rerere clear\n\t\ttest -d \"$DOTEST\" || die \"No interactive rebase running\"\n\n\t\tHEADNAME=$(cat \"$DOTEST\"/head-name)\n\t\tHEAD=$(cat \"$DOTEST\"/head)\n\t\tcase $HEADNAME in\n\t\trefs/*)\n\t\t\tgit symbolic-ref HEAD $HEADNAME\n\t\t\t;;\n\t\tesac &&\n\t\toutput git reset --hard $HEAD &&\n\t\trm -rf \"$DOTEST\"\n\t\texit\n\t\t;;\n\t--skip)\n\t\tis_standalone \"$@\" || usage\n\t\tget_saved_options\n\t\tcomment_for_reflog skip\n\n\t\tgit rerere clear\n\t\ttest -d \"$DOTEST\" || die \"No interactive rebase running\"\n\n\t\toutput git reset --hard && do_rest\n\t\t;;\n\t-s)\n\t\tcase \"$#,$1\" in\n\t\t*,*=*)\n\t\t\tSTRATEGY=\"-s \"$(expr \"z$1\" : 'z-[^=]*=\\(.*\\)') ;;\n\t\t1,*)\n\t\t\tusage ;;\n\t\t*)\n\t\t\tSTRATEGY=\"-s $2\"\n\t\t\tshift ;;\n\t\tesac\n\t\t;;\n\t-m)\n\t\t# we use merge anyway\n\t\t;;\n\t-v)\n\t\tVERBOSE=t\n\t\t;;\n\t-p)\n\t\tPRESERVE_MERGES=t\n\t\t;;\n\t-i)\n\t\t# yeah, we know\n\t\t;;\n\t--root)\n\t\tREBASE_ROOT=t\n\t\t;;\n\t--onto)\n\t\tshift\n\t\tONTO=$(git rev-parse --verify \"$1\") ||\n\t\t\tdie \"Does not point to a valid commit: $1\"\n\t\t;;\n\t--)\n\t\tshift\n\t\ttest -z \"$REBASE_ROOT\" -a $# -ge 1 -a $# -le 2 ||\n\t\ttest ! -z \"$REBASE_ROOT\" -a $# -le 1 || usage\n\t\ttest -d \"$DOTEST\" &&\n\t\t\tdie \"Interactive rebase already started\"\n\n\t\tgit var GIT_COMMITTER_IDENT >/dev/null ||\n\t\t\tdie \"You need to set your committer info first\"\n\n\t\tif test -z \"$REBASE_ROOT\"\n\t\tthen\n\t\t\tUPSTREAM_ARG=\"$1\"\n\t\t\tUPSTREAM=$(git rev-parse --verify \"$1\") || die \"Invalid base\"\n\t\t\ttest -z \"$ONTO\" && ONTO=$UPSTREAM\n\t\t\tshift\n\t\telse\n\t\t\tUPSTREAM_ARG=--root\n\t\t\ttest -z \"$ONTO\" &&\n\t\t\t\tdie \"You must specify --onto when using --root\"\n\t\tfi\n\t\trun_pre_rebase_hook \"$UPSTREAM_ARG\" \"$@\"\n\n\t\tcomment_for_reflog start\n\n\t\trequire_clean_work_tree\n\n\t\tif test ! -z \"$1\"\n\t\tthen\n\t\t\toutput git show-ref --verify --quiet \"refs/heads/$1\" ||\n\t\t\t\tdie \"Invalid branchname: $1\"\n\t\t\toutput git checkout \"$1\" ||\n\t\t\t\tdie \"Could not checkout $1\"\n\t\tfi\n\n\t\tHEAD=$(git rev-parse --verify HEAD) || die \"No HEAD?\"\n\t\tmkdir \"$DOTEST\" || die \"Could not create temporary $DOTEST\"\n\n\t\t: > \"$DOTEST\"/interactive || die \"Could not mark as interactive\"\n\t\tgit symbolic-ref HEAD > \"$DOTEST\"/head-name 2> /dev/null ||\n\t\t\techo \"detached HEAD\" > \"$DOTEST\"/head-name\n\n\t\techo $HEAD > \"$DOTEST\"/head\n\t\techo $UPSTREAM > \"$DOTEST\"/upstream\n\t\techo $ONTO > \"$DOTEST\"/onto\n\t\ttest -z \"$STRATEGY\" || echo \"$STRATEGY\" > \"$DOTEST\"/strategy\n\t\ttest t = \"$VERBOSE\" && : > \"$DOTEST\"/verbose\n\t\tif test t = \"$PRESERVE_MERGES\"\n\t\tthen\n\t\t\t# $REWRITTEN contains files for each commit that is\n\t\t\t# reachable by at least one merge base of $HEAD and\n\t\t\t# $UPSTREAM. They are not necessarily rewritten, but\n\t\t\t# their children might be.\n\t\t\t# This ensures that commits on merged, but otherwise\n\t\t\t# unrelated side branches are left alone. (Think \"X\"\n\t\t\t# in the man page's example.)\n\t\t\tif test -z \"$REBASE_ROOT\"\n\t\t\tthen\n\t\t\t\tmkdir \"$REWRITTEN\" &&\n\t\t\t\tfor c in $(git merge-base --all $HEAD $UPSTREAM)\n\t\t\t\tdo\n\t\t\t\t\techo $ONTO > \"$REWRITTEN\"/$c ||\n\t\t\t\t\t\tdie \"Could not init rewritten commits\"\n\t\t\t\tdone\n\t\t\telse\n\t\t\t\tmkdir \"$REWRITTEN\" &&\n\t\t\t\techo $ONTO > \"$REWRITTEN\"/root ||\n\t\t\t\t\tdie \"Could not init rewritten commits\"\n\t\t\tfi\n\t\t\t# No cherry-pick because our first pass is to determine\n\t\t\t# parents to rewrite and skipping dropped commits would\n\t\t\t# prematurely end our probe\n\t\t\tMERGES_OPTION=\n\t\t\tfirst_after_upstream=\"$(git rev-list --reverse --first-parent $UPSTREAM..$HEAD | head -n 1)\"\n\t\telse\n\t\t\tMERGES_OPTION=\"--no-merges --cherry-pick\"\n\t\tfi\n\n\t\tSHORTHEAD=$(git rev-parse --short $HEAD)\n\t\tSHORTONTO=$(git rev-parse --short $ONTO)\n\t\tif test -z \"$REBASE_ROOT\"\n\t\t\t# this is now equivalent to ! -z \"$UPSTREAM\"\n\t\tthen\n\t\t\tSHORTUPSTREAM=$(git rev-parse --short $UPSTREAM)\n\t\t\tREVISIONS=$UPSTREAM...$HEAD\n\t\t\tSHORTREVISIONS=$SHORTUPSTREAM..$SHORTHEAD\n\t\telse\n\t\t\tREVISIONS=$ONTO...$HEAD\n\t\t\tSHORTREVISIONS=$SHORTHEAD\n\t\tfi\n\t\tgit rev-list $MERGES_OPTION --pretty=oneline --abbrev-commit \\\n\t\t\t--abbrev=7 --reverse --left-right --topo-order \\\n\t\t\t$REVISIONS | \\\n\t\t\tsed -n \"s/^>//p\" | while read shortsha1 rest\n\t\tdo\n\t\t\tif test t != \"$PRESERVE_MERGES\"\n\t\t\tthen\n\t\t\t\techo \"pick $shortsha1 $rest\" >> \"$TODO\"\n\t\t\telse\n\t\t\t\tsha1=$(git rev-parse $shortsha1)\n\t\t\t\tif test -z \"$REBASE_ROOT\"\n\t\t\t\tthen\n\t\t\t\t\tpreserve=t\n\t\t\t\t\tfor p in $(git rev-list --parents -1 $sha1 | cut -d' ' -s -f2-)\n\t\t\t\t\tdo\n\t\t\t\t\t\tif test -f \"$REWRITTEN\"/$p -a \\( $p != $UPSTREAM -o $sha1 = $first_after_upstream \\)\n\t\t\t\t\t\tthen\n\t\t\t\t\t\t\tpreserve=f\n\t\t\t\t\t\tfi\n\t\t\t\t\tdone\n\t\t\t\telse\n\t\t\t\t\tpreserve=f\n\t\t\t\tfi\n\t\t\t\tif test f = \"$preserve\"\n\t\t\t\tthen\n\t\t\t\t\ttouch \"$REWRITTEN\"/$sha1\n\t\t\t\t\techo \"pick $shortsha1 $rest\" >> \"$TODO\"\n\t\t\t\tfi\n\t\t\tfi\n\t\tdone\n\n\t\t# Watch for commits that been dropped by --cherry-pick\n\t\tif test t = \"$PRESERVE_MERGES\"\n\t\tthen\n\t\t\tmkdir \"$DROPPED\"\n\t\t\t# Save all non-cherry-picked changes\n\t\t\tgit rev-list $REVISIONS --left-right --cherry-pick | \\\n\t\t\t\tsed -n \"s/^>//p\" > \"$DOTEST\"/not-cherry-picks\n\t\t\t# Now all commits and note which ones are missing in\n\t\t\t# not-cherry-picks and hence being dropped\n\t\t\tgit rev-list $REVISIONS |\n\t\t\twhile read rev\n\t\t\tdo\n\t\t\t\tif test -f \"$REWRITTEN\"/$rev -a \"$(grep \"$rev\" \"$DOTEST\"/not-cherry-picks)\" = \"\"\n\t\t\t\tthen\n\t\t\t\t\t# Use -f2 because if rev-list is telling us this commit is\n\t\t\t\t\t# not worthwhile, we don't want to track its multiple heads,\n\t\t\t\t\t# just the history of its first-parent for others that will\n\t\t\t\t\t# be rebasing on top of it\n\t\t\t\t\tgit rev-list --parents -1 $rev | cut -d' ' -s -f2 > \"$DROPPED\"/$rev\n\t\t\t\t\tshort=$(git rev-list -1 --abbrev-commit --abbrev=7 $rev)\n\t\t\t\t\tgrep -v \"^[a-z][a-z]* $short\" <\"$TODO\" > \"${TODO}2\" ; mv \"${TODO}2\" \"$TODO\"\n\t\t\t\t\trm \"$REWRITTEN\"/$rev\n\t\t\t\tfi\n\t\t\tdone\n\t\tfi\n\n\t\ttest -s \"$TODO\" || echo noop >> \"$TODO\"\n\t\tcat >> \"$TODO\" << EOF\n\n# Rebase $SHORTREVISIONS onto $SHORTONTO\n#\n# Commands:\n#  p, pick = use commit\n#  e, edit = use commit, but stop for amending\n#  s, squash = use commit, but meld into previous commit\n#\n# If you remove a line here THAT COMMIT WILL BE LOST.\n# However, if you remove everything, the rebase will be aborted.\n#\nEOF\n\n\t\thas_action \"$TODO\" ||\n\t\t\tdie_abort \"Nothing to do\"\n\n\t\tcp \"$TODO\" \"$TODO\".backup\n\t\tgit_editor \"$TODO\" ||\n\t\t\tdie \"Could not execute editor\"\n\n\t\thas_action \"$TODO\" ||\n\t\t\tdie_abort \"Nothing to do\"\n\n\t\tgit update-ref ORIG_HEAD $HEAD\n\t\toutput git checkout $ONTO && do_rest\n\t\t;;\n\tesac\n\tshift\ndone\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "002929eb091fe3724ba2f37277a61364f1c90db1",
  "sha1_ok": true,
  "size": 18138
}
