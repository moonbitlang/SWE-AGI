{
  "content": {
    "base64": "I2lmbmRlZiBQQUNLX0gKI2RlZmluZSBQQUNLX0gKCiNpbmNsdWRlICJvYmplY3QuaCIKI2luY2x1ZGUgImNzdW0tZmlsZS5oIgoKLyoKICogUGFja2VkIG9iamVjdCBoZWFkZXIKICovCiNkZWZpbmUgUEFDS19TSUdOQVRVUkUgMHg1MDQxNDM0YgkvKiAiUEFDSyIgKi8KI2RlZmluZSBQQUNLX1ZFUlNJT04gMgojZGVmaW5lIHBhY2tfdmVyc2lvbl9vayh2KSAoKHYpID09IGh0b25sKDIpIHx8ICh2KSA9PSBodG9ubCgzKSkKc3RydWN0IHBhY2tfaGVhZGVyIHsKCXVpbnQzMl90IGhkcl9zaWduYXR1cmU7Cgl1aW50MzJfdCBoZHJfdmVyc2lvbjsKCXVpbnQzMl90IGhkcl9lbnRyaWVzOwp9OwoKLyoKICogVGhlIGZpcnN0IGZvdXIgYnl0ZXMgb2YgaW5kZXggZm9ybWF0cyBsYXRlciB0aGFuIHZlcnNpb24gMSBzaG91bGQKICogc3RhcnQgd2l0aCB0aGlzIHNpZ25hdHVyZSwgYXMgYWxsIG9sZGVyIGdpdCBiaW5hcmllcyB3b3VsZCBmaW5kIHRoaXMKICogdmFsdWUgaWxsZWdhbCBhbmQgYWJvcnQgcmVhZGluZyB0aGUgZmlsZS4KICoKICogVGhpcyBpcyB0aGUgY2FzZSBiZWNhdXNlIHRoZSBudW1iZXIgb2Ygb2JqZWN0cyBpbiBhIHBhY2tmaWxlCiAqIGNhbm5vdCBleGNlZWQgMSw0MzEsNjYwLDAwMCBhcyBldmVyeSBvYmplY3Qgd291bGQgbmVlZCBhdCBsZWFzdAogKiAzIGJ5dGVzIG9mIGRhdGEgYW5kIHRoZSBvdmVyYWxsIHBhY2tmaWxlIGNhbm5vdCBleGNlZWQgNCBHaUIgd2l0aAogKiB2ZXJzaW9uIDEgb2YgdGhlIGluZGV4IGZpbGUgZHVlIHRvIHRoZSBvZmZzZXRzIGxpbWl0ZWQgdG8gMzIgYml0cy4KICogQ2xlYXJseSB0aGUgc2lnbmF0dXJlIGV4Y2VlZHMgdGhpcyBtYXhpbXVtLgogKgogKiBWZXJ5IG9sZCBnaXQgYmluYXJpZXMgd2lsbCBhbHNvIGNvbXBhcmUgdGhlIGZpcnN0IDQgYnl0ZXMgdG8gdGhlCiAqIG5leHQgNCBieXRlcyBpbiB0aGUgaW5kZXggYW5kIGFib3J0IHdpdGggYSAibm9uLW1vbm90b25pYyBpbmRleCIKICogZXJyb3IgaWYgdGhlIHNlY29uZCA0IGJ5dGUgd29yZCBpcyBzbWFsbGVyIHRoYW4gdGhlIGZpcnN0IDQKICogYnl0ZSB3b3JkLiAgVGhpcyB3b3VsZCBiZSB0cnVlIGluIHRoZSBwcm9wb3NlZCBmdXR1cmUgaW5kZXgKICogZm9ybWF0IGFzIGlkeF9zaWduYXR1cmUgd291bGQgYmUgZ3JlYXRlciB0aGFuIGlkeF92ZXJzaW9uLgogKi8KI2RlZmluZSBQQUNLX0lEWF9TSUdOQVRVUkUgMHhmZjc0NGY2MwkvKiAiXDM3N3RPYyIgKi8KCnN0cnVjdCBwYWNrX2lkeF9vcHRpb24gewoJdW5zaWduZWQgZmxhZ3M7CgkvKiBmbGFnIGJpdHMgKi8KI2RlZmluZSBXUklURV9JRFhfVkVSSUZZIDAxCgoJdWludDMyX3QgdmVyc2lvbjsKCXVpbnQzMl90IG9mZjMyX2xpbWl0OwoKCS8qCgkgKiBMaXN0IG9mIG9mZnNldHMgdGhhdCB3b3VsZCBmaXQgd2l0aGluIG9mZjMyX2xpbWl0IGJ1dAoJICogbmVlZCB0byBiZSB3cml0dGVuIG91dCBhcyA2NC1iaXQgZW50aXR5IGZvciBieXRlLWZvci1ieXRlCgkgKiB2ZXJpZmljYXRpb24uCgkgKi8KCWludCBhbm9tYWx5X2FsbG9jLCBhbm9tYWx5X25yOwoJdWludDMyX3QgKmFub21hbHk7Cn07CgpleHRlcm4gdm9pZCByZXNldF9wYWNrX2lkeF9vcHRpb24oc3RydWN0IHBhY2tfaWR4X29wdGlvbiAqKTsKCi8qCiAqIFBhY2tlZCBvYmplY3QgaW5kZXggaGVhZGVyCiAqLwpzdHJ1Y3QgcGFja19pZHhfaGVhZGVyIHsKCXVpbnQzMl90IGlkeF9zaWduYXR1cmU7Cgl1aW50MzJfdCBpZHhfdmVyc2lvbjsKfTsKCi8qCiAqIENvbW1vbiBwYXJ0IG9mIG9iamVjdCBzdHJ1Y3R1cmUgdXNlZCBmb3Igd3JpdGVfaWR4X2ZpbGUKICovCnN0cnVjdCBwYWNrX2lkeF9lbnRyeSB7Cgl1bnNpZ25lZCBjaGFyIHNoYTFbMjBdOwoJdWludDMyX3QgY3JjMzI7CglvZmZfdCBvZmZzZXQ7Cn07CgpleHRlcm4gY29uc3QgY2hhciAqd3JpdGVfaWR4X2ZpbGUoY29uc3QgY2hhciAqaW5kZXhfbmFtZSwgc3RydWN0IHBhY2tfaWR4X2VudHJ5ICoqb2JqZWN0cywgaW50IG5yX29iamVjdHMsIGNvbnN0IHN0cnVjdCBwYWNrX2lkeF9vcHRpb24gKiwgdW5zaWduZWQgY2hhciAqc2hhMSk7CmV4dGVybiBpbnQgY2hlY2tfcGFja19jcmMoc3RydWN0IHBhY2tlZF9naXQgKnAsIHN0cnVjdCBwYWNrX3dpbmRvdyAqKndfY3Vycywgb2ZmX3Qgb2Zmc2V0LCBvZmZfdCBsZW4sIHVuc2lnbmVkIGludCBucik7CmV4dGVybiBpbnQgdmVyaWZ5X3BhY2tfaW5kZXgoc3RydWN0IHBhY2tlZF9naXQgKik7CmV4dGVybiBpbnQgdmVyaWZ5X3BhY2soc3RydWN0IHBhY2tlZF9naXQgKik7CmV4dGVybiBvZmZfdCB3cml0ZV9wYWNrX2hlYWRlcihzdHJ1Y3Qgc2hhMWZpbGUgKmYsIHVpbnQzMl90KTsKZXh0ZXJuIHZvaWQgZml4dXBfcGFja19oZWFkZXJfZm9vdGVyKGludCwgdW5zaWduZWQgY2hhciAqLCBjb25zdCBjaGFyICosIHVpbnQzMl90LCB1bnNpZ25lZCBjaGFyICosIG9mZl90KTsKZXh0ZXJuIGNoYXIgKmluZGV4X3BhY2tfbG9ja2ZpbGUoaW50IGZkKTsKZXh0ZXJuIGludCBlbmNvZGVfaW5fcGFja19vYmplY3RfaGVhZGVyKGVudW0gb2JqZWN0X3R5cGUsIHVpbnRtYXhfdCwgdW5zaWduZWQgY2hhciAqKTsKCiNkZWZpbmUgUEhfRVJST1JfRU9GCQkoLTEpCiNkZWZpbmUgUEhfRVJST1JfUEFDS19TSUdOQVRVUkUJKC0yKQojZGVmaW5lIFBIX0VSUk9SX1BST1RPQ09MCSgtMykKZXh0ZXJuIGludCByZWFkX3BhY2tfaGVhZGVyKGludCBmZCwgc3RydWN0IHBhY2tfaGVhZGVyICopOwoKZXh0ZXJuIHN0cnVjdCBzaGExZmlsZSAqY3JlYXRlX3RtcF9wYWNrZmlsZShjaGFyICoqcGFja190bXBfbmFtZSk7CgojZW5kaWYK",
    "text": "#ifndef PACK_H\n#define PACK_H\n\n#include \"object.h\"\n#include \"csum-file.h\"\n\n/*\n * Packed object header\n */\n#define PACK_SIGNATURE 0x5041434b\t/* \"PACK\" */\n#define PACK_VERSION 2\n#define pack_version_ok(v) ((v) == htonl(2) || (v) == htonl(3))\nstruct pack_header {\n\tuint32_t hdr_signature;\n\tuint32_t hdr_version;\n\tuint32_t hdr_entries;\n};\n\n/*\n * The first four bytes of index formats later than version 1 should\n * start with this signature, as all older git binaries would find this\n * value illegal and abort reading the file.\n *\n * This is the case because the number of objects in a packfile\n * cannot exceed 1,431,660,000 as every object would need at least\n * 3 bytes of data and the overall packfile cannot exceed 4 GiB with\n * version 1 of the index file due to the offsets limited to 32 bits.\n * Clearly the signature exceeds this maximum.\n *\n * Very old git binaries will also compare the first 4 bytes to the\n * next 4 bytes in the index and abort with a \"non-monotonic index\"\n * error if the second 4 byte word is smaller than the first 4\n * byte word.  This would be true in the proposed future index\n * format as idx_signature would be greater than idx_version.\n */\n#define PACK_IDX_SIGNATURE 0xff744f63\t/* \"\\377tOc\" */\n\nstruct pack_idx_option {\n\tunsigned flags;\n\t/* flag bits */\n#define WRITE_IDX_VERIFY 01\n\n\tuint32_t version;\n\tuint32_t off32_limit;\n\n\t/*\n\t * List of offsets that would fit within off32_limit but\n\t * need to be written out as 64-bit entity for byte-for-byte\n\t * verification.\n\t */\n\tint anomaly_alloc, anomaly_nr;\n\tuint32_t *anomaly;\n};\n\nextern void reset_pack_idx_option(struct pack_idx_option *);\n\n/*\n * Packed object index header\n */\nstruct pack_idx_header {\n\tuint32_t idx_signature;\n\tuint32_t idx_version;\n};\n\n/*\n * Common part of object structure used for write_idx_file\n */\nstruct pack_idx_entry {\n\tunsigned char sha1[20];\n\tuint32_t crc32;\n\toff_t offset;\n};\n\nextern const char *write_idx_file(const char *index_name, struct pack_idx_entry **objects, int nr_objects, const struct pack_idx_option *, unsigned char *sha1);\nextern int check_pack_crc(struct packed_git *p, struct pack_window **w_curs, off_t offset, off_t len, unsigned int nr);\nextern int verify_pack_index(struct packed_git *);\nextern int verify_pack(struct packed_git *);\nextern off_t write_pack_header(struct sha1file *f, uint32_t);\nextern void fixup_pack_header_footer(int, unsigned char *, const char *, uint32_t, unsigned char *, off_t);\nextern char *index_pack_lockfile(int fd);\nextern int encode_in_pack_object_header(enum object_type, uintmax_t, unsigned char *);\n\n#define PH_ERROR_EOF\t\t(-1)\n#define PH_ERROR_PACK_SIGNATURE\t(-2)\n#define PH_ERROR_PROTOCOL\t(-3)\nextern int read_pack_header(int fd, struct pack_header *);\n\nextern struct sha1file *create_tmp_packfile(char **pack_tmp_name);\n\n#endif\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "0027ac6149eb2a993afd8ade5245ef31536934f8",
  "sha1_ok": true,
  "size": 2799
}
