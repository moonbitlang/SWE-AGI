{
  "content": {
    "base64": "IyEvYmluL3NoCiMKIyBDb3B5cmlnaHQgKGMpIDIwMDUgSnVuaW8gQyBIYW1hbm8KIwoKdGVzdF9kZXNjcmlwdGlvbj0nTWVyZ2UgYmFzZSBjb21wdXRhdGlvbi4KJwoKLiAuL3Rlc3QtbGliLnNoCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzZXR1cCcgJwoJVD0kKGdpdCB3cml0ZS10cmVlKSAmJgoKCU09MTEzMDAwMDAwMCAmJgoJWj0rMDAwMCAmJgoKCUdJVF9DT01NSVRURVJfRU1BSUw9Z2l0QGNvbW0uaXRlci54eiAmJgoJR0lUX0NPTU1JVFRFUl9OQU1FPSJDIE8gTW1pdGVyIiAmJgoJR0lUX0FVVEhPUl9OQU1FPSJBIFUgVGhvciIgJiYKCUdJVF9BVVRIT1JfRU1BSUw9Z2l0QGF1LnRob3IueHogJiYKCWV4cG9ydCBHSVRfQ09NTUlUVEVSX0VNQUlMIEdJVF9DT01NSVRURVJfTkFNRSBHSVRfQVVUSE9SX05BTUUgR0lUX0FVVEhPUl9FTUFJTCAmJgoKCWRvaXQoKSB7CgkJT0ZGU0VUPSQxICYmCgkJTkFNRT0kMiAmJgoJCXNoaWZ0IDIgJiYKCgkJUEFSRU5UUz0gJiYKCQlmb3IgUAoJCWRvCgkJCVBBUkVOVFM9IiR7UEFSRU5UU30tcCAkUCAiCgkJZG9uZSAmJgoKCQlHSVRfQ09NTUlUVEVSX0RBVEU9IiQoKCRNICsgJE9GRlNFVCkpICRaIiAmJgoJCUdJVF9BVVRIT1JfREFURT0kR0lUX0NPTU1JVFRFUl9EQVRFICYmCgkJZXhwb3J0IEdJVF9DT01NSVRURVJfREFURSBHSVRfQVVUSE9SX0RBVEUgJiYKCgkJY29tbWl0PSQoZWNobyAkTkFNRSB8IGdpdCBjb21taXQtdHJlZSAkVCAkUEFSRU5UUykgJiYKCgkJZWNobyAkY29tbWl0ID4uZ2l0L3JlZnMvdGFncy8kTkFNRSAmJgoJCWVjaG8gJGNvbW1pdAoJfQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzZXQgdXAgRyBhbmQgSCcgJwoJIyBFLS0tRC0tLUMtLS1CLS0tQQoJIyBcIi1fICAgICAgICAgXCAgIFwKCSMgIFwgIGAtLS0tLS0tLS1HICAgXAoJIyAgIFwgICAgICAgICAgICAgICAgXAoJIyAgICBGLS0tLS0tLS0tLS0tLS0tLUgKCUU9JChkb2l0IDUgRSkgJiYKCUQ9JChkb2l0IDQgRCAkRSkgJiYKCUY9JChkb2l0IDYgRiAkRSkgJiYKCUM9JChkb2l0IDMgQyAkRCkgJiYKCUI9JChkb2l0IDIgQiAkQykgJiYKCUE9JChkb2l0IDEgQSAkQikgJiYKCUc9JChkb2l0IDcgRyAkQiAkRSkgJiYKCUg9JChkb2l0IDggSCAkQSAkRikKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnbWVyZ2UtYmFzZSBHIEgnICcKCWdpdCBuYW1lLXJldiAkQiA+ZXhwZWN0ZWQgJiYKCglNQj0kKGdpdCBtZXJnZS1iYXNlIEcgSCkgJiYKCWdpdCBuYW1lLXJldiAiJE1CIiA+YWN0dWFsLnNpbmdsZSAmJgoKCU1CPSQoZ2l0IG1lcmdlLWJhc2UgLS1hbGwgRyBIKSAmJgoJZ2l0IG5hbWUtcmV2ICIkTUIiID5hY3R1YWwuYWxsICYmCgoJTUI9JChnaXQgc2hvdy1icmFuY2ggLS1tZXJnZS1iYXNlIEcgSCkgJiYKCWdpdCBuYW1lLXJldiAiJE1CIiA+YWN0dWFsLnNiICYmCgoJdGVzdF9jbXAgZXhwZWN0ZWQgYWN0dWFsLnNpbmdsZSAmJgoJdGVzdF9jbXAgZXhwZWN0ZWQgYWN0dWFsLmFsbCAmJgoJdGVzdF9jbXAgZXhwZWN0ZWQgYWN0dWFsLnNiCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3Vuc3luY2hyb25pemVkIGNsb2NrcycgJwoJIyBUaGlzIHRlc3QgaXMgdG8gZGVtb25zdHJhdGUgdGhhdCByZWx5aW5nIG9uIHRpbWVzdGFtcHMgaW4gYSBkaXN0cmlidXRlZAoJIyBTQ00gdG8gcHJvdmlkZSBhIF9jb25zaXN0ZW50XyBwYXJ0aWFsIG9yZGVyaW5nIG9mIGNvbW1pdHMgbGVhZHMgdG8KCSMgaW5zYW5pdHkuCgkjCgkjICAgICAgICAgICAgICAgUmVsYXRpdmUKCSMgU3RydWN0dXJlICAgICB0aW1lc3RhbXBzCgkjCgkjICAgUEwgIFBSICAgICAgICArNCAgKzQKCSMgIC8gIFwvICBcICAgICAgLyAgXC8gIFwKCSMgTDIgIEMyICBSMiAgICArMyAgLTEgICszCgkjIHwgICB8ICAgfCAgICAgfCAgIHwgICB8CgkjIEwxICBDMSAgUjEgICAgKzIgIC0yICArMgoJIyB8ICAgfCAgIHwgICAgIHwgICB8ICAgfAoJIyBMMCAgQzAgIFIwICAgICsxICAtMyAgKzEKCSMgICBcIHwgIC8gICAgICAgIFwgfCAgLwoJIyAgICAgUyAgICAgICAgICAgICAwCgkjCgkjIFRoZSBsZWZ0IGFuZCByaWdodCBjaGFpbnMgb2YgY29tbWl0cyBjYW4gYmUgb2YgYW55IGxlbmd0aCBhbmQgY29tcGxleGl0eSBhcwoJIyBsb25nIGFzIGFsbCBvZiB0aGUgdGltZXN0YW1wcyBhcmUgZ3JlYXRlciB0aGFuIHRoYXQgb2YgUy4KCglTPSQoZG9pdCAgMCBTKSAmJgoKCUMwPSQoZG9pdCAtMyBDMCAkUykgJiYKCUMxPSQoZG9pdCAtMiBDMSAkQzApICYmCglDMj0kKGRvaXQgLTEgQzIgJEMxKSAmJgoKCUwwPSQoZG9pdCAgMSBMMCAkUykgJiYKCUwxPSQoZG9pdCAgMiBMMSAkTDApICYmCglMMj0kKGRvaXQgIDMgTDIgJEwxKSAmJgoKCVIwPSQoZG9pdCAgMSBSMCAkUykgJiYKCVIxPSQoZG9pdCAgMiBSMSAkUjApICYmCglSMj0kKGRvaXQgIDMgUjIgJFIxKSAmJgoKCVBMPSQoZG9pdCAgNCBQTCAkTDIgJEMyKSAmJgoJUFI9JChkb2l0ICA0IFBSICRDMiAkUjIpCgoJZ2l0IG5hbWUtcmV2ICRDMiA+ZXhwZWN0ZWQgJiYKCglNQj0kKGdpdCBtZXJnZS1iYXNlIFBMIFBSKSAmJgoJZ2l0IG5hbWUtcmV2ICIkTUIiID5hY3R1YWwuc2luZ2xlICYmCgoJTUI9JChnaXQgbWVyZ2UtYmFzZSAtLWFsbCBQTCBQUikgJiYKCWdpdCBuYW1lLXJldiAiJE1CIiA+YWN0dWFsLmFsbCAmJgoKCXRlc3RfY21wIGV4cGVjdGVkIGFjdHVhbC5zaW5nbGUgJiYKCXRlc3RfY21wIGV4cGVjdGVkIGFjdHVhbC5hbGwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnbWVyZ2UtYmFzZSBmb3Igb2N0b3B1cy1zdGVwIChzZXR1cCknICcKCSMgQW5vdGhlciBzZXQgdG8gZGVtb25zdHJhdGUgYmFzZSBiZXR3ZWVuIG9uZSBjb21taXQgYW5kIGEgbWVyZ2UKCSMgaW4gdGhlIGRvY3VtZW50YXRpb24uCgkjCgkjICogQyAoTU1DKSAqIEIgKE1NQikgKiBBICAoTU1BKQoJIyAqIG8gICAgICAgKiBvICAgICAgICogbwoJIyAqIG8gICAgICAgKiBvICAgICAgICogbwoJIyAqIG8gICAgICAgKiBvICAgICAgICogbwoJIyAqIG8gICAgICAgfCBfX19fX19fLwoJIyB8ICAgICAgICAgfC8KCSMgfCAgICAgICAgICogMSAoTU0xKQoJIyB8IF9fX19fX18vCgkjIHwvCgkjICogcm9vdCAoTU1SKQoKCXRlc3RfY29tbWl0IE1NUiAmJgoJdGVzdF9jb21taXQgTU0xICYmCgl0ZXN0X2NvbW1pdCBNTS1vICYmCgl0ZXN0X2NvbW1pdCBNTS1wICYmCgl0ZXN0X2NvbW1pdCBNTS1xICYmCgl0ZXN0X2NvbW1pdCBNTUEgJiYKCWdpdCBjaGVja291dCBNTTEgJiYKCXRlc3RfY29tbWl0IE1NLXIgJiYKCXRlc3RfY29tbWl0IE1NLXMgJiYKCXRlc3RfY29tbWl0IE1NLXQgJiYKCXRlc3RfY29tbWl0IE1NQiAmJgoJZ2l0IGNoZWNrb3V0IE1NUiAmJgoJdGVzdF9jb21taXQgTU0tdSAmJgoJdGVzdF9jb21taXQgTU0tdiAmJgoJdGVzdF9jb21taXQgTU0tdyAmJgoJdGVzdF9jb21taXQgTU0teCAmJgoJdGVzdF9jb21taXQgTU1DCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ21lcmdlLWJhc2UgQSBCIEMnICcKCWdpdCByZXYtcGFyc2UgLS12ZXJpZnkgTU0xID5leHBlY3RlZCAmJgoJZ2l0IHJldi1wYXJzZSAtLXZlcmlmeSBNTVIgPmV4cGVjdGVkLnNiICYmCgoJZ2l0IG1lcmdlLWJhc2UgLS1hbGwgTU1BIE1NQiBNTUMgPmFjdHVhbCAmJgoJZ2l0IG1lcmdlLWJhc2UgLS1hbGwgLS1vY3RvcHVzIE1NQSBNTUIgTU1DID5hY3R1YWwuY29tbW9uICYmCglnaXQgc2hvdy1icmFuY2ggLS1tZXJnZS1iYXNlIE1NQSBNTUIgTU1DID5hY3R1YWwuc2IgJiYKCgl0ZXN0X2NtcCBleHBlY3RlZCBhY3R1YWwgJiYKCXRlc3RfY21wIGV4cGVjdGVkLnNiIGFjdHVhbC5jb21tb24gJiYKCXRlc3RfY21wIGV4cGVjdGVkLnNiIGFjdHVhbC5zYgonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdjcmlzcy1jcm9zcyBtZXJnZS1iYXNlIGZvciBvY3RvcHVzLXN0ZXAnICcKCWdpdCByZXNldCAtLWhhcmQgTU1SICYmCgl0ZXN0X2NvbW1pdCBDQzEgJiYKCWdpdCByZXNldCAtLWhhcmQgRSAmJgoJdGVzdF9jb21taXQgQ0MyICYmCgl0ZXN0X3RpY2sgJiYKCWdpdCBtZXJnZSAtcyBvdXJzIENDMSAmJgoJdGVzdF9jb21taXQgQ0MtbyAmJgoJdGVzdF9jb21taXQgQ0NCICYmCglnaXQgcmVzZXQgLS1oYXJkIENDMSAmJgoJZ2l0IG1lcmdlIC1zIG91cnMgQ0MyICYmCgl0ZXN0X2NvbW1pdCBDQ0EgJiYKCglnaXQgcmV2LXBhcnNlIENDMSBDQzIgPmV4cGVjdGVkICYmCglnaXQgbWVyZ2UtYmFzZSAtLWFsbCBDQ0IgQ0NBXl4gQ0NBXl4yID5hY3R1YWwgJiYKCglzb3J0IGV4cGVjdGVkID5leHBlY3RlZC5zb3J0ZWQgJiYKCXNvcnQgYWN0dWFsID5hY3R1YWwuc29ydGVkICYmCgl0ZXN0X2NtcCBleHBlY3RlZC5zb3J0ZWQgYWN0dWFsLnNvcnRlZAonCgp0ZXN0X2RvbmUK",
    "text": "#!/bin/sh\n#\n# Copyright (c) 2005 Junio C Hamano\n#\n\ntest_description='Merge base computation.\n'\n\n. ./test-lib.sh\n\ntest_expect_success 'setup' '\n\tT=$(git write-tree) &&\n\n\tM=1130000000 &&\n\tZ=+0000 &&\n\n\tGIT_COMMITTER_EMAIL=git@comm.iter.xz &&\n\tGIT_COMMITTER_NAME=\"C O Mmiter\" &&\n\tGIT_AUTHOR_NAME=\"A U Thor\" &&\n\tGIT_AUTHOR_EMAIL=git@au.thor.xz &&\n\texport GIT_COMMITTER_EMAIL GIT_COMMITTER_NAME GIT_AUTHOR_NAME GIT_AUTHOR_EMAIL &&\n\n\tdoit() {\n\t\tOFFSET=$1 &&\n\t\tNAME=$2 &&\n\t\tshift 2 &&\n\n\t\tPARENTS= &&\n\t\tfor P\n\t\tdo\n\t\t\tPARENTS=\"${PARENTS}-p $P \"\n\t\tdone &&\n\n\t\tGIT_COMMITTER_DATE=\"$(($M + $OFFSET)) $Z\" &&\n\t\tGIT_AUTHOR_DATE=$GIT_COMMITTER_DATE &&\n\t\texport GIT_COMMITTER_DATE GIT_AUTHOR_DATE &&\n\n\t\tcommit=$(echo $NAME | git commit-tree $T $PARENTS) &&\n\n\t\techo $commit >.git/refs/tags/$NAME &&\n\t\techo $commit\n\t}\n'\n\ntest_expect_success 'set up G and H' '\n\t# E---D---C---B---A\n\t# \\\"-_         \\   \\\n\t#  \\  `---------G   \\\n\t#   \\                \\\n\t#    F----------------H\n\tE=$(doit 5 E) &&\n\tD=$(doit 4 D $E) &&\n\tF=$(doit 6 F $E) &&\n\tC=$(doit 3 C $D) &&\n\tB=$(doit 2 B $C) &&\n\tA=$(doit 1 A $B) &&\n\tG=$(doit 7 G $B $E) &&\n\tH=$(doit 8 H $A $F)\n'\n\ntest_expect_success 'merge-base G H' '\n\tgit name-rev $B >expected &&\n\n\tMB=$(git merge-base G H) &&\n\tgit name-rev \"$MB\" >actual.single &&\n\n\tMB=$(git merge-base --all G H) &&\n\tgit name-rev \"$MB\" >actual.all &&\n\n\tMB=$(git show-branch --merge-base G H) &&\n\tgit name-rev \"$MB\" >actual.sb &&\n\n\ttest_cmp expected actual.single &&\n\ttest_cmp expected actual.all &&\n\ttest_cmp expected actual.sb\n'\n\ntest_expect_success 'unsynchronized clocks' '\n\t# This test is to demonstrate that relying on timestamps in a distributed\n\t# SCM to provide a _consistent_ partial ordering of commits leads to\n\t# insanity.\n\t#\n\t#               Relative\n\t# Structure     timestamps\n\t#\n\t#   PL  PR        +4  +4\n\t#  /  \\/  \\      /  \\/  \\\n\t# L2  C2  R2    +3  -1  +3\n\t# |   |   |     |   |   |\n\t# L1  C1  R1    +2  -2  +2\n\t# |   |   |     |   |   |\n\t# L0  C0  R0    +1  -3  +1\n\t#   \\ |  /        \\ |  /\n\t#     S             0\n\t#\n\t# The left and right chains of commits can be of any length and complexity as\n\t# long as all of the timestamps are greater than that of S.\n\n\tS=$(doit  0 S) &&\n\n\tC0=$(doit -3 C0 $S) &&\n\tC1=$(doit -2 C1 $C0) &&\n\tC2=$(doit -1 C2 $C1) &&\n\n\tL0=$(doit  1 L0 $S) &&\n\tL1=$(doit  2 L1 $L0) &&\n\tL2=$(doit  3 L2 $L1) &&\n\n\tR0=$(doit  1 R0 $S) &&\n\tR1=$(doit  2 R1 $R0) &&\n\tR2=$(doit  3 R2 $R1) &&\n\n\tPL=$(doit  4 PL $L2 $C2) &&\n\tPR=$(doit  4 PR $C2 $R2)\n\n\tgit name-rev $C2 >expected &&\n\n\tMB=$(git merge-base PL PR) &&\n\tgit name-rev \"$MB\" >actual.single &&\n\n\tMB=$(git merge-base --all PL PR) &&\n\tgit name-rev \"$MB\" >actual.all &&\n\n\ttest_cmp expected actual.single &&\n\ttest_cmp expected actual.all\n'\n\ntest_expect_success 'merge-base for octopus-step (setup)' '\n\t# Another set to demonstrate base between one commit and a merge\n\t# in the documentation.\n\t#\n\t# * C (MMC) * B (MMB) * A  (MMA)\n\t# * o       * o       * o\n\t# * o       * o       * o\n\t# * o       * o       * o\n\t# * o       | _______/\n\t# |         |/\n\t# |         * 1 (MM1)\n\t# | _______/\n\t# |/\n\t# * root (MMR)\n\n\ttest_commit MMR &&\n\ttest_commit MM1 &&\n\ttest_commit MM-o &&\n\ttest_commit MM-p &&\n\ttest_commit MM-q &&\n\ttest_commit MMA &&\n\tgit checkout MM1 &&\n\ttest_commit MM-r &&\n\ttest_commit MM-s &&\n\ttest_commit MM-t &&\n\ttest_commit MMB &&\n\tgit checkout MMR &&\n\ttest_commit MM-u &&\n\ttest_commit MM-v &&\n\ttest_commit MM-w &&\n\ttest_commit MM-x &&\n\ttest_commit MMC\n'\n\ntest_expect_success 'merge-base A B C' '\n\tgit rev-parse --verify MM1 >expected &&\n\tgit rev-parse --verify MMR >expected.sb &&\n\n\tgit merge-base --all MMA MMB MMC >actual &&\n\tgit merge-base --all --octopus MMA MMB MMC >actual.common &&\n\tgit show-branch --merge-base MMA MMB MMC >actual.sb &&\n\n\ttest_cmp expected actual &&\n\ttest_cmp expected.sb actual.common &&\n\ttest_cmp expected.sb actual.sb\n'\n\ntest_expect_success 'criss-cross merge-base for octopus-step' '\n\tgit reset --hard MMR &&\n\ttest_commit CC1 &&\n\tgit reset --hard E &&\n\ttest_commit CC2 &&\n\ttest_tick &&\n\tgit merge -s ours CC1 &&\n\ttest_commit CC-o &&\n\ttest_commit CCB &&\n\tgit reset --hard CC1 &&\n\tgit merge -s ours CC2 &&\n\ttest_commit CCA &&\n\n\tgit rev-parse CC1 CC2 >expected &&\n\tgit merge-base --all CCB CCA^^ CCA^^2 >actual &&\n\n\tsort expected >expected.sorted &&\n\tsort actual >actual.sorted &&\n\ttest_cmp expected.sorted actual.sorted\n'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "001431b36310813e0cd75d9aac364d72c8d0673d",
  "sha1_ok": true,
  "size": 4332
}
