{
  "content": {
    "base64": "I2luY2x1ZGUgImJ1aWx0aW4uaCIKI2luY2x1ZGUgImNvbmZpZy5oIgojaW5jbHVkZSAiaGV4LmgiCiNpbmNsdWRlICJvYmplY3Qtc3RvcmUuaCIKI2luY2x1ZGUgIndyYXBwZXIuaCIKCnN0YXRpYyBjaGFyICpjcmVhdGVfdGVtcF9maWxlKHN0cnVjdCBvYmplY3RfaWQgKm9pZCkKewoJc3RhdGljIGNoYXIgcGF0aFs1MF07Cgl2b2lkICpidWY7CgllbnVtIG9iamVjdF90eXBlIHR5cGU7Cgl1bnNpZ25lZCBsb25nIHNpemU7CglpbnQgZmQ7CgoJYnVmID0gcmVwb19yZWFkX29iamVjdF9maWxlKHRoZV9yZXBvc2l0b3J5LCBvaWQsICZ0eXBlLCAmc2l6ZSk7CglpZiAoIWJ1ZiB8fCB0eXBlICE9IE9CSl9CTE9CKQoJCWRpZSgidW5hYmxlIHRvIHJlYWQgYmxvYiBvYmplY3QgJXMiLCBvaWRfdG9faGV4KG9pZCkpOwoKCXhzbnByaW50ZihwYXRoLCBzaXplb2YocGF0aCksICIubWVyZ2VfZmlsZV9YWFhYWFgiKTsKCWZkID0geG1rc3RlbXAocGF0aCk7CglpZiAod3JpdGVfaW5fZnVsbChmZCwgYnVmLCBzaXplKSA8IDApCgkJZGllX2Vycm5vKCJ1bmFibGUgdG8gd3JpdGUgdGVtcC1maWxlIik7CgljbG9zZShmZCk7CglmcmVlKGJ1Zik7CglyZXR1cm4gcGF0aDsKfQoKaW50IGNtZF91bnBhY2tfZmlsZShpbnQgYXJnYywgY29uc3QgY2hhciAqKmFyZ3YsIGNvbnN0IGNoYXIgKnByZWZpeCBVTlVTRUQpCnsKCXN0cnVjdCBvYmplY3RfaWQgb2lkOwoKCWlmIChhcmdjICE9IDIgfHwgIXN0cmNtcChhcmd2WzFdLCAiLWgiKSkKCQl1c2FnZSgiZ2l0IHVucGFjay1maWxlIDxibG9iPiIpOwoJaWYgKHJlcG9fZ2V0X29pZCh0aGVfcmVwb3NpdG9yeSwgYXJndlsxXSwgJm9pZCkpCgkJZGllKCJOb3QgYSB2YWxpZCBvYmplY3QgbmFtZSAlcyIsIGFyZ3ZbMV0pOwoKCWdpdF9jb25maWcoZ2l0X2RlZmF1bHRfY29uZmlnLCBOVUxMKTsKCglwdXRzKGNyZWF0ZV90ZW1wX2ZpbGUoJm9pZCkpOwoJcmV0dXJuIDA7Cn0K",
    "text": "#include \"builtin.h\"\n#include \"config.h\"\n#include \"hex.h\"\n#include \"object-store.h\"\n#include \"wrapper.h\"\n\nstatic char *create_temp_file(struct object_id *oid)\n{\n\tstatic char path[50];\n\tvoid *buf;\n\tenum object_type type;\n\tunsigned long size;\n\tint fd;\n\n\tbuf = repo_read_object_file(the_repository, oid, &type, &size);\n\tif (!buf || type != OBJ_BLOB)\n\t\tdie(\"unable to read blob object %s\", oid_to_hex(oid));\n\n\txsnprintf(path, sizeof(path), \".merge_file_XXXXXX\");\n\tfd = xmkstemp(path);\n\tif (write_in_full(fd, buf, size) < 0)\n\t\tdie_errno(\"unable to write temp-file\");\n\tclose(fd);\n\tfree(buf);\n\treturn path;\n}\n\nint cmd_unpack_file(int argc, const char **argv, const char *prefix UNUSED)\n{\n\tstruct object_id oid;\n\n\tif (argc != 2 || !strcmp(argv[1], \"-h\"))\n\t\tusage(\"git unpack-file <blob>\");\n\tif (repo_get_oid(the_repository, argv[1], &oid))\n\t\tdie(\"Not a valid object name %s\", argv[1]);\n\n\tgit_config(git_default_config, NULL);\n\n\tputs(create_temp_file(&oid));\n\treturn 0;\n}\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "00179180c7dfd0d57a4ade4bee842d6af9636900",
  "sha1_ok": true,
  "size": 963
}
