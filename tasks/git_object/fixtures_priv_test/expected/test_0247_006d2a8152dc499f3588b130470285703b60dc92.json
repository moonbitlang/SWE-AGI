{
  "content": {
    "base64": "IyBJbml0aWFsaXphdGlvbiBhbmQgaGVscGVycyBmb3IgR2l0d2ViIHRlc3RzLCB3aGljaCBzb3VyY2UgdGhpcwojIHNoZWxsIGxpYnJhcnkgaW5zdGVhZCBvZiB0ZXN0LWxpYi5zaC4KIwojIENvcHlyaWdodCAoYykgMjAwNyBKYWt1YiBOYXJlYnNraQojCgpnaXR3ZWJfaW5pdCAoKSB7CglzYWZlX3B3ZD0iJChwZXJsIC1NUE9TSVg9Z2V0Y3dkIC1lICdwcmludCBxdW90ZW1ldGEoZ2V0Y3dkKScpIgoJY2F0ID5naXR3ZWJfY29uZmlnLnBlcmwgPDxFT0YKIyEvdXNyL2Jpbi9wZXJsCgojIGdpdHdlYiBjb25maWd1cmF0aW9uIGZvciB0ZXN0cwoKb3VyIFwkdmVyc2lvbiA9ICdjdXJyZW50JzsKb3VyIFwkR0lUID0gJ2dpdCc7Cm91ciBcJHByb2plY3Ryb290ID0gIiRzYWZlX3B3ZCI7Cm91ciBcJHByb2plY3RfbWF4ZGVwdGggPSA4OwpvdXIgXCRob21lX2xpbmtfc3RyID0gJ3Byb2plY3RzJzsKb3VyIFwkc2l0ZV9uYW1lID0gJ1tsb2NhbGhvc3RdJzsKb3VyIFwkc2l0ZV9odG1sX2hlYWRfc3RyaW5nID0gJyc7Cm91ciBcJHNpdGVfaGVhZGVyID0gJyc7Cm91ciBcJHNpdGVfZm9vdGVyID0gJyc7Cm91ciBcJGhvbWVfdGV4dCA9ICdpbmRleHRleHQuaHRtbCc7Cm91ciBAc3R5bGVzaGVldHMgPSAoJ2ZpbGU6Ly8vJEdJVF9CVUlMRF9ESVIvZ2l0d2ViL3N0YXRpYy9naXR3ZWIuY3NzJyk7Cm91ciBcJGxvZ28gPSAnZmlsZTovLy8kR0lUX0JVSUxEX0RJUi9naXR3ZWIvc3RhdGljL2dpdC1sb2dvLnBuZyc7Cm91ciBcJGZhdmljb24gPSAnZmlsZTovLy8kR0lUX0JVSUxEX0RJUi9naXR3ZWIvc3RhdGljL2dpdC1mYXZpY29uLnBuZyc7Cm91ciBcJHByb2plY3RzX2xpc3QgPSAnJzsKb3VyIFwkZXhwb3J0X29rID0gJyc7Cm91ciBcJHN0cmljdF9leHBvcnQgPSAnJzsKb3VyIFwkbWF4bG9hZCA9IHVuZGVmOwoKRU9GCgoJY2F0ID4uZ2l0L2Rlc2NyaXB0aW9uIDw8RU9GCiQwIHRlc3QgcmVwb3NpdG9yeQpFT0YKCgkjIFlvdSBjYW4gc2V0IHRoZSBHSVRXRUJfVEVTVF9JTlNUQUxMRUQgZW52aXJvbm1lbnQgdmFyaWFibGUgdG8KCSMgdGhlIGdpdHdlYmRpciAodGhlIGRpcmVjdG9yeSB3aGVyZSBnaXR3ZWIgaXMgaW5zdGFsbGVkIC8gZGVwbG95ZWQgdG8pCgkjIG9mIGFuIGV4aXN0aW5nIGdpdHdlYiBpbnN0YWxsYXRpb24gdG8gdGVzdCB0aGF0IGluc3RhbGxhdGlvbiwKCSMgb3Igc2ltcGx5IHRvIHBhdGhuYW1lIG9mIGluc3RhbGxlZCBnaXR3ZWIgc2NyaXB0LgoJaWYgdGVzdCAtbiAiJEdJVFdFQl9URVNUX0lOU1RBTExFRCIgOyB0aGVuCgkJaWYgdGVzdCAtZCAkR0lUV0VCX1RFU1RfSU5TVEFMTEVEOyB0aGVuCgkJCVNDUklQVF9OQU1FPSIkR0lUV0VCX1RFU1RfSU5TVEFMTEVEL2dpdHdlYi5jZ2kiCgkJZWxzZQoJCQlTQ1JJUFRfTkFNRT0iJEdJVFdFQl9URVNUX0lOU1RBTExFRCIKCQlmaQoJCXRlc3QgLWYgIiRTQ1JJUFRfTkFNRSIgfHwKCQllcnJvciAiQ2Fubm90IGZpbmQgZ2l0d2ViIGF0ICRHSVRXRUJfVEVTVF9JTlNUQUxMRUQuIgoJCXNheSAiIyBUZXN0aW5nICRTQ1JJUFRfTkFNRSIKCWVsc2UgIyBub3JtYWwgY2FzZSwgdXNlIHNvdXJjZSB2ZXJzaW9uIG9mIGdpdHdlYgoJCVNDUklQVF9OQU1FPSIkR0lUX0JVSUxEX0RJUi9naXR3ZWIvZ2l0d2ViLnBlcmwiCglmaQoJZXhwb3J0IFNDUklQVF9OQU1FCn0KCmdpdHdlYl9ydW4gKCkgewoJR0FURVdBWV9JTlRFUkZBQ0U9J0NHSS8xLjEnCglIVFRQX0FDQ0VQVD0nKi8qJwoJUkVRVUVTVF9NRVRIT0Q9J0dFVCcKCVFVRVJZX1NUUklORz0iIiQxIiIKCVBBVEhfSU5GTz0iIiQyIiIKCWV4cG9ydCBHQVRFV0FZX0lOVEVSRkFDRSBIVFRQX0FDQ0VQVCBSRVFVRVNUX01FVEhPRCBcCgkJUVVFUllfU1RSSU5HIFBBVEhfSU5GTwoKCUdJVFdFQl9DT05GSUc9JChwd2QpL2dpdHdlYl9jb25maWcucGVybAoJZXhwb3J0IEdJVFdFQl9DT05GSUcKCgkjIHNvbWUgb2YgZ2l0IGNvbW1hbmRzIHdyaXRlIHRvIFNUREVSUiBvbiBlcnJvciwgYnV0IHRoaXMgaXMgbm90CgkjIHdyaXR0ZW4gdG8gd2ViIHNlcnZlciBsb2dzLCBzbyB3ZSBhcmUgbm90IGludGVyZXN0ZWQgaW4gdGhhdDoKCSMgd2UgYXJlIGludGVyZXN0ZWQgb25seSBpbiBwcm9wZXJseSBmb3JtYXR0ZWQgZXJyb3JzL3dhcm5pbmdzCglybSAtZiBnaXR3ZWIubG9nICYmCglwZXJsIC0tICIkU0NSSVBUX05BTUUiIFwKCQk+Z2l0d2ViLm91dHB1dCAyPmdpdHdlYi5sb2cgJiYKCXBlcmwgLXcgLWUgJwoJCW9wZW4gTywgIj5naXR3ZWIuaGVhZGVycyI7CgkJd2hpbGUgKDw+KSB7CgkJCXByaW50IE87CgkJCWxhc3QgaWYgKC9eXHIkLyB8fCAvXiQvKTsKCQl9CgkJb3BlbiBPLCAiPmdpdHdlYi5ib2R5IjsKCQl3aGlsZSAoPD4pIHsKCQkJcHJpbnQgTzsKCQl9CgkJY2xvc2UgTzsKCScgZ2l0d2ViLm91dHB1dCAmJgoJaWYgZ3JlcCAnXltbXScgZ2l0d2ViLmxvZyA+L2Rldi9udWxsIDI+JjE7IHRoZW4KCQl0ZXN0X2RlYnVnICdjYXQgZ2l0d2ViLmxvZyA+JjInICYmCgkJZmFsc2UKCWVsc2UKCQl0cnVlCglmaQoKCSMgZ2l0d2ViLmxvZyBpcyBsZWZ0IGZvciBkZWJ1Z2dpbmcKCSMgZ2l0d2ViLm91dHB1dCBpcyB1c2VkIHRvIHBhcnNlIEhUVFAgb3V0cHV0CgkjIGdpdHdlYi5oZWFkZXJzIGNvbnRhaW5zIG9ubHkgSFRUUCBoZWFkZXJzCgkjIGdpdHdlYi5ib2R5IGNvbnRhaW5zIGJvZHkgb2YgbWVzc2FnZSwgd2l0aG91dCBoZWFkZXJzCn0KCi4gLi90ZXN0LWxpYi5zaAoKaWYgISB0ZXN0X2hhdmVfcHJlcmVxIFBFUkw7IHRoZW4KCXNraXBfYWxsPSdza2lwcGluZyBnaXR3ZWIgdGVzdHMsIHBlcmwgbm90IGF2YWlsYWJsZScKCXRlc3RfZG9uZQpmaQoKcGVybCAtTUVuY29kZSAtZSAnJGU9IiI7ZGVjb2RlX3V0ZjgoJGUsIEVuY29kZTo6RkJfQ1JPQUspJyA+L2Rldi9udWxsIDI+JjEgfHwgewoJc2tpcF9hbGw9J3NraXBwaW5nIGdpdHdlYiB0ZXN0cywgcGVybCB2ZXJzaW9uIGlzIHRvbyBvbGQnCgl0ZXN0X2RvbmUKfQoKcGVybCAtTUNHSSAtTUNHSTo6VXRpbCAtTUNHSTo6Q2FycCAtZSAwID4vZGV2L251bGwgMj4mMSB8fCB7Cglza2lwX2FsbD0nc2tpcHBpbmcgZ2l0d2ViIHRlc3RzLCBDR0kgJiBDR0k6OlV0aWwgJiBDR0k6OkNhcnAgbW9kdWxlcyBub3QgYXZhaWxhYmxlJwoJdGVzdF9kb25lCn0KCnBlcmwgLW1UaW1lOjpIaVJlcyAtZSAwID4vZGV2L251bGwgMj4mMSB8fCB7Cglza2lwX2FsbD0nc2tpcHBpbmcgZ2l0d2ViIHRlc3RzLCBUaW1lOjpIaVJlcyBtb2R1bGUgbm90IGF2YWlsYWJsZScKCXRlc3RfZG9uZQp9CgpnaXR3ZWJfaW5pdAo=",
    "text": "# Initialization and helpers for Gitweb tests, which source this\n# shell library instead of test-lib.sh.\n#\n# Copyright (c) 2007 Jakub Narebski\n#\n\ngitweb_init () {\n\tsafe_pwd=\"$(perl -MPOSIX=getcwd -e 'print quotemeta(getcwd)')\"\n\tcat >gitweb_config.perl <<EOF\n#!/usr/bin/perl\n\n# gitweb configuration for tests\n\nour \\$version = 'current';\nour \\$GIT = 'git';\nour \\$projectroot = \"$safe_pwd\";\nour \\$project_maxdepth = 8;\nour \\$home_link_str = 'projects';\nour \\$site_name = '[localhost]';\nour \\$site_html_head_string = '';\nour \\$site_header = '';\nour \\$site_footer = '';\nour \\$home_text = 'indextext.html';\nour @stylesheets = ('file:///$GIT_BUILD_DIR/gitweb/static/gitweb.css');\nour \\$logo = 'file:///$GIT_BUILD_DIR/gitweb/static/git-logo.png';\nour \\$favicon = 'file:///$GIT_BUILD_DIR/gitweb/static/git-favicon.png';\nour \\$projects_list = '';\nour \\$export_ok = '';\nour \\$strict_export = '';\nour \\$maxload = undef;\n\nEOF\n\n\tcat >.git/description <<EOF\n$0 test repository\nEOF\n\n\t# You can set the GITWEB_TEST_INSTALLED environment variable to\n\t# the gitwebdir (the directory where gitweb is installed / deployed to)\n\t# of an existing gitweb installation to test that installation,\n\t# or simply to pathname of installed gitweb script.\n\tif test -n \"$GITWEB_TEST_INSTALLED\" ; then\n\t\tif test -d $GITWEB_TEST_INSTALLED; then\n\t\t\tSCRIPT_NAME=\"$GITWEB_TEST_INSTALLED/gitweb.cgi\"\n\t\telse\n\t\t\tSCRIPT_NAME=\"$GITWEB_TEST_INSTALLED\"\n\t\tfi\n\t\ttest -f \"$SCRIPT_NAME\" ||\n\t\terror \"Cannot find gitweb at $GITWEB_TEST_INSTALLED.\"\n\t\tsay \"# Testing $SCRIPT_NAME\"\n\telse # normal case, use source version of gitweb\n\t\tSCRIPT_NAME=\"$GIT_BUILD_DIR/gitweb/gitweb.perl\"\n\tfi\n\texport SCRIPT_NAME\n}\n\ngitweb_run () {\n\tGATEWAY_INTERFACE='CGI/1.1'\n\tHTTP_ACCEPT='*/*'\n\tREQUEST_METHOD='GET'\n\tQUERY_STRING=\"\"$1\"\"\n\tPATH_INFO=\"\"$2\"\"\n\texport GATEWAY_INTERFACE HTTP_ACCEPT REQUEST_METHOD \\\n\t\tQUERY_STRING PATH_INFO\n\n\tGITWEB_CONFIG=$(pwd)/gitweb_config.perl\n\texport GITWEB_CONFIG\n\n\t# some of git commands write to STDERR on error, but this is not\n\t# written to web server logs, so we are not interested in that:\n\t# we are interested only in properly formatted errors/warnings\n\trm -f gitweb.log &&\n\tperl -- \"$SCRIPT_NAME\" \\\n\t\t>gitweb.output 2>gitweb.log &&\n\tperl -w -e '\n\t\topen O, \">gitweb.headers\";\n\t\twhile (<>) {\n\t\t\tprint O;\n\t\t\tlast if (/^\\r$/ || /^$/);\n\t\t}\n\t\topen O, \">gitweb.body\";\n\t\twhile (<>) {\n\t\t\tprint O;\n\t\t}\n\t\tclose O;\n\t' gitweb.output &&\n\tif grep '^[[]' gitweb.log >/dev/null 2>&1; then\n\t\ttest_debug 'cat gitweb.log >&2' &&\n\t\tfalse\n\telse\n\t\ttrue\n\tfi\n\n\t# gitweb.log is left for debugging\n\t# gitweb.output is used to parse HTTP output\n\t# gitweb.headers contains only HTTP headers\n\t# gitweb.body contains body of message, without headers\n}\n\n. ./test-lib.sh\n\nif ! test_have_prereq PERL; then\n\tskip_all='skipping gitweb tests, perl not available'\n\ttest_done\nfi\n\nperl -MEncode -e '$e=\"\";decode_utf8($e, Encode::FB_CROAK)' >/dev/null 2>&1 || {\n\tskip_all='skipping gitweb tests, perl version is too old'\n\ttest_done\n}\n\nperl -MCGI -MCGI::Util -MCGI::Carp -e 0 >/dev/null 2>&1 || {\n\tskip_all='skipping gitweb tests, CGI & CGI::Util & CGI::Carp modules not available'\n\ttest_done\n}\n\nperl -mTime::HiRes -e 0 >/dev/null 2>&1 || {\n\tskip_all='skipping gitweb tests, Time::HiRes module not available'\n\ttest_done\n}\n\ngitweb_init\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "006d2a8152dc499f3588b130470285703b60dc92",
  "sha1_ok": true,
  "size": 3260
}
