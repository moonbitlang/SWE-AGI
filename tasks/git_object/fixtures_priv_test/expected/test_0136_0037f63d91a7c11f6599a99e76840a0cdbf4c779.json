{
  "content": {
    "base64": "IyEvYmluL3NoCiMKIyBDb3B5cmlnaHQgKEMpIDIwMDUgUmVuZSBTY2hhcmZlCiMKCnRlc3RfZGVzY3JpcHRpb249J2dpdCB0YXItdHJlZSBhbmQgZ2l0IGdldC10YXItY29tbWl0LWlkIHRlc3QKClRoaXMgdGVzdCBjb3ZlcnMgdGhlIHRvcGljcyBvZiBmaWxlIGNvbnRlbnRzLCBjb21taXQgZGF0ZSBoYW5kbGluZyBhbmQKY29tbWl0IGlkIGVtYmVkZGluZzoKCiAgVGhlIGNvbnRlbnRzIG9mIHRoZSByZXBvc2l0b3J5IGlzIGNvbXBhcmVkIHRvIHRoZSBleHRyYWN0ZWQgdGFyCiAgYXJjaGl2ZS4gIFRoZSByZXBvc2l0b3J5IGNvbnRhaW5zIHNpbXBsZSB0ZXh0IGZpbGVzLCBzeW1saW5rcyBhbmQgYQogIGJpbmFyeSBmaWxlICgvYmluL3NoKS4gIE9ubHkgcGF0aHMgc2hvcnRlciB0aGFuIDk5IGNoYXJhY3RlcnMgYXJlCiAgdXNlZC4KCiAgZ2l0IHRhci10cmVlIGFwcGxpZXMgdGhlIGNvbW1pdCBkYXRlIHRvIGV2ZXJ5IGZpbGUgaW4gdGhlIGFyY2hpdmUgaXQKICBjcmVhdGVzLiAgVGhlIHRlc3Qgc2V0cyB0aGUgY29tbWl0IGRhdGUgdG8gYSBzcGVjaWZpYyB2YWx1ZSBhbmQgY2hlY2tzCiAgaWYgdGhlIHRhciBhcmNoaXZlIGNvbnRhaW5zIHRoYXQgdmFsdWUuCgogIFdoZW4gZ2l2aW5nIGdpdCB0YXItdHJlZSBhIGNvbW1pdCBpZCAoaW4gY29udHJhc3QgdG8gYSB0cmVlIGlkKSBpdAogIGVtYmVkcyB0aGlzIGNvbW1pdCBpZCBpbnRvIHRoZSB0YXIgYXJjaGl2ZSBhcyBhIGNvbW1lbnQuICBUaGUgdGVzdAogIGNoZWNrcyB0aGUgYWJpbGl0eSBvZiBnaXQgZ2V0LXRhci1jb21taXQtaWQgdG8gZmlndXJlIGl0IG91dCBmcm9tIHRoZQogIHRhciBmaWxlLgoKJwoKLiAuL3Rlc3QtbGliLnNoClVOWklQPSR7VU5aSVA6LXVuemlwfQoKU1VCU1RGT1JNQVQ9JUglbgoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAncG9wdWxhdGUgd29ya2RpcicgXAogICAgJ21rZGlyIGEgYiBjICYmCiAgICAgZWNobyBzaW1wbGUgdGV4dGZpbGUgPmEvYSAmJgogICAgIG1rZGlyIGEvYmluICYmCiAgICAgY3AgL2Jpbi9zaCBhL2JpbiAmJgogICAgIHByaW50ZiAiQVwkRm9ybWF0OiVzXCRPIiAiJFNVQlNURk9STUFUIiA+YS9zdWJzdGZpbGUxICYmCiAgICAgcHJpbnRmICJBIG5vdCBzdWJzdGl0dXRlZCBPIiA+YS9zdWJzdGZpbGUyICYmCiAgICAgaWYgdGVzdF9oYXZlX3ByZXJlcSBTWU1MSU5LUzsgdGhlbgoJbG4gLXMgYSBhL2wxCiAgICAgZWxzZQoJcHJpbnRmICVzIGEgPiBhL2wxCiAgICAgZmkgJiYKICAgICAocD1sb25nX3BhdGhfdG9fYV9maWxlICYmIGNkIGEgJiYKICAgICAgZm9yIGRlcHRoIGluIDEgMiAzIDQgNTsgZG8gbWtkaXIgJHAgJiYgY2QgJHA7IGRvbmUgJiYKICAgICAgZWNobyB0ZXh0ID5maWxlX3dpdGhfbG9uZ19wYXRoKSAmJgogICAgIChjZCBhICYmIGZpbmQgLikgfCBzb3J0ID5hLmxzdCcKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ2FkZCBpZ25vcmVkIGZpbGUnIFwKICAgICdlY2hvIGlnbm9yZSBtZSA+YS9pZ25vcmVkICYmCiAgICAgZWNobyBpZ25vcmVkIGV4cG9ydC1pZ25vcmUgPi5naXQvaW5mby9hdHRyaWJ1dGVzJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAnYWRkIGZpbGVzIHRvIHJlcG9zaXRvcnknIFwKICAgICdmaW5kIGEgLXR5cGUgZiB8IHhhcmdzIGdpdCB1cGRhdGUtaW5kZXggLS1hZGQgJiYKICAgICBmaW5kIGEgLXR5cGUgbCB8IHhhcmdzIGdpdCB1cGRhdGUtaW5kZXggLS1hZGQgJiYKICAgICB0cmVlaWQ9YGdpdCB3cml0ZS10cmVlYCAmJgogICAgIGVjaG8gJHRyZWVpZCA+dHJlZWlkICYmCiAgICAgZ2l0IHVwZGF0ZS1yZWYgSEVBRCAkKFRaPUdNVCBHSVRfQ09NTUlUVEVSX0RBVEU9IjIwMDUtMDUtMjcgMjI6MDA6MDAiIFwKICAgICBnaXQgY29tbWl0LXRyZWUgJHRyZWVpZCA8L2Rldi9udWxsKScKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ2NyZWF0ZSBiYXJlIGNsb25lJyBcCiAgICAnZ2l0IGNsb25lIC0tYmFyZSAuIGJhcmUuZ2l0ICYmCiAgICAgY3AgLmdpdC9pbmZvL2F0dHJpYnV0ZXMgYmFyZS5naXQvaW5mby9hdHRyaWJ1dGVzJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAncmVtb3ZlIGlnbm9yZWQgZmlsZScgXAogICAgJ3JtIGEvaWdub3JlZCcKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ2dpdCBhcmNoaXZlJyBcCiAgICAnZ2l0IGFyY2hpdmUgSEVBRCA+Yi50YXInCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICdnaXQgdGFyLXRyZWUnIFwKICAgICdnaXQgdGFyLXRyZWUgSEVBRCA+YjIudGFyJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAnZ2l0IGFyY2hpdmUgdnMuIGdpdCB0YXItdHJlZScgXAogICAgJ3Rlc3RfY21wIGIudGFyIGIyLnRhcicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ2dpdCBhcmNoaXZlIGluIGEgYmFyZSByZXBvJyBcCiAgICAnKGNkIGJhcmUuZ2l0ICYmIGdpdCBhcmNoaXZlIEhFQUQpID5iMy50YXInCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICdnaXQgYXJjaGl2ZSB2cy4gdGhlIHNhbWUgaW4gYSBiYXJlIHJlcG8nIFwKICAgICd0ZXN0X2NtcCBiLnRhciBiMy50YXInCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdnaXQgYXJjaGl2ZSB3aXRoIC0tb3V0cHV0JyBcCiAgICAnZ2l0IGFyY2hpdmUgLS1vdXRwdXQ9YjQudGFyIEhFQUQgJiYKICAgIHRlc3RfY21wIGIudGFyIGI0LnRhcicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBhcmNoaXZlIC0tcmVtb3RlJyBcCiAgICAnZ2l0IGFyY2hpdmUgLS1yZW1vdGU9LiBIRUFEID5iNS50YXIgJiYKICAgIHRlc3RfY21wIGIudGFyIGI1LnRhcicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ3ZhbGlkYXRlIGZpbGUgbW9kaWZpY2F0aW9uIHRpbWUnIFwKICAgICdta2RpciBleHRyYWN0ICYmCiAgICAgIiRUQVIiIHhmIGIudGFyIC1DIGV4dHJhY3QgYS9hICYmCiAgICAgdGVzdC1jaG10aW1lIC12ICswIGV4dHJhY3QvYS9hIHxjdXQgLWYgMSA+Yi5tdGltZSAmJgogICAgIGVjaG8gIjExMTcyMzEyMDAiID5leHBlY3RlZC5tdGltZSAmJgogICAgIHRlc3RfY21wIGV4cGVjdGVkLm10aW1lIGIubXRpbWUnCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICdnaXQgZ2V0LXRhci1jb21taXQtaWQnIFwKICAgICdnaXQgZ2V0LXRhci1jb21taXQtaWQgPGIudGFyID5iLmNvbW1pdGlkICYmCiAgICAgdGVzdF9jbXAgLmdpdC8kKGdpdCBzeW1ib2xpYy1yZWYgSEVBRCkgYi5jb21taXRpZCcKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ2V4dHJhY3QgdGFyIGFyY2hpdmUnIFwKICAgICcoY2QgYiAmJiAiJFRBUiIgeGYgLSkgPGIudGFyJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAndmFsaWRhdGUgZmlsZW5hbWVzJyBcCiAgICAnKGNkIGIvYSAmJiBmaW5kIC4pIHwgc29ydCA+Yi5sc3QgJiYKICAgICB0ZXN0X2NtcCBhLmxzdCBiLmxzdCcKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ3ZhbGlkYXRlIGZpbGUgY29udGVudHMnIFwKICAgICdkaWZmIC1yIGEgYi9hJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAnZ2l0IHRhci10cmVlIHdpdGggcHJlZml4JyBcCiAgICAnZ2l0IHRhci10cmVlIEhFQUQgcHJlZml4ID5jLnRhcicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ2V4dHJhY3QgdGFyIGFyY2hpdmUgd2l0aCBwcmVmaXgnIFwKICAgICcoY2QgYyAmJiAiJFRBUiIgeGYgLSkgPGMudGFyJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAndmFsaWRhdGUgZmlsZW5hbWVzIHdpdGggcHJlZml4JyBcCiAgICAnKGNkIGMvcHJlZml4L2EgJiYgZmluZCAuKSB8IHNvcnQgPmMubHN0ICYmCiAgICAgdGVzdF9jbXAgYS5sc3QgYy5sc3QnCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICd2YWxpZGF0ZSBmaWxlIGNvbnRlbnRzIHdpdGggcHJlZml4JyBcCiAgICAnZGlmZiAtciBhIGMvcHJlZml4L2EnCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICdjcmVhdGUgYXJjaGl2ZXMgd2l0aCBzdWJzdGZpbGVzJyBcCiAgICAnY3AgLmdpdC9pbmZvL2F0dHJpYnV0ZXMgLmdpdC9pbmZvL2F0dHJpYnV0ZXMuYmVmb3JlICYmCiAgICAgZWNobyAic3Vic3RmaWxlPyIgZXhwb3J0LXN1YnN0ID4+LmdpdC9pbmZvL2F0dHJpYnV0ZXMgJiYKICAgICBnaXQgYXJjaGl2ZSBIRUFEID5mLnRhciAmJgogICAgIGdpdCBhcmNoaXZlIC0tcHJlZml4PXByZWZpeC8gSEVBRCA+Zy50YXIgJiYKICAgICBtdiAuZ2l0L2luZm8vYXR0cmlidXRlcy5iZWZvcmUgLmdpdC9pbmZvL2F0dHJpYnV0ZXMnCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICdleHRyYWN0IHN1YnN0ZmlsZXMnIFwKICAgICcobWtkaXIgZiAmJiBjZCBmICYmICIkVEFSIiB4ZiAtKSA8Zi50YXInCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICAndmFsaWRhdGUgc3Vic3RmaWxlIGNvbnRlbnRzJyBcCiAgICAgJ2dpdCBsb2cgLS1tYXgtY291bnQ9MSAiLS1wcmV0dHk9Zm9ybWF0OkEke1NVQlNURk9STUFUfU8iIEhFQUQgXAogICAgICA+Zi9hL3N1YnN0ZmlsZTEuZXhwZWN0ZWQgJiYKICAgICAgdGVzdF9jbXAgZi9hL3N1YnN0ZmlsZTEuZXhwZWN0ZWQgZi9hL3N1YnN0ZmlsZTEgJiYKICAgICAgdGVzdF9jbXAgYS9zdWJzdGZpbGUyIGYvYS9zdWJzdGZpbGUyCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ2V4dHJhY3Qgc3Vic3RmaWxlcyBmcm9tIGFyY2hpdmUgd2l0aCBwcmVmaXgnIFwKICAgICcobWtkaXIgZyAmJiBjZCBnICYmICIkVEFSIiB4ZiAtKSA8Zy50YXInCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICAndmFsaWRhdGUgc3Vic3RmaWxlIGNvbnRlbnRzIGZyb20gYXJjaGl2ZSB3aXRoIHByZWZpeCcgXAogICAgICdnaXQgbG9nIC0tbWF4LWNvdW50PTEgIi0tcHJldHR5PWZvcm1hdDpBJHtTVUJTVEZPUk1BVH1PIiBIRUFEIFwKICAgICAgPmcvcHJlZml4L2Evc3Vic3RmaWxlMS5leHBlY3RlZCAmJgogICAgICB0ZXN0X2NtcCBnL3ByZWZpeC9hL3N1YnN0ZmlsZTEuZXhwZWN0ZWQgZy9wcmVmaXgvYS9zdWJzdGZpbGUxICYmCiAgICAgIHRlc3RfY21wIGEvc3Vic3RmaWxlMiBnL3ByZWZpeC9hL3N1YnN0ZmlsZTIKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAnZ2l0IGFyY2hpdmUgLS1mb3JtYXQ9emlwJyBcCiAgICAnZ2l0IGFyY2hpdmUgLS1mb3JtYXQ9emlwIEhFQUQgPmQuemlwJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAnZ2l0IGFyY2hpdmUgLS1mb3JtYXQ9emlwIGluIGEgYmFyZSByZXBvJyBcCiAgICAnKGNkIGJhcmUuZ2l0ICYmIGdpdCBhcmNoaXZlIC0tZm9ybWF0PXppcCBIRUFEKSA+ZDEuemlwJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBcCiAgICAnZ2l0IGFyY2hpdmUgLS1mb3JtYXQ9emlwIHZzLiB0aGUgc2FtZSBpbiBhIGJhcmUgcmVwbycgXAogICAgJ3Rlc3RfY21wIGQuemlwIGQxLnppcCcKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBhcmNoaXZlIC0tZm9ybWF0PXppcCB3aXRoIC0tb3V0cHV0JyBcCiAgICAnZ2l0IGFyY2hpdmUgLS1mb3JtYXQ9emlwIC0tb3V0cHV0PWQyLnppcCBIRUFEICYmCiAgICB0ZXN0X2NtcCBkLnppcCBkMi56aXAnCgokVU5aSVAgLXYgPi9kZXYvbnVsbCAyPiYxCmlmIFsgJD8gLWVxIDEyNyBdOyB0aGVuCglzYXkgIlNraXBwaW5nIFpJUCB0ZXN0cywgYmVjYXVzZSB1bnppcCB3YXMgbm90IGZvdW5kIgplbHNlCgl0ZXN0X3NldF9wcmVyZXEgVU5aSVAKZmkKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgVU5aSVAgXAogICAgJ2V4dHJhY3QgWklQIGFyY2hpdmUnIFwKICAgICcobWtkaXIgZCAmJiBjZCBkICYmICRVTlpJUCAuLi9kLnppcCknCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFVOWklQIFwKICAgICd2YWxpZGF0ZSBmaWxlbmFtZXMnIFwKICAgICcoY2QgZC9hICYmIGZpbmQgLikgfCBzb3J0ID5kLmxzdCAmJgogICAgIHRlc3RfY21wIGEubHN0IGQubHN0JwoKdGVzdF9leHBlY3Rfc3VjY2VzcyBVTlpJUCBcCiAgICAndmFsaWRhdGUgZmlsZSBjb250ZW50cycgXAogICAgJ2RpZmYgLXIgYSBkL2EnCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFwKICAgICdnaXQgYXJjaGl2ZSAtLWZvcm1hdD16aXAgd2l0aCBwcmVmaXgnIFwKICAgICdnaXQgYXJjaGl2ZSAtLWZvcm1hdD16aXAgLS1wcmVmaXg9cHJlZml4LyBIRUFEID5lLnppcCcKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgVU5aSVAgXAogICAgJ2V4dHJhY3QgWklQIGFyY2hpdmUgd2l0aCBwcmVmaXgnIFwKICAgICcobWtkaXIgZSAmJiBjZCBlICYmICRVTlpJUCAuLi9lLnppcCknCgp0ZXN0X2V4cGVjdF9zdWNjZXNzIFVOWklQIFwKICAgICd2YWxpZGF0ZSBmaWxlbmFtZXMgd2l0aCBwcmVmaXgnIFwKICAgICcoY2QgZS9wcmVmaXgvYSAmJiBmaW5kIC4pIHwgc29ydCA+ZS5sc3QgJiYKICAgICB0ZXN0X2NtcCBhLmxzdCBlLmxzdCcKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgVU5aSVAgXAogICAgJ3ZhbGlkYXRlIGZpbGUgY29udGVudHMgd2l0aCBwcmVmaXgnIFwKICAgICdkaWZmIC1yIGEgZS9wcmVmaXgvYScKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgXAogICAgJ2dpdCBhcmNoaXZlIC0tbGlzdCBvdXRzaWRlIG9mIGEgZ2l0IHJlcG8nIFwKICAgICdHSVRfRElSPXNvbWUvbm9uLWV4aXN0aW5nL2RpcmVjdG9yeSBnaXQgYXJjaGl2ZSAtLWxpc3QnCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdnaXQtYXJjaGl2ZSAtLXByZWZpeD1vbGRlLScgJwoJZ2l0IGFyY2hpdmUgLS1wcmVmaXg9b2xkZS0gPmgudGFyIEhFQUQgJiYKCSgKCQlta2RpciBoICYmCgkJY2QgaCAmJgoJCSIkVEFSIiB4ZiAtIDwuLi9oLnRhcgoJKSAmJgoJdGVzdCAtZCBoL29sZGUtYSAmJgoJdGVzdCAtZCBoL29sZGUtYS9iaW4gJiYKCXRlc3QgLWYgaC9vbGRlLWEvYmluL3NoCicKCnRlc3RfZG9uZQo=",
    "text": "#!/bin/sh\n#\n# Copyright (C) 2005 Rene Scharfe\n#\n\ntest_description='git tar-tree and git get-tar-commit-id test\n\nThis test covers the topics of file contents, commit date handling and\ncommit id embedding:\n\n  The contents of the repository is compared to the extracted tar\n  archive.  The repository contains simple text files, symlinks and a\n  binary file (/bin/sh).  Only paths shorter than 99 characters are\n  used.\n\n  git tar-tree applies the commit date to every file in the archive it\n  creates.  The test sets the commit date to a specific value and checks\n  if the tar archive contains that value.\n\n  When giving git tar-tree a commit id (in contrast to a tree id) it\n  embeds this commit id into the tar archive as a comment.  The test\n  checks the ability of git get-tar-commit-id to figure it out from the\n  tar file.\n\n'\n\n. ./test-lib.sh\nUNZIP=${UNZIP:-unzip}\n\nSUBSTFORMAT=%H%n\n\ntest_expect_success \\\n    'populate workdir' \\\n    'mkdir a b c &&\n     echo simple textfile >a/a &&\n     mkdir a/bin &&\n     cp /bin/sh a/bin &&\n     printf \"A\\$Format:%s\\$O\" \"$SUBSTFORMAT\" >a/substfile1 &&\n     printf \"A not substituted O\" >a/substfile2 &&\n     if test_have_prereq SYMLINKS; then\n\tln -s a a/l1\n     else\n\tprintf %s a > a/l1\n     fi &&\n     (p=long_path_to_a_file && cd a &&\n      for depth in 1 2 3 4 5; do mkdir $p && cd $p; done &&\n      echo text >file_with_long_path) &&\n     (cd a && find .) | sort >a.lst'\n\ntest_expect_success \\\n    'add ignored file' \\\n    'echo ignore me >a/ignored &&\n     echo ignored export-ignore >.git/info/attributes'\n\ntest_expect_success \\\n    'add files to repository' \\\n    'find a -type f | xargs git update-index --add &&\n     find a -type l | xargs git update-index --add &&\n     treeid=`git write-tree` &&\n     echo $treeid >treeid &&\n     git update-ref HEAD $(TZ=GMT GIT_COMMITTER_DATE=\"2005-05-27 22:00:00\" \\\n     git commit-tree $treeid </dev/null)'\n\ntest_expect_success \\\n    'create bare clone' \\\n    'git clone --bare . bare.git &&\n     cp .git/info/attributes bare.git/info/attributes'\n\ntest_expect_success \\\n    'remove ignored file' \\\n    'rm a/ignored'\n\ntest_expect_success \\\n    'git archive' \\\n    'git archive HEAD >b.tar'\n\ntest_expect_success \\\n    'git tar-tree' \\\n    'git tar-tree HEAD >b2.tar'\n\ntest_expect_success \\\n    'git archive vs. git tar-tree' \\\n    'test_cmp b.tar b2.tar'\n\ntest_expect_success \\\n    'git archive in a bare repo' \\\n    '(cd bare.git && git archive HEAD) >b3.tar'\n\ntest_expect_success \\\n    'git archive vs. the same in a bare repo' \\\n    'test_cmp b.tar b3.tar'\n\ntest_expect_success 'git archive with --output' \\\n    'git archive --output=b4.tar HEAD &&\n    test_cmp b.tar b4.tar'\n\ntest_expect_success 'git archive --remote' \\\n    'git archive --remote=. HEAD >b5.tar &&\n    test_cmp b.tar b5.tar'\n\ntest_expect_success \\\n    'validate file modification time' \\\n    'mkdir extract &&\n     \"$TAR\" xf b.tar -C extract a/a &&\n     test-chmtime -v +0 extract/a/a |cut -f 1 >b.mtime &&\n     echo \"1117231200\" >expected.mtime &&\n     test_cmp expected.mtime b.mtime'\n\ntest_expect_success \\\n    'git get-tar-commit-id' \\\n    'git get-tar-commit-id <b.tar >b.commitid &&\n     test_cmp .git/$(git symbolic-ref HEAD) b.commitid'\n\ntest_expect_success \\\n    'extract tar archive' \\\n    '(cd b && \"$TAR\" xf -) <b.tar'\n\ntest_expect_success \\\n    'validate filenames' \\\n    '(cd b/a && find .) | sort >b.lst &&\n     test_cmp a.lst b.lst'\n\ntest_expect_success \\\n    'validate file contents' \\\n    'diff -r a b/a'\n\ntest_expect_success \\\n    'git tar-tree with prefix' \\\n    'git tar-tree HEAD prefix >c.tar'\n\ntest_expect_success \\\n    'extract tar archive with prefix' \\\n    '(cd c && \"$TAR\" xf -) <c.tar'\n\ntest_expect_success \\\n    'validate filenames with prefix' \\\n    '(cd c/prefix/a && find .) | sort >c.lst &&\n     test_cmp a.lst c.lst'\n\ntest_expect_success \\\n    'validate file contents with prefix' \\\n    'diff -r a c/prefix/a'\n\ntest_expect_success \\\n    'create archives with substfiles' \\\n    'cp .git/info/attributes .git/info/attributes.before &&\n     echo \"substfile?\" export-subst >>.git/info/attributes &&\n     git archive HEAD >f.tar &&\n     git archive --prefix=prefix/ HEAD >g.tar &&\n     mv .git/info/attributes.before .git/info/attributes'\n\ntest_expect_success \\\n    'extract substfiles' \\\n    '(mkdir f && cd f && \"$TAR\" xf -) <f.tar'\n\ntest_expect_success \\\n     'validate substfile contents' \\\n     'git log --max-count=1 \"--pretty=format:A${SUBSTFORMAT}O\" HEAD \\\n      >f/a/substfile1.expected &&\n      test_cmp f/a/substfile1.expected f/a/substfile1 &&\n      test_cmp a/substfile2 f/a/substfile2\n'\n\ntest_expect_success \\\n    'extract substfiles from archive with prefix' \\\n    '(mkdir g && cd g && \"$TAR\" xf -) <g.tar'\n\ntest_expect_success \\\n     'validate substfile contents from archive with prefix' \\\n     'git log --max-count=1 \"--pretty=format:A${SUBSTFORMAT}O\" HEAD \\\n      >g/prefix/a/substfile1.expected &&\n      test_cmp g/prefix/a/substfile1.expected g/prefix/a/substfile1 &&\n      test_cmp a/substfile2 g/prefix/a/substfile2\n'\n\ntest_expect_success \\\n    'git archive --format=zip' \\\n    'git archive --format=zip HEAD >d.zip'\n\ntest_expect_success \\\n    'git archive --format=zip in a bare repo' \\\n    '(cd bare.git && git archive --format=zip HEAD) >d1.zip'\n\ntest_expect_success \\\n    'git archive --format=zip vs. the same in a bare repo' \\\n    'test_cmp d.zip d1.zip'\n\ntest_expect_success 'git archive --format=zip with --output' \\\n    'git archive --format=zip --output=d2.zip HEAD &&\n    test_cmp d.zip d2.zip'\n\n$UNZIP -v >/dev/null 2>&1\nif [ $? -eq 127 ]; then\n\tsay \"Skipping ZIP tests, because unzip was not found\"\nelse\n\ttest_set_prereq UNZIP\nfi\n\ntest_expect_success UNZIP \\\n    'extract ZIP archive' \\\n    '(mkdir d && cd d && $UNZIP ../d.zip)'\n\ntest_expect_success UNZIP \\\n    'validate filenames' \\\n    '(cd d/a && find .) | sort >d.lst &&\n     test_cmp a.lst d.lst'\n\ntest_expect_success UNZIP \\\n    'validate file contents' \\\n    'diff -r a d/a'\n\ntest_expect_success \\\n    'git archive --format=zip with prefix' \\\n    'git archive --format=zip --prefix=prefix/ HEAD >e.zip'\n\ntest_expect_success UNZIP \\\n    'extract ZIP archive with prefix' \\\n    '(mkdir e && cd e && $UNZIP ../e.zip)'\n\ntest_expect_success UNZIP \\\n    'validate filenames with prefix' \\\n    '(cd e/prefix/a && find .) | sort >e.lst &&\n     test_cmp a.lst e.lst'\n\ntest_expect_success UNZIP \\\n    'validate file contents with prefix' \\\n    'diff -r a e/prefix/a'\n\ntest_expect_success \\\n    'git archive --list outside of a git repo' \\\n    'GIT_DIR=some/non-existing/directory git archive --list'\n\ntest_expect_success 'git-archive --prefix=olde-' '\n\tgit archive --prefix=olde- >h.tar HEAD &&\n\t(\n\t\tmkdir h &&\n\t\tcd h &&\n\t\t\"$TAR\" xf - <../h.tar\n\t) &&\n\ttest -d h/olde-a &&\n\ttest -d h/olde-a/bin &&\n\ttest -f h/olde-a/bin/sh\n'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "0037f63d91a7c11f6599a99e76840a0cdbf4c779",
  "sha1_ok": true,
  "size": 6812
}
