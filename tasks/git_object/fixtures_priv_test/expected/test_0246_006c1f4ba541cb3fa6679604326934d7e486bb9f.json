{
  "content": {
    "base64": "Lyogd3JhcHBlcnMgZm9yIHRoZSBFVlAgQVBJIG9mIE9wZW5TU0wgMysgKi8KI2lmbmRlZiBTSEExX09QRU5TU0xfSAojZGVmaW5lIFNIQTFfT1BFTlNTTF9ICiNpbmNsdWRlIDxvcGVuc3NsL2V2cC5oPgoKc3RydWN0IG9wZW5zc2xfU0hBMV9DVFggewoJRVZQX01EX0NUWCAqZWN0eDsKfTsKCnR5cGVkZWYgc3RydWN0IG9wZW5zc2xfU0hBMV9DVFggb3BlbnNzbF9TSEExX0NUWDsKCnN0YXRpYyBpbmxpbmUgdm9pZCBvcGVuc3NsX1NIQTFfSW5pdChzdHJ1Y3Qgb3BlbnNzbF9TSEExX0NUWCAqY3R4KQp7Cgljb25zdCBFVlBfTUQgKnR5cGUgPSBFVlBfc2hhMSgpOwoKCWN0eC0+ZWN0eCA9IEVWUF9NRF9DVFhfbmV3KCk7CglpZiAoIWN0eC0+ZWN0eCkKCQlkaWUoIkVWUF9NRF9DVFhfbmV3OiBvdXQgb2YgbWVtb3J5Iik7CgoJRVZQX0RpZ2VzdEluaXRfZXgoY3R4LT5lY3R4LCB0eXBlLCBOVUxMKTsKfQoKc3RhdGljIGlubGluZSB2b2lkIG9wZW5zc2xfU0hBMV9VcGRhdGUoc3RydWN0IG9wZW5zc2xfU0hBMV9DVFggKmN0eCwKCQkJCQljb25zdCB2b2lkICpkYXRhLAoJCQkJCXNpemVfdCBsZW4pCnsKCUVWUF9EaWdlc3RVcGRhdGUoY3R4LT5lY3R4LCBkYXRhLCBsZW4pOwp9CgpzdGF0aWMgaW5saW5lIHZvaWQgb3BlbnNzbF9TSEExX0ZpbmFsKHVuc2lnbmVkIGNoYXIgKmRpZ2VzdCwKCQkJCSAgICAgICBzdHJ1Y3Qgb3BlbnNzbF9TSEExX0NUWCAqY3R4KQp7CglFVlBfRGlnZXN0RmluYWxfZXgoY3R4LT5lY3R4LCBkaWdlc3QsIE5VTEwpOwoJRVZQX01EX0NUWF9mcmVlKGN0eC0+ZWN0eCk7Cn0KCnN0YXRpYyBpbmxpbmUgdm9pZCBvcGVuc3NsX1NIQTFfQ2xvbmUoc3RydWN0IG9wZW5zc2xfU0hBMV9DVFggKmRzdCwKCQkJCQljb25zdCBzdHJ1Y3Qgb3BlbnNzbF9TSEExX0NUWCAqc3JjKQp7CglFVlBfTURfQ1RYX2NvcHlfZXgoZHN0LT5lY3R4LCBzcmMtPmVjdHgpOwp9CgojZGVmaW5lIHBsYXRmb3JtX1NIQV9DVFggb3BlbnNzbF9TSEExX0NUWAojZGVmaW5lIHBsYXRmb3JtX1NIQTFfSW5pdCBvcGVuc3NsX1NIQTFfSW5pdAojZGVmaW5lIHBsYXRmb3JtX1NIQTFfQ2xvbmUgb3BlbnNzbF9TSEExX0Nsb25lCiNkZWZpbmUgcGxhdGZvcm1fU0hBMV9VcGRhdGUgb3BlbnNzbF9TSEExX1VwZGF0ZQojZGVmaW5lIHBsYXRmb3JtX1NIQTFfRmluYWwgb3BlbnNzbF9TSEExX0ZpbmFsCgojZW5kaWYgLyogU0hBMV9PUEVOU1NMX0ggKi8K",
    "text": "/* wrappers for the EVP API of OpenSSL 3+ */\n#ifndef SHA1_OPENSSL_H\n#define SHA1_OPENSSL_H\n#include <openssl/evp.h>\n\nstruct openssl_SHA1_CTX {\n\tEVP_MD_CTX *ectx;\n};\n\ntypedef struct openssl_SHA1_CTX openssl_SHA1_CTX;\n\nstatic inline void openssl_SHA1_Init(struct openssl_SHA1_CTX *ctx)\n{\n\tconst EVP_MD *type = EVP_sha1();\n\n\tctx->ectx = EVP_MD_CTX_new();\n\tif (!ctx->ectx)\n\t\tdie(\"EVP_MD_CTX_new: out of memory\");\n\n\tEVP_DigestInit_ex(ctx->ectx, type, NULL);\n}\n\nstatic inline void openssl_SHA1_Update(struct openssl_SHA1_CTX *ctx,\n\t\t\t\t\tconst void *data,\n\t\t\t\t\tsize_t len)\n{\n\tEVP_DigestUpdate(ctx->ectx, data, len);\n}\n\nstatic inline void openssl_SHA1_Final(unsigned char *digest,\n\t\t\t\t       struct openssl_SHA1_CTX *ctx)\n{\n\tEVP_DigestFinal_ex(ctx->ectx, digest, NULL);\n\tEVP_MD_CTX_free(ctx->ectx);\n}\n\nstatic inline void openssl_SHA1_Clone(struct openssl_SHA1_CTX *dst,\n\t\t\t\t\tconst struct openssl_SHA1_CTX *src)\n{\n\tEVP_MD_CTX_copy_ex(dst->ectx, src->ectx);\n}\n\n#define platform_SHA_CTX openssl_SHA1_CTX\n#define platform_SHA1_Init openssl_SHA1_Init\n#define platform_SHA1_Clone openssl_SHA1_Clone\n#define platform_SHA1_Update openssl_SHA1_Update\n#define platform_SHA1_Final openssl_SHA1_Final\n\n#endif /* SHA1_OPENSSL_H */\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "006c1f4ba541cb3fa6679604326934d7e486bb9f",
  "sha1_ok": true,
  "size": 1209
}
