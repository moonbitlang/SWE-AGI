{
  "content": {
    "base64": "LyoKICBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDCgogIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGEgQlNELXN0eWxlCiAgbGljZW5zZSB0aGF0IGNhbiBiZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIG9yIGF0CiAgaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vb3Blbi1zb3VyY2UvbGljZW5zZXMvYnNkCiovCgojaWZuZGVmIFJFRlRBQkxFX1JFQURFUl9ICiNkZWZpbmUgUkVGVEFCTEVfUkVBREVSX0gKCiNpbmNsdWRlICJyZWZ0YWJsZS1pdGVyYXRvci5oIgojaW5jbHVkZSAicmVmdGFibGUtYmxvY2tzb3VyY2UuaCIKCi8qCiAqIFJlYWRpbmcgc2luZ2xlIHRhYmxlcwogKgogKiBUaGUgZm9sbG93IHJvdXRpbmVzIGFyZSBmb3IgcmVhZGluZyBzaW5nbGUgZmlsZXMuIEZvciBhbgogKiBhcHBsaWNhdGlvbi1sZXZlbCBpbnRlcmZhY2UsIHNraXAgYWhlYWQgdG8gc3RydWN0CiAqIHJlZnRhYmxlX21lcmdlZF90YWJsZSBhbmQgc3RydWN0IHJlZnRhYmxlX3N0YWNrLgogKi8KCi8qIFRoZSByZWFkZXIgc3RydWN0IGlzIGEgaGFuZGxlIHRvIGFuIG9wZW4gcmVmdGFibGUgZmlsZS4gKi8Kc3RydWN0IHJlZnRhYmxlX3JlYWRlcjsKCi8qIHJlZnRhYmxlX3JlYWRlcl9uZXcgb3BlbnMgYSByZWZ0YWJsZSBmb3IgcmVhZGluZy4gSWYgc3VjY2Vzc2Z1bCwKICogcmV0dXJucyAwIGNvZGUgYW5kIHNldHMgcHAuIFRoZSBuYW1lIGlzIHVzZWQgZm9yIGNyZWF0aW5nIGEKICogc3RhY2suIFR5cGljYWxseSwgaXQgaXMgdGhlIGJhc2VuYW1lIG9mIHRoZSBmaWxlLiBUaGUgYmxvY2sgc291cmNlCiAqIGBzcmNgIGlzIG93bmVkIGJ5IHRoZSByZWFkZXIsIGFuZCBpcyBjbG9zZWQgb24gY2FsbGluZwogKiByZWZ0YWJsZV9yZWFkZXJfZGVzdHJveSgpLiBPbiBlcnJvciwgdGhlIGJsb2NrIHNvdXJjZSBgc3JjYCBpcwogKiBjbG9zZWQgYXMgd2VsbC4KICovCmludCByZWZ0YWJsZV9yZWFkZXJfbmV3KHN0cnVjdCByZWZ0YWJsZV9yZWFkZXIgKipwcCwKCQkJc3RydWN0IHJlZnRhYmxlX2Jsb2NrX3NvdXJjZSAqc3JjLCBjb25zdCBjaGFyICpuYW1lKTsKCi8qCiAqIE1hbmFnZSB0aGUgcmVmZXJlbmNlIGNvdW50IG9mIHRoZSByZWZ0YWJsZSByZWFkZXIuIEEgbmV3bHkgaW5pdGlhbGl6ZWQKICogcmVhZGVyIHN0YXJ0cyB3aXRoIGEgcmVmY291bnQgb2YgMSBhbmQgd2lsbCBiZSBkZWxldGVkIG9uY2UgdGhlIHJlZmNvdW50IGhhcwogKiByZWFjaGVkIDAuCiAqCiAqIFRoaXMgaXMgcmVxdWlyZWQgYmVjYXVzZSByZWFkZXJzIG1heSBoYXZlIGxvbmdlciBsaWZldGltZXMgdGhhbiB0aGUgc3RhY2sKICogdGhleSBiZWxvbmcgdG8uIFRoZSBzdGFjayBtYXkgZm9yIGV4YW1wbGUgYmUgcmVsb2FkZWQgd2hpbGUgdGhlIG9sZCB0YWJsZXMKICogYXJlIHN0aWxsIGJlaW5nIGFjY2Vzc2VkIGJ5IGFuIGl0ZXJhdG9yLgogKi8Kdm9pZCByZWZ0YWJsZV9yZWFkZXJfaW5jcmVmKHN0cnVjdCByZWZ0YWJsZV9yZWFkZXIgKnJlYWRlcik7CnZvaWQgcmVmdGFibGVfcmVhZGVyX2RlY3JlZihzdHJ1Y3QgcmVmdGFibGVfcmVhZGVyICpyZWFkZXIpOwoKLyogSW5pdGlhbGl6ZSBhIHJlZnRhYmxlIGl0ZXJhdG9yIGZvciByZWFkaW5nIHJlZnMuICovCmludCByZWZ0YWJsZV9yZWFkZXJfaW5pdF9yZWZfaXRlcmF0b3Ioc3RydWN0IHJlZnRhYmxlX3JlYWRlciAqciwKCQkJCSAgICAgIHN0cnVjdCByZWZ0YWJsZV9pdGVyYXRvciAqaXQpOwoKLyogSW5pdGlhbGl6ZSBhIHJlZnRhYmxlIGl0ZXJhdG9yIGZvciByZWFkaW5nIGxvZ3MuICovCmludCByZWZ0YWJsZV9yZWFkZXJfaW5pdF9sb2dfaXRlcmF0b3Ioc3RydWN0IHJlZnRhYmxlX3JlYWRlciAqciwKCQkJCSAgICAgIHN0cnVjdCByZWZ0YWJsZV9pdGVyYXRvciAqaXQpOwoKLyogcmV0dXJucyB0aGUgaGFzaCBJRCB1c2VkIGluIHRoaXMgdGFibGUuICovCmVudW0gcmVmdGFibGVfaGFzaCByZWZ0YWJsZV9yZWFkZXJfaGFzaF9pZChzdHJ1Y3QgcmVmdGFibGVfcmVhZGVyICpyKTsKCi8qIHJldHVybiBhbiBpdGVyYXRvciBmb3IgdGhlIHJlZnMgcG9pbnRpbmcgdG8gYG9pZGAuICovCmludCByZWZ0YWJsZV9yZWFkZXJfcmVmc19mb3Ioc3RydWN0IHJlZnRhYmxlX3JlYWRlciAqciwKCQkJICAgICBzdHJ1Y3QgcmVmdGFibGVfaXRlcmF0b3IgKml0LCB1aW50OF90ICpvaWQpOwoKLyogcmV0dXJuIHRoZSBtYXhfdXBkYXRlX2luZGV4IGZvciBhIHRhYmxlICovCnVpbnQ2NF90IHJlZnRhYmxlX3JlYWRlcl9tYXhfdXBkYXRlX2luZGV4KHN0cnVjdCByZWZ0YWJsZV9yZWFkZXIgKnIpOwoKLyogcmV0dXJuIHRoZSBtaW5fdXBkYXRlX2luZGV4IGZvciBhIHRhYmxlICovCnVpbnQ2NF90IHJlZnRhYmxlX3JlYWRlcl9taW5fdXBkYXRlX2luZGV4KHN0cnVjdCByZWZ0YWJsZV9yZWFkZXIgKnIpOwoKLyogcHJpbnQgYmxvY2tzIG9udG8gc3Rkb3V0IGZvciBkZWJ1Z2dpbmcuICovCmludCByZWZ0YWJsZV9yZWFkZXJfcHJpbnRfYmxvY2tzKGNvbnN0IGNoYXIgKnRhYmxlbmFtZSk7CgojZW5kaWYK",
    "text": "/*\n  Copyright 2020 Google LLC\n\n  Use of this source code is governed by a BSD-style\n  license that can be found in the LICENSE file or at\n  https://developers.google.com/open-source/licenses/bsd\n*/\n\n#ifndef REFTABLE_READER_H\n#define REFTABLE_READER_H\n\n#include \"reftable-iterator.h\"\n#include \"reftable-blocksource.h\"\n\n/*\n * Reading single tables\n *\n * The follow routines are for reading single files. For an\n * application-level interface, skip ahead to struct\n * reftable_merged_table and struct reftable_stack.\n */\n\n/* The reader struct is a handle to an open reftable file. */\nstruct reftable_reader;\n\n/* reftable_reader_new opens a reftable for reading. If successful,\n * returns 0 code and sets pp. The name is used for creating a\n * stack. Typically, it is the basename of the file. The block source\n * `src` is owned by the reader, and is closed on calling\n * reftable_reader_destroy(). On error, the block source `src` is\n * closed as well.\n */\nint reftable_reader_new(struct reftable_reader **pp,\n\t\t\tstruct reftable_block_source *src, const char *name);\n\n/*\n * Manage the reference count of the reftable reader. A newly initialized\n * reader starts with a refcount of 1 and will be deleted once the refcount has\n * reached 0.\n *\n * This is required because readers may have longer lifetimes than the stack\n * they belong to. The stack may for example be reloaded while the old tables\n * are still being accessed by an iterator.\n */\nvoid reftable_reader_incref(struct reftable_reader *reader);\nvoid reftable_reader_decref(struct reftable_reader *reader);\n\n/* Initialize a reftable iterator for reading refs. */\nint reftable_reader_init_ref_iterator(struct reftable_reader *r,\n\t\t\t\t      struct reftable_iterator *it);\n\n/* Initialize a reftable iterator for reading logs. */\nint reftable_reader_init_log_iterator(struct reftable_reader *r,\n\t\t\t\t      struct reftable_iterator *it);\n\n/* returns the hash ID used in this table. */\nenum reftable_hash reftable_reader_hash_id(struct reftable_reader *r);\n\n/* return an iterator for the refs pointing to `oid`. */\nint reftable_reader_refs_for(struct reftable_reader *r,\n\t\t\t     struct reftable_iterator *it, uint8_t *oid);\n\n/* return the max_update_index for a table */\nuint64_t reftable_reader_max_update_index(struct reftable_reader *r);\n\n/* return the min_update_index for a table */\nuint64_t reftable_reader_min_update_index(struct reftable_reader *r);\n\n/* print blocks onto stdout for debugging. */\nint reftable_reader_print_blocks(const char *tablename);\n\n#endif\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "0085fbb903291a836c67b3d8daaa5f8b2f54fd86",
  "sha1_ok": true,
  "size": 2520
}
