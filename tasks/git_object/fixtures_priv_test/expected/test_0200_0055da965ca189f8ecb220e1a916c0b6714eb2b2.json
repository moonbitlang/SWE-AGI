{
  "content": {
    "base64": "IyEvYmluL3NoCiMKIyBDb3B5cmlnaHQgKGMpIDIwMDcgTGFycyBIamVtbGkKIwoKdGVzdF9kZXNjcmlwdGlvbj0nQmFzaWMgcG9yY2VsYWluIHN1cHBvcnQgZm9yIHN1Ym1vZHVsZXMKClRoaXMgdGVzdCB0cmllcyB0byB2ZXJpZnkgYmFzaWMgc2FuaXR5IG9mIHRoZSBpbml0LCB1cGRhdGUgYW5kIHN0YXR1cwpzdWJjb21tYW5kcyBvZiBnaXQgc3VibW9kdWxlLgonCgouIC4vdGVzdC1saWIuc2gKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NldHVwIC0gaW5pdGlhbCBjb21taXQnICcKCT50ICYmCglnaXQgYWRkIHQgJiYKCWdpdCBjb21taXQgLW0gImluaXRpYWwgY29tbWl0IiAmJgoJZ2l0IGJyYW5jaCBpbml0aWFsCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NldHVwIC0gcmVwb3NpdG9yeSBpbiBpbml0IHN1YmRpcmVjdG9yeScgJwoJbWtkaXIgaW5pdCAmJgoJKAoJCWNkIGluaXQgJiYKCQlnaXQgaW5pdCAmJgoJCWVjaG8gYSA+YSAmJgoJCWdpdCBhZGQgYSAmJgoJCWdpdCBjb21taXQgLW0gInN1Ym1vZHVsZSBjb21taXQgMSIgJiYKCQlnaXQgdGFnIC1hIC1tICJyZXYtMSIgcmV2LTEKCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2V0dXAgLSBjb21taXQgd2l0aCBnaXRsaW5rJyAnCgllY2hvIGEgPmEgJiYKCWVjaG8geiA+eiAmJgoJZ2l0IGFkZCBhIGluaXQgeiAmJgoJZ2l0IGNvbW1pdCAtbSAic3VwZXIgY29tbWl0IDEiCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NldHVwIC0gaGlkZSBpbml0IHN1YmRpcmVjdG9yeScgJwoJbXYgaW5pdCAuc3VicmVwbwonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzZXR1cCAtIHJlcG9zaXRvcnkgdG8gYWRkIHN1Ym1vZHVsZXMgdG8nICcKCWdpdCBpbml0IGFkZHRlc3QgJiYKCWdpdCBpbml0IGFkZHRlc3QtaWdub3JlCicKCiMgVGhlICdzdWJtb2R1bGUgYWRkJyB0ZXN0cyBuZWVkIHNvbWUgcmVwb3NpdG9yeSB0byBhZGQgYXMgYSBzdWJtb2R1bGUuCiMgVGhlIHRyYXNoIGRpcmVjdG9yeSBpcyBhIGdvb2Qgb25lIGFzIGFueS4gV2UgbmVlZCB0byBjYW5vbmljYWxpemUKIyB0aGUgbmFtZSwgdGhvdWdoLCBhcyBzb21lIHRlc3RzIGNvbXBhcmUgaXQgdG8gdGhlIGFic29sdXRlIHBhdGggZ2l0CiMgZ2VuZXJhdGVzLCB3aGljaCB3aWxsIGV4cGFuZCBzeW1ib2xpYyBsaW5rcy4Kc3VibW9kdXJsPSQocHdkIC1QKQoKbGlzdGJyYW5jaGVzKCkgewoJZ2l0IGZvci1lYWNoLXJlZiAtLWZvcm1hdD0nJShyZWZuYW1lKScgJ3JlZnMvaGVhZHMvKicKfQoKaW5zcGVjdCgpIHsKCWRpcj0kMSAmJgoJZG90ZG90PSIkezI6LS4ufSIgJiYKCgkoCgkJY2QgIiRkaXIiICYmCgkJbGlzdGJyYW5jaGVzID4iJGRvdGRvdC9oZWFkcyIgJiYKCQl7IGdpdCBzeW1ib2xpYy1yZWYgSEVBRCB8fCA6OyB9ID4iJGRvdGRvdC9oZWFkIiAmJgoJCWdpdCByZXYtcGFyc2UgSEVBRCA+IiRkb3Rkb3QvaGVhZC1zaGExIiAmJgoJCWdpdCB1cGRhdGUtaW5kZXggLS1yZWZyZXNoICYmCgkJZ2l0IGRpZmYtZmlsZXMgLS1leGl0LWNvZGUgJiYKCQlnaXQgY2xlYW4gLW4gLWQgLXggPiIkZG90ZG90L3VudHJhY2tlZCIKCSkKfQoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3VibW9kdWxlIGFkZCcgJwoJZWNobyAicmVmcy9oZWFkcy9tYXN0ZXIiID5leHBlY3QgJiYKCT5lbXB0eSAmJgoKCSgKCQljZCBhZGR0ZXN0ICYmCgkJZ2l0IHN1Ym1vZHVsZSBhZGQgLXEgIiRzdWJtb2R1cmwiIHN1Ym1vZCA+YWN0dWFsICYmCgkJdGVzdF9tdXN0X2JlX2VtcHR5IGFjdHVhbCAmJgoJCWVjaG8gImdpdGRpcjogLi4vLmdpdC9tb2R1bGVzL3N1Ym1vZCIgPmV4cGVjdCAmJgoJCXRlc3RfY21wIGV4cGVjdCBzdWJtb2QvLmdpdCAmJgoJCSgKCQkJY2Qgc3VibW9kICYmCgkJCWdpdCBjb25maWcgY29yZS53b3JrdHJlZSA+YWN0dWFsICYmCgkJCWVjaG8gIi4uLy4uLy4uL3N1Ym1vZCIgPmV4cGVjdCAmJgoJCQl0ZXN0X2NtcCBleHBlY3QgYWN0dWFsICYmCgkJCXJtIC1mIGFjdHVhbCBleHBlY3QKCQkpICYmCgkJZ2l0IHN1Ym1vZHVsZSBpbml0CgkpICYmCgoJcm0gLWYgaGVhZHMgaGVhZCB1bnRyYWNrZWQgJiYKCWluc3BlY3QgYWRkdGVzdC9zdWJtb2QgLi4vLi4gJiYKCXRlc3RfY21wIGV4cGVjdCBoZWFkcyAmJgoJdGVzdF9jbXAgZXhwZWN0IGhlYWQgJiYKCXRlc3RfY21wIGVtcHR5IHVudHJhY2tlZAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzdWJtb2R1bGUgYWRkIHRvIC5naXRpZ25vcmVkIHBhdGggZmFpbHMnICcKCSgKCQljZCBhZGR0ZXN0LWlnbm9yZSAmJgoJCWNhdCA8PC1cRU9GID5leHBlY3QgJiYKCQlUaGUgZm9sbG93aW5nIHBhdGggaXMgaWdub3JlZCBieSBvbmUgb2YgeW91ciAuZ2l0aWdub3JlIGZpbGVzOgoJCXN1Ym1vZAoJCVVzZSAtZiBpZiB5b3UgcmVhbGx5IHdhbnQgdG8gYWRkIGl0LgoJCUVPRgoJCSMgRG9lcyBub3QgdXNlIHRlc3RfY29tbWl0IGR1ZSB0byB0aGUgaWdub3JlCgkJZWNobyAiKiIgPiAuZ2l0aWdub3JlICYmCgkJZ2l0IGFkZCAtLWZvcmNlIC5naXRpZ25vcmUgJiYKCQlnaXQgY29tbWl0IC1tIklnbm9yZSBldmVyeXRoaW5nIiAmJgoJCSEgZ2l0IHN1Ym1vZHVsZSBhZGQgIiRzdWJtb2R1cmwiIHN1Ym1vZCA+YWN0dWFsIDI+JjEgJiYKCQl0ZXN0X2kxOG5jbXAgZXhwZWN0IGFjdHVhbAoJKQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzdWJtb2R1bGUgYWRkIHRvIC5naXRpZ25vcmVkIHBhdGggd2l0aCAtLWZvcmNlJyAnCgkoCgkJY2QgYWRkdGVzdC1pZ25vcmUgJiYKCQlnaXQgc3VibW9kdWxlIGFkZCAtLWZvcmNlICIkc3VibW9kdXJsIiBzdWJtb2QKCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3VibW9kdWxlIGFkZCAtLWJyYW5jaCcgJwoJZWNobyAicmVmcy9oZWFkcy9pbml0aWFsIiA+ZXhwZWN0LWhlYWQgJiYKCWNhdCA8PC1cRU9GID5leHBlY3QtaGVhZHMgJiYKCXJlZnMvaGVhZHMvaW5pdGlhbAoJcmVmcy9oZWFkcy9tYXN0ZXIKCUVPRgoJPmVtcHR5ICYmCgoJKAoJCWNkIGFkZHRlc3QgJiYKCQlnaXQgc3VibW9kdWxlIGFkZCAtYiBpbml0aWFsICIkc3VibW9kdXJsIiBzdWJtb2QtYnJhbmNoICYmCgkJdGVzdCAiaW5pdGlhbCIgPSAiJChnaXQgY29uZmlnIC1mIC5naXRtb2R1bGVzIHN1Ym1vZHVsZS5zdWJtb2QtYnJhbmNoLmJyYW5jaCkiICYmCgkJZ2l0IHN1Ym1vZHVsZSBpbml0CgkpICYmCgoJcm0gLWYgaGVhZHMgaGVhZCB1bnRyYWNrZWQgJiYKCWluc3BlY3QgYWRkdGVzdC9zdWJtb2QtYnJhbmNoIC4uLy4uICYmCgl0ZXN0X2NtcCBleHBlY3QtaGVhZHMgaGVhZHMgJiYKCXRlc3RfY21wIGV4cGVjdC1oZWFkIGhlYWQgJiYKCXRlc3RfY21wIGVtcHR5IHVudHJhY2tlZAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzdWJtb2R1bGUgYWRkIHdpdGggLi8gaW4gcGF0aCcgJwoJZWNobyAicmVmcy9oZWFkcy9tYXN0ZXIiID5leHBlY3QgJiYKCT5lbXB0eSAmJgoKCSgKCQljZCBhZGR0ZXN0ICYmCgkJZ2l0IHN1Ym1vZHVsZSBhZGQgIiRzdWJtb2R1cmwiIC4vLi9kb3RzdWJtb2QvLi9mcm90ei8uLyAmJgoJCWdpdCBzdWJtb2R1bGUgaW5pdAoJKSAmJgoKCXJtIC1mIGhlYWRzIGhlYWQgdW50cmFja2VkICYmCglpbnNwZWN0IGFkZHRlc3QvZG90c3VibW9kL2Zyb3R6IC4uLy4uLy4uICYmCgl0ZXN0X2NtcCBleHBlY3QgaGVhZHMgJiYKCXRlc3RfY21wIGV4cGVjdCBoZWFkICYmCgl0ZXN0X2NtcCBlbXB0eSB1bnRyYWNrZWQKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3VibW9kdWxlIGFkZCB3aXRoIC8vIGluIHBhdGgnICcKCWVjaG8gInJlZnMvaGVhZHMvbWFzdGVyIiA+ZXhwZWN0ICYmCgk+ZW1wdHkgJiYKCgkoCgkJY2QgYWRkdGVzdCAmJgoJCWdpdCBzdWJtb2R1bGUgYWRkICIkc3VibW9kdXJsIiBzbGFzaHNsYXNoc3VibW9kLy8vZnJvdHovLyAmJgoJCWdpdCBzdWJtb2R1bGUgaW5pdAoJKSAmJgoKCXJtIC1mIGhlYWRzIGhlYWQgdW50cmFja2VkICYmCglpbnNwZWN0IGFkZHRlc3Qvc2xhc2hzbGFzaHN1Ym1vZC9mcm90eiAuLi8uLi8uLiAmJgoJdGVzdF9jbXAgZXhwZWN0IGhlYWRzICYmCgl0ZXN0X2NtcCBleHBlY3QgaGVhZCAmJgoJdGVzdF9jbXAgZW1wdHkgdW50cmFja2VkCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3N1Ym1vZHVsZSBhZGQgd2l0aCAvLi4gaW4gcGF0aCcgJwoJZWNobyAicmVmcy9oZWFkcy9tYXN0ZXIiID5leHBlY3QgJiYKCT5lbXB0eSAmJgoKCSgKCQljZCBhZGR0ZXN0ICYmCgkJZ2l0IHN1Ym1vZHVsZSBhZGQgIiRzdWJtb2R1cmwiIGRvdGRvdHN1Ym1vZC8uLi9yZWFsc3VibW9kL2Zyb3R6Ly4uICYmCgkJZ2l0IHN1Ym1vZHVsZSBpbml0CgkpICYmCgoJcm0gLWYgaGVhZHMgaGVhZCB1bnRyYWNrZWQgJiYKCWluc3BlY3QgYWRkdGVzdC9yZWFsc3VibW9kIC4uLy4uICYmCgl0ZXN0X2NtcCBleHBlY3QgaGVhZHMgJiYKCXRlc3RfY21wIGV4cGVjdCBoZWFkICYmCgl0ZXN0X2NtcCBlbXB0eSB1bnRyYWNrZWQKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3VibW9kdWxlIGFkZCB3aXRoIC4vLCAvLi4gYW5kIC8vIGluIHBhdGgnICcKCWVjaG8gInJlZnMvaGVhZHMvbWFzdGVyIiA+ZXhwZWN0ICYmCgk+ZW1wdHkgJiYKCgkoCgkJY2QgYWRkdGVzdCAmJgoJCWdpdCBzdWJtb2R1bGUgYWRkICIkc3VibW9kdXJsIiBkb3QvZG90c2xhc2hzdWJtb2QvLi8uLi8uLi8vLy9yZWFsc3VibW9kMi9hL2IvYy9kLy4uLy4uLy4uLy4uL2Zyb3R6Ly8uLiAmJgoJCWdpdCBzdWJtb2R1bGUgaW5pdAoJKSAmJgoKCXJtIC1mIGhlYWRzIGhlYWQgdW50cmFja2VkICYmCglpbnNwZWN0IGFkZHRlc3QvcmVhbHN1Ym1vZDIgLi4vLi4gJiYKCXRlc3RfY21wIGV4cGVjdCBoZWFkcyAmJgoJdGVzdF9jbXAgZXhwZWN0IGhlYWQgJiYKCXRlc3RfY21wIGVtcHR5IHVudHJhY2tlZAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzZXR1cCAtIGFkZCBhbiBleGFtcGxlIGVudHJ5IHRvIC5naXRtb2R1bGVzJyAnCglHSVRfQ09ORklHPS5naXRtb2R1bGVzIFwKCWdpdCBjb25maWcgc3VibW9kdWxlLmV4YW1wbGUudXJsIGdpdDovL2V4YW1wbGUuY29tL2luaXQuZ2l0CicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3N0YXR1cyBzaG91bGQgZmFpbCBmb3IgdW5tYXBwZWQgcGF0aHMnICcKCXRlc3RfbXVzdF9mYWlsIGdpdCBzdWJtb2R1bGUgc3RhdHVzCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NldHVwIC0gbWFwIHBhdGggaW4gLmdpdG1vZHVsZXMnICcKCWNhdCA8PFxFT0YgPmV4cGVjdCAmJgpbc3VibW9kdWxlICJleGFtcGxlIl0KCXVybCA9IGdpdDovL2V4YW1wbGUuY29tL2luaXQuZ2l0CglwYXRoID0gaW5pdApFT0YKCglHSVRfQ09ORklHPS5naXRtb2R1bGVzIGdpdCBjb25maWcgc3VibW9kdWxlLmV4YW1wbGUucGF0aCBpbml0ICYmCgoJdGVzdF9jbXAgZXhwZWN0IC5naXRtb2R1bGVzCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3N0YXR1cyBzaG91bGQgb25seSBwcmludCBvbmUgbGluZScgJwoJZ2l0IHN1Ym1vZHVsZSBzdGF0dXMgPmxpbmVzICYmCgl0ZXN0X2xpbmVfY291bnQgPSAxIGxpbmVzCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NldHVwIC0gZmV0Y2ggY29tbWl0IG5hbWUgZnJvbSBzdWJtb2R1bGUnICcKCXJldjE9JChjZCAuc3VicmVwbyAmJiBnaXQgcmV2LXBhcnNlIEhFQUQpICYmCglwcmludGYgInJldjE6ICVzXG4iICIkcmV2MSIgJiYKCXRlc3QgLW4gIiRyZXYxIgonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzdGF0dXMgc2hvdWxkIGluaXRpYWxseSBiZSAibWlzc2luZyInICcKCWdpdCBzdWJtb2R1bGUgc3RhdHVzID5saW5lcyAmJgoJZ3JlcCAiXi0kcmV2MSIgbGluZXMKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnaW5pdCBzaG91bGQgcmVnaXN0ZXIgc3VibW9kdWxlIHVybCBpbiAuZ2l0L2NvbmZpZycgJwoJZWNobyBnaXQ6Ly9leGFtcGxlLmNvbS9pbml0LmdpdCA+ZXhwZWN0ICYmCgoJZ2l0IHN1Ym1vZHVsZSBpbml0ICYmCglnaXQgY29uZmlnIHN1Ym1vZHVsZS5leGFtcGxlLnVybCA+dXJsICYmCglnaXQgY29uZmlnIHN1Ym1vZHVsZS5leGFtcGxlLnVybCAuLy5zdWJyZXBvICYmCgoJdGVzdF9jbXAgZXhwZWN0IHVybAonCgp0ZXN0X2ZhaWx1cmVfd2l0aF91bmtub3duX3N1Ym1vZHVsZSAoKSB7Cgl0ZXN0X211c3RfZmFpbCBnaXQgc3VibW9kdWxlICQxIG5vLXN1Y2gtc3VibW9kdWxlIDI+b3V0cHV0LmVyciAmJgoJZ3JlcCAiXmVycm9yOiAuKm5vLXN1Y2gtc3VibW9kdWxlIiBvdXRwdXQuZXJyCn0KCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2luaXQgc2hvdWxkIGZhaWwgd2l0aCB1bmtub3duIHN1Ym1vZHVsZScgJwoJdGVzdF9mYWlsdXJlX3dpdGhfdW5rbm93bl9zdWJtb2R1bGUgaW5pdAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICd1cGRhdGUgc2hvdWxkIGZhaWwgd2l0aCB1bmtub3duIHN1Ym1vZHVsZScgJwoJdGVzdF9mYWlsdXJlX3dpdGhfdW5rbm93bl9zdWJtb2R1bGUgdXBkYXRlCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3N0YXR1cyBzaG91bGQgZmFpbCB3aXRoIHVua25vd24gc3VibW9kdWxlJyAnCgl0ZXN0X2ZhaWx1cmVfd2l0aF91bmtub3duX3N1Ym1vZHVsZSBzdGF0dXMKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3luYyBzaG91bGQgZmFpbCB3aXRoIHVua25vd24gc3VibW9kdWxlJyAnCgl0ZXN0X2ZhaWx1cmVfd2l0aF91bmtub3duX3N1Ym1vZHVsZSBzeW5jCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3VwZGF0ZSBzaG91bGQgZmFpbCB3aGVuIHBhdGggaXMgdXNlZCBieSBhIGZpbGUnICcKCWVjaG8gaGVsbG8gPmV4cGVjdCAmJgoKCWVjaG8gImhlbGxvIiA+aW5pdCAmJgoJdGVzdF9tdXN0X2ZhaWwgZ2l0IHN1Ym1vZHVsZSB1cGRhdGUgJiYKCgl0ZXN0X2NtcCBleHBlY3QgaW5pdAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICd1cGRhdGUgc2hvdWxkIGZhaWwgd2hlbiBwYXRoIGlzIHVzZWQgYnkgYSBub25lbXB0eSBkaXJlY3RvcnknICcKCWVjaG8gaGVsbG8gPmV4cGVjdCAmJgoKCXJtIC1mciBpbml0ICYmCglta2RpciBpbml0ICYmCgllY2hvICJoZWxsbyIgPmluaXQvYSAmJgoKCXRlc3RfbXVzdF9mYWlsIGdpdCBzdWJtb2R1bGUgdXBkYXRlICYmCgoJdGVzdF9jbXAgZXhwZWN0IGluaXQvYQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICd1cGRhdGUgc2hvdWxkIHdvcmsgd2hlbiBwYXRoIGlzIGFuIGVtcHR5IGRpcicgJwoJcm0gLWZyIGluaXQgJiYKCXJtIC1mIGhlYWQtc2hhMSAmJgoJZWNobyAiJHJldjEiID5leHBlY3QgJiYKCglta2RpciBpbml0ICYmCglnaXQgc3VibW9kdWxlIHVwZGF0ZSAtcSA+dXBkYXRlLm91dCAmJgoJdGVzdF9tdXN0X2JlX2VtcHR5IHVwZGF0ZS5vdXQgJiYKCglpbnNwZWN0IGluaXQgJiYKCXRlc3RfY21wIGV4cGVjdCBoZWFkLXNoYTEKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3RhdHVzIHNob3VsZCBiZSAidXAtdG8tZGF0ZSIgYWZ0ZXIgdXBkYXRlJyAnCglnaXQgc3VibW9kdWxlIHN0YXR1cyA+bGlzdCAmJgoJZ3JlcCAiXiAkcmV2MSIgbGlzdAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzdGF0dXMgc2hvdWxkIGJlICJtb2RpZmllZCIgYWZ0ZXIgc3VibW9kdWxlIGNvbW1pdCcgJwoJKAoJCWNkIGluaXQgJiYKCQllY2hvIGIgPmIgJiYKCQlnaXQgYWRkIGIgJiYKCQlnaXQgY29tbWl0IC1tICJzdWJtb2R1bGUgY29tbWl0IDIiCgkpICYmCgoJcmV2Mj0kKGNkIGluaXQgJiYgZ2l0IHJldi1wYXJzZSBIRUFEKSAmJgoJdGVzdCAtbiAiJHJldjIiICYmCglnaXQgc3VibW9kdWxlIHN0YXR1cyA+bGlzdCAmJgoKCWdyZXAgIl4rJHJldjIiIGxpc3QKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAndGhlIC0tY2FjaGVkIHNoYTEgc2hvdWxkIGJlIHJldjEnICcKCWdpdCBzdWJtb2R1bGUgLS1jYWNoZWQgc3RhdHVzID5saXN0ICYmCglncmVwICJeKyRyZXYxIiBsaXN0CicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBkaWZmIHNob3VsZCByZXBvcnQgdGhlIFNIQTEgb2YgdGhlIG5ldyBzdWJtb2R1bGUgY29tbWl0JyAnCglnaXQgZGlmZiA+ZGlmZiAmJgoJZ3JlcCAiXitTdWJwcm9qZWN0IGNvbW1pdCAkcmV2MiIgZGlmZgonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICd1cGRhdGUgc2hvdWxkIGNoZWNrb3V0IHJldjEnICcKCXJtIC1mIGhlYWQtc2hhMSAmJgoJZWNobyAiJHJldjEiID5leHBlY3QgJiYKCglnaXQgc3VibW9kdWxlIHVwZGF0ZSBpbml0ICYmCglpbnNwZWN0IGluaXQgJiYKCgl0ZXN0X2NtcCBleHBlY3QgaGVhZC1zaGExCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3N0YXR1cyBzaG91bGQgYmUgInVwLXRvLWRhdGUiIGFmdGVyIHVwZGF0ZScgJwoJZ2l0IHN1Ym1vZHVsZSBzdGF0dXMgPmxpc3QgJiYKCWdyZXAgIl4gJHJldjEiIGxpc3QKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2hlY2tvdXQgc3VwZXJwcm9qZWN0IHdpdGggc3VicHJvamVjdCBhbHJlYWR5IHByZXNlbnQnICcKCWdpdCBjaGVja291dCBpbml0aWFsICYmCglnaXQgY2hlY2tvdXQgbWFzdGVyCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2FwcGx5IHN1Ym1vZHVsZSBkaWZmJyAnCgk+ZW1wdHkgJiYKCglnaXQgYnJhbmNoIHNlY29uZCAmJgoJKAoJCWNkIGluaXQgJiYKCQllY2hvIHMgPnMgJiYKCQlnaXQgYWRkIHMgJiYKCQlnaXQgY29tbWl0IC1tICJjaGFuZ2Ugc3VicHJvamVjdCIKCSkgJiYKCWdpdCB1cGRhdGUtaW5kZXggLS1hZGQgaW5pdCAmJgoJZ2l0IGNvbW1pdCAtbSAiY2hhbmdlIGluaXQiICYmCglnaXQgZm9ybWF0LXBhdGNoIC0xIC0tc3Rkb3V0ID5QLmRpZmYgJiYKCWdpdCBjaGVja291dCBzZWNvbmQgJiYKCWdpdCBhcHBseSAtLWluZGV4IFAuZGlmZiAmJgoKCWdpdCBkaWZmIC0tY2FjaGVkIG1hc3RlciA+c3RhZ2VkICYmCgl0ZXN0X2NtcCBlbXB0eSBzdGFnZWQKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAndXBkYXRlIC0taW5pdCcgJwoJbXYgaW5pdCBpbml0MiAmJgoJZ2l0IGNvbmZpZyAtZiAuZ2l0bW9kdWxlcyBzdWJtb2R1bGUuZXhhbXBsZS51cmwgIiQocHdkKS9pbml0MiIgJiYKCWdpdCBjb25maWcgLS1yZW1vdmUtc2VjdGlvbiBzdWJtb2R1bGUuZXhhbXBsZSAmJgoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNvbmZpZyBzdWJtb2R1bGUuZXhhbXBsZS51cmwgJiYKCglnaXQgc3VibW9kdWxlIHVwZGF0ZSBpbml0ID4gdXBkYXRlLm91dCAmJgoJY2F0IHVwZGF0ZS5vdXQgJiYKCXRlc3RfaTE4bmdyZXAgIm5vdCBpbml0aWFsaXplZCIgdXBkYXRlLm91dCAmJgoJdGVzdF9tdXN0X2ZhaWwgZ2l0IHJldi1wYXJzZSAtLXJlc29sdmUtZ2l0LWRpciBpbml0Ly5naXQgJiYKCglnaXQgc3VibW9kdWxlIHVwZGF0ZSAtLWluaXQgaW5pdCAmJgoJZ2l0IHJldi1wYXJzZSAtLXJlc29sdmUtZ2l0LWRpciBpbml0Ly5naXQKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnZG8gbm90IGFkZCBmaWxlcyBmcm9tIGEgc3VibW9kdWxlJyAnCgoJZ2l0IHJlc2V0IC0taGFyZCAmJgoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGFkZCBpbml0L2EKCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dyYWNlZnVsbHkgYWRkIHN1Ym1vZHVsZSB3aXRoIGEgdHJhaWxpbmcgc2xhc2gnICcKCglnaXQgcmVzZXQgLS1oYXJkICYmCglnaXQgY29tbWl0IC1tICJjb21taXQgc3VicHJvamVjdCIgaW5pdCAmJgoJKGNkIGluaXQgJiYKCSBlY2hvIGIgPiBhKSAmJgoJZ2l0IGFkZCBpbml0LyAmJgoJZ2l0IGRpZmYgLS1leGl0LWNvZGUgLS1jYWNoZWQgaW5pdCAmJgoJY29tbWl0PSQoY2QgaW5pdCAmJgoJIGdpdCBjb21taXQgLW0gdXBkYXRlIGEgPi9kZXYvbnVsbCAmJgoJIGdpdCByZXYtcGFyc2UgSEVBRCkgJiYKCWdpdCBhZGQgaW5pdC8gJiYKCXRlc3RfbXVzdF9mYWlsIGdpdCBkaWZmIC0tZXhpdC1jb2RlIC0tY2FjaGVkIGluaXQgJiYKCXRlc3QgJGNvbW1pdCA9ICQoZ2l0IGxzLWZpbGVzIC0tc3RhZ2UgfAoJCXNlZCAtbiAicy9eMTYwMDAwIFwoW14gXSpcKS4qL1wxL3AiKQoKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnbHMtZmlsZXMgZ3JhY2VmdWxseSBoYW5kbGVzIHRyYWlsaW5nIHNsYXNoJyAnCgoJdGVzdCAiaW5pdCIgPSAiJChnaXQgbHMtZmlsZXMgaW5pdC8pIgoKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnbW92aW5nIHRvIGEgY29tbWl0IHdpdGhvdXQgc3VibW9kdWxlIGRvZXMgbm90IGxlYXZlIGVtcHR5IGRpcicgJwoJcm0gLXJmIGluaXQgJiYKCW1rZGlyIGluaXQgJiYKCWdpdCByZXNldCAtLWhhcmQgJiYKCWdpdCBjaGVja291dCBpbml0aWFsICYmCgl0ZXN0ICEgLWQgaW5pdCAmJgoJZ2l0IGNoZWNrb3V0IHNlY29uZAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzdWJtb2R1bGUgPGludmFsaWQtc3ViY29tbWFuZD4gZmFpbHMnICcKCXRlc3RfbXVzdF9mYWlsIGdpdCBzdWJtb2R1bGUgbm8tc3VjaC1zdWJjb21tYW5kCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2FkZCBzdWJtb2R1bGVzIHdpdGhvdXQgc3BlY2lmeWluZyBhbiBleHBsaWNpdCBwYXRoJyAnCglta2RpciByZXBvICYmCgkoCgkJY2QgcmVwbyAmJgoJCWdpdCBpbml0ICYmCgkJZWNobyByID5yICYmCgkJZ2l0IGFkZCByICYmCgkJZ2l0IGNvbW1pdCAtbSAicmVwbyBjb21taXQgMSIKCSkgJiYKCWdpdCBjbG9uZSAtLWJhcmUgcmVwby8gYmFyZS5naXQgJiYKCSgKCQljZCBhZGR0ZXN0ICYmCgkJZ2l0IHN1Ym1vZHVsZSBhZGQgIiRzdWJtb2R1cmwvcmVwbyIgJiYKCQlnaXQgY29uZmlnIC1mIC5naXRtb2R1bGVzIHN1Ym1vZHVsZS5yZXBvLnBhdGggcmVwbyAmJgoJCWdpdCBzdWJtb2R1bGUgYWRkICIkc3VibW9kdXJsL2JhcmUuZ2l0IiAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLmJhcmUucGF0aCBiYXJlCgkpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2FkZCBzaG91bGQgZmFpbCB3aGVuIHBhdGggaXMgdXNlZCBieSBhIGZpbGUnICcKCSgKCQljZCBhZGR0ZXN0ICYmCgkJdG91Y2ggZmlsZSAmJgoJCXRlc3RfbXVzdF9mYWlsCWdpdCBzdWJtb2R1bGUgYWRkICIkc3VibW9kdXJsL3JlcG8iIGZpbGUKCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnYWRkIHNob3VsZCBmYWlsIHdoZW4gcGF0aCBpcyB1c2VkIGJ5IGFuIGV4aXN0aW5nIGRpcmVjdG9yeScgJwoJKAoJCWNkIGFkZHRlc3QgJiYKCQlta2RpciBlbXB0eS1kaXIgJiYKCQl0ZXN0X211c3RfZmFpbCBnaXQgc3VibW9kdWxlIGFkZCAiJHN1Ym1vZHVybC9yZXBvIiBlbXB0eS1kaXIKCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAndXNlIHN1cGVycHJvamVjdCBhcyB1cHN0cmVhbSB3aGVuIHBhdGggaXMgcmVsYXRpdmUgYW5kIG5vIHVybCBpcyBzZXQgdGhlcmUnICcKCSgKCQljZCBhZGR0ZXN0ICYmCgkJZ2l0IHN1Ym1vZHVsZSBhZGQgLi4vcmVwbyByZWxhdGl2ZSAmJgoJCXRlc3QgIiQoZ2l0IGNvbmZpZyAtZiAuZ2l0bW9kdWxlcyBzdWJtb2R1bGUucmVsYXRpdmUudXJsKSIgPSAuLi9yZXBvICYmCgkJZ2l0IHN1Ym1vZHVsZSBzeW5jIHJlbGF0aXZlICYmCgkJdGVzdCAiJChnaXQgY29uZmlnIHN1Ym1vZHVsZS5yZWxhdGl2ZS51cmwpIiA9ICIkc3VibW9kdXJsL3JlcG8iCgkpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NldCB1cCBmb3IgcmVsYXRpdmUgcGF0aCB0ZXN0cycgJwoJbWtkaXIgcmVsdGVzdCAmJgoJKAoJCWNkIHJlbHRlc3QgJiYKCQlnaXQgaW5pdCAmJgoJCW1rZGlyIHN1YiAmJgoJCSgKCQkJY2Qgc3ViICYmCgkJCWdpdCBpbml0ICYmCgkJCXRlc3RfY29tbWl0IGZvbwoJCSkgJiYKCQlnaXQgYWRkIHN1YiAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLnN1Yi5wYXRoIHN1YiAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLnN1Yi51cmwgLi4vc3VicmVwbyAmJgoJCWNwIC5naXQvY29uZmlnIHByaXN0aW5lLS5naXQtY29uZmlnICYmCgkJY3AgLmdpdG1vZHVsZXMgcHJpc3RpbmUtLmdpdG1vZHVsZXMKCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnLi4vc3VicmVwbyB3b3JrcyB3aXRoIFVSTCAtIHNzaDovL2hvc3RuYW1lL3JlcG8nICcKCSgKCQljZCByZWx0ZXN0ICYmCgkJY3AgcHJpc3RpbmUtLmdpdC1jb25maWcgLmdpdC9jb25maWcgJiYKCQljcCBwcmlzdGluZS0uZ2l0bW9kdWxlcyAuZ2l0bW9kdWxlcyAmJgoJCWdpdCBjb25maWcgcmVtb3RlLm9yaWdpbi51cmwgc3NoOi8vaG9zdG5hbWUvcmVwbyAmJgoJCWdpdCBzdWJtb2R1bGUgaW5pdCAmJgoJCXRlc3QgIiQoZ2l0IGNvbmZpZyBzdWJtb2R1bGUuc3ViLnVybCkiID0gc3NoOi8vaG9zdG5hbWUvc3VicmVwbwoJKQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICcuLi9zdWJyZXBvIHdvcmtzIHdpdGggcG9ydC1xdWFsaWZpZWQgVVJMIC0gc3NoOi8vaG9zdG5hbWU6MjIvcmVwbycgJwoJKAoJCWNkIHJlbHRlc3QgJiYKCQljcCBwcmlzdGluZS0uZ2l0LWNvbmZpZyAuZ2l0L2NvbmZpZyAmJgoJCWNwIHByaXN0aW5lLS5naXRtb2R1bGVzIC5naXRtb2R1bGVzICYmCgkJZ2l0IGNvbmZpZyByZW1vdGUub3JpZ2luLnVybCBzc2g6Ly9ob3N0bmFtZToyMi9yZXBvICYmCgkJZ2l0IHN1Ym1vZHVsZSBpbml0ICYmCgkJdGVzdCAiJChnaXQgY29uZmlnIHN1Ym1vZHVsZS5zdWIudXJsKSIgPSBzc2g6Ly9ob3N0bmFtZToyMi9zdWJyZXBvCgkpCicKCiMgQWJvdXQgdGhlIGNob2ljZSBvZiB0aGUgcGF0aCBpbiB0aGUgbmV4dCB0ZXN0OgojIC0gZG91YmxlLXNsYXNoIHNpZGUtc3RlcHMgcGF0aCBtYW5nbGluZyBpc3N1ZXMgb24gV2luZG93cwojIC0gaXQgaXMgc3RpbGwgYW4gYWJzb2x1dGUgbG9jYWwgcGF0aAojIC0gdGhlcmUgY2Fubm90IGJlIGEgc2VydmVyIHdpdGggYSBibGFuayBpbiBpdHMgbmFtZSBqdXN0IGluIGNhc2UgdGhlCiMgICBwYXRoIGlzIHVzZWQgZXJyb25lb3VzbHkgdG8gYWNjZXNzIGEgLy9zZXJ2ZXIvc2hhcmUgc3R5bGUgcGF0aAp0ZXN0X2V4cGVjdF9zdWNjZXNzICcuLi9zdWJyZXBvIHBhdGggd29ya3Mgd2l0aCBsb2NhbCBwYXRoIC0gLy9zb21ld2hlcmUgZWxzZS9yZXBvJyAnCgkoCgkJY2QgcmVsdGVzdCAmJgoJCWNwIHByaXN0aW5lLS5naXQtY29uZmlnIC5naXQvY29uZmlnICYmCgkJY3AgcHJpc3RpbmUtLmdpdG1vZHVsZXMgLmdpdG1vZHVsZXMgJiYKCQlnaXQgY29uZmlnIHJlbW90ZS5vcmlnaW4udXJsICIvL3NvbWV3aGVyZSBlbHNlL3JlcG8iICYmCgkJZ2l0IHN1Ym1vZHVsZSBpbml0ICYmCgkJdGVzdCAiJChnaXQgY29uZmlnIHN1Ym1vZHVsZS5zdWIudXJsKSIgPSAiLy9zb21ld2hlcmUgZWxzZS9zdWJyZXBvIgoJKQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICcuLi9zdWJyZXBvIHdvcmtzIHdpdGggZmlsZSBVUkwgLSBmaWxlOi8vL3RtcC9yZXBvJyAnCgkoCgkJY2QgcmVsdGVzdCAmJgoJCWNwIHByaXN0aW5lLS5naXQtY29uZmlnIC5naXQvY29uZmlnICYmCgkJY3AgcHJpc3RpbmUtLmdpdG1vZHVsZXMgLmdpdG1vZHVsZXMgJiYKCQlnaXQgY29uZmlnIHJlbW90ZS5vcmlnaW4udXJsIGZpbGU6Ly8vdG1wL3JlcG8gJiYKCQlnaXQgc3VibW9kdWxlIGluaXQgJiYKCQl0ZXN0ICIkKGdpdCBjb25maWcgc3VibW9kdWxlLnN1Yi51cmwpIiA9IGZpbGU6Ly8vdG1wL3N1YnJlcG8KCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnLi4vc3VicmVwbyB3b3JrcyB3aXRoIGhlbHBlciBVUkwtIGhlbHBlcjo6Ly9ob3N0bmFtZS9yZXBvJyAnCgkoCgkJY2QgcmVsdGVzdCAmJgoJCWNwIHByaXN0aW5lLS5naXQtY29uZmlnIC5naXQvY29uZmlnICYmCgkJY3AgcHJpc3RpbmUtLmdpdG1vZHVsZXMgLmdpdG1vZHVsZXMgJiYKCQlnaXQgY29uZmlnIHJlbW90ZS5vcmlnaW4udXJsIGhlbHBlcjo6Ly9ob3N0bmFtZS9yZXBvICYmCgkJZ2l0IHN1Ym1vZHVsZSBpbml0ICYmCgkJdGVzdCAiJChnaXQgY29uZmlnIHN1Ym1vZHVsZS5zdWIudXJsKSIgPSBoZWxwZXI6Oi8vaG9zdG5hbWUvc3VicmVwbwoJKQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICcuLi9zdWJyZXBvIHdvcmtzIHdpdGggc2NwLXN0eWxlIFVSTCAtIHVzZXJAaG9zdDpyZXBvJyAnCgkoCgkJY2QgcmVsdGVzdCAmJgoJCWNwIHByaXN0aW5lLS5naXQtY29uZmlnIC5naXQvY29uZmlnICYmCgkJZ2l0IGNvbmZpZyByZW1vdGUub3JpZ2luLnVybCB1c2VyQGhvc3Q6cmVwbyAmJgoJCWdpdCBzdWJtb2R1bGUgaW5pdCAmJgoJCXRlc3QgIiQoZ2l0IGNvbmZpZyBzdWJtb2R1bGUuc3ViLnVybCkiID0gdXNlckBob3N0OnN1YnJlcG8KCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnLi4vc3VicmVwbyB3b3JrcyB3aXRoIHNjcC1zdHlsZSBVUkwgLSB1c2VyQGhvc3Q6cGF0aC90by9yZXBvJyAnCgkoCgkJY2QgcmVsdGVzdCAmJgoJCWNwIHByaXN0aW5lLS5naXQtY29uZmlnIC5naXQvY29uZmlnICYmCgkJY3AgcHJpc3RpbmUtLmdpdG1vZHVsZXMgLmdpdG1vZHVsZXMgJiYKCQlnaXQgY29uZmlnIHJlbW90ZS5vcmlnaW4udXJsIHVzZXJAaG9zdDpwYXRoL3RvL3JlcG8gJiYKCQlnaXQgc3VibW9kdWxlIGluaXQgJiYKCQl0ZXN0ICIkKGdpdCBjb25maWcgc3VibW9kdWxlLnN1Yi51cmwpIiA9IHVzZXJAaG9zdDpwYXRoL3RvL3N1YnJlcG8KCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnLi4vc3VicmVwbyB3b3JrcyB3aXRoIHJlbGF0aXZlIGxvY2FsIHBhdGggLSBmb28nICcKCSgKCQljZCByZWx0ZXN0ICYmCgkJY3AgcHJpc3RpbmUtLmdpdC1jb25maWcgLmdpdC9jb25maWcgJiYKCQljcCBwcmlzdGluZS0uZ2l0bW9kdWxlcyAuZ2l0bW9kdWxlcyAmJgoJCWdpdCBjb25maWcgcmVtb3RlLm9yaWdpbi51cmwgZm9vICYmCgkJIyBhY3R1YWw6IGZhaWxzIHdpdGggYW4gZXJyb3IKCQlnaXQgc3VibW9kdWxlIGluaXQgJiYKCQl0ZXN0ICIkKGdpdCBjb25maWcgc3VibW9kdWxlLnN1Yi51cmwpIiA9IHN1YnJlcG8KCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnLi4vc3VicmVwbyB3b3JrcyB3aXRoIHJlbGF0aXZlIGxvY2FsIHBhdGggLSBmb28vYmFyJyAnCgkoCgkJY2QgcmVsdGVzdCAmJgoJCWNwIHByaXN0aW5lLS5naXQtY29uZmlnIC5naXQvY29uZmlnICYmCgkJY3AgcHJpc3RpbmUtLmdpdG1vZHVsZXMgLmdpdG1vZHVsZXMgJiYKCQlnaXQgY29uZmlnIHJlbW90ZS5vcmlnaW4udXJsIGZvby9iYXIgJiYKCQlnaXQgc3VibW9kdWxlIGluaXQgJiYKCQl0ZXN0ICIkKGdpdCBjb25maWcgc3VibW9kdWxlLnN1Yi51cmwpIiA9IGZvby9zdWJyZXBvCgkpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJy4uL3N1YnJlcG8gd29ya3Mgd2l0aCByZWxhdGl2ZSBsb2NhbCBwYXRoIC0gLi9mb28nICcKCSgKCQljZCByZWx0ZXN0ICYmCgkJY3AgcHJpc3RpbmUtLmdpdC1jb25maWcgLmdpdC9jb25maWcgJiYKCQljcCBwcmlzdGluZS0uZ2l0bW9kdWxlcyAuZ2l0bW9kdWxlcyAmJgoJCWdpdCBjb25maWcgcmVtb3RlLm9yaWdpbi51cmwgLi9mb28gJiYKCQlnaXQgc3VibW9kdWxlIGluaXQgJiYKCQl0ZXN0ICIkKGdpdCBjb25maWcgc3VibW9kdWxlLnN1Yi51cmwpIiA9IHN1YnJlcG8KCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnLi4vc3VicmVwbyB3b3JrcyB3aXRoIHJlbGF0aXZlIGxvY2FsIHBhdGggLSAuL2Zvby9iYXInICcKCSgKCQljZCByZWx0ZXN0ICYmCgkJY3AgcHJpc3RpbmUtLmdpdC1jb25maWcgLmdpdC9jb25maWcgJiYKCQljcCBwcmlzdGluZS0uZ2l0bW9kdWxlcyAuZ2l0bW9kdWxlcyAmJgoJCWdpdCBjb25maWcgcmVtb3RlLm9yaWdpbi51cmwgLi9mb28vYmFyICYmCgkJZ2l0IHN1Ym1vZHVsZSBpbml0ICYmCgkJdGVzdCAiJChnaXQgY29uZmlnIHN1Ym1vZHVsZS5zdWIudXJsKSIgPSBmb28vc3VicmVwbwoJKQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICcuLi9zdWJyZXBvIHdvcmtzIHdpdGggcmVsYXRpdmUgbG9jYWwgcGF0aCAtIC4uL2ZvbycgJwoJKAoJCWNkIHJlbHRlc3QgJiYKCQljcCBwcmlzdGluZS0uZ2l0LWNvbmZpZyAuZ2l0L2NvbmZpZyAmJgoJCWNwIHByaXN0aW5lLS5naXRtb2R1bGVzIC5naXRtb2R1bGVzICYmCgkJZ2l0IGNvbmZpZyByZW1vdGUub3JpZ2luLnVybCAuLi9mb28gJiYKCQlnaXQgc3VibW9kdWxlIGluaXQgJiYKCQl0ZXN0ICIkKGdpdCBjb25maWcgc3VibW9kdWxlLnN1Yi51cmwpIiA9IC4uL3N1YnJlcG8KCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnLi4vc3VicmVwbyB3b3JrcyB3aXRoIHJlbGF0aXZlIGxvY2FsIHBhdGggLSAuLi9mb28vYmFyJyAnCgkoCgkJY2QgcmVsdGVzdCAmJgoJCWNwIHByaXN0aW5lLS5naXQtY29uZmlnIC5naXQvY29uZmlnICYmCgkJY3AgcHJpc3RpbmUtLmdpdG1vZHVsZXMgLmdpdG1vZHVsZXMgJiYKCQlnaXQgY29uZmlnIHJlbW90ZS5vcmlnaW4udXJsIC4uL2Zvby9iYXIgJiYKCQlnaXQgc3VibW9kdWxlIGluaXQgJiYKCQl0ZXN0ICIkKGdpdCBjb25maWcgc3VibW9kdWxlLnN1Yi51cmwpIiA9IC4uL2Zvby9zdWJyZXBvCgkpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJy4uL2Jhci9hL2IvYyB3b3JrcyB3aXRoIHJlbGF0aXZlIGxvY2FsIHBhdGggLSAuLi9mb28vYmFyLmdpdCcgJwoJKAoJCWNkIHJlbHRlc3QgJiYKCQljcCBwcmlzdGluZS0uZ2l0LWNvbmZpZyAuZ2l0L2NvbmZpZyAmJgoJCWNwIHByaXN0aW5lLS5naXRtb2R1bGVzIC5naXRtb2R1bGVzICYmCgkJbWtkaXIgLXAgYS9iL2MgJiYKCQkoY2QgYS9iL2M7IGdpdCBpbml0KSAmJgoJCWdpdCBjb25maWcgcmVtb3RlLm9yaWdpbi51cmwgLi4vZm9vL2Jhci5naXQgJiYKCQlnaXQgc3VibW9kdWxlIGFkZCAuLi9iYXIvYS9iL2MgLi9hL2IvYyAmJgoJCWdpdCBzdWJtb2R1bGUgaW5pdCAmJgoJCXRlc3QgIiQoZ2l0IGNvbmZpZyBzdWJtb2R1bGUuYS9iL2MudXJsKSIgPSAuLi9mb28vYmFyL2EvYi9jCgkpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ21vdmluZyB0aGUgc3VwZXJwcm9qZWN0IGRvZXMgbm90IGJyZWFrIHN1Ym1vZHVsZXMnICcKCSgKCQljZCBhZGR0ZXN0ICYmCgkJZ2l0IHN1Ym1vZHVsZSBzdGF0dXMgPmV4cGVjdAoJKQoJbXYgYWRkdGVzdCBhZGR0ZXN0MiAmJgoJKAoJCWNkIGFkZHRlc3QyICYmCgkJZ2l0IHN1Ym1vZHVsZSBzdGF0dXMgPmFjdHVhbCAmJgoJCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwKCSkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3VibW9kdWxlIGFkZCAtLW5hbWUgYWxsb3dzIHRvIHJlcGxhY2UgYSBzdWJtb2R1bGUgd2l0aCBhbm90aGVyIGF0IHRoZSBzYW1lIHBhdGgnICcKCSgKCQljZCBhZGR0ZXN0MiAmJgoJCSgKCQkJY2QgcmVwbyAmJgoJCQllY2hvICIkc3VibW9kdXJsL3JlcG8iID5leHBlY3QgJiYKCQkJZ2l0IGNvbmZpZyByZW1vdGUub3JpZ2luLnVybCA+YWN0dWFsICYmCgkJCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwgJiYKCQkJZWNobyAiZ2l0ZGlyOiAuLi8uZ2l0L21vZHVsZXMvcmVwbyIgPmV4cGVjdCAmJgoJCQl0ZXN0X2NtcCBleHBlY3QgLmdpdAoJCSkgJiYKCQlybSAtcmYgcmVwbyAmJgoJCWdpdCBybSByZXBvICYmCgkJZ2l0IHN1Ym1vZHVsZSBhZGQgLXEgLS1uYW1lIHJlcG9fbmV3ICIkc3VibW9kdXJsL2JhcmUuZ2l0IiByZXBvID5hY3R1YWwgJiYKCQl0ZXN0X211c3RfYmVfZW1wdHkgYWN0dWFsICYmCgkJZWNobyAiZ2l0ZGlyOiAuLi8uZ2l0L21vZHVsZXMvc3VibW9kIiA+ZXhwZWN0ICYmCgkJdGVzdF9jbXAgZXhwZWN0IHN1Ym1vZC8uZ2l0ICYmCgkJKAoJCQljZCByZXBvICYmCgkJCWVjaG8gIiRzdWJtb2R1cmwvYmFyZS5naXQiID5leHBlY3QgJiYKCQkJZ2l0IGNvbmZpZyByZW1vdGUub3JpZ2luLnVybCA+YWN0dWFsICYmCgkJCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwgJiYKCQkJZWNobyAiZ2l0ZGlyOiAuLi8uZ2l0L21vZHVsZXMvcmVwb19uZXciID5leHBlY3QgJiYKCQkJdGVzdF9jbXAgZXhwZWN0IC5naXQKCQkpICYmCgkJZWNobyAicmVwbyIgPmV4cGVjdCAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLnJlcG8ucGF0aCA+YWN0dWFsICYmCgkJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbCAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLnJlcG9fbmV3LnBhdGggPmFjdHVhbCAmJgoJCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwmJgoJCWVjaG8gIiRzdWJtb2R1cmwvcmVwbyIgPmV4cGVjdCAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLnJlcG8udXJsID5hY3R1YWwgJiYKCQl0ZXN0X2NtcCBleHBlY3QgYWN0dWFsICYmCgkJZWNobyAiJHN1Ym1vZHVybC9iYXJlLmdpdCIgPmV4cGVjdCAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLnJlcG9fbmV3LnVybCA+YWN0dWFsICYmCgkJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbCAmJgoJCWVjaG8gIiRzdWJtb2R1cmwvcmVwbyIgPmV4cGVjdCAmJgoJCWdpdCBjb25maWcgc3VibW9kdWxlLnJlcG8udXJsID5hY3R1YWwgJiYKCQl0ZXN0X2NtcCBleHBlY3QgYWN0dWFsICYmCgkJZWNobyAiJHN1Ym1vZHVybC9iYXJlLmdpdCIgPmV4cGVjdCAmJgoJCWdpdCBjb25maWcgc3VibW9kdWxlLnJlcG9fbmV3LnVybCA+YWN0dWFsICYmCgkJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbAoJKQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzdWJtb2R1bGUgYWRkIHdpdGggYW4gZXhpc3RpbmcgbmFtZSBmYWlscyB1bmxlc3MgZm9yY2VkJyAnCgkoCgkJY2QgYWRkdGVzdDIgJiYKCQlybSAtcmYgcmVwbyAmJgoJCWdpdCBybSByZXBvICYmCgkJdGVzdF9tdXN0X2ZhaWwgZ2l0IHN1Ym1vZHVsZSBhZGQgLXEgLS1uYW1lIHJlcG9fbmV3ICIkc3VibW9kdXJsL3JlcG8uZ2l0IiByZXBvICYmCgkJdGVzdCAhIC1kIHJlcG8gJiYKCQllY2hvICJyZXBvIiA+ZXhwZWN0ICYmCgkJZ2l0IGNvbmZpZyAtZiAuZ2l0bW9kdWxlcyBzdWJtb2R1bGUucmVwb19uZXcucGF0aCA+YWN0dWFsICYmCgkJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbCYmCgkJZWNobyAiJHN1Ym1vZHVybC9iYXJlLmdpdCIgPmV4cGVjdCAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLnJlcG9fbmV3LnVybCA+YWN0dWFsICYmCgkJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbCAmJgoJCWVjaG8gIiRzdWJtb2R1cmwvYmFyZS5naXQiID5leHBlY3QgJiYKCQlnaXQgY29uZmlnIHN1Ym1vZHVsZS5yZXBvX25ldy51cmwgPmFjdHVhbCAmJgoJCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwgJiYKCQlnaXQgc3VibW9kdWxlIGFkZCAtZiAtcSAtLW5hbWUgcmVwb19uZXcgIiRzdWJtb2R1cmwvcmVwby5naXQiIHJlcG8gJiYKCQl0ZXN0IC1kIHJlcG8gJiYKCQllY2hvICJyZXBvIiA+ZXhwZWN0ICYmCgkJZ2l0IGNvbmZpZyAtZiAuZ2l0bW9kdWxlcyBzdWJtb2R1bGUucmVwb19uZXcucGF0aCA+YWN0dWFsICYmCgkJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbCYmCgkJZWNobyAiJHN1Ym1vZHVybC9yZXBvLmdpdCIgPmV4cGVjdCAmJgoJCWdpdCBjb25maWcgLWYgLmdpdG1vZHVsZXMgc3VibW9kdWxlLnJlcG9fbmV3LnVybCA+YWN0dWFsICYmCgkJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbCAmJgoJCWVjaG8gIiRzdWJtb2R1cmwvcmVwby5naXQiID5leHBlY3QgJiYKCQlnaXQgY29uZmlnIHN1Ym1vZHVsZS5yZXBvX25ldy51cmwgPmFjdHVhbCAmJgoJCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwKCSkKJwoKdGVzdF9kb25lCg==",
    "text": "#!/bin/sh\n#\n# Copyright (c) 2007 Lars Hjemli\n#\n\ntest_description='Basic porcelain support for submodules\n\nThis test tries to verify basic sanity of the init, update and status\nsubcommands of git submodule.\n'\n\n. ./test-lib.sh\n\ntest_expect_success 'setup - initial commit' '\n\t>t &&\n\tgit add t &&\n\tgit commit -m \"initial commit\" &&\n\tgit branch initial\n'\n\ntest_expect_success 'setup - repository in init subdirectory' '\n\tmkdir init &&\n\t(\n\t\tcd init &&\n\t\tgit init &&\n\t\techo a >a &&\n\t\tgit add a &&\n\t\tgit commit -m \"submodule commit 1\" &&\n\t\tgit tag -a -m \"rev-1\" rev-1\n\t)\n'\n\ntest_expect_success 'setup - commit with gitlink' '\n\techo a >a &&\n\techo z >z &&\n\tgit add a init z &&\n\tgit commit -m \"super commit 1\"\n'\n\ntest_expect_success 'setup - hide init subdirectory' '\n\tmv init .subrepo\n'\n\ntest_expect_success 'setup - repository to add submodules to' '\n\tgit init addtest &&\n\tgit init addtest-ignore\n'\n\n# The 'submodule add' tests need some repository to add as a submodule.\n# The trash directory is a good one as any. We need to canonicalize\n# the name, though, as some tests compare it to the absolute path git\n# generates, which will expand symbolic links.\nsubmodurl=$(pwd -P)\n\nlistbranches() {\n\tgit for-each-ref --format='%(refname)' 'refs/heads/*'\n}\n\ninspect() {\n\tdir=$1 &&\n\tdotdot=\"${2:-..}\" &&\n\n\t(\n\t\tcd \"$dir\" &&\n\t\tlistbranches >\"$dotdot/heads\" &&\n\t\t{ git symbolic-ref HEAD || :; } >\"$dotdot/head\" &&\n\t\tgit rev-parse HEAD >\"$dotdot/head-sha1\" &&\n\t\tgit update-index --refresh &&\n\t\tgit diff-files --exit-code &&\n\t\tgit clean -n -d -x >\"$dotdot/untracked\"\n\t)\n}\n\ntest_expect_success 'submodule add' '\n\techo \"refs/heads/master\" >expect &&\n\t>empty &&\n\n\t(\n\t\tcd addtest &&\n\t\tgit submodule add -q \"$submodurl\" submod >actual &&\n\t\ttest_must_be_empty actual &&\n\t\techo \"gitdir: ../.git/modules/submod\" >expect &&\n\t\ttest_cmp expect submod/.git &&\n\t\t(\n\t\t\tcd submod &&\n\t\t\tgit config core.worktree >actual &&\n\t\t\techo \"../../../submod\" >expect &&\n\t\t\ttest_cmp expect actual &&\n\t\t\trm -f actual expect\n\t\t) &&\n\t\tgit submodule init\n\t) &&\n\n\trm -f heads head untracked &&\n\tinspect addtest/submod ../.. &&\n\ttest_cmp expect heads &&\n\ttest_cmp expect head &&\n\ttest_cmp empty untracked\n'\n\ntest_expect_success 'submodule add to .gitignored path fails' '\n\t(\n\t\tcd addtest-ignore &&\n\t\tcat <<-\\EOF >expect &&\n\t\tThe following path is ignored by one of your .gitignore files:\n\t\tsubmod\n\t\tUse -f if you really want to add it.\n\t\tEOF\n\t\t# Does not use test_commit due to the ignore\n\t\techo \"*\" > .gitignore &&\n\t\tgit add --force .gitignore &&\n\t\tgit commit -m\"Ignore everything\" &&\n\t\t! git submodule add \"$submodurl\" submod >actual 2>&1 &&\n\t\ttest_i18ncmp expect actual\n\t)\n'\n\ntest_expect_success 'submodule add to .gitignored path with --force' '\n\t(\n\t\tcd addtest-ignore &&\n\t\tgit submodule add --force \"$submodurl\" submod\n\t)\n'\n\ntest_expect_success 'submodule add --branch' '\n\techo \"refs/heads/initial\" >expect-head &&\n\tcat <<-\\EOF >expect-heads &&\n\trefs/heads/initial\n\trefs/heads/master\n\tEOF\n\t>empty &&\n\n\t(\n\t\tcd addtest &&\n\t\tgit submodule add -b initial \"$submodurl\" submod-branch &&\n\t\ttest \"initial\" = \"$(git config -f .gitmodules submodule.submod-branch.branch)\" &&\n\t\tgit submodule init\n\t) &&\n\n\trm -f heads head untracked &&\n\tinspect addtest/submod-branch ../.. &&\n\ttest_cmp expect-heads heads &&\n\ttest_cmp expect-head head &&\n\ttest_cmp empty untracked\n'\n\ntest_expect_success 'submodule add with ./ in path' '\n\techo \"refs/heads/master\" >expect &&\n\t>empty &&\n\n\t(\n\t\tcd addtest &&\n\t\tgit submodule add \"$submodurl\" ././dotsubmod/./frotz/./ &&\n\t\tgit submodule init\n\t) &&\n\n\trm -f heads head untracked &&\n\tinspect addtest/dotsubmod/frotz ../../.. &&\n\ttest_cmp expect heads &&\n\ttest_cmp expect head &&\n\ttest_cmp empty untracked\n'\n\ntest_expect_success 'submodule add with // in path' '\n\techo \"refs/heads/master\" >expect &&\n\t>empty &&\n\n\t(\n\t\tcd addtest &&\n\t\tgit submodule add \"$submodurl\" slashslashsubmod///frotz// &&\n\t\tgit submodule init\n\t) &&\n\n\trm -f heads head untracked &&\n\tinspect addtest/slashslashsubmod/frotz ../../.. &&\n\ttest_cmp expect heads &&\n\ttest_cmp expect head &&\n\ttest_cmp empty untracked\n'\n\ntest_expect_success 'submodule add with /.. in path' '\n\techo \"refs/heads/master\" >expect &&\n\t>empty &&\n\n\t(\n\t\tcd addtest &&\n\t\tgit submodule add \"$submodurl\" dotdotsubmod/../realsubmod/frotz/.. &&\n\t\tgit submodule init\n\t) &&\n\n\trm -f heads head untracked &&\n\tinspect addtest/realsubmod ../.. &&\n\ttest_cmp expect heads &&\n\ttest_cmp expect head &&\n\ttest_cmp empty untracked\n'\n\ntest_expect_success 'submodule add with ./, /.. and // in path' '\n\techo \"refs/heads/master\" >expect &&\n\t>empty &&\n\n\t(\n\t\tcd addtest &&\n\t\tgit submodule add \"$submodurl\" dot/dotslashsubmod/./../..////realsubmod2/a/b/c/d/../../../../frotz//.. &&\n\t\tgit submodule init\n\t) &&\n\n\trm -f heads head untracked &&\n\tinspect addtest/realsubmod2 ../.. &&\n\ttest_cmp expect heads &&\n\ttest_cmp expect head &&\n\ttest_cmp empty untracked\n'\n\ntest_expect_success 'setup - add an example entry to .gitmodules' '\n\tGIT_CONFIG=.gitmodules \\\n\tgit config submodule.example.url git://example.com/init.git\n'\n\ntest_expect_success 'status should fail for unmapped paths' '\n\ttest_must_fail git submodule status\n'\n\ntest_expect_success 'setup - map path in .gitmodules' '\n\tcat <<\\EOF >expect &&\n[submodule \"example\"]\n\turl = git://example.com/init.git\n\tpath = init\nEOF\n\n\tGIT_CONFIG=.gitmodules git config submodule.example.path init &&\n\n\ttest_cmp expect .gitmodules\n'\n\ntest_expect_success 'status should only print one line' '\n\tgit submodule status >lines &&\n\ttest_line_count = 1 lines\n'\n\ntest_expect_success 'setup - fetch commit name from submodule' '\n\trev1=$(cd .subrepo && git rev-parse HEAD) &&\n\tprintf \"rev1: %s\\n\" \"$rev1\" &&\n\ttest -n \"$rev1\"\n'\n\ntest_expect_success 'status should initially be \"missing\"' '\n\tgit submodule status >lines &&\n\tgrep \"^-$rev1\" lines\n'\n\ntest_expect_success 'init should register submodule url in .git/config' '\n\techo git://example.com/init.git >expect &&\n\n\tgit submodule init &&\n\tgit config submodule.example.url >url &&\n\tgit config submodule.example.url ./.subrepo &&\n\n\ttest_cmp expect url\n'\n\ntest_failure_with_unknown_submodule () {\n\ttest_must_fail git submodule $1 no-such-submodule 2>output.err &&\n\tgrep \"^error: .*no-such-submodule\" output.err\n}\n\ntest_expect_success 'init should fail with unknown submodule' '\n\ttest_failure_with_unknown_submodule init\n'\n\ntest_expect_success 'update should fail with unknown submodule' '\n\ttest_failure_with_unknown_submodule update\n'\n\ntest_expect_success 'status should fail with unknown submodule' '\n\ttest_failure_with_unknown_submodule status\n'\n\ntest_expect_success 'sync should fail with unknown submodule' '\n\ttest_failure_with_unknown_submodule sync\n'\n\ntest_expect_success 'update should fail when path is used by a file' '\n\techo hello >expect &&\n\n\techo \"hello\" >init &&\n\ttest_must_fail git submodule update &&\n\n\ttest_cmp expect init\n'\n\ntest_expect_success 'update should fail when path is used by a nonempty directory' '\n\techo hello >expect &&\n\n\trm -fr init &&\n\tmkdir init &&\n\techo \"hello\" >init/a &&\n\n\ttest_must_fail git submodule update &&\n\n\ttest_cmp expect init/a\n'\n\ntest_expect_success 'update should work when path is an empty dir' '\n\trm -fr init &&\n\trm -f head-sha1 &&\n\techo \"$rev1\" >expect &&\n\n\tmkdir init &&\n\tgit submodule update -q >update.out &&\n\ttest_must_be_empty update.out &&\n\n\tinspect init &&\n\ttest_cmp expect head-sha1\n'\n\ntest_expect_success 'status should be \"up-to-date\" after update' '\n\tgit submodule status >list &&\n\tgrep \"^ $rev1\" list\n'\n\ntest_expect_success 'status should be \"modified\" after submodule commit' '\n\t(\n\t\tcd init &&\n\t\techo b >b &&\n\t\tgit add b &&\n\t\tgit commit -m \"submodule commit 2\"\n\t) &&\n\n\trev2=$(cd init && git rev-parse HEAD) &&\n\ttest -n \"$rev2\" &&\n\tgit submodule status >list &&\n\n\tgrep \"^+$rev2\" list\n'\n\ntest_expect_success 'the --cached sha1 should be rev1' '\n\tgit submodule --cached status >list &&\n\tgrep \"^+$rev1\" list\n'\n\ntest_expect_success 'git diff should report the SHA1 of the new submodule commit' '\n\tgit diff >diff &&\n\tgrep \"^+Subproject commit $rev2\" diff\n'\n\ntest_expect_success 'update should checkout rev1' '\n\trm -f head-sha1 &&\n\techo \"$rev1\" >expect &&\n\n\tgit submodule update init &&\n\tinspect init &&\n\n\ttest_cmp expect head-sha1\n'\n\ntest_expect_success 'status should be \"up-to-date\" after update' '\n\tgit submodule status >list &&\n\tgrep \"^ $rev1\" list\n'\n\ntest_expect_success 'checkout superproject with subproject already present' '\n\tgit checkout initial &&\n\tgit checkout master\n'\n\ntest_expect_success 'apply submodule diff' '\n\t>empty &&\n\n\tgit branch second &&\n\t(\n\t\tcd init &&\n\t\techo s >s &&\n\t\tgit add s &&\n\t\tgit commit -m \"change subproject\"\n\t) &&\n\tgit update-index --add init &&\n\tgit commit -m \"change init\" &&\n\tgit format-patch -1 --stdout >P.diff &&\n\tgit checkout second &&\n\tgit apply --index P.diff &&\n\n\tgit diff --cached master >staged &&\n\ttest_cmp empty staged\n'\n\ntest_expect_success 'update --init' '\n\tmv init init2 &&\n\tgit config -f .gitmodules submodule.example.url \"$(pwd)/init2\" &&\n\tgit config --remove-section submodule.example &&\n\ttest_must_fail git config submodule.example.url &&\n\n\tgit submodule update init > update.out &&\n\tcat update.out &&\n\ttest_i18ngrep \"not initialized\" update.out &&\n\ttest_must_fail git rev-parse --resolve-git-dir init/.git &&\n\n\tgit submodule update --init init &&\n\tgit rev-parse --resolve-git-dir init/.git\n'\n\ntest_expect_success 'do not add files from a submodule' '\n\n\tgit reset --hard &&\n\ttest_must_fail git add init/a\n\n'\n\ntest_expect_success 'gracefully add submodule with a trailing slash' '\n\n\tgit reset --hard &&\n\tgit commit -m \"commit subproject\" init &&\n\t(cd init &&\n\t echo b > a) &&\n\tgit add init/ &&\n\tgit diff --exit-code --cached init &&\n\tcommit=$(cd init &&\n\t git commit -m update a >/dev/null &&\n\t git rev-parse HEAD) &&\n\tgit add init/ &&\n\ttest_must_fail git diff --exit-code --cached init &&\n\ttest $commit = $(git ls-files --stage |\n\t\tsed -n \"s/^160000 \\([^ ]*\\).*/\\1/p\")\n\n'\n\ntest_expect_success 'ls-files gracefully handles trailing slash' '\n\n\ttest \"init\" = \"$(git ls-files init/)\"\n\n'\n\ntest_expect_success 'moving to a commit without submodule does not leave empty dir' '\n\trm -rf init &&\n\tmkdir init &&\n\tgit reset --hard &&\n\tgit checkout initial &&\n\ttest ! -d init &&\n\tgit checkout second\n'\n\ntest_expect_success 'submodule <invalid-subcommand> fails' '\n\ttest_must_fail git submodule no-such-subcommand\n'\n\ntest_expect_success 'add submodules without specifying an explicit path' '\n\tmkdir repo &&\n\t(\n\t\tcd repo &&\n\t\tgit init &&\n\t\techo r >r &&\n\t\tgit add r &&\n\t\tgit commit -m \"repo commit 1\"\n\t) &&\n\tgit clone --bare repo/ bare.git &&\n\t(\n\t\tcd addtest &&\n\t\tgit submodule add \"$submodurl/repo\" &&\n\t\tgit config -f .gitmodules submodule.repo.path repo &&\n\t\tgit submodule add \"$submodurl/bare.git\" &&\n\t\tgit config -f .gitmodules submodule.bare.path bare\n\t)\n'\n\ntest_expect_success 'add should fail when path is used by a file' '\n\t(\n\t\tcd addtest &&\n\t\ttouch file &&\n\t\ttest_must_fail\tgit submodule add \"$submodurl/repo\" file\n\t)\n'\n\ntest_expect_success 'add should fail when path is used by an existing directory' '\n\t(\n\t\tcd addtest &&\n\t\tmkdir empty-dir &&\n\t\ttest_must_fail git submodule add \"$submodurl/repo\" empty-dir\n\t)\n'\n\ntest_expect_success 'use superproject as upstream when path is relative and no url is set there' '\n\t(\n\t\tcd addtest &&\n\t\tgit submodule add ../repo relative &&\n\t\ttest \"$(git config -f .gitmodules submodule.relative.url)\" = ../repo &&\n\t\tgit submodule sync relative &&\n\t\ttest \"$(git config submodule.relative.url)\" = \"$submodurl/repo\"\n\t)\n'\n\ntest_expect_success 'set up for relative path tests' '\n\tmkdir reltest &&\n\t(\n\t\tcd reltest &&\n\t\tgit init &&\n\t\tmkdir sub &&\n\t\t(\n\t\t\tcd sub &&\n\t\t\tgit init &&\n\t\t\ttest_commit foo\n\t\t) &&\n\t\tgit add sub &&\n\t\tgit config -f .gitmodules submodule.sub.path sub &&\n\t\tgit config -f .gitmodules submodule.sub.url ../subrepo &&\n\t\tcp .git/config pristine-.git-config &&\n\t\tcp .gitmodules pristine-.gitmodules\n\t)\n'\n\ntest_expect_success '../subrepo works with URL - ssh://hostname/repo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url ssh://hostname/repo &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = ssh://hostname/subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with port-qualified URL - ssh://hostname:22/repo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url ssh://hostname:22/repo &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = ssh://hostname:22/subrepo\n\t)\n'\n\n# About the choice of the path in the next test:\n# - double-slash side-steps path mangling issues on Windows\n# - it is still an absolute local path\n# - there cannot be a server with a blank in its name just in case the\n#   path is used erroneously to access a //server/share style path\ntest_expect_success '../subrepo path works with local path - //somewhere else/repo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url \"//somewhere else/repo\" &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = \"//somewhere else/subrepo\"\n\t)\n'\n\ntest_expect_success '../subrepo works with file URL - file:///tmp/repo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url file:///tmp/repo &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = file:///tmp/subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with helper URL- helper:://hostname/repo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url helper:://hostname/repo &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = helper:://hostname/subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with scp-style URL - user@host:repo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tgit config remote.origin.url user@host:repo &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = user@host:subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with scp-style URL - user@host:path/to/repo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url user@host:path/to/repo &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = user@host:path/to/subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with relative local path - foo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url foo &&\n\t\t# actual: fails with an error\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with relative local path - foo/bar' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url foo/bar &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = foo/subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with relative local path - ./foo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url ./foo &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with relative local path - ./foo/bar' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url ./foo/bar &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = foo/subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with relative local path - ../foo' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url ../foo &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = ../subrepo\n\t)\n'\n\ntest_expect_success '../subrepo works with relative local path - ../foo/bar' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tgit config remote.origin.url ../foo/bar &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.sub.url)\" = ../foo/subrepo\n\t)\n'\n\ntest_expect_success '../bar/a/b/c works with relative local path - ../foo/bar.git' '\n\t(\n\t\tcd reltest &&\n\t\tcp pristine-.git-config .git/config &&\n\t\tcp pristine-.gitmodules .gitmodules &&\n\t\tmkdir -p a/b/c &&\n\t\t(cd a/b/c; git init) &&\n\t\tgit config remote.origin.url ../foo/bar.git &&\n\t\tgit submodule add ../bar/a/b/c ./a/b/c &&\n\t\tgit submodule init &&\n\t\ttest \"$(git config submodule.a/b/c.url)\" = ../foo/bar/a/b/c\n\t)\n'\n\ntest_expect_success 'moving the superproject does not break submodules' '\n\t(\n\t\tcd addtest &&\n\t\tgit submodule status >expect\n\t)\n\tmv addtest addtest2 &&\n\t(\n\t\tcd addtest2 &&\n\t\tgit submodule status >actual &&\n\t\ttest_cmp expect actual\n\t)\n'\n\ntest_expect_success 'submodule add --name allows to replace a submodule with another at the same path' '\n\t(\n\t\tcd addtest2 &&\n\t\t(\n\t\t\tcd repo &&\n\t\t\techo \"$submodurl/repo\" >expect &&\n\t\t\tgit config remote.origin.url >actual &&\n\t\t\ttest_cmp expect actual &&\n\t\t\techo \"gitdir: ../.git/modules/repo\" >expect &&\n\t\t\ttest_cmp expect .git\n\t\t) &&\n\t\trm -rf repo &&\n\t\tgit rm repo &&\n\t\tgit submodule add -q --name repo_new \"$submodurl/bare.git\" repo >actual &&\n\t\ttest_must_be_empty actual &&\n\t\techo \"gitdir: ../.git/modules/submod\" >expect &&\n\t\ttest_cmp expect submod/.git &&\n\t\t(\n\t\t\tcd repo &&\n\t\t\techo \"$submodurl/bare.git\" >expect &&\n\t\t\tgit config remote.origin.url >actual &&\n\t\t\ttest_cmp expect actual &&\n\t\t\techo \"gitdir: ../.git/modules/repo_new\" >expect &&\n\t\t\ttest_cmp expect .git\n\t\t) &&\n\t\techo \"repo\" >expect &&\n\t\tgit config -f .gitmodules submodule.repo.path >actual &&\n\t\ttest_cmp expect actual &&\n\t\tgit config -f .gitmodules submodule.repo_new.path >actual &&\n\t\ttest_cmp expect actual&&\n\t\techo \"$submodurl/repo\" >expect &&\n\t\tgit config -f .gitmodules submodule.repo.url >actual &&\n\t\ttest_cmp expect actual &&\n\t\techo \"$submodurl/bare.git\" >expect &&\n\t\tgit config -f .gitmodules submodule.repo_new.url >actual &&\n\t\ttest_cmp expect actual &&\n\t\techo \"$submodurl/repo\" >expect &&\n\t\tgit config submodule.repo.url >actual &&\n\t\ttest_cmp expect actual &&\n\t\techo \"$submodurl/bare.git\" >expect &&\n\t\tgit config submodule.repo_new.url >actual &&\n\t\ttest_cmp expect actual\n\t)\n'\n\ntest_expect_success 'submodule add with an existing name fails unless forced' '\n\t(\n\t\tcd addtest2 &&\n\t\trm -rf repo &&\n\t\tgit rm repo &&\n\t\ttest_must_fail git submodule add -q --name repo_new \"$submodurl/repo.git\" repo &&\n\t\ttest ! -d repo &&\n\t\techo \"repo\" >expect &&\n\t\tgit config -f .gitmodules submodule.repo_new.path >actual &&\n\t\ttest_cmp expect actual&&\n\t\techo \"$submodurl/bare.git\" >expect &&\n\t\tgit config -f .gitmodules submodule.repo_new.url >actual &&\n\t\ttest_cmp expect actual &&\n\t\techo \"$submodurl/bare.git\" >expect &&\n\t\tgit config submodule.repo_new.url >actual &&\n\t\ttest_cmp expect actual &&\n\t\tgit submodule add -f -q --name repo_new \"$submodurl/repo.git\" repo &&\n\t\ttest -d repo &&\n\t\techo \"repo\" >expect &&\n\t\tgit config -f .gitmodules submodule.repo_new.path >actual &&\n\t\ttest_cmp expect actual&&\n\t\techo \"$submodurl/repo.git\" >expect &&\n\t\tgit config -f .gitmodules submodule.repo_new.url >actual &&\n\t\ttest_cmp expect actual &&\n\t\techo \"$submodurl/repo.git\" >expect &&\n\t\tgit config submodule.repo_new.url >actual &&\n\t\ttest_cmp expect actual\n\t)\n'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "0055da965ca189f8ecb220e1a916c0b6714eb2b2",
  "sha1_ok": true,
  "size": 19402
}
