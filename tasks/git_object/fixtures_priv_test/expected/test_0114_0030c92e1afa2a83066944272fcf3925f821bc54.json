{
  "content": {
    "base64": "IyEvYmluL3NoCgp0ZXN0X2Rlc2NyaXB0aW9uPSdmZXRjaCAtLWFsbCB3b3JrcyBjb3JyZWN0bHknCgouIC4vdGVzdC1saWIuc2gKCnNldHVwX3JlcG9zaXRvcnkgKCkgewoJbWtkaXIgIiQxIiAmJiAoCgljZCAiJDEiICYmCglnaXQgaW5pdCAmJgoJPmZpbGUgJiYKCWdpdCBhZGQgZmlsZSAmJgoJdGVzdF90aWNrICYmCglnaXQgY29tbWl0IC1tICJJbml0aWFsIiAmJgoJZ2l0IGNoZWNrb3V0IC1iIHNpZGUgJiYKCT5lbGlmICYmCglnaXQgYWRkIGVsaWYgJiYKCXRlc3RfdGljayAmJgoJZ2l0IGNvbW1pdCAtbSAiU2Vjb25kIiAmJgoJZ2l0IGNoZWNrb3V0IG1hc3RlcgoJKQp9Cgp0ZXN0X2V4cGVjdF9zdWNjZXNzIHNldHVwICcKCXNldHVwX3JlcG9zaXRvcnkgb25lICYmCglzZXR1cF9yZXBvc2l0b3J5IHR3byAmJgoJKAoJCWNkIHR3byAmJiBnaXQgYnJhbmNoIGFub3RoZXIKCSkgJiYKCWdpdCBjbG9uZSAtLW1pcnJvciB0d28gdGhyZWUgJiYKCWdpdCBjbG9uZSBvbmUgdGVzdAonCgpjYXQgPiB0ZXN0L2V4cGVjdCA8PCBFT0YKICBvbmUvbWFzdGVyCiAgb25lL3NpZGUKICBvcmlnaW4vSEVBRCAtPiBvcmlnaW4vbWFzdGVyCiAgb3JpZ2luL21hc3RlcgogIG9yaWdpbi9zaWRlCiAgdGhyZWUvYW5vdGhlcgogIHRocmVlL21hc3RlcgogIHRocmVlL3NpZGUKICB0d28vYW5vdGhlcgogIHR3by9tYXN0ZXIKICB0d28vc2lkZQpFT0YKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBmZXRjaCAtLWFsbCcgJwoJKGNkIHRlc3QgJiYKCSBnaXQgcmVtb3RlIGFkZCBvbmUgLi4vb25lICYmCgkgZ2l0IHJlbW90ZSBhZGQgdHdvIC4uL3R3byAmJgoJIGdpdCByZW1vdGUgYWRkIHRocmVlIC4uL3RocmVlICYmCgkgZ2l0IGZldGNoIC0tYWxsICYmCgkgZ2l0IGJyYW5jaCAtciA+IG91dHB1dCAmJgoJIHRlc3RfY21wIGV4cGVjdCBvdXRwdXQpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBmZXRjaCAtLWFsbCBzaG91bGQgY29udGludWUgaWYgYSByZW1vdGUgaGFzIGVycm9ycycgJwoJKGdpdCBjbG9uZSBvbmUgdGVzdDIgJiYKCSBjZCB0ZXN0MiAmJgoJIGdpdCByZW1vdGUgYWRkIGJhZCAuLi9ub24tZXhpc3RpbmcgJiYKCSBnaXQgcmVtb3RlIGFkZCBvbmUgLi4vb25lICYmCgkgZ2l0IHJlbW90ZSBhZGQgdHdvIC4uL3R3byAmJgoJIGdpdCByZW1vdGUgYWRkIHRocmVlIC4uL3RocmVlICYmCgkgdGVzdF9tdXN0X2ZhaWwgZ2l0IGZldGNoIC0tYWxsICYmCgkgZ2l0IGJyYW5jaCAtciA+IG91dHB1dCAmJgoJIHRlc3RfY21wIC4uL3Rlc3QvZXhwZWN0IG91dHB1dCkKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnZ2l0IGZldGNoIC0tYWxsIGRvZXMgbm90IGFsbG93IG5vbi1vcHRpb24gYXJndW1lbnRzJyAnCgkoY2QgdGVzdCAmJgoJIHRlc3RfbXVzdF9mYWlsIGdpdCBmZXRjaCAtLWFsbCBvcmlnaW4gJiYKCSB0ZXN0X211c3RfZmFpbCBnaXQgZmV0Y2ggLS1hbGwgb3JpZ2luIG1hc3RlcikKJwoKY2F0ID4gZXhwZWN0IDw8IEVPRgogIG9yaWdpbi9IRUFEIC0+IG9yaWdpbi9tYXN0ZXIKICBvcmlnaW4vbWFzdGVyCiAgb3JpZ2luL3NpZGUKICB0aHJlZS9hbm90aGVyCiAgdGhyZWUvbWFzdGVyCiAgdGhyZWUvc2lkZQpFT0YKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBmZXRjaCAtLW11bHRpcGxlIChidXQgb25seSBvbmUgcmVtb3RlKScgJwoJKGdpdCBjbG9uZSBvbmUgdGVzdDMgJiYKCSBjZCB0ZXN0MyAmJgoJIGdpdCByZW1vdGUgYWRkIHRocmVlIC4uL3RocmVlICYmCgkgZ2l0IGZldGNoIC0tbXVsdGlwbGUgdGhyZWUgJiYKCSBnaXQgYnJhbmNoIC1yID4gb3V0cHV0ICYmCgkgdGVzdF9jbXAgLi4vZXhwZWN0IG91dHB1dCkKJwoKY2F0ID4gZXhwZWN0IDw8IEVPRgogIG9uZS9tYXN0ZXIKICBvbmUvc2lkZQogIHR3by9hbm90aGVyCiAgdHdvL21hc3RlcgogIHR3by9zaWRlCkVPRgoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnZ2l0IGZldGNoIC0tbXVsdGlwbGUgKHR3byByZW1vdGVzKScgJwoJKGdpdCBjbG9uZSBvbmUgdGVzdDQgJiYKCSBjZCB0ZXN0NCAmJgoJIGdpdCByZW1vdGUgcm0gb3JpZ2luICYmCgkgZ2l0IHJlbW90ZSBhZGQgb25lIC4uL29uZSAmJgoJIGdpdCByZW1vdGUgYWRkIHR3byAuLi90d28gJiYKCSBnaXQgZmV0Y2ggLS1tdWx0aXBsZSBvbmUgdHdvICYmCgkgZ2l0IGJyYW5jaCAtciA+IG91dHB1dCAmJgoJIHRlc3RfY21wIC4uL2V4cGVjdCBvdXRwdXQpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBmZXRjaCAtLW11bHRpcGxlIChiYWQgcmVtb3RlIG5hbWVzKScgJwoJKGNkIHRlc3Q0ICYmCgkgdGVzdF9tdXN0X2ZhaWwgZ2l0IGZldGNoIC0tbXVsdGlwbGUgZm91cikKJwoKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBmZXRjaCAtLWFsbCAoc2tpcEZldGNoQWxsKScgJwoJKGNkIHRlc3Q0ICYmCgkgZm9yIGIgaW4gJChnaXQgYnJhbmNoIC1yKQoJIGRvCgkJZ2l0IGJyYW5jaCAtciAtZCAkYiB8fCBleGl0IDEKCSBkb25lICYmCgkgZ2l0IHJlbW90ZSBhZGQgdGhyZWUgLi4vdGhyZWUgJiYKCSBnaXQgY29uZmlnIHJlbW90ZS50aHJlZS5za2lwRmV0Y2hBbGwgdHJ1ZSAmJgoJIGdpdCBmZXRjaCAtLWFsbCAmJgoJIGdpdCBicmFuY2ggLXIgPiBvdXRwdXQgJiYKCSB0ZXN0X2NtcCAuLi9leHBlY3Qgb3V0cHV0KQonCgpjYXQgPiBleHBlY3QgPDwgRU9GCiAgb25lL21hc3RlcgogIG9uZS9zaWRlCiAgdGhyZWUvYW5vdGhlcgogIHRocmVlL21hc3RlcgogIHRocmVlL3NpZGUKICB0d28vYW5vdGhlcgogIHR3by9tYXN0ZXIKICB0d28vc2lkZQpFT0YKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBmZXRjaCAtLW11bHRpcGxlIChpZ25vcmluZyBza2lwRmV0Y2hBbGwpJyAnCgkoY2QgdGVzdDQgJiYKCSBmb3IgYiBpbiAkKGdpdCBicmFuY2ggLXIpCgkgZG8KCQlnaXQgYnJhbmNoIC1yIC1kICRiIHx8IGV4aXQgMQoJIGRvbmUgJiYKCSBnaXQgZmV0Y2ggLS1tdWx0aXBsZSBvbmUgdHdvIHRocmVlICYmCgkgZ2l0IGJyYW5jaCAtciA+IG91dHB1dCAmJgoJIHRlc3RfY21wIC4uL2V4cGVjdCBvdXRwdXQpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBmZXRjaCAtLWFsbCAtLW5vLXRhZ3MnICcKCWdpdCBjbG9uZSBvbmUgdGVzdDUgJiYKCWdpdCBjbG9uZSB0ZXN0NSB0ZXN0NiAmJgoJKGNkIHRlc3Q1ICYmIGdpdCB0YWcgdGVzdC10YWcpICYmCgkoCgkJY2QgdGVzdDYgJiYKCQlnaXQgZmV0Y2ggLS1hbGwgLS1uby10YWdzICYmCgkJZ2l0IHRhZyA+b3V0cHV0CgkpICYmCgl0ZXN0X211c3RfYmVfZW1wdHkgdGVzdDYvb3V0cHV0CicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2dpdCBmZXRjaCAtLWFsbCAtLXRhZ3MnICcKCWVjaG8gdGVzdC10YWcgPmV4cGVjdCAmJgoJZ2l0IGNsb25lIG9uZSB0ZXN0NyAmJgoJZ2l0IGNsb25lIHRlc3Q3IHRlc3Q4ICYmCgkoCgkJY2QgdGVzdDcgJiYKCQl0ZXN0X2NvbW1pdCB0ZXN0LXRhZyAmJgoJCWdpdCByZXNldCAtLWhhcmQgSEVBRF4KCSkgJiYKCSgKCQljZCB0ZXN0OCAmJgoJCWdpdCBmZXRjaCAtLWFsbCAtLXRhZ3MgJiYKCQlnaXQgdGFnID5vdXRwdXQKCSkgJiYKCXRlc3RfY21wIGV4cGVjdCB0ZXN0OC9vdXRwdXQKJwoKdGVzdF9kb25lCg==",
    "text": "#!/bin/sh\n\ntest_description='fetch --all works correctly'\n\n. ./test-lib.sh\n\nsetup_repository () {\n\tmkdir \"$1\" && (\n\tcd \"$1\" &&\n\tgit init &&\n\t>file &&\n\tgit add file &&\n\ttest_tick &&\n\tgit commit -m \"Initial\" &&\n\tgit checkout -b side &&\n\t>elif &&\n\tgit add elif &&\n\ttest_tick &&\n\tgit commit -m \"Second\" &&\n\tgit checkout master\n\t)\n}\n\ntest_expect_success setup '\n\tsetup_repository one &&\n\tsetup_repository two &&\n\t(\n\t\tcd two && git branch another\n\t) &&\n\tgit clone --mirror two three &&\n\tgit clone one test\n'\n\ncat > test/expect << EOF\n  one/master\n  one/side\n  origin/HEAD -> origin/master\n  origin/master\n  origin/side\n  three/another\n  three/master\n  three/side\n  two/another\n  two/master\n  two/side\nEOF\n\ntest_expect_success 'git fetch --all' '\n\t(cd test &&\n\t git remote add one ../one &&\n\t git remote add two ../two &&\n\t git remote add three ../three &&\n\t git fetch --all &&\n\t git branch -r > output &&\n\t test_cmp expect output)\n'\n\ntest_expect_success 'git fetch --all should continue if a remote has errors' '\n\t(git clone one test2 &&\n\t cd test2 &&\n\t git remote add bad ../non-existing &&\n\t git remote add one ../one &&\n\t git remote add two ../two &&\n\t git remote add three ../three &&\n\t test_must_fail git fetch --all &&\n\t git branch -r > output &&\n\t test_cmp ../test/expect output)\n'\n\ntest_expect_success 'git fetch --all does not allow non-option arguments' '\n\t(cd test &&\n\t test_must_fail git fetch --all origin &&\n\t test_must_fail git fetch --all origin master)\n'\n\ncat > expect << EOF\n  origin/HEAD -> origin/master\n  origin/master\n  origin/side\n  three/another\n  three/master\n  three/side\nEOF\n\ntest_expect_success 'git fetch --multiple (but only one remote)' '\n\t(git clone one test3 &&\n\t cd test3 &&\n\t git remote add three ../three &&\n\t git fetch --multiple three &&\n\t git branch -r > output &&\n\t test_cmp ../expect output)\n'\n\ncat > expect << EOF\n  one/master\n  one/side\n  two/another\n  two/master\n  two/side\nEOF\n\ntest_expect_success 'git fetch --multiple (two remotes)' '\n\t(git clone one test4 &&\n\t cd test4 &&\n\t git remote rm origin &&\n\t git remote add one ../one &&\n\t git remote add two ../two &&\n\t git fetch --multiple one two &&\n\t git branch -r > output &&\n\t test_cmp ../expect output)\n'\n\ntest_expect_success 'git fetch --multiple (bad remote names)' '\n\t(cd test4 &&\n\t test_must_fail git fetch --multiple four)\n'\n\n\ntest_expect_success 'git fetch --all (skipFetchAll)' '\n\t(cd test4 &&\n\t for b in $(git branch -r)\n\t do\n\t\tgit branch -r -d $b || exit 1\n\t done &&\n\t git remote add three ../three &&\n\t git config remote.three.skipFetchAll true &&\n\t git fetch --all &&\n\t git branch -r > output &&\n\t test_cmp ../expect output)\n'\n\ncat > expect << EOF\n  one/master\n  one/side\n  three/another\n  three/master\n  three/side\n  two/another\n  two/master\n  two/side\nEOF\n\ntest_expect_success 'git fetch --multiple (ignoring skipFetchAll)' '\n\t(cd test4 &&\n\t for b in $(git branch -r)\n\t do\n\t\tgit branch -r -d $b || exit 1\n\t done &&\n\t git fetch --multiple one two three &&\n\t git branch -r > output &&\n\t test_cmp ../expect output)\n'\n\ntest_expect_success 'git fetch --all --no-tags' '\n\tgit clone one test5 &&\n\tgit clone test5 test6 &&\n\t(cd test5 && git tag test-tag) &&\n\t(\n\t\tcd test6 &&\n\t\tgit fetch --all --no-tags &&\n\t\tgit tag >output\n\t) &&\n\ttest_must_be_empty test6/output\n'\n\ntest_expect_success 'git fetch --all --tags' '\n\techo test-tag >expect &&\n\tgit clone one test7 &&\n\tgit clone test7 test8 &&\n\t(\n\t\tcd test7 &&\n\t\ttest_commit test-tag &&\n\t\tgit reset --hard HEAD^\n\t) &&\n\t(\n\t\tcd test8 &&\n\t\tgit fetch --all --tags &&\n\t\tgit tag >output\n\t) &&\n\ttest_cmp expect test8/output\n'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "0030c92e1afa2a83066944272fcf3925f821bc54",
  "sha1_ok": true,
  "size": 3571
}
