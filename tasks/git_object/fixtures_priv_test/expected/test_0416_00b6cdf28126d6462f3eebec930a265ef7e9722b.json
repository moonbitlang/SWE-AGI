{
  "content": {
    "base64": "IyEvYmluL3NoCiMgVGNsIGlnbm9yZXMgdGhlIG5leHQgbGluZSAtKi0gdGNsIC0qLSBcCmV4ZWMgd2lzaCAiJDAiIC0tICIkQCIKCiMgQ29weXJpZ2h0IChDKSAyMDA2IFNoYXduIFBlYXJjZSwgUGF1bCBNYWNrZXJyYXMuICBBbGwgcmlnaHRzIHJlc2VydmVkLgojIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyBpdCBtYXkgYmUgdXNlZCwgY29waWVkLCBtb2RpZmllZAojIGFuZCBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbmNlLAojIGVpdGhlciB2ZXJzaW9uIDIsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgpzZXQgYXBwbmFtZSBbbGluZGV4IFtmaWxlIHNwbGl0ICRhcmd2MF0gZW5kXQpzZXQgZ2l0ZGlyIHt9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjCiMjIGNvbmZpZwoKcHJvYyBpc19tYW55X2NvbmZpZyB7bmFtZX0gewoJc3dpdGNoIC1nbG9iIC0tICRuYW1lIHsKCXJlbW90ZS4qLmZldGNoIC0KCXJlbW90ZS4qLnB1c2gKCQl7cmV0dXJuIDF9CgkqCgkJe3JldHVybiAwfQoJfQp9Cgpwcm9jIGxvYWRfY29uZmlnIHtpbmNsdWRlX2dsb2JhbH0gewoJZ2xvYmFsIHJlcG9fY29uZmlnIGdsb2JhbF9jb25maWcgZGVmYXVsdF9jb25maWcKCglhcnJheSB1bnNldCBnbG9iYWxfY29uZmlnCglpZiB7JGluY2x1ZGVfZ2xvYmFsfSB7CgkJY2F0Y2ggewoJCQlzZXQgZmRfcmMgW29wZW4gInwgZ2l0IHJlcG8tY29uZmlnIC0tZ2xvYmFsIC0tbGlzdCIgcl0KCQkJd2hpbGUge1tnZXRzICRmZF9yYyBsaW5lXSA+PSAwfSB7CgkJCQlpZiB7W3JlZ2V4cCB7XihbXj1dKyk9KC4qKSR9ICRsaW5lIGxpbmUgbmFtZSB2YWx1ZV19IHsKCQkJCQlpZiB7W2lzX21hbnlfY29uZmlnICRuYW1lXX0gewoJCQkJCQlsYXBwZW5kIGdsb2JhbF9jb25maWcoJG5hbWUpICR2YWx1ZQoJCQkJCX0gZWxzZSB7CgkJCQkJCXNldCBnbG9iYWxfY29uZmlnKCRuYW1lKSAkdmFsdWUKCQkJCQl9CgkJCQl9CgkJCX0KCQkJY2xvc2UgJGZkX3JjCgkJfQoJfQoKCWFycmF5IHVuc2V0IHJlcG9fY29uZmlnCgljYXRjaCB7CgkJc2V0IGZkX3JjIFtvcGVuICJ8IGdpdCByZXBvLWNvbmZpZyAtLWxpc3QiIHJdCgkJd2hpbGUge1tnZXRzICRmZF9yYyBsaW5lXSA+PSAwfSB7CgkJCWlmIHtbcmVnZXhwIHteKFtePV0rKT0oLiopJH0gJGxpbmUgbGluZSBuYW1lIHZhbHVlXX0gewoJCQkJaWYge1tpc19tYW55X2NvbmZpZyAkbmFtZV19IHsKCQkJCQlsYXBwZW5kIHJlcG9fY29uZmlnKCRuYW1lKSAkdmFsdWUKCQkJCX0gZWxzZSB7CgkJCQkJc2V0IHJlcG9fY29uZmlnKCRuYW1lKSAkdmFsdWUKCQkJCX0KCQkJfQoJCX0KCQljbG9zZSAkZmRfcmMKCX0KCglmb3JlYWNoIG5hbWUgW2FycmF5IG5hbWVzIGRlZmF1bHRfY29uZmlnXSB7CgkJaWYge1tjYXRjaCB7c2V0IHYgJGdsb2JhbF9jb25maWcoJG5hbWUpfV19IHsKCQkJc2V0IGdsb2JhbF9jb25maWcoJG5hbWUpICRkZWZhdWx0X2NvbmZpZygkbmFtZSkKCQl9CgkJaWYge1tjYXRjaCB7c2V0IHYgJHJlcG9fY29uZmlnKCRuYW1lKX1dfSB7CgkJCXNldCByZXBvX2NvbmZpZygkbmFtZSkgJGRlZmF1bHRfY29uZmlnKCRuYW1lKQoJCX0KCX0KfQoKcHJvYyBzYXZlX2NvbmZpZyB7fSB7CglnbG9iYWwgZGVmYXVsdF9jb25maWcgZm9udF9kZXNjcwoJZ2xvYmFsIHJlcG9fY29uZmlnIGdsb2JhbF9jb25maWcKCWdsb2JhbCByZXBvX2NvbmZpZ19uZXcgZ2xvYmFsX2NvbmZpZ19uZXcKCglmb3JlYWNoIG9wdGlvbiAkZm9udF9kZXNjcyB7CgkJc2V0IG5hbWUgW2xpbmRleCAkb3B0aW9uIDBdCgkJc2V0IGZvbnQgW2xpbmRleCAkb3B0aW9uIDFdCgkJZm9udCBjb25maWd1cmUgJGZvbnQgXAoJCQktZmFtaWx5ICRnbG9iYWxfY29uZmlnX25ldyhndWkuJGZvbnReXmZhbWlseSkgXAoJCQktc2l6ZSAkZ2xvYmFsX2NvbmZpZ19uZXcoZ3VpLiRmb250Xl5zaXplKQoJCWZvbnQgY29uZmlndXJlICR7Zm9udH1ib2xkIFwKCQkJLWZhbWlseSAkZ2xvYmFsX2NvbmZpZ19uZXcoZ3VpLiRmb250Xl5mYW1pbHkpIFwKCQkJLXNpemUgJGdsb2JhbF9jb25maWdfbmV3KGd1aS4kZm9udF5ec2l6ZSkKCQlzZXQgZ2xvYmFsX2NvbmZpZ19uZXcoZ3VpLiRuYW1lKSBbZm9udCBjb25maWd1cmUgJGZvbnRdCgkJdW5zZXQgZ2xvYmFsX2NvbmZpZ19uZXcoZ3VpLiRmb250Xl5mYW1pbHkpCgkJdW5zZXQgZ2xvYmFsX2NvbmZpZ19uZXcoZ3VpLiRmb250Xl5zaXplKQoJfQoKCWZvcmVhY2ggbmFtZSBbYXJyYXkgbmFtZXMgZGVmYXVsdF9jb25maWddIHsKCQlzZXQgdmFsdWUgJGdsb2JhbF9jb25maWdfbmV3KCRuYW1lKQoJCWlmIHskdmFsdWUgbmUgJGdsb2JhbF9jb25maWcoJG5hbWUpfSB7CgkJCWlmIHskdmFsdWUgZXEgJGRlZmF1bHRfY29uZmlnKCRuYW1lKX0gewoJCQkJY2F0Y2gge2V4ZWMgZ2l0IHJlcG8tY29uZmlnIC0tZ2xvYmFsIC0tdW5zZXQgJG5hbWV9CgkJCX0gZWxzZSB7CgkJCQlyZWdzdWIgLWFsbCAiXFt7fVxdIiAkdmFsdWUgeyJ9IHZhbHVlCgkJCQlleGVjIGdpdCByZXBvLWNvbmZpZyAtLWdsb2JhbCAkbmFtZSAkdmFsdWUKCQkJfQoJCQlzZXQgZ2xvYmFsX2NvbmZpZygkbmFtZSkgJHZhbHVlCgkJCWlmIHskdmFsdWUgZXEgJHJlcG9fY29uZmlnKCRuYW1lKX0gewoJCQkJY2F0Y2gge2V4ZWMgZ2l0IHJlcG8tY29uZmlnIC0tdW5zZXQgJG5hbWV9CgkJCQlzZXQgcmVwb19jb25maWcoJG5hbWUpICR2YWx1ZQoJCQl9CgkJfQoJfQoKCWZvcmVhY2ggbmFtZSBbYXJyYXkgbmFtZXMgZGVmYXVsdF9jb25maWddIHsKCQlzZXQgdmFsdWUgJHJlcG9fY29uZmlnX25ldygkbmFtZSkKCQlpZiB7JHZhbHVlIG5lICRyZXBvX2NvbmZpZygkbmFtZSl9IHsKCQkJaWYgeyR2YWx1ZSBlcSAkZ2xvYmFsX2NvbmZpZygkbmFtZSl9IHsKCQkJCWNhdGNoIHtleGVjIGdpdCByZXBvLWNvbmZpZyAtLXVuc2V0ICRuYW1lfQoJCQl9IGVsc2UgewoJCQkJcmVnc3ViIC1hbGwgIlxbe31cXSIgJHZhbHVlIHsifSB2YWx1ZQoJCQkJZXhlYyBnaXQgcmVwby1jb25maWcgJG5hbWUgJHZhbHVlCgkJCX0KCQkJc2V0IHJlcG9fY29uZmlnKCRuYW1lKSAkdmFsdWUKCQl9Cgl9Cn0KCnByb2MgZXJyb3JfcG9wdXAge21zZ30gewoJZ2xvYmFsIGdpdGRpciBhcHBuYW1lCgoJc2V0IHRpdGxlICRhcHBuYW1lCglpZiB7JGdpdGRpciBuZSB7fX0gewoJCWFwcGVuZCB0aXRsZSB7ICh9CgkJYXBwZW5kIHRpdGxlIFtsaW5kZXggXAoJCQlbZmlsZSBzcGxpdCBbZmlsZSBub3JtYWxpemUgW2ZpbGUgZGlybmFtZSAkZ2l0ZGlyXV1dIFwKCQkJZW5kXQoJCWFwcGVuZCB0aXRsZSB7KX0KCX0KCXRrX21lc3NhZ2VCb3ggXAoJCS1wYXJlbnQgLiBcCgkJLWljb24gZXJyb3IgXAoJCS10eXBlIG9rIFwKCQktdGl0bGUgIiR0aXRsZTogZXJyb3IiIFwKCQktbWVzc2FnZSAkbXNnCn0KCnByb2MgaW5mb19wb3B1cCB7bXNnfSB7CglnbG9iYWwgZ2l0ZGlyIGFwcG5hbWUKCglzZXQgdGl0bGUgJGFwcG5hbWUKCWlmIHskZ2l0ZGlyIG5lIHt9fSB7CgkJYXBwZW5kIHRpdGxlIHsgKH0KCQlhcHBlbmQgdGl0bGUgW2xpbmRleCBcCgkJCVtmaWxlIHNwbGl0IFtmaWxlIG5vcm1hbGl6ZSBbZmlsZSBkaXJuYW1lICRnaXRkaXJdXV0gXAoJCQllbmRdCgkJYXBwZW5kIHRpdGxlIHspfQoJfQoJdGtfbWVzc2FnZUJveCBcCgkJLXBhcmVudCAuIFwKCQktaWNvbiBlcnJvciBcCgkJLXR5cGUgb2sgXAoJCS10aXRsZSAkdGl0bGUgXAoJCS1tZXNzYWdlICRtc2cKfQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIwojIyByZXBvc2l0b3J5IHNldHVwCgppZiB7ICAgW2NhdGNoIHtzZXQgY2R1cCBbZXhlYyBnaXQgcmV2LXBhcnNlIC0tc2hvdy1jZHVwXX0gZXJyXQoJfHwgW2NhdGNoIHtzZXQgZ2l0ZGlyIFtleGVjIGdpdCByZXYtcGFyc2UgLS1naXQtZGlyXX0gZXJyXX0gewoJY2F0Y2gge3dtIHdpdGhkcmF3IC59CgllcnJvcl9wb3B1cCAiQ2Fubm90IGZpbmQgdGhlIGdpdCBkaXJlY3Rvcnk6XG5cbiRlcnIiCglleGl0IDEKfQppZiB7JGNkdXAgbmUgIiJ9IHsKCWNkICRjZHVwCn0KdW5zZXQgY2R1cAoKc2V0IHNpbmdsZV9jb21taXQgMAppZiB7JGFwcG5hbWUgZXEge2dpdC1jaXRvb2x9fSB7CglzZXQgc2luZ2xlX2NvbW1pdCAxCn0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMKIyMgdGFzayBtYW5hZ2VtZW50CgpzZXQgc3RhdHVzX2FjdGl2ZSAwCnNldCBkaWZmX2FjdGl2ZSAwCgpzZXQgZGlzYWJsZV9vbl9sb2NrIFtsaXN0XQpzZXQgaW5kZXhfbG9ja190eXBlIG5vbmUKCnNldCBIRUFEIHt9CnNldCBQQVJFTlQge30Kc2V0IGNvbW1pdF90eXBlIHt9Cgpwcm9jIGxvY2tfaW5kZXgge3R5cGV9IHsKCWdsb2JhbCBpbmRleF9sb2NrX3R5cGUgZGlzYWJsZV9vbl9sb2NrCgoJaWYgeyRpbmRleF9sb2NrX3R5cGUgZXEge25vbmV9fSB7CgkJc2V0IGluZGV4X2xvY2tfdHlwZSAkdHlwZQoJCWZvcmVhY2ggdyAkZGlzYWJsZV9vbl9sb2NrIHsKCQkJdXBsZXZlbCAjMCAkdyBkaXNhYmxlZAoJCX0KCQlyZXR1cm4gMQoJfSBlbHNlaWYgeyRpbmRleF9sb2NrX3R5cGUgZXEge2JlZ2luLXVwZGF0ZX0gJiYgJHR5cGUgZXEge3VwZGF0ZX19IHsKCQlzZXQgaW5kZXhfbG9ja190eXBlICR0eXBlCgkJcmV0dXJuIDEKCX0KCXJldHVybiAwCn0KCnByb2MgdW5sb2NrX2luZGV4IHt9IHsKCWdsb2JhbCBpbmRleF9sb2NrX3R5cGUgZGlzYWJsZV9vbl9sb2NrCgoJc2V0IGluZGV4X2xvY2tfdHlwZSBub25lCglmb3JlYWNoIHcgJGRpc2FibGVfb25fbG9jayB7CgkJdXBsZXZlbCAjMCAkdyBub3JtYWwKCX0KfQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIwojIyBzdGF0dXMKCnByb2MgcmVwb3NpdG9yeV9zdGF0ZSB7aGR2YXIgY3R2YXJ9IHsKCWdsb2JhbCBnaXRkaXIKCXVwdmFyICRoZHZhciBoZCAkY3R2YXIgY3QKCglpZiB7W2NhdGNoIHtzZXQgaGQgW2V4ZWMgZ2l0IHJldi1wYXJzZSAtLXZlcmlmeSBIRUFEXX1dfSB7CgkJc2V0IGN0IGluaXRpYWwKCX0gZWxzZWlmIHtbZmlsZSBleGlzdHMgW2ZpbGUgam9pbiAkZ2l0ZGlyIE1FUkdFX0hFQURdXX0gewoJCXNldCBjdCBtZXJnZQoJfSBlbHNlIHsKCQlzZXQgY3Qgbm9ybWFsCgl9Cn0KCnByb2MgdXBkYXRlX3N0YXR1cyB7e2ZpbmFsIFJlYWR5Ln19IHsKCWdsb2JhbCBIRUFEIFBBUkVOVCBjb21taXRfdHlwZQoJZ2xvYmFsIHVpX2luZGV4IHVpX290aGVyIHVpX3N0YXR1c192YWx1ZSB1aV9jb21tCglnbG9iYWwgc3RhdHVzX2FjdGl2ZSBmaWxlX3N0YXRlcwoJZ2xvYmFsIHJlcG9fY29uZmlnCgoJaWYgeyRzdGF0dXNfYWN0aXZlIHx8ICFbbG9ja19pbmRleCByZWFkXX0gcmV0dXJuCgoJcmVwb3NpdG9yeV9zdGF0ZSBuZXdfSEVBRCBuZXdfdHlwZQoJaWYgeyRjb21taXRfdHlwZSBlcSB7YW1lbmR9CgkJJiYgJG5ld190eXBlIGVxIHtub3JtYWx9CgkJJiYgJG5ld19IRUFEIGVxICRIRUFEfSB7Cgl9IGVsc2UgewoJCXNldCBIRUFEICRuZXdfSEVBRAoJCXNldCBQQVJFTlQgJG5ld19IRUFECgkJc2V0IGNvbW1pdF90eXBlICRuZXdfdHlwZQoJfQoKCWFycmF5IHVuc2V0IGZpbGVfc3RhdGVzCgoJaWYgeyFbJHVpX2NvbW0gZWRpdCBtb2RpZmllZF0KCQl8fCBbc3RyaW5nIHRyaW0gWyR1aV9jb21tIGdldCAwLjAgZW5kXV0gZXEge319IHsKCQlpZiB7W2xvYWRfbWVzc2FnZSBHSVRHVUlfTVNHXX0gewoJCX0gZWxzZWlmIHtbbG9hZF9tZXNzYWdlIE1FUkdFX01TR119IHsKCQl9IGVsc2VpZiB7W2xvYWRfbWVzc2FnZSBTUVVBU0hfTVNHXX0gewoJCX0KCQkkdWlfY29tbSBlZGl0IG1vZGlmaWVkIGZhbHNlCgkJJHVpX2NvbW0gZWRpdCByZXNldAoJfQoKCWlmIHskcmVwb19jb25maWcoZ3VpLnRydXN0bXRpbWUpIGVxIHt0cnVlfX0gewoJCXVwZGF0ZV9zdGF0dXNfc3RhZ2UyIHt9ICRmaW5hbAoJfSBlbHNlIHsKCQlzZXQgc3RhdHVzX2FjdGl2ZSAxCgkJc2V0IHVpX3N0YXR1c192YWx1ZSB7UmVmcmVzaGluZyBmaWxlIHN0YXR1cy4uLn0KCQlzZXQgY21kIFtsaXN0IGdpdCB1cGRhdGUtaW5kZXhdCgkJbGFwcGVuZCBjbWQgLXEKCQlsYXBwZW5kIGNtZCAtLXVubWVyZ2VkCgkJbGFwcGVuZCBjbWQgLS1pZ25vcmUtbWlzc2luZwoJCWxhcHBlbmQgY21kIC0tcmVmcmVzaAoJCXNldCBmZF9yZiBbb3BlbiAifCAkY21kIiByXQoJCWZjb25maWd1cmUgJGZkX3JmIC1ibG9ja2luZyAwIC10cmFuc2xhdGlvbiBiaW5hcnkKCQlmaWxlZXZlbnQgJGZkX3JmIHJlYWRhYmxlIFwKCQkJW2xpc3QgdXBkYXRlX3N0YXR1c19zdGFnZTIgJGZkX3JmICRmaW5hbF0KCX0KfQoKcHJvYyB1cGRhdGVfc3RhdHVzX3N0YWdlMiB7ZmQgZmluYWx9IHsKCWdsb2JhbCBnaXRkaXIgUEFSRU5UIGNvbW1pdF90eXBlCglnbG9iYWwgdWlfaW5kZXggdWlfb3RoZXIgdWlfc3RhdHVzX3ZhbHVlIHVpX2NvbW0KCWdsb2JhbCBzdGF0dXNfYWN0aXZlCglnbG9iYWwgYnVmX3JkaSBidWZfcmRmIGJ1Zl9ybG8KCglpZiB7JGZkIG5lIHt9fSB7CgkJcmVhZCAkZmQKCQlpZiB7IVtlb2YgJGZkXX0gcmV0dXJuCgkJY2xvc2UgJGZkCgl9CgoJc2V0IGxzX290aGVycyBbbGlzdCB8IGdpdCBscy1maWxlcyAtLW90aGVycyAteiBcCgkJLS1leGNsdWRlLXBlci1kaXJlY3Rvcnk9LmdpdGlnbm9yZV0KCXNldCBpbmZvX2V4Y2x1ZGUgW2ZpbGUgam9pbiAkZ2l0ZGlyIGluZm8gZXhjbHVkZV0KCWlmIHtbZmlsZSByZWFkYWJsZSAkaW5mb19leGNsdWRlXX0gewoJCWxhcHBlbmQgbHNfb3RoZXJzICItLWV4Y2x1ZGUtZnJvbT0kaW5mb19leGNsdWRlIgoJfQoKCXNldCBidWZfcmRpIHt9CglzZXQgYnVmX3JkZiB7fQoJc2V0IGJ1Zl9ybG8ge30KCglzZXQgc3RhdHVzX2FjdGl2ZSAzCglzZXQgdWlfc3RhdHVzX3ZhbHVlIHtTY2FubmluZyBmb3IgbW9kaWZpZWQgZmlsZXMgLi4ufQoJc2V0IGZkX2RpIFtvcGVuICJ8IGdpdCBkaWZmLWluZGV4IC0tY2FjaGVkIC16ICRQQVJFTlQiIHJdCglzZXQgZmRfZGYgW29wZW4gInwgZ2l0IGRpZmYtZmlsZXMgLXoiIHJdCglzZXQgZmRfbG8gW29wZW4gJGxzX290aGVycyByXQoKCWZjb25maWd1cmUgJGZkX2RpIC1ibG9ja2luZyAwIC10cmFuc2xhdGlvbiBiaW5hcnkKCWZjb25maWd1cmUgJGZkX2RmIC1ibG9ja2luZyAwIC10cmFuc2xhdGlvbiBiaW5hcnkKCWZjb25maWd1cmUgJGZkX2xvIC1ibG9ja2luZyAwIC10cmFuc2xhdGlvbiBiaW5hcnkKCWZpbGVldmVudCAkZmRfZGkgcmVhZGFibGUgW2xpc3QgcmVhZF9kaWZmX2luZGV4ICRmZF9kaSAkZmluYWxdCglmaWxlZXZlbnQgJGZkX2RmIHJlYWRhYmxlIFtsaXN0IHJlYWRfZGlmZl9maWxlcyAkZmRfZGYgJGZpbmFsXQoJZmlsZWV2ZW50ICRmZF9sbyByZWFkYWJsZSBbbGlzdCByZWFkX2xzX290aGVycyAkZmRfbG8gJGZpbmFsXQp9Cgpwcm9jIGxvYWRfbWVzc2FnZSB7ZmlsZX0gewoJZ2xvYmFsIGdpdGRpciB1aV9jb21tCgoJc2V0IGYgW2ZpbGUgam9pbiAkZ2l0ZGlyICRmaWxlXQoJaWYge1tmaWxlIGlzZmlsZSAkZl19IHsKCQlpZiB7W2NhdGNoIHtzZXQgZmQgW29wZW4gJGYgcl19XX0gewoJCQlyZXR1cm4gMAoJCX0KCQlzZXQgY29udGVudCBbc3RyaW5nIHRyaW0gW3JlYWQgJGZkXV0KCQljbG9zZSAkZmQKCQkkdWlfY29tbSBkZWxldGUgMC4wIGVuZAoJCSR1aV9jb21tIGluc2VydCBlbmQgJGNvbnRlbnQKCQlyZXR1cm4gMQoJfQoJcmV0dXJuIDAKfQoKcHJvYyByZWFkX2RpZmZfaW5kZXgge2ZkIGZpbmFsfSB7CglnbG9iYWwgYnVmX3JkaQoKCWFwcGVuZCBidWZfcmRpIFtyZWFkICRmZF0KCXNldCBjIDAKCXNldCBuIFtzdHJpbmcgbGVuZ3RoICRidWZfcmRpXQoJd2hpbGUgeyRjIDwgJG59IHsKCQlzZXQgejEgW3N0cmluZyBmaXJzdCAiXDAiICRidWZfcmRpICRjXQoJCWlmIHskejEgPT0gLTF9IGJyZWFrCgkJaW5jciB6MQoJCXNldCB6MiBbc3RyaW5nIGZpcnN0ICJcMCIgJGJ1Zl9yZGkgJHoxXQoJCWlmIHskejIgPT0gLTF9IGJyZWFrCgoJCXNldCBjICR6MgoJCWluY3IgejIgLTEKCQlkaXNwbGF5X2ZpbGUgXAoJCQlbc3RyaW5nIHJhbmdlICRidWZfcmRpICR6MSAkejJdIFwKCQkJW3N0cmluZyBpbmRleCAkYnVmX3JkaSBbZXhwciAkejEgLSAyXV1fCgkJaW5jciBjCgl9CglpZiB7JGMgPCAkbn0gewoJCXNldCBidWZfcmRpIFtzdHJpbmcgcmFuZ2UgJGJ1Zl9yZGkgJGMgZW5kXQoJfSBlbHNlIHsKCQlzZXQgYnVmX3JkaSB7fQoJfQoKCXN0YXR1c19lb2YgJGZkIGJ1Zl9yZGkgJGZpbmFsCn0KCnByb2MgcmVhZF9kaWZmX2ZpbGVzIHtmZCBmaW5hbH0gewoJZ2xvYmFsIGJ1Zl9yZGYKCglhcHBlbmQgYnVmX3JkZiBbcmVhZCAkZmRdCglzZXQgYyAwCglzZXQgbiBbc3RyaW5nIGxlbmd0aCAkYnVmX3JkZl0KCXdoaWxlIHskYyA8ICRufSB7CgkJc2V0IHoxIFtzdHJpbmcgZmlyc3QgIlwwIiAkYnVmX3JkZiAkY10KCQlpZiB7JHoxID09IC0xfSBicmVhawoJCWluY3IgejEKCQlzZXQgejIgW3N0cmluZyBmaXJzdCAiXDAiICRidWZfcmRmICR6MV0KCQlpZiB7JHoyID09IC0xfSBicmVhawoKCQlzZXQgYyAkejIKCQlpbmNyIHoyIC0xCgkJZGlzcGxheV9maWxlIFwKCQkJW3N0cmluZyByYW5nZSAkYnVmX3JkZiAkejEgJHoyXSBcCgkJCV9bc3RyaW5nIGluZGV4ICRidWZfcmRmIFtleHByICR6MSAtIDJdXQoJCWluY3IgYwoJfQoJaWYgeyRjIDwgJG59IHsKCQlzZXQgYnVmX3JkZiBbc3RyaW5nIHJhbmdlICRidWZfcmRmICRjIGVuZF0KCX0gZWxzZSB7CgkJc2V0IGJ1Zl9yZGYge30KCX0KCglzdGF0dXNfZW9mICRmZCBidWZfcmRmICRmaW5hbAp9Cgpwcm9jIHJlYWRfbHNfb3RoZXJzIHtmZCBmaW5hbH0gewoJZ2xvYmFsIGJ1Zl9ybG8KCglhcHBlbmQgYnVmX3JsbyBbcmVhZCAkZmRdCglzZXQgcGNrIFtzcGxpdCAkYnVmX3JsbyAiXDAiXQoJc2V0IGJ1Zl9ybG8gW2xpbmRleCAkcGNrIGVuZF0KCWZvcmVhY2ggcCBbbHJhbmdlICRwY2sgMCBlbmQtMV0gewoJCWRpc3BsYXlfZmlsZSAkcCBfTwoJfQoJc3RhdHVzX2VvZiAkZmQgYnVmX3JsbyAkZmluYWwKfQoKcHJvYyBzdGF0dXNfZW9mIHtmZCBidWYgZmluYWx9IHsKCWdsb2JhbCBzdGF0dXNfYWN0aXZlIHVpX3N0YXR1c192YWx1ZQoJdXB2YXIgJGJ1ZiB0b19jbGVhcgoKCWlmIHtbZW9mICRmZF19IHsKCQlzZXQgdG9fY2xlYXIge30KCQljbG9zZSAkZmQKCgkJaWYge1tpbmNyIHN0YXR1c19hY3RpdmUgLTFdID09IDB9IHsKCQkJZGlzcGxheV9hbGxfZmlsZXMKCQkJdW5sb2NrX2luZGV4CgkJCXJlc2hvd19kaWZmCgkJCXNldCB1aV9zdGF0dXNfdmFsdWUgJGZpbmFsCgkJfQoJfQp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjCiMjIGRpZmYKCnByb2MgY2xlYXJfZGlmZiB7fSB7CglnbG9iYWwgdWlfZGlmZiB1aV9mbmFtZV92YWx1ZSB1aV9mc3RhdHVzX3ZhbHVlIHVpX2luZGV4IHVpX290aGVyCgoJJHVpX2RpZmYgY29uZiAtc3RhdGUgbm9ybWFsCgkkdWlfZGlmZiBkZWxldGUgMC4wIGVuZAoJJHVpX2RpZmYgY29uZiAtc3RhdGUgZGlzYWJsZWQKCglzZXQgdWlfZm5hbWVfdmFsdWUge30KCXNldCB1aV9mc3RhdHVzX3ZhbHVlIHt9CgoJJHVpX2luZGV4IHRhZyByZW1vdmUgaW5fZGlmZiAwLjAgZW5kCgkkdWlfb3RoZXIgdGFnIHJlbW92ZSBpbl9kaWZmIDAuMCBlbmQKfQoKcHJvYyByZXNob3dfZGlmZiB7fSB7CglnbG9iYWwgdWlfZm5hbWVfdmFsdWUgdWlfc3RhdHVzX3ZhbHVlIGZpbGVfc3RhdGVzCgoJaWYgeyR1aV9mbmFtZV92YWx1ZSBlcSB7fQoJCXx8IFtjYXRjaCB7c2V0IHMgJGZpbGVfc3RhdGVzKCR1aV9mbmFtZV92YWx1ZSl9XX0gewoJCWNsZWFyX2RpZmYKCX0gZWxzZSB7CgkJc2hvd19kaWZmICR1aV9mbmFtZV92YWx1ZQoJfQp9Cgpwcm9jIGhhbmRsZV9lbXB0eV9kaWZmIHt9IHsKCWdsb2JhbCB1aV9mbmFtZV92YWx1ZSBmaWxlX3N0YXRlcyBmaWxlX2xpc3RzCgoJc2V0IHBhdGggJHVpX2ZuYW1lX3ZhbHVlCglzZXQgcyAkZmlsZV9zdGF0ZXMoJHBhdGgpCglpZiB7W2xpbmRleCAkcyAwXSBuZSB7X019fSByZXR1cm4KCglpbmZvX3BvcHVwICJObyBkaWZmZXJlbmNlcyBkZXRlY3RlZC4KCltzaG9ydF9wYXRoICRwYXRoXSBoYXMgbm8gY2hhbmdlcy4KClRoZSBtb2RpZmljYXRpb24gZGF0ZSBvZiB0aGlzIGZpbGUgd2FzIHVwZGF0ZWQgYnkgYW5vdGhlcgphcHBsaWNhdGlvbiBhbmQgeW91IGN1cnJlbnRseSBoYXZlIHRoZSBUcnVzdCBGaWxlIE1vZGlmaWNhdGlvbgpUaW1lc3RhbXBzIG9wdGlvbiBlbmFibGVkLCBzbyBHaXQgZGlkIG5vdCBhdXRvbWF0aWNhbGx5IGRldGVjdAp0aGF0IHRoZXJlIGFyZSBubyBjb250ZW50IGRpZmZlcmVuY2VzIGluIHRoaXMgZmlsZS4KClRoaXMgZmlsZSB3aWxsIG5vdyBiZSByZW1vdmVkIGZyb20gdGhlIG1vZGlmaWVkIGZpbGVzIGxpc3QsIHRvCnByZXZlbnQgcG9zc2libGUgY29uZnVzaW9uLgoiCglpZiB7W2NhdGNoIHtleGVjIGdpdCB1cGRhdGUtaW5kZXggLS0gJHBhdGh9IGVycl19IHsKCQllcnJvcl9wb3B1cCAiRmFpbGVkIHRvIHJlZnJlc2ggaW5kZXg6XG5cbiRlcnIiCgl9CgoJY2xlYXJfZGlmZgoJc2V0IG9sZF93IFttYXBjb2wgW2xpbmRleCAkZmlsZV9zdGF0ZXMoJHBhdGgpIDBdICRwYXRoXQoJc2V0IGxubyBbbHNlYXJjaCAtc29ydGVkICRmaWxlX2xpc3RzKCRvbGRfdykgJHBhdGhdCglpZiB7JGxubyA+PSAwfSB7CgkJc2V0IGZpbGVfbGlzdHMoJG9sZF93KSBcCgkJCVtscmVwbGFjZSAkZmlsZV9saXN0cygkb2xkX3cpICRsbm8gJGxub10KCQlpbmNyIGxubwoJCSRvbGRfdyBjb25mIC1zdGF0ZSBub3JtYWwKCQkkb2xkX3cgZGVsZXRlICRsbm8uMCBbZXhwciAkbG5vICsgMV0uMAoJCSRvbGRfdyBjb25mIC1zdGF0ZSBkaXNhYmxlZAoJfQp9Cgpwcm9jIHNob3dfZGlmZiB7cGF0aCB7dyB7fX0ge2xubyB7fX19IHsKCWdsb2JhbCBmaWxlX3N0YXRlcyBmaWxlX2xpc3RzCglnbG9iYWwgUEFSRU5UIGRpZmZfM3dheSBkaWZmX2FjdGl2ZSByZXBvX2NvbmZpZwoJZ2xvYmFsIHVpX2RpZmYgdWlfZm5hbWVfdmFsdWUgdWlfZnN0YXR1c192YWx1ZSB1aV9zdGF0dXNfdmFsdWUKCglpZiB7JGRpZmZfYWN0aXZlIHx8ICFbbG9ja19pbmRleCByZWFkXX0gcmV0dXJuCgoJY2xlYXJfZGlmZgoJaWYgeyR3IGVxIHt9IHx8ICRsbm8gPT0ge319IHsKCQlmb3JlYWNoIHcgW2FycmF5IG5hbWVzIGZpbGVfbGlzdHNdIHsKCQkJc2V0IGxubyBbbHNlYXJjaCAtc29ydGVkICRmaWxlX2xpc3RzKCR3KSAkcGF0aF0KCQkJaWYgeyRsbm8gPj0gMH0gewoJCQkJaW5jciBsbm8KCQkJCWJyZWFrCgkJCX0KCQl9Cgl9CglpZiB7JHcgbmUge30gJiYgJGxubyA+PSAxfSB7CgkJJHcgdGFnIGFkZCBpbl9kaWZmICRsbm8uMCBbZXhwciAkbG5vICsgMV0uMAoJfQoKCXNldCBzICRmaWxlX3N0YXRlcygkcGF0aCkKCXNldCBtIFtsaW5kZXggJHMgMF0KCXNldCBkaWZmXzN3YXkgMAoJc2V0IGRpZmZfYWN0aXZlIDEKCXNldCB1aV9mbmFtZV92YWx1ZSAkcGF0aAoJc2V0IHVpX2ZzdGF0dXNfdmFsdWUgW21hcGRlc2MgJG0gJHBhdGhdCglzZXQgdWlfc3RhdHVzX3ZhbHVlICJMb2FkaW5nIGRpZmYgb2YgW2VzY2FwZV9wYXRoICRwYXRoXS4uLiIKCglzZXQgY21kIFtsaXN0IHwgZ2l0IGRpZmYtaW5kZXhdCglsYXBwZW5kIGNtZCAtLW5vLWNvbG9yCglpZiB7JHJlcG9fY29uZmlnKGd1aS5kaWZmY29udGV4dCkgPiAwfSB7CgkJbGFwcGVuZCBjbWQgIi1VJHJlcG9fY29uZmlnKGd1aS5kaWZmY29udGV4dCkiCgl9CglsYXBwZW5kIGNtZCAtcAoKCXN3aXRjaCAkbSB7CglNTSB7CgkJbGFwcGVuZCBjbWQgLWMKCX0KCV9PIHsKCQlpZiB7W2NhdGNoIHsKCQkJCXNldCBmZCBbb3BlbiAkcGF0aCByXQoJCQkJc2V0IGNvbnRlbnQgW3JlYWQgJGZkXQoJCQkJY2xvc2UgJGZkCgkJCX0gZXJyIF19IHsKCQkJc2V0IGRpZmZfYWN0aXZlIDAKCQkJdW5sb2NrX2luZGV4CgkJCXNldCB1aV9zdGF0dXNfdmFsdWUgIlVuYWJsZSB0byBkaXNwbGF5IFtlc2NhcGVfcGF0aCAkcGF0aF0iCgkJCWVycm9yX3BvcHVwICJFcnJvciBsb2FkaW5nIGZpbGU6XG5cbiRlcnIiCgkJCXJldHVybgoJCX0KCQkkdWlfZGlmZiBjb25mIC1zdGF0ZSBub3JtYWwKCQkkdWlfZGlmZiBpbnNlcnQgZW5kICRjb250ZW50CgkJJHVpX2RpZmYgY29uZiAtc3RhdGUgZGlzYWJsZWQKCQlzZXQgZGlmZl9hY3RpdmUgMAoJCXVubG9ja19pbmRleAoJCXNldCB1aV9zdGF0dXNfdmFsdWUge1JlYWR5Ln0KCQlyZXR1cm4KCX0KCX0KCglsYXBwZW5kIGNtZCAkUEFSRU5UCglsYXBwZW5kIGNtZCAtLQoJbGFwcGVuZCBjbWQgJHBhdGgKCglpZiB7W2NhdGNoIHtzZXQgZmQgW29wZW4gJGNtZCByXX0gZXJyXX0gewoJCXNldCBkaWZmX2FjdGl2ZSAwCgkJdW5sb2NrX2luZGV4CgkJc2V0IHVpX3N0YXR1c192YWx1ZSAiVW5hYmxlIHRvIGRpc3BsYXkgW2VzY2FwZV9wYXRoICRwYXRoXSIKCQllcnJvcl9wb3B1cCAiRXJyb3IgbG9hZGluZyBkaWZmOlxuXG4kZXJyIgoJCXJldHVybgoJfQoKCWZjb25maWd1cmUgJGZkIC1ibG9ja2luZyAwIC10cmFuc2xhdGlvbiBhdXRvCglmaWxlZXZlbnQgJGZkIHJlYWRhYmxlIFtsaXN0IHJlYWRfZGlmZiAkZmRdCn0KCnByb2MgcmVhZF9kaWZmIHtmZH0gewoJZ2xvYmFsIHVpX2RpZmYgdWlfc3RhdHVzX3ZhbHVlIGRpZmZfM3dheSBkaWZmX2FjdGl2ZQoJZ2xvYmFsIHJlcG9fY29uZmlnCgoJd2hpbGUge1tnZXRzICRmZCBsaW5lXSA+PSAwfSB7CgkJaWYge1tzdHJpbmcgbWF0Y2gge2RpZmYgLS1naXQgKn0gJGxpbmVdfSBjb250aW51ZQoJCWlmIHtbc3RyaW5nIG1hdGNoIHtkaWZmIC0tY29tYmluZWQgKn0gJGxpbmVdfSBjb250aW51ZQoJCWlmIHtbc3RyaW5nIG1hdGNoIHstLS0gKn0gJGxpbmVdfSBjb250aW51ZQoJCWlmIHtbc3RyaW5nIG1hdGNoIHsrKysgKn0gJGxpbmVdfSBjb250aW51ZQoJCWlmIHtbc3RyaW5nIG1hdGNoIGluZGV4KiAkbGluZV19IHsKCQkJaWYge1tzdHJpbmcgZmlyc3QgLCAkbGluZV0gPj0gMH0gewoJCQkJc2V0IGRpZmZfM3dheSAxCgkJCX0KCQl9CgoJCSR1aV9kaWZmIGNvbmYgLXN0YXRlIG5vcm1hbAoJCWlmIHshJGRpZmZfM3dheX0gewoJCQlzZXQgeCBbc3RyaW5nIGluZGV4ICRsaW5lIDBdCgkJCXN3aXRjaCAtLSAkeCB7CgkJCSJAIiB7c2V0IHRhZ3MgZGF9CgkJCSIrIiB7c2V0IHRhZ3MgZHB9CgkJCSItIiB7c2V0IHRhZ3MgZG19CgkJCWRlZmF1bHQge3NldCB0YWdzIHt9fQoJCQl9CgkJfSBlbHNlIHsKCQkJc2V0IHggW3N0cmluZyByYW5nZSAkbGluZSAwIDFdCgkJCXN3aXRjaCAtLSAkeCB7CgkJCWRlZmF1bHQge3NldCB0YWdzIHt9fQoJCQkiQEAiIHtzZXQgdGFncyBkYX0KCQkJIisrIiB7c2V0IHRhZ3MgZHA7IHNldCB4ICIgKyJ9CgkJCSIgKyIge3NldCB0YWdzIHtkaSBib2xkfTsgc2V0IHggIisrIn0KCQkJIisgIiB7c2V0IHRhZ3MgZG5pOyBzZXQgeCAiLSsifQoJCQkiLS0iIHtzZXQgdGFncyBkbTsgc2V0IHggIiAtIn0KCQkJIiAtIiB7c2V0IHRhZ3Mge2RtIGJvbGR9OyBzZXQgeCAiLS0ifQoJCQkiLSAiIHtzZXQgdGFncyBkaTsgc2V0IHggIistIn0KCQkJZGVmYXVsdCB7c2V0IHRhZ3Mge319CgkJCX0KCQkJc2V0IGxpbmUgW3N0cmluZyByZXBsYWNlICRsaW5lIDAgMSAkeF0KCQl9CgkJJHVpX2RpZmYgaW5zZXJ0IGVuZCAkbGluZSAkdGFncwoJCSR1aV9kaWZmIGluc2VydCBlbmQgIlxuIgoJCSR1aV9kaWZmIGNvbmYgLXN0YXRlIGRpc2FibGVkCgl9CgoJaWYge1tlb2YgJGZkXX0gewoJCWNsb3NlICRmZAoJCXNldCBkaWZmX2FjdGl2ZSAwCgkJdW5sb2NrX2luZGV4CgkJc2V0IHVpX3N0YXR1c192YWx1ZSB7UmVhZHkufQoKCQlpZiB7JHJlcG9fY29uZmlnKGd1aS50cnVzdG10aW1lKSBlcSB7dHJ1ZX0KCQkJJiYgWyR1aV9kaWZmIGluZGV4IGVuZF0gZXEgezIuMH19IHsKCQkJaGFuZGxlX2VtcHR5X2RpZmYKCQl9Cgl9Cn0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMKIyMgY29tbWl0Cgpwcm9jIGxvYWRfbGFzdF9jb21taXQge30gewoJZ2xvYmFsIEhFQUQgUEFSRU5UIGNvbW1pdF90eXBlIHVpX2NvbW0KCglpZiB7JGNvbW1pdF90eXBlIGVxIHthbWVuZH19IHJldHVybgoJaWYgeyRjb21taXRfdHlwZSBuZSB7bm9ybWFsfX0gewoJCWVycm9yX3BvcHVwICJDYW4ndCBhbWVuZCBhICRjb21taXRfdHlwZSBjb21taXQuIgoJCXJldHVybgoJfQoKCXNldCBtc2cge30KCXNldCBwYXJlbnQge30KCXNldCBwYXJlbnRfY291bnQgMAoJaWYge1tjYXRjaCB7CgkJCXNldCBmZCBbb3BlbiAifCBnaXQgY2F0LWZpbGUgY29tbWl0ICRIRUFEIiByXQoJCQl3aGlsZSB7W2dldHMgJGZkIGxpbmVdID4gMH0gewoJCQkJaWYge1tzdHJpbmcgbWF0Y2gge3BhcmVudCAqfSAkbGluZV19IHsKCQkJCQlzZXQgcGFyZW50IFtzdHJpbmcgcmFuZ2UgJGxpbmUgNyBlbmRdCgkJCQkJaW5jciBwYXJlbnRfY291bnQKCQkJCX0KCQkJfQoJCQlzZXQgbXNnIFtzdHJpbmcgdHJpbSBbcmVhZCAkZmRdXQoJCQljbG9zZSAkZmQKCQl9IGVycl19IHsKCQllcnJvcl9wb3B1cCAiRXJyb3IgbG9hZGluZyBjb21taXQgZGF0YSBmb3IgYW1lbmQ6XG5cbiRlcnIiCgkJcmV0dXJuCgl9CgoJaWYgeyRwYXJlbnRfY291bnQgPT0gMH0gewoJCXNldCBjb21taXRfdHlwZSBhbWVuZAoJCXNldCBIRUFEIHt9CgkJc2V0IFBBUkVOVCB7fQoJCXVwZGF0ZV9zdGF0dXMKCX0gZWxzZWlmIHskcGFyZW50X2NvdW50ID09IDF9IHsKCQlzZXQgY29tbWl0X3R5cGUgYW1lbmQKCQlzZXQgUEFSRU5UICRwYXJlbnQKCQkkdWlfY29tbSBkZWxldGUgMC4wIGVuZAoJCSR1aV9jb21tIGluc2VydCBlbmQgJG1zZwoJCSR1aV9jb21tIGVkaXQgbW9kaWZpZWQgZmFsc2UKCQkkdWlfY29tbSBlZGl0IHJlc2V0CgkJdXBkYXRlX3N0YXR1cwoJfSBlbHNlIHsKCQllcnJvcl9wb3B1cCB7WW91IGNhbid0IGFtZW5kIGEgbWVyZ2UgY29tbWl0Ln0KCQlyZXR1cm4KCX0KfQoKcHJvYyBjb21taXRfdHJlZSB7fSB7CglnbG9iYWwgdGNsX3BsYXRmb3JtIEhFQUQgZ2l0ZGlyIGNvbW1pdF90eXBlIGZpbGVfc3RhdGVzCglnbG9iYWwgcGNoX2Vycm9yCglnbG9iYWwgdWlfc3RhdHVzX3ZhbHVlIHVpX2NvbW0KCglpZiB7IVtsb2NrX2luZGV4IHVwZGF0ZV19IHJldHVybgoKCSMgLS0gT3VyIGluIG1lbW9yeSBzdGF0ZSBzaG91bGQgbWF0Y2ggdGhlIHJlcG9zaXRvcnkuCgkjCglyZXBvc2l0b3J5X3N0YXRlIGN1ckhFQUQgY3VyX3R5cGUKCWlmIHskY29tbWl0X3R5cGUgZXEge2FtZW5kfQoJCSYmICRjdXJfdHlwZSBlcSB7bm9ybWFsfQoJCSYmICRjdXJIRUFEIGVxICRIRUFEfSB7Cgl9IGVsc2VpZiB7JGNvbW1pdF90eXBlIG5lICRjdXJfdHlwZSB8fCAkSEVBRCBuZSAkY3VySEVBRH0gewoJCWVycm9yX3BvcHVwIHtMYXN0IHNjYW5uZWQgc3RhdGUgZG9lcyBub3QgbWF0Y2ggcmVwb3NpdG9yeSBzdGF0ZS4KCkl0cyBoaWdobHkgbGlrZWx5IHRoYXQgYW5vdGhlciBHaXQgcHJvZ3JhbSBtb2RpZmllZCB0aGUKcmVwb3NpdG9yeSBzaW5jZSBvdXIgbGFzdCBzY2FuLiAgQSByZXNjYW4gaXMgcmVxdWlyZWQKYmVmb3JlIGNvbW1pdHRpbmcuCn0KCQl1bmxvY2tfaW5kZXgKCQl1cGRhdGVfc3RhdHVzCgkJcmV0dXJuCgl9CgoJIyAtLSBBdCBsZWFzdCBvbmUgZmlsZSBzaG91bGQgZGlmZmVyIGluIHRoZSBpbmRleC4KCSMKCXNldCBmaWxlc19yZWFkeSAwCglmb3JlYWNoIHBhdGggW2FycmF5IG5hbWVzIGZpbGVfc3RhdGVzXSB7CgkJc2V0IHMgJGZpbGVfc3RhdGVzKCRwYXRoKQoJCXN3aXRjaCAtZ2xvYiAtLSBbbGluZGV4ICRzIDBdIHsKCQlfPyB7Y29udGludWV9CgkJQT8gLQoJCUQ/IC0KCQlNPyB7c2V0IGZpbGVzX3JlYWR5IDE7IGJyZWFrfQoJCVU/IHsKCQkJZXJyb3JfcG9wdXAgIlVubWVyZ2VkIGZpbGVzIGNhbm5vdCBiZSBjb21taXR0ZWQuCgpGaWxlIFtzaG9ydF9wYXRoICRwYXRoXSBoYXMgbWVyZ2UgY29uZmxpY3RzLgpZb3UgbXVzdCByZXNvbHZlIHRoZW0gYW5kIGluY2x1ZGUgdGhlIGZpbGUgYmVmb3JlIGNvbW1pdHRpbmcuCiIKCQkJdW5sb2NrX2luZGV4CgkJCXJldHVybgoJCX0KCQlkZWZhdWx0IHsKCQkJZXJyb3JfcG9wdXAgIlVua25vd24gZmlsZSBzdGF0ZSBbbGluZGV4ICRzIDBdIGRldGVjdGVkLgoKRmlsZSBbc2hvcnRfcGF0aCAkcGF0aF0gY2Fubm90IGJlIGNvbW1pdHRlZCBieSB0aGlzIHByb2dyYW0uCiIKCQl9CgkJfQoJfQoJaWYgeyEkZmlsZXNfcmVhZHl9IHsKCQllcnJvcl9wb3B1cCB7Tm8gaW5jbHVkZWQgZmlsZXMgdG8gY29tbWl0LgoKWW91IG11c3QgaW5jbHVkZSBhdCBsZWFzdCAxIGZpbGUgYmVmb3JlIHlvdSBjYW4gY29tbWl0Lgp9CgkJdW5sb2NrX2luZGV4CgkJcmV0dXJuCgl9CgoJIyAtLSBBIG1lc3NhZ2UgaXMgcmVxdWlyZWQuCgkjCglzZXQgbXNnIFtzdHJpbmcgdHJpbSBbJHVpX2NvbW0gZ2V0IDEuMCBlbmRdXQoJaWYgeyRtc2cgZXEge319IHsKCQllcnJvcl9wb3B1cCB7UGxlYXNlIHN1cHBseSBhIGNvbW1pdCBtZXNzYWdlLgoKQSBnb29kIGNvbW1pdCBtZXNzYWdlIGhhcyB0aGUgZm9sbG93aW5nIGZvcm1hdDoKCi0gRmlyc3QgbGluZTogRGVzY3JpYmUgaW4gb25lIHNlbnRhbmNlIHdoYXQgeW91IGRpZC4KLSBTZWNvbmQgbGluZTogQmxhbmsKLSBSZW1haW5pbmcgbGluZXM6IERlc2NyaWJlIHdoeSB0aGlzIGNoYW5nZSBpcyBnb29kLgp9CgkJdW5sb2NrX2luZGV4CgkJcmV0dXJuCgl9CgoJIyAtLSBBc2sgdGhlIHByZS1jb21taXQgaG9vayBmb3IgdGhlIGdvLWFoZWFkLgoJIwoJc2V0IHBjaG9vayBbZmlsZSBqb2luICRnaXRkaXIgaG9va3MgcHJlLWNvbW1pdF0KCWlmIHskdGNsX3BsYXRmb3JtKHBsYXRmb3JtKSBlcSB7d2luZG93c30gJiYgW2ZpbGUgaXNmaWxlICRwY2hvb2tdfSB7CgkJc2V0IHBjaG9vayBbbGlzdCBzaCAtYyBbY29uY2F0IFwKCQkJImlmIHRlc3QgLXggXCIkcGNob29rXCI7IiBcCgkJCSJ0aGVuIGV4ZWMgXCIkcGNob29rXCIgMj4mMTsiIFwKCQkJImZpIl1dCgl9IGVsc2VpZiB7W2ZpbGUgZXhlY3V0YWJsZSAkcGNob29rXX0gewoJCXNldCBwY2hvb2sgW2xpc3QgJHBjaG9vayB8JiBjYXRdCgl9IGVsc2UgewoJCXNldCBwY2hvb2sge30KCX0KCWlmIHskcGNob29rIG5lIHt9fSB7CgkJc2V0IHVpX3N0YXR1c192YWx1ZSB7Q2FsbGluZyBwcmUtY29tbWl0IGhvb2suLi59CgkJc2V0IHBjaF9lcnJvciB7fQoJCXNldCBmZF9waCBbb3BlbiAifCAkcGNob29rIiByXQoJCWZjb25maWd1cmUgJGZkX3BoIC1ibG9ja2luZyAwIC10cmFuc2xhdGlvbiBiaW5hcnkKCQlmaWxlZXZlbnQgJGZkX3BoIHJlYWRhYmxlIFwKCQkJW2xpc3QgY29tbWl0X3N0YWdlMSAkZmRfcGggJGN1ckhFQUQgJG1zZ10KCX0gZWxzZSB7CgkJY29tbWl0X3N0YWdlMiAkY3VySEVBRCAkbXNnCgl9Cn0KCnByb2MgY29tbWl0X3N0YWdlMSB7ZmRfcGggY3VySEVBRCBtc2d9IHsKCWdsb2JhbCBwY2hfZXJyb3IgdWlfc3RhdHVzX3ZhbHVlCgoJYXBwZW5kIHBjaF9lcnJvciBbcmVhZCAkZmRfcGhdCglmY29uZmlndXJlICRmZF9waCAtYmxvY2tpbmcgMQoJaWYge1tlb2YgJGZkX3BoXX0gewoJCWlmIHtbY2F0Y2gge2Nsb3NlICRmZF9waH1dfSB7CgkJCXNldCB1aV9zdGF0dXNfdmFsdWUge0NvbW1pdCBkZWNsaW5lZCBieSBwcmUtY29tbWl0IGhvb2sufQoJCQlob29rX2ZhaWxlZF9wb3B1cCBwcmUtY29tbWl0ICRwY2hfZXJyb3IKCQkJdW5sb2NrX2luZGV4CgkJfSBlbHNlIHsKCQkJY29tbWl0X3N0YWdlMiAkY3VySEVBRCAkbXNnCgkJfQoJCXNldCBwY2hfZXJyb3Ige30KCX0gZWxzZSB7CgkJZmNvbmZpZ3VyZSAkZmRfcGggLWJsb2NraW5nIDAKCX0KfQoKcHJvYyBjb21taXRfc3RhZ2UyIHtjdXJIRUFEIG1zZ30gewoJZ2xvYmFsIHVpX3N0YXR1c192YWx1ZQoKCSMgLS0gV3JpdGUgdGhlIHRyZWUgaW4gdGhlIGJhY2tncm91bmQuCgkjCglzZXQgdWlfc3RhdHVzX3ZhbHVlIHtDb21taXR0aW5nIGNoYW5nZXMuLi59CglzZXQgZmRfd3QgW29wZW4gInwgZ2l0IHdyaXRlLXRyZWUiIHJdCglmaWxlZXZlbnQgJGZkX3d0IHJlYWRhYmxlIFtsaXN0IGNvbW1pdF9zdGFnZTMgJGZkX3d0ICRjdXJIRUFEICRtc2ddCn0KCnByb2MgY29tbWl0X3N0YWdlMyB7ZmRfd3QgY3VySEVBRCBtc2d9IHsKCWdsb2JhbCBzaW5nbGVfY29tbWl0IGdpdGRpciBIRUFEIFBBUkVOVCBjb21taXRfdHlwZSB0Y2xfcGxhdGZvcm0KCWdsb2JhbCB1aV9zdGF0dXNfdmFsdWUgdWlfY29tbQoJZ2xvYmFsIGZpbGVfc3RhdGVzCgoJZ2V0cyAkZmRfd3QgdHJlZV9pZAoJaWYgeyR0cmVlX2lkIGVxIHt9IHx8IFtjYXRjaCB7Y2xvc2UgJGZkX3d0fSBlcnJdfSB7CgkJZXJyb3JfcG9wdXAgIndyaXRlLXRyZWUgZmFpbGVkOlxuXG4kZXJyIgoJCXNldCB1aV9zdGF0dXNfdmFsdWUge0NvbW1pdCBmYWlsZWQufQoJCXVubG9ja19pbmRleAoJCXJldHVybgoJfQoKCSMgLS0gQ3JlYXRlIHRoZSBjb21taXQuCgkjCglzZXQgY21kIFtsaXN0IGdpdCBjb21taXQtdHJlZSAkdHJlZV9pZF0KCWlmIHskUEFSRU5UIG5lIHt9fSB7CgkJbGFwcGVuZCBjbWQgLXAgJFBBUkVOVAoJfQoJaWYgeyRjb21taXRfdHlwZSBlcSB7bWVyZ2V9fSB7CgkJaWYge1tjYXRjaCB7CgkJCQlzZXQgZmRfbWggW29wZW4gW2ZpbGUgam9pbiAkZ2l0ZGlyIE1FUkdFX0hFQURdIHJdCgkJCQl3aGlsZSB7W2dldHMgJGZkX21oIG1lcmdlX2hlYWRdID49IDB9IHsKCQkJCQlsYXBwZW5kIGNtZCAtcCAkbWVyZ2VfaGVhZAoJCQkJfQoJCQkJY2xvc2UgJGZkX21oCgkJCX0gZXJyXX0gewoJCQllcnJvcl9wb3B1cCAiTG9hZGluZyBNRVJHRV9IRUFEIGZhaWxlZDpcblxuJGVyciIKCQkJc2V0IHVpX3N0YXR1c192YWx1ZSB7Q29tbWl0IGZhaWxlZC59CgkJCXVubG9ja19pbmRleAoJCQlyZXR1cm4KCQl9Cgl9CglpZiB7JFBBUkVOVCBlcSB7fX0gewoJCSMgZ2l0IGNvbW1pdC10cmVlIHdyaXRlcyB0byBzdGRlcnIgZHVyaW5nIGluaXRpYWwgY29tbWl0LgoJCWxhcHBlbmQgY21kIDI+L2Rldi9udWxsCgl9CglsYXBwZW5kIGNtZCA8PCAkbXNnCglpZiB7W2NhdGNoIHtzZXQgY210X2lkIFtldmFsIGV4ZWMgJGNtZF19IGVycl19IHsKCQllcnJvcl9wb3B1cCAiY29tbWl0LXRyZWUgZmFpbGVkOlxuXG4kZXJyIgoJCXNldCB1aV9zdGF0dXNfdmFsdWUge0NvbW1pdCBmYWlsZWQufQoJCXVubG9ja19pbmRleAoJCXJldHVybgoJfQoKCSMgLS0gVXBkYXRlIHRoZSBIRUFEIHJlZi4KCSMKCXNldCByZWZsb2dtIGNvbW1pdAoJaWYgeyRjb21taXRfdHlwZSBuZSB7bm9ybWFsfX0gewoJCWFwcGVuZCByZWZsb2dtICIgKCRjb21taXRfdHlwZSkiCgl9CglzZXQgaSBbc3RyaW5nIGZpcnN0ICJcbiIgJG1zZ10KCWlmIHskaSA+PSAwfSB7CgkJYXBwZW5kIHJlZmxvZ20gezogfSBbc3RyaW5nIHJhbmdlICRtc2cgMCBbZXhwciAkaSAtIDFdXQoJfSBlbHNlIHsKCQlhcHBlbmQgcmVmbG9nbSB7OiB9ICRtc2cKCX0KCXNldCBjbWQgW2xpc3QgZ2l0IHVwZGF0ZS1yZWYgLW0gJHJlZmxvZ20gSEVBRCAkY210X2lkICRjdXJIRUFEXQoJaWYge1tjYXRjaCB7ZXZhbCBleGVjICRjbWR9IGVycl19IHsKCQllcnJvcl9wb3B1cCAidXBkYXRlLXJlZiBmYWlsZWQ6XG5cbiRlcnIiCgkJc2V0IHVpX3N0YXR1c192YWx1ZSB7Q29tbWl0IGZhaWxlZC59CgkJdW5sb2NrX2luZGV4CgkJcmV0dXJuCgl9CgoJIyAtLSBDbGVhbnVwIGFmdGVyIG91cnNlbHZlcy4KCSMKCWNhdGNoIHtmaWxlIGRlbGV0ZSBbZmlsZSBqb2luICRnaXRkaXIgTUVSR0VfSEVBRF19CgljYXRjaCB7ZmlsZSBkZWxldGUgW2ZpbGUgam9pbiAkZ2l0ZGlyIE1FUkdFX01TR119CgljYXRjaCB7ZmlsZSBkZWxldGUgW2ZpbGUgam9pbiAkZ2l0ZGlyIFNRVUFTSF9NU0ddfQoJY2F0Y2gge2ZpbGUgZGVsZXRlIFtmaWxlIGpvaW4gJGdpdGRpciBHSVRHVUlfTVNHXX0KCgkjIC0tIExldCByZXJlcmUgZG8gaXRzIHRoaW5nLgoJIwoJaWYge1tmaWxlIGlzZGlyZWN0b3J5IFtmaWxlIGpvaW4gJGdpdGRpciByci1jYWNoZV1dfSB7CgkJY2F0Y2gge2V4ZWMgZ2l0IHJlcmVyZX0KCX0KCgkjIC0tIFJ1biB0aGUgcG9zdC1jb21taXQgaG9vay4KCSMKCXNldCBwY2hvb2sgW2ZpbGUgam9pbiAkZ2l0ZGlyIGhvb2tzIHBvc3QtY29tbWl0XQoJaWYgeyR0Y2xfcGxhdGZvcm0ocGxhdGZvcm0pIGVxIHt3aW5kb3dzfSAmJiBbZmlsZSBpc2ZpbGUgJHBjaG9va119IHsKCQlzZXQgcGNob29rIFtsaXN0IHNoIC1jIFtjb25jYXQgXAoJCQkiaWYgdGVzdCAteCBcIiRwY2hvb2tcIjsiIFwKCQkJInRoZW4gZXhlYyBcIiRwY2hvb2tcIjsiIFwKCQkJImZpIl1dCgl9IGVsc2VpZiB7IVtmaWxlIGV4ZWN1dGFibGUgJHBjaG9va119IHsKCQlzZXQgcGNob29rIHt9Cgl9CglpZiB7JHBjaG9vayBuZSB7fX0gewoJCWNhdGNoIHtleGVjICRwY2hvb2sgJn0KCX0KCgkkdWlfY29tbSBkZWxldGUgMC4wIGVuZAoJJHVpX2NvbW0gZWRpdCBtb2RpZmllZCBmYWxzZQoJJHVpX2NvbW0gZWRpdCByZXNldAoKCWlmIHskc2luZ2xlX2NvbW1pdH0gZG9fcXVpdAoKCSMgLS0gVXBkYXRlIHN0YXR1cyB3aXRob3V0IGludm9raW5nIGFueSBnaXQgY29tbWFuZHMuCgkjCglzZXQgY29tbWl0X3R5cGUgbm9ybWFsCglzZXQgSEVBRCAkY210X2lkCglzZXQgUEFSRU5UICRjbXRfaWQKCglmb3JlYWNoIHBhdGggW2FycmF5IG5hbWVzIGZpbGVfc3RhdGVzXSB7CgkJc2V0IHMgJGZpbGVfc3RhdGVzKCRwYXRoKQoJCXNldCBtIFtsaW5kZXggJHMgMF0KCQlzd2l0Y2ggLWdsb2IgLS0gJG0gewoJCUE/IC0KCQlNPyAtCgkJRD8ge3NldCBtIF9bc3RyaW5nIGluZGV4ICRtIDFdfQoJCX0KCgkJaWYgeyRtIGVxIHtfX319IHsKCQkJdW5zZXQgZmlsZV9zdGF0ZXMoJHBhdGgpCgkJfSBlbHNlIHsKCQkJbHNldCBmaWxlX3N0YXRlcygkcGF0aCkgMCAkbQoJCX0KCX0KCglkaXNwbGF5X2FsbF9maWxlcwoJdW5sb2NrX2luZGV4CglyZXNob3dfZGlmZgoJc2V0IHVpX3N0YXR1c192YWx1ZSBcCgkJIkNoYW5nZXMgY29tbWl0dGVkIGFzIFtzdHJpbmcgcmFuZ2UgJGNtdF9pZCAwIDddLiIKfQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIwojIyBmZXRjaCBwdWxsIHB1c2gKCnByb2MgZmV0Y2hfZnJvbSB7cmVtb3RlfSB7CglzZXQgdyBbbmV3X2NvbnNvbGUgImZldGNoICRyZW1vdGUiIFwKCQkiRmV0Y2hpbmcgbmV3IGNoYW5nZXMgZnJvbSAkcmVtb3RlIl0KCXNldCBjbWQgW2xpc3QgZ2l0IGZldGNoXQoJbGFwcGVuZCBjbWQgJHJlbW90ZQoJY29uc29sZV9leGVjICR3ICRjbWQKfQoKcHJvYyBwdWxsX3JlbW90ZSB7cmVtb3RlIGJyYW5jaH0gewoJZ2xvYmFsIEhFQUQgY29tbWl0X3R5cGUgZmlsZV9zdGF0ZXMgcmVwb19jb25maWcKCglpZiB7IVtsb2NrX2luZGV4IHVwZGF0ZV19IHJldHVybgoKCSMgLS0gT3VyIGluIG1lbW9yeSBzdGF0ZSBzaG91bGQgbWF0Y2ggdGhlIHJlcG9zaXRvcnkuCgkjCglyZXBvc2l0b3J5X3N0YXRlIGN1ckhFQUQgY3VyX3R5cGUKCWlmIHskY29tbWl0X3R5cGUgbmUgJGN1cl90eXBlIHx8ICRIRUFEIG5lICRjdXJIRUFEfSB7CgkJZXJyb3JfcG9wdXAge0xhc3Qgc2Nhbm5lZCBzdGF0ZSBkb2VzIG5vdCBtYXRjaCByZXBvc2l0b3J5IHN0YXRlLgoKSXRzIGhpZ2hseSBsaWtlbHkgdGhhdCBhbm90aGVyIEdpdCBwcm9ncmFtIG1vZGlmaWVkIHRoZQpyZXBvc2l0b3J5IHNpbmNlIG91ciBsYXN0IHNjYW4uICBBIHJlc2NhbiBpcyByZXF1aXJlZApiZWZvcmUgYSBwdWxsIGNhbiBiZSBzdGFydGVkLgp9CgkJdW5sb2NrX2luZGV4CgkJdXBkYXRlX3N0YXR1cwoJCXJldHVybgoJfQoKCSMgLS0gTm8gZGlmZmVyZW5jZXMgc2hvdWxkIGV4aXN0IGJlZm9yZSBhIHB1bGwuCgkjCglpZiB7W2FycmF5IHNpemUgZmlsZV9zdGF0ZXNdICE9IDB9IHsKCQllcnJvcl9wb3B1cCB7VW5jb21taXR0ZWQgYnV0IG1vZGlmaWVkIGZpbGVzIGFyZSBwcmVzZW50LgoKWW91IHNob3VsZCBub3QgcGVyZm9ybSBhIHB1bGwgd2l0aCB1bm1vZGlmaWVkIGZpbGVzIGluIHlvdXIgd29ya2luZwpkaXJlY3RvcnkgYXMgR2l0IHdvdWxkIGJlIHVuYWJsZSB0byByZWNvdmVyIGZyb20gYW4gaW5jb3JyZWN0IG1lcmdlLgoKQ29tbWl0IG9yIHRocm93IGF3YXkgYWxsIGNoYW5nZXMgYmVmb3JlIHN0YXJ0aW5nIGEgcHVsbCBvcGVyYXRpb24uCn0KCQl1bmxvY2tfaW5kZXgKCQlyZXR1cm4KCX0KCglzZXQgdyBbbmV3X2NvbnNvbGUgInB1bGwgJHJlbW90ZSAkYnJhbmNoIiBcCgkJIlB1bGxpbmcgbmV3IGNoYW5nZXMgZnJvbSBicmFuY2ggJGJyYW5jaCBpbiAkcmVtb3RlIl0KCXNldCBjbWQgW2xpc3QgZ2l0IHB1bGxdCglpZiB7JHJlcG9fY29uZmlnKGd1aS5wdWxsc3VtbWFyeSkgZXEge2ZhbHNlfX0gewoJCWxhcHBlbmQgY21kIC0tbm8tc3VtbWFyeQoJfQoJbGFwcGVuZCBjbWQgJHJlbW90ZQoJbGFwcGVuZCBjbWQgJGJyYW5jaAoJY29uc29sZV9leGVjICR3ICRjbWQgW2xpc3QgcG9zdF9wdWxsX3JlbW90ZSAkcmVtb3RlICRicmFuY2hdCn0KCnByb2MgcG9zdF9wdWxsX3JlbW90ZSB7cmVtb3RlIGJyYW5jaCBzdWNjZXNzfSB7CglnbG9iYWwgSEVBRCBQQVJFTlQgY29tbWl0X3R5cGUKCWdsb2JhbCB1aV9zdGF0dXNfdmFsdWUKCgl1bmxvY2tfaW5kZXgKCWlmIHskc3VjY2Vzc30gewoJCXJlcG9zaXRvcnlfc3RhdGUgSEVBRCBjb21taXRfdHlwZQoJCXNldCBQQVJFTlQgJEhFQUQKCQlzZXQgJHVpX3N0YXR1c192YWx1ZSB7UmVhZHkufQoJfSBlbHNlIHsKCQl1cGRhdGVfc3RhdHVzIFwKCQkJIkNvbmZsaWN0cyBkZXRlY3RlZCB3aGlsZSBwdWxsaW5nICRicmFuY2ggZnJvbSAkcmVtb3RlLiIKCX0KfQoKcHJvYyBwdXNoX3RvIHtyZW1vdGV9IHsKCXNldCB3IFtuZXdfY29uc29sZSAicHVzaCAkcmVtb3RlIiBcCgkJIlB1c2hpbmcgY2hhbmdlcyB0byAkcmVtb3RlIl0KCXNldCBjbWQgW2xpc3QgZ2l0IHB1c2hdCglsYXBwZW5kIGNtZCAkcmVtb3RlCgljb25zb2xlX2V4ZWMgJHcgJGNtZAp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjCiMjIHVpIGhlbHBlcnMKCnByb2MgbWFwY29sIHtzdGF0ZSBwYXRofSB7CglnbG9iYWwgYWxsX2NvbHMgdWlfb3RoZXIKCglpZiB7W2NhdGNoIHtzZXQgciAkYWxsX2NvbHMoJHN0YXRlKX1dfSB7CgkJcHV0cyAiZXJyb3I6IG5vIGNvbHVtbiBmb3Igc3RhdGU9eyRzdGF0ZX0gJHBhdGgiCgkJcmV0dXJuICR1aV9vdGhlcgoJfQoJcmV0dXJuICRyCn0KCnByb2MgbWFwaWNvbiB7c3RhdGUgcGF0aH0gewoJZ2xvYmFsIGFsbF9pY29ucwoKCWlmIHtbY2F0Y2gge3NldCByICRhbGxfaWNvbnMoJHN0YXRlKX1dfSB7CgkJcHV0cyAiZXJyb3I6IG5vIGljb24gZm9yIHN0YXRlPXskc3RhdGV9ICRwYXRoIgoJCXJldHVybiBmaWxlX3BsYWluCgl9CglyZXR1cm4gJHIKfQoKcHJvYyBtYXBkZXNjIHtzdGF0ZSBwYXRofSB7CglnbG9iYWwgYWxsX2Rlc2NzCgoJaWYge1tjYXRjaCB7c2V0IHIgJGFsbF9kZXNjcygkc3RhdGUpfV19IHsKCQlwdXRzICJlcnJvcjogbm8gZGVzYyBmb3Igc3RhdGU9eyRzdGF0ZX0gJHBhdGgiCgkJcmV0dXJuICRzdGF0ZQoJfQoJcmV0dXJuICRyCn0KCnByb2MgZXNjYXBlX3BhdGgge3BhdGh9IHsKCXJlZ3N1YiAtYWxsICJcbiIgJHBhdGggIlxcbiIgcGF0aAoJcmV0dXJuICRwYXRoCn0KCnByb2Mgc2hvcnRfcGF0aCB7cGF0aH0gewoJcmV0dXJuIFtlc2NhcGVfcGF0aCBbbGluZGV4IFtmaWxlIHNwbGl0ICRwYXRoXSBlbmRdXQp9CgpzZXQgbmV4dF9pY29uX2lkIDAKCnByb2MgbWVyZ2Vfc3RhdGUge3BhdGggbmV3X3N0YXRlfSB7CglnbG9iYWwgZmlsZV9zdGF0ZXMgbmV4dF9pY29uX2lkCgoJc2V0IHMwIFtzdHJpbmcgaW5kZXggJG5ld19zdGF0ZSAwXQoJc2V0IHMxIFtzdHJpbmcgaW5kZXggJG5ld19zdGF0ZSAxXQoKCWlmIHtbY2F0Y2gge3NldCBpbmZvICRmaWxlX3N0YXRlcygkcGF0aCl9XX0gewoJCXNldCBzdGF0ZSBfXwoJCXNldCBpY29uIG5baW5jciBuZXh0X2ljb25faWRdCgl9IGVsc2UgewoJCXNldCBzdGF0ZSBbbGluZGV4ICRpbmZvIDBdCgkJc2V0IGljb24gW2xpbmRleCAkaW5mbyAxXQoJfQoKCWlmIHskczAgZXEge199fSB7CgkJc2V0IHMwIFtzdHJpbmcgaW5kZXggJHN0YXRlIDBdCgl9IGVsc2VpZiB7JHMwIGVxIHsqfX0gewoJCXNldCBzMCBfCgl9CgoJaWYgeyRzMSBlcSB7X319IHsKCQlzZXQgczEgW3N0cmluZyBpbmRleCAkc3RhdGUgMV0KCX0gZWxzZWlmIHskczEgZXEgeyp9fSB7CgkJc2V0IHMxIF8KCX0KCglzZXQgZmlsZV9zdGF0ZXMoJHBhdGgpIFtsaXN0ICRzMCRzMSAkaWNvbl0KCXJldHVybiAkc3RhdGUKfQoKcHJvYyBkaXNwbGF5X2ZpbGUge3BhdGggc3RhdGV9IHsKCWdsb2JhbCBmaWxlX3N0YXRlcyBmaWxlX2xpc3RzIHN0YXR1c19hY3RpdmUKCglzZXQgb2xkX20gW21lcmdlX3N0YXRlICRwYXRoICRzdGF0ZV0KCWlmIHskc3RhdHVzX2FjdGl2ZX0gcmV0dXJuCgoJc2V0IHMgJGZpbGVfc3RhdGVzKCRwYXRoKQoJc2V0IG5ld19tIFtsaW5kZXggJHMgMF0KCXNldCBuZXdfdyBbbWFwY29sICRuZXdfbSAkcGF0aF0gCglzZXQgb2xkX3cgW21hcGNvbCAkb2xkX20gJHBhdGhdCglzZXQgbmV3X2ljb24gW21hcGljb24gJG5ld19tICRwYXRoXQoKCWlmIHskbmV3X3cgbmUgJG9sZF93fSB7CgkJc2V0IGxubyBbbHNlYXJjaCAtc29ydGVkICRmaWxlX2xpc3RzKCRvbGRfdykgJHBhdGhdCgkJaWYgeyRsbm8gPj0gMH0gewoJCQlpbmNyIGxubwoJCQkkb2xkX3cgY29uZiAtc3RhdGUgbm9ybWFsCgkJCSRvbGRfdyBkZWxldGUgJGxuby4wIFtleHByICRsbm8gKyAxXS4wCgkJCSRvbGRfdyBjb25mIC1zdGF0ZSBkaXNhYmxlZAoJCX0KCgkJbGFwcGVuZCBmaWxlX2xpc3RzKCRuZXdfdykgJHBhdGgKCQlzZXQgZmlsZV9saXN0cygkbmV3X3cpIFtsc29ydCAkZmlsZV9saXN0cygkbmV3X3cpXQoJCXNldCBsbm8gW2xzZWFyY2ggLXNvcnRlZCAkZmlsZV9saXN0cygkbmV3X3cpICRwYXRoXQoJCWluY3IgbG5vCgkJJG5ld193IGNvbmYgLXN0YXRlIG5vcm1hbAoJCSRuZXdfdyBpbWFnZSBjcmVhdGUgJGxuby4wIFwKCQkJLWFsaWduIGNlbnRlciAtcGFkeCA1IC1wYWR5IDEgXAoJCQktbmFtZSBbbGluZGV4ICRzIDFdIFwKCQkJLWltYWdlICRuZXdfaWNvbgoJCSRuZXdfdyBpbnNlcnQgJGxuby4xICJbZXNjYXBlX3BhdGggJHBhdGhdXG4iCgkJJG5ld193IGNvbmYgLXN0YXRlIGRpc2FibGVkCgl9IGVsc2VpZiB7JG5ld19pY29uIG5lIFttYXBpY29uICRvbGRfbSAkcGF0aF19IHsKCQkkbmV3X3cgY29uZiAtc3RhdGUgbm9ybWFsCgkJJG5ld193IGltYWdlIGNvbmYgW2xpbmRleCAkcyAxXSAtaW1hZ2UgJG5ld19pY29uCgkJJG5ld193IGNvbmYgLXN0YXRlIGRpc2FibGVkCgl9Cn0KCnByb2MgZGlzcGxheV9hbGxfZmlsZXMge30gewoJZ2xvYmFsIHVpX2luZGV4IHVpX290aGVyIGZpbGVfc3RhdGVzIGZpbGVfbGlzdHMKCgkkdWlfaW5kZXggY29uZiAtc3RhdGUgbm9ybWFsCgkkdWlfb3RoZXIgY29uZiAtc3RhdGUgbm9ybWFsCgoJJHVpX2luZGV4IGRlbGV0ZSAwLjAgZW5kCgkkdWlfb3RoZXIgZGVsZXRlIDAuMCBlbmQKCglzZXQgZmlsZV9saXN0cygkdWlfaW5kZXgpIFtsaXN0XQoJc2V0IGZpbGVfbGlzdHMoJHVpX290aGVyKSBbbGlzdF0KCglmb3JlYWNoIHBhdGggW2xzb3J0IFthcnJheSBuYW1lcyBmaWxlX3N0YXRlc11dIHsKCQlzZXQgcyAkZmlsZV9zdGF0ZXMoJHBhdGgpCgkJc2V0IG0gW2xpbmRleCAkcyAwXQoJCXNldCB3IFttYXBjb2wgJG0gJHBhdGhdCgkJbGFwcGVuZCBmaWxlX2xpc3RzKCR3KSAkcGF0aAoJCSR3IGltYWdlIGNyZWF0ZSBlbmQgXAoJCQktYWxpZ24gY2VudGVyIC1wYWR4IDUgLXBhZHkgMSBcCgkJCS1uYW1lIFtsaW5kZXggJHMgMV0gXAoJCQktaW1hZ2UgW21hcGljb24gJG0gJHBhdGhdCgkJJHcgaW5zZXJ0IGVuZCAiW2VzY2FwZV9wYXRoICRwYXRoXVxuIgoJfQoKCSR1aV9pbmRleCBjb25mIC1zdGF0ZSBkaXNhYmxlZAoJJHVpX290aGVyIGNvbmYgLXN0YXRlIGRpc2FibGVkCn0KCnByb2MgdXBkYXRlX2luZGV4IHtwYXRoTGlzdH0gewoJZ2xvYmFsIHVwZGF0ZV9pbmRleF9jcCB1cGRhdGVfaW5kZXhfcnNkIHVpX3N0YXR1c192YWx1ZQoKCWlmIHshW2xvY2tfaW5kZXggdXBkYXRlXX0gcmV0dXJuCgoJc2V0IHVwZGF0ZV9pbmRleF9jcCAwCglzZXQgdXBkYXRlX2luZGV4X3JzZCAwCglzZXQgcGF0aExpc3QgW2xzb3J0ICRwYXRoTGlzdF0KCXNldCB0b3RhbENudCBbbGxlbmd0aCAkcGF0aExpc3RdCglzZXQgYmF0Y2ggW2V4cHIge2ludCgkdG90YWxDbnQgKiAuMDEpICsgMX1dCglpZiB7JGJhdGNoID4gMjV9IHtzZXQgYmF0Y2ggMjV9CgoJc2V0IHVpX3N0YXR1c192YWx1ZSAiSW5jbHVkaW5nIGZpbGVzIC4uLiAwLyR0b3RhbENudCAwJSIKCXNldCB1aV9zdGF0dXNfdmFsdWUgW2Zvcm1hdCBcCgkJIkluY2x1ZGluZyBmaWxlcyAuLi4gJWkvJWkgZmlsZXMgKCUuMmYlJSkiIFwKCQkkdXBkYXRlX2luZGV4X2NwIFwKCQkkdG90YWxDbnQgXAoJCTAuMF0KCXNldCBmZCBbb3BlbiAifCBnaXQgdXBkYXRlLWluZGV4IC0tYWRkIC0tcmVtb3ZlIC16IC0tc3RkaW4iIHddCglmY29uZmlndXJlICRmZCBcCgkJLWJsb2NraW5nIDAgXAoJCS1idWZmZXJpbmcgZnVsbCBcCgkJLWJ1ZmZlcnNpemUgNTEyIFwKCQktdHJhbnNsYXRpb24gYmluYXJ5CglmaWxlZXZlbnQgJGZkIHdyaXRhYmxlIFtsaXN0IFwKCQl3cml0ZV91cGRhdGVfaW5kZXggXAoJCSRmZCBcCgkJJHBhdGhMaXN0IFwKCQkkdG90YWxDbnQgXAoJCSRiYXRjaCBcCgkJXQp9Cgpwcm9jIHdyaXRlX3VwZGF0ZV9pbmRleCB7ZmQgcGF0aExpc3QgdG90YWxDbnQgYmF0Y2h9IHsKCWdsb2JhbCB1cGRhdGVfaW5kZXhfY3AgdXBkYXRlX2luZGV4X3JzZCB1aV9zdGF0dXNfdmFsdWUKCWdsb2JhbCBmaWxlX3N0YXRlcyB1aV9mbmFtZV92YWx1ZQoKCWlmIHskdXBkYXRlX2luZGV4X2NwID49ICR0b3RhbENudH0gewoJCWNsb3NlICRmZAoJCXVubG9ja19pbmRleAoJCWlmIHskdXBkYXRlX2luZGV4X3JzZH0gewoJCQlyZXNob3dfZGlmZgoJCX0gZWxzZSB7CgkJCXNldCB1aV9zdGF0dXNfdmFsdWUge1JlYWR5Ln0KCQl9CgkJcmV0dXJuCgl9CgoJZm9yIHtzZXQgaSAkYmF0Y2h9IFwKCQl7JHVwZGF0ZV9pbmRleF9jcCA8ICR0b3RhbENudCAmJiAkaSA+IDB9IFwKCQl7aW5jciBpIC0xfSB7CgkJc2V0IHBhdGggW2xpbmRleCAkcGF0aExpc3QgJHVwZGF0ZV9pbmRleF9jcF0KCQlpbmNyIHVwZGF0ZV9pbmRleF9jcAoKCQlzd2l0Y2ggLS0gW2xpbmRleCAkZmlsZV9zdGF0ZXMoJHBhdGgpIDBdIHsKCQlBTSAtCgkJX08ge3NldCBuZXcgQSp9CgkJX00gLQoJCU1NIHtzZXQgbmV3IE0qfQoJCUFEIC0KCQlfRCB7c2V0IG5ldyBEKn0KCQlkZWZhdWx0IHtjb250aW51ZX0KCQl9CgoJCXB1dHMgLW5vbmV3bGluZSAkZmQgJHBhdGgKCQlwdXRzIC1ub25ld2xpbmUgJGZkICJcMCIKCQlkaXNwbGF5X2ZpbGUgJHBhdGggJG5ldwoJCWlmIHskdWlfZm5hbWVfdmFsdWUgZXEgJHBhdGh9IHsKCQkJc2V0IHVwZGF0ZV9pbmRleF9yc2QgMQoJCX0KCX0KCglzZXQgdWlfc3RhdHVzX3ZhbHVlIFtmb3JtYXQgXAoJCSJJbmNsdWRpbmcgZmlsZXMgLi4uICVpLyVpIGZpbGVzICglLjJmJSUpIiBcCgkJJHVwZGF0ZV9pbmRleF9jcCBcCgkJJHRvdGFsQ250IFwKCQlbZXhwciB7MTAwLjAgKiAkdXBkYXRlX2luZGV4X2NwIC8gJHRvdGFsQ250fV1dCn0KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMKIyMgcmVtb3RlIG1hbmFnZW1lbnQKCnByb2MgbG9hZF9hbGxfcmVtb3RlcyB7fSB7CglnbG9iYWwgZ2l0ZGlyIGFsbF9yZW1vdGVzIHJlcG9fY29uZmlnCgoJc2V0IGFsbF9yZW1vdGVzIFtsaXN0XQoJc2V0IHJtX2RpciBbZmlsZSBqb2luICRnaXRkaXIgcmVtb3Rlc10KCWlmIHtbZmlsZSBpc2RpcmVjdG9yeSAkcm1fZGlyXX0gewoJCXNldCBhbGxfcmVtb3RlcyBbY29uY2F0ICRhbGxfcmVtb3RlcyBbZ2xvYiBcCgkJCS10eXBlcyBmIFwKCQkJLXRhaWxzIFwKCQkJLW5vY29tcGxhaW4gXAoJCQktZGlyZWN0b3J5ICRybV9kaXIgKl1dCgl9CgoJZm9yZWFjaCBsaW5lIFthcnJheSBuYW1lcyByZXBvX2NvbmZpZyByZW1vdGUuKi51cmxdIHsKCQlpZiB7W3JlZ2V4cCBecmVtb3RlXC4oLiopXC51cmxcJCAkbGluZSBsaW5lIG5hbWVdfSB7CgkJCWxhcHBlbmQgYWxsX3JlbW90ZXMgJG5hbWUKCQl9Cgl9CgoJc2V0IGFsbF9yZW1vdGVzIFtsc29ydCAtdW5pcXVlICRhbGxfcmVtb3Rlc10KfQoKcHJvYyBwb3B1bGF0ZV9yZW1vdGVfbWVudSB7bSBwZnggb3B9IHsKCWdsb2JhbCBhbGxfcmVtb3RlcwoKCWZvcmVhY2ggcmVtb3RlICRhbGxfcmVtb3RlcyB7CgkJJG0gYWRkIGNvbW1hbmQgLWxhYmVsICIkcGZ4ICRyZW1vdGUuLi4iIFwKCQkJLWNvbW1hbmQgW2xpc3QgJG9wICRyZW1vdGVdIFwKCQkJLWZvbnQgZm9udF91aQoJfQp9Cgpwcm9jIHBvcHVsYXRlX3B1bGxfbWVudSB7bX0gewoJZ2xvYmFsIGdpdGRpciByZXBvX2NvbmZpZyBhbGxfcmVtb3RlcyBkaXNhYmxlX29uX2xvY2sKCglmb3JlYWNoIHJlbW90ZSAkYWxsX3JlbW90ZXMgewoJCXNldCByYiB7fQoJCWlmIHtbYXJyYXkgZ2V0IHJlcG9fY29uZmlnIHJlbW90ZS4kcmVtb3RlLnVybF0gbmUge319IHsKCQkJaWYge1thcnJheSBnZXQgcmVwb19jb25maWcgcmVtb3RlLiRyZW1vdGUuZmV0Y2hdIG5lIHt9fSB7CgkJCQlyZWdleHAge14oW146XSspOn0gXAoJCQkJCVtsaW5kZXggJHJlcG9fY29uZmlnKHJlbW90ZS4kcmVtb3RlLmZldGNoKSAwXSBcCgkJCQkJbGluZSByYgoJCQl9CgkJfSBlbHNlIHsKCQkJY2F0Y2ggewoJCQkJc2V0IGZkIFtvcGVuIFtmaWxlIGpvaW4gJGdpdGRpciByZW1vdGVzICRyZW1vdGVdIHJdCgkJCQl3aGlsZSB7W2dldHMgJGZkIGxpbmVdID49IDB9IHsKCQkJCQlpZiB7W3JlZ2V4cCB7XlB1bGw6WyBcdF0qKFteOl0rKTp9ICRsaW5lIGxpbmUgcmJdfSB7CgkJCQkJCWJyZWFrCgkJCQkJfQoJCQkJfQoJCQkJY2xvc2UgJGZkCgkJCX0KCQl9CgoJCXNldCByYl9zaG9ydCAkcmIKCQlyZWdzdWIgXnJlZnMvaGVhZHMvICRyYiB7fSByYl9zaG9ydAoJCWlmIHskcmJfc2hvcnQgbmUge319IHsKCQkJJG0gYWRkIGNvbW1hbmQgXAoJCQkJLWxhYmVsICJCcmFuY2ggJHJiX3Nob3J0IGZyb20gJHJlbW90ZS4uLiIgXAoJCQkJLWNvbW1hbmQgW2xpc3QgcHVsbF9yZW1vdGUgJHJlbW90ZSAkcmJdIFwKCQkJCS1mb250IGZvbnRfdWkKCQkJbGFwcGVuZCBkaXNhYmxlX29uX2xvY2sgXAoJCQkJW2xpc3QgJG0gZW50cnljb25mIFskbSBpbmRleCBsYXN0XSAtc3RhdGVdCgkJfQoJfQp9CgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjCiMjIGljb25zCgpzZXQgZmlsZW1hc2sgewojZGVmaW5lIG1hc2tfd2lkdGggMTQKI2RlZmluZSBtYXNrX2hlaWdodCAxNQpzdGF0aWMgdW5zaWduZWQgY2hhciBtYXNrX2JpdHNbXSA9IHsKICAgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwKICAgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwKICAgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZiwgMHhmZSwgMHgxZn07Cn0KCmltYWdlIGNyZWF0ZSBiaXRtYXAgZmlsZV9wbGFpbiAtYmFja2dyb3VuZCB3aGl0ZSAtZm9yZWdyb3VuZCBibGFjayAtZGF0YSB7CiNkZWZpbmUgcGxhaW5fd2lkdGggMTQKI2RlZmluZSBwbGFpbl9oZWlnaHQgMTUKc3RhdGljIHVuc2lnbmVkIGNoYXIgcGxhaW5fYml0c1tdID0gewogICAweGZlLCAweDAxLCAweDAyLCAweDAzLCAweDAyLCAweDA1LCAweDAyLCAweDA5LCAweDAyLCAweDFmLCAweDAyLCAweDEwLAogICAweDAyLCAweDEwLCAweDAyLCAweDEwLCAweDAyLCAweDEwLCAweDAyLCAweDEwLCAweDAyLCAweDEwLCAweDAyLCAweDEwLAogICAweDAyLCAweDEwLCAweDAyLCAweDEwLCAweGZlLCAweDFmfTsKfSAtbWFza2RhdGEgJGZpbGVtYXNrCgppbWFnZSBjcmVhdGUgYml0bWFwIGZpbGVfbW9kIC1iYWNrZ3JvdW5kIHdoaXRlIC1mb3JlZ3JvdW5kIGJsdWUgLWRhdGEgewojZGVmaW5lIG1vZF93aWR0aCAxNAojZGVmaW5lIG1vZF9oZWlnaHQgMTUKc3RhdGljIHVuc2lnbmVkIGNoYXIgbW9kX2JpdHNbXSA9IHsKICAgMHhmZSwgMHgwMSwgMHgwMiwgMHgwMywgMHg3YSwgMHgwNSwgMHgwMiwgMHgwOSwgMHg3YSwgMHgxZiwgMHgwMiwgMHgxMCwKICAgMHhmYSwgMHgxNywgMHgwMiwgMHgxMCwgMHhmYSwgMHgxNywgMHgwMiwgMHgxMCwgMHhmYSwgMHgxNywgMHgwMiwgMHgxMCwKICAgMHhmYSwgMHgxNywgMHgwMiwgMHgxMCwgMHhmZSwgMHgxZn07Cn0gLW1hc2tkYXRhICRmaWxlbWFzawoKaW1hZ2UgY3JlYXRlIGJpdG1hcCBmaWxlX2Z1bGx0aWNrIC1iYWNrZ3JvdW5kIHdoaXRlIC1mb3JlZ3JvdW5kICIjMDA3MDAwIiAtZGF0YSB7CiNkZWZpbmUgZmlsZV9mdWxsdGlja193aWR0aCAxNAojZGVmaW5lIGZpbGVfZnVsbHRpY2tfaGVpZ2h0IDE1CnN0YXRpYyB1bnNpZ25lZCBjaGFyIGZpbGVfZnVsbHRpY2tfYml0c1tdID0gewogICAweGZlLCAweDAxLCAweDAyLCAweDFhLCAweDAyLCAweDBjLCAweDAyLCAweDBjLCAweDAyLCAweDE2LCAweDAyLCAweDE2LAogICAweDAyLCAweDEzLCAweDAwLCAweDEzLCAweDg2LCAweDExLCAweDhjLCAweDExLCAweGQ4LCAweDEwLCAweGYyLCAweDEwLAogICAweDYyLCAweDEwLCAweDAyLCAweDEwLCAweGZlLCAweDFmfTsKfSAtbWFza2RhdGEgJGZpbGVtYXNrCgppbWFnZSBjcmVhdGUgYml0bWFwIGZpbGVfcGFydHRpY2sgLWJhY2tncm91bmQgd2hpdGUgLWZvcmVncm91bmQgIiMwMDUwNTAiIC1kYXRhIHsKI2RlZmluZSBwYXJ0dGlja193aWR0aCAxNAojZGVmaW5lIHBhcnR0aWNrX2hlaWdodCAxNQpzdGF0aWMgdW5zaWduZWQgY2hhciBwYXJ0dGlja19iaXRzW10gPSB7CiAgIDB4ZmUsIDB4MDEsIDB4MDIsIDB4MDMsIDB4N2EsIDB4MDUsIDB4MDIsIDB4MDksIDB4N2EsIDB4MWYsIDB4MDIsIDB4MTAsCiAgIDB4N2EsIDB4MTQsIDB4MDIsIDB4MTYsIDB4MDIsIDB4MTMsIDB4OGEsIDB4MTEsIDB4ZGEsIDB4MTAsIDB4NzIsIDB4MTAsCiAgIDB4MjIsIDB4MTAsIDB4MDIsIDB4MTAsIDB4ZmUsIDB4MWZ9Owp9IC1tYXNrZGF0YSAkZmlsZW1hc2sKCmltYWdlIGNyZWF0ZSBiaXRtYXAgZmlsZV9xdWVzdGlvbiAtYmFja2dyb3VuZCB3aGl0ZSAtZm9yZWdyb3VuZCBibGFjayAtZGF0YSB7CiNkZWZpbmUgZmlsZV9xdWVzdGlvbl93aWR0aCAxNAojZGVmaW5lIGZpbGVfcXVlc3Rpb25faGVpZ2h0IDE1CnN0YXRpYyB1bnNpZ25lZCBjaGFyIGZpbGVfcXVlc3Rpb25fYml0c1tdID0gewogICAweGZlLCAweDAxLCAweDAyLCAweDAyLCAweGUyLCAweDA0LCAweGYyLCAweDA5LCAweDFhLCAweDFiLCAweDBhLCAweDEzLAogICAweDgyLCAweDExLCAweGMyLCAweDEwLCAweDYyLCAweDEwLCAweDYyLCAweDEwLCAweDAyLCAweDEwLCAweDYyLCAweDEwLAogICAweDYyLCAweDEwLCAweDAyLCAweDEwLCAweGZlLCAweDFmfTsKfSAtbWFza2RhdGEgJGZpbGVtYXNrCgppbWFnZSBjcmVhdGUgYml0bWFwIGZpbGVfcmVtb3ZlZCAtYmFja2dyb3VuZCB3aGl0ZSAtZm9yZWdyb3VuZCByZWQgLWRhdGEgewojZGVmaW5lIGZpbGVfcmVtb3ZlZF93aWR0aCAxNAojZGVmaW5lIGZpbGVfcmVtb3ZlZF9oZWlnaHQgMTUKc3RhdGljIHVuc2lnbmVkIGNoYXIgZmlsZV9yZW1vdmVkX2JpdHNbXSA9IHsKICAgMHhmZSwgMHgwMSwgMHgwMiwgMHgwMywgMHgwMiwgMHgwNSwgMHgwMiwgMHgwOSwgMHgwMiwgMHgxZiwgMHgwMiwgMHgxMCwKICAgMHgxYSwgMHgxNiwgMHgzMiwgMHgxMywgMHhlMiwgMHgxMSwgMHhjMiwgMHgxMCwgMHhlMiwgMHgxMSwgMHgzMiwgMHgxMywKICAgMHgxYSwgMHgxNiwgMHgwMiwgMHgxMCwgMHhmZSwgMHgxZn07Cn0gLW1hc2tkYXRhICRmaWxlbWFzawoKaW1hZ2UgY3JlYXRlIGJpdG1hcCBmaWxlX21lcmdlIC1iYWNrZ3JvdW5kIHdoaXRlIC1mb3JlZ3JvdW5kIGJsdWUgLWRhdGEgewojZGVmaW5lIGZpbGVfbWVyZ2Vfd2lkdGggMTQKI2RlZmluZSBmaWxlX21lcmdlX2hlaWdodCAxNQpzdGF0aWMgdW5zaWduZWQgY2hhciBmaWxlX21lcmdlX2JpdHNbXSA9IHsKICAgMHhmZSwgMHgwMSwgMHgwMiwgMHgwMywgMHg2MiwgMHgwNSwgMHg2MiwgMHgwOSwgMHg2MiwgMHgxZiwgMHg2MiwgMHgxMCwKICAgMHhmYSwgMHgxMSwgMHhmMiwgMHgxMCwgMHg2MiwgMHgxMCwgMHgwMiwgMHgxMCwgMHhmYSwgMHgxNywgMHgwMiwgMHgxMCwKICAgMHhmYSwgMHgxNywgMHgwMiwgMHgxMCwgMHhmZSwgMHgxZn07Cn0gLW1hc2tkYXRhICRmaWxlbWFzawoKc2V0IHVpX2luZGV4IC52cGFuZS5maWxlcy5pbmRleC5saXN0CnNldCB1aV9vdGhlciAudnBhbmUuZmlsZXMub3RoZXIubGlzdApzZXQgbWF4X3N0YXR1c19kZXNjIDAKZm9yZWFjaCBpIHsKCQl7X18gaSBwbGFpbiAgICAiVW5tb2RpZmllZCJ9CgkJe19NIGkgbW9kICAgICAgIk1vZGlmaWVkIn0KCQl7TV8gaSBmdWxsdGljayAiSW5jbHVkZWQgaW4gY29tbWl0In0KCQl7TU0gaSBwYXJ0dGljayAiUGFydGlhbGx5IGluY2x1ZGVkIn0KCgkJe19PIG8gcGxhaW4gICAgIlVudHJhY2tlZCJ9CgkJe0FfIG8gZnVsbHRpY2sgIkFkZGVkIGJ5IGNvbW1pdCJ9CgkJe0FNIG8gcGFydHRpY2sgIlBhcnRpYWxseSBhZGRlZCJ9CgkJe0FEIG8gcXVlc3Rpb24gIkFkZGVkIChidXQgbm93IGdvbmUpIn0KCgkJe19EIGkgcXVlc3Rpb24gIk1pc3NpbmcifQoJCXtEXyBpIHJlbW92ZWQgICJSZW1vdmVkIGJ5IGNvbW1pdCJ9CgkJe0REIGkgcmVtb3ZlZCAgIlJlbW92ZWQgYnkgY29tbWl0In0KCQl7RE8gaSByZW1vdmVkICAiUmVtb3ZlZCAoc3RpbGwgZXhpc3RzKSJ9CgoJCXtVTSBpIG1lcmdlICAgICJNZXJnZSBjb25mbGljdHMifQoJCXtVXyBpIG1lcmdlICAgICJNZXJnZSBjb25mbGljdHMifQoJfSB7CglpZiB7JG1heF9zdGF0dXNfZGVzYyA8IFtzdHJpbmcgbGVuZ3RoIFtsaW5kZXggJGkgM11dfSB7CgkJc2V0IG1heF9zdGF0dXNfZGVzYyBbc3RyaW5nIGxlbmd0aCBbbGluZGV4ICRpIDNdXQoJfQoJaWYge1tsaW5kZXggJGkgMV0gZXEge2l9fSB7CgkJc2V0IGFsbF9jb2xzKFtsaW5kZXggJGkgMF0pICR1aV9pbmRleAoJfSBlbHNlIHsKCQlzZXQgYWxsX2NvbHMoW2xpbmRleCAkaSAwXSkgJHVpX290aGVyCgl9CglzZXQgYWxsX2ljb25zKFtsaW5kZXggJGkgMF0pIGZpbGVfW2xpbmRleCAkaSAyXQoJc2V0IGFsbF9kZXNjcyhbbGluZGV4ICRpIDBdKSBbbGluZGV4ICRpIDNdCn0KdW5zZXQgZmlsZW1hc2sgaQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIwojIyB1dGlsCgpwcm9jIGlzX01hY09TWCB7fSB7CglnbG9iYWwgdGNsX3BsYXRmb3JtIHRrX2xpYnJhcnkKCWlmIHskdGNsX3BsYXRmb3JtKHBsYXRmb3JtKSBlcSB7dW5peH0KCQkmJiAkdGNsX3BsYXRmb3JtKG9zKSBlcSB7RGFyd2lufQoJCSYmIFtzdHJpbmcgbWF0Y2ggL0xpYnJhcnkvRnJhbWV3b3Jrcy8qICR0a19saWJyYXJ5XX0gewoJCXJldHVybiAxCgl9CglyZXR1cm4gMAp9Cgpwcm9jIGJpbmRfYnV0dG9uMyB7dyBjbWR9IHsKCWJpbmQgJHcgPEFueS1CdXR0b24tMz4gJGNtZAoJaWYge1tpc19NYWNPU1hdfSB7CgkJYmluZCAkdyA8Q29udHJvbC1CdXR0b24tMT4gJGNtZAoJfQp9Cgpwcm9jIGluY3JfZm9udF9zaXplIHtmb250IHthbXQgMX19IHsKCXNldCBzeiBbZm9udCBjb25maWd1cmUgJGZvbnQgLXNpemVdCglpbmNyIHN6ICRhbXQKCWZvbnQgY29uZmlndXJlICRmb250IC1zaXplICRzegoJZm9udCBjb25maWd1cmUgJHtmb250fWJvbGQgLXNpemUgJHN6Cn0KCnByb2MgaG9va19mYWlsZWRfcG9wdXAge2hvb2sgbXNnfSB7CglnbG9iYWwgZ2l0ZGlyIGFwcG5hbWUKCglzZXQgdyAuaG9va2ZhaWwKCXRvcGxldmVsICR3CgoJZnJhbWUgJHcubQoJbGFiZWwgJHcubS5sMSAtdGV4dCAiJGhvb2sgaG9vayBmYWlsZWQ6IiBcCgkJLWFuY2hvciB3IFwKCQktanVzdGlmeSBsZWZ0IFwKCQktZm9udCBmb250X3VpYm9sZAoJdGV4dCAkdy5tLnQgXAoJCS1iYWNrZ3JvdW5kIHdoaXRlIC1ib3JkZXJ3aWR0aCAxIFwKCQktcmVsaWVmIHN1bmtlbiBcCgkJLXdpZHRoIDgwIC1oZWlnaHQgMTAgXAoJCS1mb250IGZvbnRfZGlmZiBcCgkJLXlzY3JvbGxjb21tYW5kIFtsaXN0ICR3Lm0uc2J5IHNldF0KCWxhYmVsICR3Lm0ubDIgXAoJCS10ZXh0IHtZb3UgbXVzdCBjb3JyZWN0IHRoZSBhYm92ZSBlcnJvcnMgYmVmb3JlIGNvbW1pdHRpbmcufSBcCgkJLWFuY2hvciB3IFwKCQktanVzdGlmeSBsZWZ0IFwKCQktZm9udCBmb250X3VpYm9sZAoJc2Nyb2xsYmFyICR3Lm0uc2J5IC1jb21tYW5kIFtsaXN0ICR3Lm0udCB5dmlld10KCXBhY2sgJHcubS5sMSAtc2lkZSB0b3AgLWZpbGwgeAoJcGFjayAkdy5tLmwyIC1zaWRlIGJvdHRvbSAtZmlsbCB4CglwYWNrICR3Lm0uc2J5IC1zaWRlIHJpZ2h0IC1maWxsIHkKCXBhY2sgJHcubS50IC1zaWRlIGxlZnQgLWZpbGwgYm90aCAtZXhwYW5kIDEKCXBhY2sgJHcubSAtc2lkZSB0b3AgLWZpbGwgYm90aCAtZXhwYW5kIDEgLXBhZHggNSAtcGFkeSAxMAoKCSR3Lm0udCBpbnNlcnQgMS4wICRtc2cKCSR3Lm0udCBjb25mIC1zdGF0ZSBkaXNhYmxlZAoKCWJ1dHRvbiAkdy5vayAtdGV4dCBPSyBcCgkJLXdpZHRoIDE1IFwKCQktZm9udCBmb250X3VpIFwKCQktY29tbWFuZCAiZGVzdHJveSAkdyIKCXBhY2sgJHcub2sgLXNpZGUgYm90dG9tCgoJYmluZCAkdyA8VmlzaWJpbGl0eT4gImdyYWIgJHc7IGZvY3VzICR3IgoJYmluZCAkdyA8S2V5LVJldHVybj4gImRlc3Ryb3kgJHciCgl3bSB0aXRsZSAkdyAiJGFwcG5hbWUgKFtsaW5kZXggW2ZpbGUgc3BsaXQgXAoJCVtmaWxlIG5vcm1hbGl6ZSBbZmlsZSBkaXJuYW1lICRnaXRkaXJdXV0gXAoJCWVuZF0pOiBlcnJvciIKCXRrd2FpdCB3aW5kb3cgJHcKfQoKc2V0IG5leHRfY29uc29sZV9pZCAwCgpwcm9jIG5ld19jb25zb2xlIHtzaG9ydF90aXRsZSBsb25nX3RpdGxlfSB7CglnbG9iYWwgbmV4dF9jb25zb2xlX2lkIGNvbnNvbGVfZGF0YQoJc2V0IHcgLmNvbnNvbGVbaW5jciBuZXh0X2NvbnNvbGVfaWRdCglzZXQgY29uc29sZV9kYXRhKCR3KSBbbGlzdCAkc2hvcnRfdGl0bGUgJGxvbmdfdGl0bGVdCglyZXR1cm4gW2NvbnNvbGVfaW5pdCAkd10KfQoKcHJvYyBjb25zb2xlX2luaXQge3d9IHsKCWdsb2JhbCBjb25zb2xlX2NyIGNvbnNvbGVfZGF0YQoJZ2xvYmFsIGdpdGRpciBhcHBuYW1lIE0xQgoKCXNldCBjb25zb2xlX2NyKCR3KSAxLjAKCXRvcGxldmVsICR3CglmcmFtZSAkdy5tCglsYWJlbCAkdy5tLmwxIC10ZXh0ICJbbGluZGV4ICRjb25zb2xlX2RhdGEoJHcpIDFdOiIgXAoJCS1hbmNob3IgdyBcCgkJLWp1c3RpZnkgbGVmdCBcCgkJLWZvbnQgZm9udF91aWJvbGQKCXRleHQgJHcubS50IFwKCQktYmFja2dyb3VuZCB3aGl0ZSAtYm9yZGVyd2lkdGggMSBcCgkJLXJlbGllZiBzdW5rZW4gXAoJCS13aWR0aCA4MCAtaGVpZ2h0IDEwIFwKCQktZm9udCBmb250X2RpZmYgXAoJCS1zdGF0ZSBkaXNhYmxlZCBcCgkJLXlzY3JvbGxjb21tYW5kIFtsaXN0ICR3Lm0uc2J5IHNldF0KCWxhYmVsICR3Lm0ucyAtYW5jaG9yIHcgXAoJCS1qdXN0aWZ5IGxlZnQgXAoJCS1mb250IGZvbnRfdWlib2xkCglzY3JvbGxiYXIgJHcubS5zYnkgLWNvbW1hbmQgW2xpc3QgJHcubS50IHl2aWV3XQoJcGFjayAkdy5tLmwxIC1zaWRlIHRvcCAtZmlsbCB4CglwYWNrICR3Lm0ucyAtc2lkZSBib3R0b20gLWZpbGwgeAoJcGFjayAkdy5tLnNieSAtc2lkZSByaWdodCAtZmlsbCB5CglwYWNrICR3Lm0udCAtc2lkZSBsZWZ0IC1maWxsIGJvdGggLWV4cGFuZCAxCglwYWNrICR3Lm0gLXNpZGUgdG9wIC1maWxsIGJvdGggLWV4cGFuZCAxIC1wYWR4IDUgLXBhZHkgMTAKCgltZW51ICR3LmN0eG0gLXRlYXJvZmYgMAoJJHcuY3R4bSBhZGQgY29tbWFuZCAtbGFiZWwgIkNvcHkiIFwKCQktZm9udCBmb250X3VpIFwKCQktY29tbWFuZCAidGtfdGV4dENvcHkgJHcubS50IgoJJHcuY3R4bSBhZGQgY29tbWFuZCAtbGFiZWwgIlNlbGVjdCBBbGwiIFwKCQktZm9udCBmb250X3VpIFwKCQktY29tbWFuZCAiJHcubS50IHRhZyBhZGQgc2VsIDAuMCBlbmQiCgkkdy5jdHhtIGFkZCBjb21tYW5kIC1sYWJlbCAiQ29weSBBbGwiIFwKCQktZm9udCBmb250X3VpIFwKCQktY29tbWFuZCAiCgkJCSR3Lm0udCB0YWcgYWRkIHNlbCAwLjAgZW5kCgkJCXRrX3RleHRDb3B5ICR3Lm0udAoJCQkkdy5tLnQgdGFnIHJlbW92ZSBzZWwgMC4wIGVuZAoJCSIKCglidXR0b24gJHcub2sgLXRleHQge1J1bm5pbmcuLi59IFwKCQktd2lkdGggMTUgXAoJCS1mb250IGZvbnRfdWkgXAoJCS1zdGF0ZSBkaXNhYmxlZCBcCgkJLWNvbW1hbmQgImRlc3Ryb3kgJHciCglwYWNrICR3Lm9rIC1zaWRlIGJvdHRvbQoKCWJpbmRfYnV0dG9uMyAkdy5tLnQgInRrX3BvcHVwICR3LmN0eG0gJVggJVkiCgliaW5kICR3Lm0udCA8JE0xQi1LZXktYT4gIiR3Lm0udCB0YWcgYWRkIHNlbCAwLjAgZW5kO2JyZWFrIgoJYmluZCAkdy5tLnQgPCRNMUItS2V5LUE+ICIkdy5tLnQgdGFnIGFkZCBzZWwgMC4wIGVuZDticmVhayIKCWJpbmQgJHcgPFZpc2liaWxpdHk+ICJmb2N1cyAkdyIKCXdtIHRpdGxlICR3ICIkYXBwbmFtZSAoW2xpbmRleCBbZmlsZSBzcGxpdCBcCgkJW2ZpbGUgbm9ybWFsaXplIFtmaWxlIGRpcm5hbWUgJGdpdGRpcl1dXSBcCgkJZW5kXSk6IFtsaW5kZXggJGNvbnNvbGVfZGF0YSgkdykgMF0iCglyZXR1cm4gJHcKfQoKcHJvYyBjb25zb2xlX2V4ZWMge3cgY21kIHthZnRlciB7fX19IHsKCWdsb2JhbCB0Y2xfcGxhdGZvcm0KCgkjIC0tIFdpbmRvd3MgdG9zc2VzIHRoZSBlbnZpcm9tZW50IHdoZW4gd2UgZXhlYyBvdXIgY2hpbGQuCgkjICAgIEJ1dCBtb3N0IHVzZXJzIG5lZWQgdGhhdCBzbyB3ZSBoYXZlIHRvIHJlbG9naW4uIDotKAoJIwoJaWYgeyR0Y2xfcGxhdGZvcm0ocGxhdGZvcm0pIGVxIHt3aW5kb3dzfX0gewoJCXNldCBjbWQgW2xpc3Qgc2ggLS1sb2dpbiAtYyAiY2QgXCJbcHdkXVwiICYmIFtqb2luICRjbWQgeyB9XSJdCgl9CgoJIyAtLSBUY2wgd29uJ3QgbGV0IHVzIHJlZGlyZWN0IGJvdGggc3Rkb3V0IGFuZCBzdGRlcnIgdG8KCSMgICAgdGhlIHNhbWUgcGlwZS4gIFNvIHBhc3MgaXQgdGhyb3VnaCBjYXQuLi4KCSMKCXNldCBjbWQgW2NvbmNhdCB8ICRjbWQgfCYgY2F0XQoKCXNldCBmZF9mIFtvcGVuICRjbWQgcl0KCWZjb25maWd1cmUgJGZkX2YgLWJsb2NraW5nIDAgLXRyYW5zbGF0aW9uIGJpbmFyeQoJZmlsZWV2ZW50ICRmZF9mIHJlYWRhYmxlIFtsaXN0IGNvbnNvbGVfcmVhZCAkdyAkZmRfZiAkYWZ0ZXJdCn0KCnByb2MgY29uc29sZV9yZWFkIHt3IGZkIGFmdGVyfSB7CglnbG9iYWwgY29uc29sZV9jciBjb25zb2xlX2RhdGEKCglzZXQgYnVmIFtyZWFkICRmZF0KCWlmIHskYnVmIG5lIHt9fSB7CgkJaWYgeyFbd2luZm8gZXhpc3RzICR3XX0ge2NvbnNvbGVfaW5pdCAkd30KCQkkdy5tLnQgY29uZiAtc3RhdGUgbm9ybWFsCgkJc2V0IGMgMAoJCXNldCBuIFtzdHJpbmcgbGVuZ3RoICRidWZdCgkJd2hpbGUgeyRjIDwgJG59IHsKCQkJc2V0IGNyIFtzdHJpbmcgZmlyc3QgIlxyIiAkYnVmICRjXQoJCQlzZXQgbGYgW3N0cmluZyBmaXJzdCAiXG4iICRidWYgJGNdCgkJCWlmIHskY3IgPCAwfSB7c2V0IGNyIFtleHByICRuICsgMV19CgkJCWlmIHskbGYgPCAwfSB7c2V0IGxmIFtleHByICRuICsgMV19CgoJCQlpZiB7JGxmIDwgJGNyfSB7CgkJCQkkdy5tLnQgaW5zZXJ0IGVuZCBbc3RyaW5nIHJhbmdlICRidWYgJGMgJGxmXQoJCQkJc2V0IGNvbnNvbGVfY3IoJHcpIFskdy5tLnQgaW5kZXgge2VuZCAtMWN9XQoJCQkJc2V0IGMgJGxmCgkJCQlpbmNyIGMKCQkJfSBlbHNlIHsKCQkJCSR3Lm0udCBkZWxldGUgJGNvbnNvbGVfY3IoJHcpIGVuZAoJCQkJJHcubS50IGluc2VydCBlbmQgIlxuIgoJCQkJJHcubS50IGluc2VydCBlbmQgW3N0cmluZyByYW5nZSAkYnVmICRjICRjcl0KCQkJCXNldCBjICRjcgoJCQkJaW5jciBjCgkJCX0KCQl9CgkJJHcubS50IGNvbmYgLXN0YXRlIGRpc2FibGVkCgkJJHcubS50IHNlZSBlbmQKCX0KCglmY29uZmlndXJlICRmZCAtYmxvY2tpbmcgMQoJaWYge1tlb2YgJGZkXX0gewoJCWlmIHtbY2F0Y2gge2Nsb3NlICRmZH1dfSB7CgkJCWlmIHshW3dpbmZvIGV4aXN0cyAkd119IHtjb25zb2xlX2luaXQgJHd9CgkJCSR3Lm0ucyBjb25mIC1iYWNrZ3JvdW5kIHJlZCAtdGV4dCB7RXJyb3I6IENvbW1hbmQgRmFpbGVkfQoJCQkkdy5vayBjb25mIC10ZXh0IENsb3NlCgkJCSR3Lm9rIGNvbmYgLXN0YXRlIG5vcm1hbAoJCQlzZXQgb2sgMAoJCX0gZWxzZWlmIHtbd2luZm8gZXhpc3RzICR3XX0gewoJCQkkdy5tLnMgY29uZiAtYmFja2dyb3VuZCBncmVlbiAtdGV4dCB7U3VjY2Vzc30KCQkJJHcub2sgY29uZiAtdGV4dCBDbG9zZQoJCQkkdy5vayBjb25mIC1zdGF0ZSBub3JtYWwKCQkJc2V0IG9rIDEKCQl9CgkJYXJyYXkgdW5zZXQgY29uc29sZV9jciAkdwoJCWFycmF5IHVuc2V0IGNvbnNvbGVfZGF0YSAkdwoJCWlmIHskYWZ0ZXIgbmUge319IHsKCQkJdXBsZXZlbCAjMCAkYWZ0ZXIgJG9rCgkJfQoJCXJldHVybgoJfQoJZmNvbmZpZ3VyZSAkZmQgLWJsb2NraW5nIDAKfQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIwojIyB1aSBjb21tYW5kcwoKc2V0IHN0YXJ0aW5nX2dpdGtfbXNnIHtQbGVhc2Ugd2FpdC4uLiBTdGFydGluZyBnaXRrLi4ufQoKcHJvYyBkb19naXRrIHt9IHsKCWdsb2JhbCB0Y2xfcGxhdGZvcm0gdWlfc3RhdHVzX3ZhbHVlIHN0YXJ0aW5nX2dpdGtfbXNnCgoJc2V0IHVpX3N0YXR1c192YWx1ZSAkc3RhcnRpbmdfZ2l0a19tc2cKCWFmdGVyIDEwMDAwIHsKCQlpZiB7JHVpX3N0YXR1c192YWx1ZSBlcSAkc3RhcnRpbmdfZ2l0a19tc2d9IHsKCQkJc2V0IHVpX3N0YXR1c192YWx1ZSB7UmVhZHkufQoJCX0KCX0KCglpZiB7JHRjbF9wbGF0Zm9ybShwbGF0Zm9ybSkgZXEge3dpbmRvd3N9fSB7CgkJZXhlYyBzaCAtYyBnaXRrICYKCX0gZWxzZSB7CgkJZXhlYyBnaXRrICYKCX0KfQoKcHJvYyBkb19yZXBhY2sge30gewoJc2V0IHcgW25ld19jb25zb2xlICJyZXBhY2siICJSZXBhY2tpbmcgdGhlIG9iamVjdCBkYXRhYmFzZSJdCglzZXQgY21kIFtsaXN0IGdpdCByZXBhY2tdCglsYXBwZW5kIGNtZCAtYQoJbGFwcGVuZCBjbWQgLWQKCWNvbnNvbGVfZXhlYyAkdyAkY21kCn0KCnNldCBpc19xdWl0dGluZyAwCgpwcm9jIGRvX3F1aXQge30gewoJZ2xvYmFsIGdpdGRpciB1aV9jb21tIGlzX3F1aXR0aW5nIHJlcG9fY29uZmlnCgoJaWYgeyRpc19xdWl0dGluZ30gcmV0dXJuCglzZXQgaXNfcXVpdHRpbmcgMQoKCSMgLS0gU3Rhc2ggb3VyIGN1cnJlbnQgY29tbWl0IGJ1ZmZlci4KCSMKCXNldCBzYXZlIFtmaWxlIGpvaW4gJGdpdGRpciBHSVRHVUlfTVNHXQoJc2V0IG1zZyBbc3RyaW5nIHRyaW0gWyR1aV9jb21tIGdldCAwLjAgZW5kXV0KCWlmIHtbJHVpX2NvbW0gZWRpdCBtb2RpZmllZF0gJiYgJG1zZyBuZSB7fX0gewoJCWNhdGNoIHsKCQkJc2V0IGZkIFtvcGVuICRzYXZlIHddCgkJCXB1dHMgJGZkIFtzdHJpbmcgdHJpbSBbJHVpX2NvbW0gZ2V0IDAuMCBlbmRdXQoJCQljbG9zZSAkZmQKCQl9Cgl9IGVsc2VpZiB7JG1zZyBlcSB7fSAmJiBbZmlsZSBleGlzdHMgJHNhdmVdfSB7CgkJZmlsZSBkZWxldGUgJHNhdmUKCX0KCgkjIC0tIFN0YXNoIG91ciBjdXJyZW50IHdpbmRvdyBnZW9tZXRyeSBpbnRvIHRoaXMgcmVwb3NpdG9yeS4KCSMKCXNldCBjZmdfZ2VvbWV0cnkgW2xpc3RdCglsYXBwZW5kIGNmZ19nZW9tZXRyeSBbd20gZ2VvbWV0cnkgLl0KCWxhcHBlbmQgY2ZnX2dlb21ldHJ5IFtsaW5kZXggWy52cGFuZSBzYXNoIGNvb3JkIDBdIDFdCglsYXBwZW5kIGNmZ19nZW9tZXRyeSBbbGluZGV4IFsudnBhbmUuZmlsZXMgc2FzaCBjb29yZCAwXSAwXQoJaWYge1tjYXRjaCB7c2V0IHJjX2dlb21ldHJ5ICRyZXBvX2NvbmZpZyhndWkuZ2VvbWV0cnkpfV19IHsKCQlzZXQgcmNfZ2VvbWV0cnkge30KCX0KCWlmIHskY2ZnX2dlb21ldHJ5IG5lICRyY19nZW9tZXRyeX0gewoJCWNhdGNoIHtleGVjIGdpdCByZXBvLWNvbmZpZyBndWkuZ2VvbWV0cnkgJGNmZ19nZW9tZXRyeX0KCX0KCglkZXN0cm95IC4KfQoKcHJvYyBkb19yZXNjYW4ge30gewoJdXBkYXRlX3N0YXR1cwp9Cgpwcm9jIGRvX2luY2x1ZGVfYWxsIHt9IHsKCWdsb2JhbCBmaWxlX3N0YXRlcwoKCWlmIHshW2xvY2tfaW5kZXggYmVnaW4tdXBkYXRlXX0gcmV0dXJuCgoJc2V0IHBhdGhMaXN0IFtsaXN0XQoJZm9yZWFjaCBwYXRoIFthcnJheSBuYW1lcyBmaWxlX3N0YXRlc10gewoJCXNldCBzICRmaWxlX3N0YXRlcygkcGF0aCkKCQlzZXQgbSBbbGluZGV4ICRzIDBdCgkJc3dpdGNoIC0tICRtIHsKCQlBTSAtCgkJTU0gLQoJCV9NIC0KCQlfRCB7bGFwcGVuZCBwYXRoTGlzdCAkcGF0aH0KCQl9Cgl9CglpZiB7JHBhdGhMaXN0IGVxIHt9fSB7CgkJdW5sb2NrX2luZGV4Cgl9IGVsc2UgewoJCXVwZGF0ZV9pbmRleCAkcGF0aExpc3QKCX0KfQoKc2V0IEdJVF9DT01NSVRURVJfSURFTlQge30KCnByb2MgZG9fc2lnbm9mZiB7fSB7CglnbG9iYWwgdWlfY29tbSBHSVRfQ09NTUlUVEVSX0lERU5UCgoJaWYgeyRHSVRfQ09NTUlUVEVSX0lERU5UIGVxIHt9fSB7CgkJaWYge1tjYXRjaCB7c2V0IG1lIFtleGVjIGdpdCB2YXIgR0lUX0NPTU1JVFRFUl9JREVOVF19IGVycl19IHsKCQkJZXJyb3JfcG9wdXAgIlVuYWJsZSB0byBvYnRhaW4geW91ciBpZGVudGl0eTpcblxuJGVyciIKCQkJcmV0dXJuCgkJfQoJCWlmIHshW3JlZ2V4cCB7XiguKikgWzAtOV0rIFstKzAtOV0rJH0gXAoJCQkkbWUgbWUgR0lUX0NPTU1JVFRFUl9JREVOVF19IHsKCQkJZXJyb3JfcG9wdXAgIkludmFsaWQgR0lUX0NPTU1JVFRFUl9JREVOVDpcblxuJG1lIgoJCQlyZXR1cm4KCQl9Cgl9CgoJc2V0IHNvYiAiU2lnbmVkLW9mZi1ieTogJEdJVF9DT01NSVRURVJfSURFTlQiCglzZXQgbGFzdCBbJHVpX2NvbW0gZ2V0IHtlbmQgLTFjIGxpbmVzdGFydH0ge2VuZCAtMWN9XQoJaWYgeyRsYXN0IG5lICRzb2J9IHsKCQkkdWlfY29tbSBlZGl0IHNlcGFyYXRvcgoJCWlmIHskbGFzdCBuZSB7fQoJCQkmJiAhW3JlZ2V4cCB7XltBLVpdW0EtWmEtel0qLVtBLVphLXotXSs6ICp9ICRsYXN0XX0gewoJCQkkdWlfY29tbSBpbnNlcnQgZW5kICJcbiIKCQl9CgkJJHVpX2NvbW0gaW5zZXJ0IGVuZCAiXG4kc29iIgoJCSR1aV9jb21tIGVkaXQgc2VwYXJhdG9yCgkJJHVpX2NvbW0gc2VlIGVuZAoJfQp9Cgpwcm9jIGRvX2FtZW5kX2xhc3Qge30gewoJbG9hZF9sYXN0X2NvbW1pdAp9Cgpwcm9jIGRvX2NvbW1pdCB7fSB7Cgljb21taXRfdHJlZQp9Cgpwcm9jIGRvX29wdGlvbnMge30gewoJZ2xvYmFsIGFwcG5hbWUgZ2l0ZGlyIGZvbnRfZGVzY3MKCWdsb2JhbCByZXBvX2NvbmZpZyBnbG9iYWxfY29uZmlnCglnbG9iYWwgcmVwb19jb25maWdfbmV3IGdsb2JhbF9jb25maWdfbmV3CgoJYXJyYXkgdW5zZXQgcmVwb19jb25maWdfbmV3CglhcnJheSB1bnNldCBnbG9iYWxfY29uZmlnX25ldwoJZm9yZWFjaCBuYW1lIFthcnJheSBuYW1lcyByZXBvX2NvbmZpZ10gewoJCXNldCByZXBvX2NvbmZpZ19uZXcoJG5hbWUpICRyZXBvX2NvbmZpZygkbmFtZSkKCX0KCWxvYWRfY29uZmlnIDEKCWZvcmVhY2ggbmFtZSBbYXJyYXkgbmFtZXMgcmVwb19jb25maWddIHsKCQlzd2l0Y2ggLS0gJG5hbWUgewoJCWd1aS5kaWZmY29udGV4dCB7Y29udGludWV9CgkJfQoJCXNldCByZXBvX2NvbmZpZ19uZXcoJG5hbWUpICRyZXBvX2NvbmZpZygkbmFtZSkKCX0KCWZvcmVhY2ggbmFtZSBbYXJyYXkgbmFtZXMgZ2xvYmFsX2NvbmZpZ10gewoJCXNldCBnbG9iYWxfY29uZmlnX25ldygkbmFtZSkgJGdsb2JhbF9jb25maWcoJG5hbWUpCgl9CglzZXQgcmVwb25hbWUgW2xpbmRleCBbZmlsZSBzcGxpdCBcCgkJW2ZpbGUgbm9ybWFsaXplIFtmaWxlIGRpcm5hbWUgJGdpdGRpcl1dXSBcCgkJZW5kXQoKCXNldCB3IC5vcHRpb25zX2VkaXRvcgoJdG9wbGV2ZWwgJHcKCXdtIGdlb21ldHJ5ICR3ICIrW3dpbmZvIHJvb3R4IC5dK1t3aW5mbyByb290eSAuXSIKCglsYWJlbCAkdy5oZWFkZXIgLXRleHQgIiRhcHBuYW1lIE9wdGlvbnMiIFwKCQktZm9udCBmb250X3VpYm9sZAoJcGFjayAkdy5oZWFkZXIgLXNpZGUgdG9wIC1maWxsIHgKCglmcmFtZSAkdy5idXR0b25zCglidXR0b24gJHcuYnV0dG9ucy5yZXN0b3JlIC10ZXh0IHtSZXN0b3JlIERlZmF1bHRzfSBcCgkJLWZvbnQgZm9udF91aSBcCgkJLWNvbW1hbmQgZG9fcmVzdG9yZV9kZWZhdWx0cwoJcGFjayAkdy5idXR0b25zLnJlc3RvcmUgLXNpZGUgbGVmdAoJYnV0dG9uICR3LmJ1dHRvbnMuc2F2ZSAtdGV4dCBTYXZlIFwKCQktZm9udCBmb250X3VpIFwKCQktY29tbWFuZCBbbGlzdCBkb19zYXZlX2NvbmZpZyAkd10KCXBhY2sgJHcuYnV0dG9ucy5zYXZlIC1zaWRlIHJpZ2h0CglidXR0b24gJHcuYnV0dG9ucy5jYW5jZWwgLXRleHQge0NhbmNlbH0gXAoJCS1mb250IGZvbnRfdWkgXAoJCS1jb21tYW5kIFtsaXN0IGRlc3Ryb3kgJHddCglwYWNrICR3LmJ1dHRvbnMuY2FuY2VsIC1zaWRlIHJpZ2h0CglwYWNrICR3LmJ1dHRvbnMgLXNpZGUgYm90dG9tIC1maWxsIHggLXBhZHkgMTAgLXBhZHggMTAKCglsYWJlbGZyYW1lICR3LnJlcG8gLXRleHQgIiRyZXBvbmFtZSBSZXBvc2l0b3J5IiBcCgkJLWZvbnQgZm9udF91aSBcCgkJLXJlbGllZiByYWlzZWQgLWJvcmRlcndpZHRoIDIKCWxhYmVsZnJhbWUgJHcuZ2xvYmFsIC10ZXh0IHtHbG9iYWwgKEFsbCBSZXBvc2l0b3JpZXMpfSBcCgkJLWZvbnQgZm9udF91aSBcCgkJLXJlbGllZiByYWlzZWQgLWJvcmRlcndpZHRoIDIKCXBhY2sgJHcucmVwbyAtc2lkZSBsZWZ0IC1maWxsIGJvdGggLWV4cGFuZCAxIC1wYWR5IDUgLXBhZHggNQoJcGFjayAkdy5nbG9iYWwgLXNpZGUgcmlnaHQgLWZpbGwgYm90aCAtZXhwYW5kIDEgLXBhZHkgNSAtcGFkeCA1CgoJZm9yZWFjaCBvcHRpb24gewoJCXtiIHB1bGxzdW1tYXJ5IHtTaG93IFB1bGwgU3VtbWFyeX19CgkJe2IgdHJ1c3RtdGltZSAge1RydXN0IEZpbGUgTW9kaWZpY2F0aW9uIFRpbWVzdGFtcHN9fQoJCXtpIGRpZmZjb250ZXh0IHtOdW1iZXIgb2YgRGlmZiBDb250ZXh0IExpbmVzfX0KCQl9IHsKCQlzZXQgdHlwZSBbbGluZGV4ICRvcHRpb24gMF0KCQlzZXQgbmFtZSBbbGluZGV4ICRvcHRpb24gMV0KCQlzZXQgdGV4dCBbbGluZGV4ICRvcHRpb24gMl0KCQlmb3JlYWNoIGYge3JlcG8gZ2xvYmFsfSB7CgkJCXN3aXRjaCAkdHlwZSB7CgkJCWIgewoJCQkJY2hlY2tidXR0b24gJHcuJGYuJG5hbWUgLXRleHQgJHRleHQgXAoJCQkJCS12YXJpYWJsZSAke2Z9X2NvbmZpZ19uZXcoZ3VpLiRuYW1lKSBcCgkJCQkJLW9udmFsdWUgdHJ1ZSBcCgkJCQkJLW9mZnZhbHVlIGZhbHNlIFwKCQkJCQktZm9udCBmb250X3VpCgkJCQlwYWNrICR3LiRmLiRuYW1lIC1zaWRlIHRvcCAtYW5jaG9yIHcKCQkJfQoJCQlpIHsKCQkJCWZyYW1lICR3LiRmLiRuYW1lCgkJCQlsYWJlbCAkdy4kZi4kbmFtZS5sIC10ZXh0ICIkdGV4dDoiIC1mb250IGZvbnRfdWkKCQkJCXBhY2sgJHcuJGYuJG5hbWUubCAtc2lkZSBsZWZ0IC1hbmNob3IgdyAtZmlsbCB4CgkJCQlzcGluYm94ICR3LiRmLiRuYW1lLnYgXAoJCQkJCS10ZXh0dmFyaWFibGUgJHtmfV9jb25maWdfbmV3KGd1aS4kbmFtZSkgXAoJCQkJCS1mcm9tIDEgLXRvIDk5IC1pbmNyZW1lbnQgMSBcCgkJCQkJLXdpZHRoIDMgXAoJCQkJCS1mb250IGZvbnRfdWkKCQkJCXBhY2sgJHcuJGYuJG5hbWUudiAtc2lkZSByaWdodCAtYW5jaG9yIGUKCQkJCXBhY2sgJHcuJGYuJG5hbWUgLXNpZGUgdG9wIC1hbmNob3IgdyAtZmlsbCB4CgkJCX0KCQkJfQoJCX0KCX0KCglzZXQgYWxsX2ZvbnRzIFtsc29ydCBbZm9udCBmYW1pbGllc11dCglmb3JlYWNoIG9wdGlvbiAkZm9udF9kZXNjcyB7CgkJc2V0IG5hbWUgW2xpbmRleCAkb3B0aW9uIDBdCgkJc2V0IGZvbnQgW2xpbmRleCAkb3B0aW9uIDFdCgkJc2V0IHRleHQgW2xpbmRleCAkb3B0aW9uIDJdCgoJCXNldCBnbG9iYWxfY29uZmlnX25ldyhndWkuJGZvbnReXmZhbWlseSkgXAoJCQlbZm9udCBjb25maWd1cmUgJGZvbnQgLWZhbWlseV0KCQlzZXQgZ2xvYmFsX2NvbmZpZ19uZXcoZ3VpLiRmb250Xl5zaXplKSBcCgkJCVtmb250IGNvbmZpZ3VyZSAkZm9udCAtc2l6ZV0KCgkJZnJhbWUgJHcuZ2xvYmFsLiRuYW1lCgkJbGFiZWwgJHcuZ2xvYmFsLiRuYW1lLmwgLXRleHQgIiR0ZXh0OiIgLWZvbnQgZm9udF91aQoJCXBhY2sgJHcuZ2xvYmFsLiRuYW1lLmwgLXNpZGUgbGVmdCAtYW5jaG9yIHcgLWZpbGwgeAoJCWV2YWwgdGtfb3B0aW9uTWVudSAkdy5nbG9iYWwuJG5hbWUuZmFtaWx5IFwKCQkJZ2xvYmFsX2NvbmZpZ19uZXcoZ3VpLiRmb250Xl5mYW1pbHkpIFwKCQkJJGFsbF9mb250cwoJCXNwaW5ib3ggJHcuZ2xvYmFsLiRuYW1lLnNpemUgXAoJCQktdGV4dHZhcmlhYmxlIGdsb2JhbF9jb25maWdfbmV3KGd1aS4kZm9udF5ec2l6ZSkgXAoJCQktZnJvbSAyIC10byA4MCAtaW5jcmVtZW50IDEgXAoJCQktd2lkdGggMyBcCgkJCS1mb250IGZvbnRfdWkKCQlwYWNrICR3Lmdsb2JhbC4kbmFtZS5zaXplIC1zaWRlIHJpZ2h0IC1hbmNob3IgZQoJCXBhY2sgJHcuZ2xvYmFsLiRuYW1lLmZhbWlseSAtc2lkZSByaWdodCAtYW5jaG9yIGUKCQlwYWNrICR3Lmdsb2JhbC4kbmFtZSAtc2lkZSB0b3AgLWFuY2hvciB3IC1maWxsIHgKCX0KCgliaW5kICR3IDxWaXNpYmlsaXR5PiAiZ3JhYiAkdzsgZm9jdXMgJHciCgliaW5kICR3IDxLZXktRXNjYXBlPiAiZGVzdHJveSAkdyIKCXdtIHRpdGxlICR3ICIkYXBwbmFtZSAoJHJlcG9uYW1lKTogT3B0aW9ucyIKCXRrd2FpdCB3aW5kb3cgJHcKfQoKcHJvYyBkb19yZXN0b3JlX2RlZmF1bHRzIHt9IHsKCWdsb2JhbCBmb250X2Rlc2NzIGRlZmF1bHRfY29uZmlnIHJlcG9fY29uZmlnCglnbG9iYWwgcmVwb19jb25maWdfbmV3IGdsb2JhbF9jb25maWdfbmV3CgoJZm9yZWFjaCBuYW1lIFthcnJheSBuYW1lcyBkZWZhdWx0X2NvbmZpZ10gewoJCXNldCByZXBvX2NvbmZpZ19uZXcoJG5hbWUpICRkZWZhdWx0X2NvbmZpZygkbmFtZSkKCQlzZXQgZ2xvYmFsX2NvbmZpZ19uZXcoJG5hbWUpICRkZWZhdWx0X2NvbmZpZygkbmFtZSkKCX0KCglmb3JlYWNoIG9wdGlvbiAkZm9udF9kZXNjcyB7CgkJc2V0IG5hbWUgW2xpbmRleCAkb3B0aW9uIDBdCgkJc2V0IHJlcG9fY29uZmlnKGd1aS4kbmFtZSkgJGRlZmF1bHRfY29uZmlnKGd1aS4kbmFtZSkKCX0KCWFwcGx5X2NvbmZpZwoKCWZvcmVhY2ggb3B0aW9uICRmb250X2Rlc2NzIHsKCQlzZXQgbmFtZSBbbGluZGV4ICRvcHRpb24gMF0KCQlzZXQgZm9udCBbbGluZGV4ICRvcHRpb24gMV0KCQlzZXQgZ2xvYmFsX2NvbmZpZ19uZXcoZ3VpLiRmb250Xl5mYW1pbHkpIFwKCQkJW2ZvbnQgY29uZmlndXJlICRmb250IC1mYW1pbHldCgkJc2V0IGdsb2JhbF9jb25maWdfbmV3KGd1aS4kZm9udF5ec2l6ZSkgXAoJCQlbZm9udCBjb25maWd1cmUgJGZvbnQgLXNpemVdCgl9Cn0KCnByb2MgZG9fc2F2ZV9jb25maWcge3d9IHsKCWlmIHtbY2F0Y2gge3NhdmVfY29uZmlnfSBlcnJdfSB7CgkJZXJyb3JfcG9wdXAgIkZhaWxlZCB0byBjb21wbGV0ZWx5IHNhdmUgb3B0aW9uczpcblxuJGVyciIKCX0KCXJlc2hvd19kaWZmCglkZXN0cm95ICR3Cn0KCiMgc2hpZnQgPT0gMTogbGVmdCBjbGljawojICAgICAgICAgIDM6IHJpZ2h0IGNsaWNrICAKcHJvYyBjbGljayB7dyB4IHkgc2hpZnQgd3ggd3l9IHsKCWdsb2JhbCB1aV9pbmRleCB1aV9vdGhlciBmaWxlX2xpc3RzCgoJc2V0IHBvcyBbc3BsaXQgWyR3IGluZGV4IEAkeCwkeV0gLl0KCXNldCBsbm8gW2xpbmRleCAkcG9zIDBdCglzZXQgY29sIFtsaW5kZXggJHBvcyAxXQoJc2V0IHBhdGggW2xpbmRleCAkZmlsZV9saXN0cygkdykgW2V4cHIgJGxubyAtIDFdXQoJaWYgeyRwYXRoIGVxIHt9fSByZXR1cm4KCglpZiB7JGNvbCA+IDAgJiYgJHNoaWZ0ID09IDF9IHsKCQlzaG93X2RpZmYgJHBhdGggJHcgJGxubwoJfQp9Cgpwcm9jIHVuY2xpY2sge3cgeCB5fSB7CglnbG9iYWwgZmlsZV9saXN0cwoKCXNldCBwb3MgW3NwbGl0IFskdyBpbmRleCBAJHgsJHldIC5dCglzZXQgbG5vIFtsaW5kZXggJHBvcyAwXQoJc2V0IGNvbCBbbGluZGV4ICRwb3MgMV0KCXNldCBwYXRoIFtsaW5kZXggJGZpbGVfbGlzdHMoJHcpIFtleHByICRsbm8gLSAxXV0KCWlmIHskcGF0aCBlcSB7fX0gcmV0dXJuCgoJaWYgeyRjb2wgPT0gMH0gewoJCXVwZGF0ZV9pbmRleCBbbGlzdCAkcGF0aF0KCX0KfQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIwojIyBjb25maWcgZGVmYXVsdHMKCnNldCBjdXJzb3JfcHRyIGFycm93CmZvbnQgY3JlYXRlIGZvbnRfZGlmZiAtZmFtaWx5IENvdXJpZXIgLXNpemUgMTAKZm9udCBjcmVhdGUgZm9udF91aQpjYXRjaCB7CglsYWJlbCAuZHVtbXkKCWV2YWwgZm9udCBjb25maWd1cmUgZm9udF91aSBbZm9udCBhY3R1YWwgWy5kdW1teSBjZ2V0IC1mb250XV0KCWRlc3Ryb3kgLmR1bW15Cn0KCmZvbnQgY3JlYXRlIGZvbnRfdWlib2xkCmZvbnQgY3JlYXRlIGZvbnRfZGlmZmJvbGQKCnNldCBNMUIgTTEKc2V0IE0xVCBNMQppZiB7JHRjbF9wbGF0Zm9ybShwbGF0Zm9ybSkgZXEge3dpbmRvd3N9fSB7CglzZXQgTTFCIENvbnRyb2wKCXNldCBNMVQgQ3RybAp9IGVsc2VpZiB7W2lzX01hY09TWF19IHsKCXNldCBNMUIgTTEKCXNldCBNMVQgQ21kCn0KCnByb2MgYXBwbHlfY29uZmlnIHt9IHsKCWdsb2JhbCByZXBvX2NvbmZpZyBmb250X2Rlc2NzCgoJZm9yZWFjaCBvcHRpb24gJGZvbnRfZGVzY3MgewoJCXNldCBuYW1lIFtsaW5kZXggJG9wdGlvbiAwXQoJCXNldCBmb250IFtsaW5kZXggJG9wdGlvbiAxXQoJCWlmIHtbY2F0Y2ggewoJCQlmb3JlYWNoIHtjbiBjdn0gJHJlcG9fY29uZmlnKGd1aS4kbmFtZSkgewoJCQkJZm9udCBjb25maWd1cmUgJGZvbnQgJGNuICRjdgoJCQl9CgkJCX0gZXJyXX0gewoJCQllcnJvcl9wb3B1cCAiSW52YWxpZCBmb250IHNwZWNpZmllZCBpbiBndWkuJG5hbWU6XG5cbiRlcnIiCgkJfQoJCWZvcmVhY2gge2NuIGN2fSBbZm9udCBjb25maWd1cmUgJGZvbnRdIHsKCQkJZm9udCBjb25maWd1cmUgJHtmb250fWJvbGQgJGNuICRjdgoJCX0KCQlmb250IGNvbmZpZ3VyZSAke2ZvbnR9Ym9sZCAtd2VpZ2h0IGJvbGQKCX0KfQoKc2V0IGRlZmF1bHRfY29uZmlnKGd1aS50cnVzdG10aW1lKSBmYWxzZQpzZXQgZGVmYXVsdF9jb25maWcoZ3VpLnB1bGxzdW1tYXJ5KSB0cnVlCnNldCBkZWZhdWx0X2NvbmZpZyhndWkuZGlmZmNvbnRleHQpIDUKc2V0IGRlZmF1bHRfY29uZmlnKGd1aS5mb250dWkpIFtmb250IGNvbmZpZ3VyZSBmb250X3VpXQpzZXQgZGVmYXVsdF9jb25maWcoZ3VpLmZvbnRkaWZmKSBbZm9udCBjb25maWd1cmUgZm9udF9kaWZmXQpzZXQgZm9udF9kZXNjcyB7Cgl7Zm9udHVpICAgZm9udF91aSAgIHtNYWluIEZvbnR9fQoJe2ZvbnRkaWZmIGZvbnRfZGlmZiB7RGlmZi9Db25zb2xlIEZvbnR9fQp9CmxvYWRfY29uZmlnIDAKYXBwbHlfY29uZmlnCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjCiMjIHVpIGNvbnN0cnVjdGlvbgoKIyAtLSBNZW51IEJhcgptZW51IC5tYmFyIC10ZWFyb2ZmIDAKLm1iYXIgYWRkIGNhc2NhZGUgLWxhYmVsIFByb2plY3QgLW1lbnUgLm1iYXIucHJvamVjdAoubWJhciBhZGQgY2FzY2FkZSAtbGFiZWwgRWRpdCAtbWVudSAubWJhci5lZGl0Ci5tYmFyIGFkZCBjYXNjYWRlIC1sYWJlbCBDb21taXQgLW1lbnUgLm1iYXIuY29tbWl0CmlmIHshJHNpbmdsZV9jb21taXR9IHsKCS5tYmFyIGFkZCBjYXNjYWRlIC1sYWJlbCBGZXRjaCAtbWVudSAubWJhci5mZXRjaAoJLm1iYXIgYWRkIGNhc2NhZGUgLWxhYmVsIFB1bGwgLW1lbnUgLm1iYXIucHVsbAoJLm1iYXIgYWRkIGNhc2NhZGUgLWxhYmVsIFB1c2ggLW1lbnUgLm1iYXIucHVzaAp9Ci4gY29uZmlndXJlIC1tZW51IC5tYmFyCgojIC0tIFByb2plY3QgTWVudQptZW51IC5tYmFyLnByb2plY3QKLm1iYXIucHJvamVjdCBhZGQgY29tbWFuZCAtbGFiZWwgVmlzdWFsaXplIFwKCS1jb21tYW5kIGRvX2dpdGsgXAoJLWZvbnQgZm9udF91aQppZiB7ISRzaW5nbGVfY29tbWl0fSB7CgkubWJhci5wcm9qZWN0IGFkZCBjb21tYW5kIC1sYWJlbCB7UmVwYWNrIERhdGFiYXNlfSBcCgkJLWNvbW1hbmQgZG9fcmVwYWNrIFwKCQktZm9udCBmb250X3VpCn0KLm1iYXIucHJvamVjdCBhZGQgY29tbWFuZCAtbGFiZWwgUXVpdCBcCgktY29tbWFuZCBkb19xdWl0IFwKCS1hY2NlbGVyYXRvciAkTTFULVEgXAoJLWZvbnQgZm9udF91aQoKIyAtLSBFZGl0IE1lbnUKIwptZW51IC5tYmFyLmVkaXQKLm1iYXIuZWRpdCBhZGQgY29tbWFuZCAtbGFiZWwgVW5kbyBcCgktY29tbWFuZCB7Y2F0Y2gge1tmb2N1c10gZWRpdCB1bmRvfX0gXAoJLWFjY2VsZXJhdG9yICRNMVQtWiBcCgktZm9udCBmb250X3VpCi5tYmFyLmVkaXQgYWRkIGNvbW1hbmQgLWxhYmVsIFJlZG8gXAoJLWNvbW1hbmQge2NhdGNoIHtbZm9jdXNdIGVkaXQgcmVkb319IFwKCS1hY2NlbGVyYXRvciAkTTFULVkgXAoJLWZvbnQgZm9udF91aQoubWJhci5lZGl0IGFkZCBzZXBhcmF0b3IKLm1iYXIuZWRpdCBhZGQgY29tbWFuZCAtbGFiZWwgQ3V0IFwKCS1jb21tYW5kIHtjYXRjaCB7dGtfdGV4dEN1dCBbZm9jdXNdfX0gXAoJLWFjY2VsZXJhdG9yICRNMVQtWCBcCgktZm9udCBmb250X3VpCi5tYmFyLmVkaXQgYWRkIGNvbW1hbmQgLWxhYmVsIENvcHkgXAoJLWNvbW1hbmQge2NhdGNoIHt0a190ZXh0Q29weSBbZm9jdXNdfX0gXAoJLWFjY2VsZXJhdG9yICRNMVQtQyBcCgktZm9udCBmb250X3VpCi5tYmFyLmVkaXQgYWRkIGNvbW1hbmQgLWxhYmVsIFBhc3RlIFwKCS1jb21tYW5kIHtjYXRjaCB7dGtfdGV4dFBhc3RlIFtmb2N1c107IFtmb2N1c10gc2VlIGluc2VydH19IFwKCS1hY2NlbGVyYXRvciAkTTFULVYgXAoJLWZvbnQgZm9udF91aQoubWJhci5lZGl0IGFkZCBjb21tYW5kIC1sYWJlbCBEZWxldGUgXAoJLWNvbW1hbmQge2NhdGNoIHtbZm9jdXNdIGRlbGV0ZSBzZWwuZmlyc3Qgc2VsLmxhc3R9fSBcCgktYWNjZWxlcmF0b3IgRGVsIFwKCS1mb250IGZvbnRfdWkKLm1iYXIuZWRpdCBhZGQgc2VwYXJhdG9yCi5tYmFyLmVkaXQgYWRkIGNvbW1hbmQgLWxhYmVsIHtTZWxlY3QgQWxsfSBcCgktY29tbWFuZCB7Y2F0Y2gge1tmb2N1c10gdGFnIGFkZCBzZWwgMC4wIGVuZH19IFwKCS1hY2NlbGVyYXRvciAkTTFULUEgXAoJLWZvbnQgZm9udF91aQoubWJhci5lZGl0IGFkZCBzZXBhcmF0b3IKLm1iYXIuZWRpdCBhZGQgY29tbWFuZCAtbGFiZWwge09wdGlvbnMuLi59IFwKCS1jb21tYW5kIGRvX29wdGlvbnMgXAoJLWZvbnQgZm9udF91aQoKIyAtLSBDb21taXQgTWVudQptZW51IC5tYmFyLmNvbW1pdAoubWJhci5jb21taXQgYWRkIGNvbW1hbmQgLWxhYmVsIFJlc2NhbiBcCgktY29tbWFuZCBkb19yZXNjYW4gXAoJLWFjY2VsZXJhdG9yIEY1IFwKCS1mb250IGZvbnRfdWkKbGFwcGVuZCBkaXNhYmxlX29uX2xvY2sgXAoJW2xpc3QgLm1iYXIuY29tbWl0IGVudHJ5Y29uZiBbLm1iYXIuY29tbWl0IGluZGV4IGxhc3RdIC1zdGF0ZV0KLm1iYXIuY29tbWl0IGFkZCBjb21tYW5kIC1sYWJlbCB7QW1lbmQgTGFzdCBDb21taXR9IFwKCS1jb21tYW5kIGRvX2FtZW5kX2xhc3QgXAoJLWZvbnQgZm9udF91aQpsYXBwZW5kIGRpc2FibGVfb25fbG9jayBcCglbbGlzdCAubWJhci5jb21taXQgZW50cnljb25mIFsubWJhci5jb21taXQgaW5kZXggbGFzdF0gLXN0YXRlXQoubWJhci5jb21taXQgYWRkIGNvbW1hbmQgLWxhYmVsIHtJbmNsdWRlIEFsbCBGaWxlc30gXAoJLWNvbW1hbmQgZG9faW5jbHVkZV9hbGwgXAoJLWFjY2VsZXJhdG9yICRNMVQtSSBcCgktZm9udCBmb250X3VpCmxhcHBlbmQgZGlzYWJsZV9vbl9sb2NrIFwKCVtsaXN0IC5tYmFyLmNvbW1pdCBlbnRyeWNvbmYgWy5tYmFyLmNvbW1pdCBpbmRleCBsYXN0XSAtc3RhdGVdCi5tYmFyLmNvbW1pdCBhZGQgY29tbWFuZCAtbGFiZWwge1NpZ24gT2ZmfSBcCgktY29tbWFuZCBkb19zaWdub2ZmIFwKCS1hY2NlbGVyYXRvciAkTTFULVMgXAoJLWZvbnQgZm9udF91aQoubWJhci5jb21taXQgYWRkIGNvbW1hbmQgLWxhYmVsIENvbW1pdCBcCgktY29tbWFuZCBkb19jb21taXQgXAoJLWFjY2VsZXJhdG9yICRNMVQtUmV0dXJuIFwKCS1mb250IGZvbnRfdWkKbGFwcGVuZCBkaXNhYmxlX29uX2xvY2sgXAoJW2xpc3QgLm1iYXIuY29tbWl0IGVudHJ5Y29uZiBbLm1iYXIuY29tbWl0IGluZGV4IGxhc3RdIC1zdGF0ZV0KCmlmIHshJHNpbmdsZV9jb21taXR9IHsKCSMgLS0gRmV0Y2ggTWVudQoJbWVudSAubWJhci5mZXRjaAoKCSMgLS0gUHVsbCBNZW51CgltZW51IC5tYmFyLnB1bGwKCgkjIC0tIFB1c2ggTWVudQoJbWVudSAubWJhci5wdXNoCn0KCiMgLS0gTWFpbiBXaW5kb3cgTGF5b3V0CnBhbmVkd2luZG93IC52cGFuZSAtb3JpZW50IHZlcnRpY2FsCnBhbmVkd2luZG93IC52cGFuZS5maWxlcyAtb3JpZW50IGhvcml6b250YWwKLnZwYW5lIGFkZCAudnBhbmUuZmlsZXMgLXN0aWNreSBuc2V3IC1oZWlnaHQgMTAwIC13aWR0aCA0MDAKcGFjayAudnBhbmUgLWFuY2hvciBuIC1zaWRlIHRvcCAtZmlsbCBib3RoIC1leHBhbmQgMQoKIyAtLSBJbmRleCBGaWxlIExpc3QKZnJhbWUgLnZwYW5lLmZpbGVzLmluZGV4IC1oZWlnaHQgMTAwIC13aWR0aCA0MDAKbGFiZWwgLnZwYW5lLmZpbGVzLmluZGV4LnRpdGxlIC10ZXh0IHtNb2RpZmllZCBGaWxlc30gXAoJLWJhY2tncm91bmQgZ3JlZW4gXAoJLWZvbnQgZm9udF91aQp0ZXh0ICR1aV9pbmRleCAtYmFja2dyb3VuZCB3aGl0ZSAtYm9yZGVyd2lkdGggMCBcCgktd2lkdGggNDAgLWhlaWdodCAxMCBcCgktZm9udCBmb250X3VpIFwKCS1jdXJzb3IgJGN1cnNvcl9wdHIgXAoJLXlzY3JvbGxjb21tYW5kIHsudnBhbmUuZmlsZXMuaW5kZXguc2Igc2V0fSBcCgktc3RhdGUgZGlzYWJsZWQKc2Nyb2xsYmFyIC52cGFuZS5maWxlcy5pbmRleC5zYiAtY29tbWFuZCBbbGlzdCAkdWlfaW5kZXggeXZpZXddCnBhY2sgLnZwYW5lLmZpbGVzLmluZGV4LnRpdGxlIC1zaWRlIHRvcCAtZmlsbCB4CnBhY2sgLnZwYW5lLmZpbGVzLmluZGV4LnNiIC1zaWRlIHJpZ2h0IC1maWxsIHkKcGFjayAkdWlfaW5kZXggLXNpZGUgbGVmdCAtZmlsbCBib3RoIC1leHBhbmQgMQoudnBhbmUuZmlsZXMgYWRkIC52cGFuZS5maWxlcy5pbmRleCAtc3RpY2t5IG5zZXcKCiMgLS0gT3RoZXIgKEFkZCkgRmlsZSBMaXN0CmZyYW1lIC52cGFuZS5maWxlcy5vdGhlciAtaGVpZ2h0IDEwMCAtd2lkdGggMTAwCmxhYmVsIC52cGFuZS5maWxlcy5vdGhlci50aXRsZSAtdGV4dCB7VW50cmFja2VkIEZpbGVzfSBcCgktYmFja2dyb3VuZCByZWQgXAoJLWZvbnQgZm9udF91aQp0ZXh0ICR1aV9vdGhlciAtYmFja2dyb3VuZCB3aGl0ZSAtYm9yZGVyd2lkdGggMCBcCgktd2lkdGggNDAgLWhlaWdodCAxMCBcCgktZm9udCBmb250X3VpIFwKCS1jdXJzb3IgJGN1cnNvcl9wdHIgXAoJLXlzY3JvbGxjb21tYW5kIHsudnBhbmUuZmlsZXMub3RoZXIuc2Igc2V0fSBcCgktc3RhdGUgZGlzYWJsZWQKc2Nyb2xsYmFyIC52cGFuZS5maWxlcy5vdGhlci5zYiAtY29tbWFuZCBbbGlzdCAkdWlfb3RoZXIgeXZpZXddCnBhY2sgLnZwYW5lLmZpbGVzLm90aGVyLnRpdGxlIC1zaWRlIHRvcCAtZmlsbCB4CnBhY2sgLnZwYW5lLmZpbGVzLm90aGVyLnNiIC1zaWRlIHJpZ2h0IC1maWxsIHkKcGFjayAkdWlfb3RoZXIgLXNpZGUgbGVmdCAtZmlsbCBib3RoIC1leHBhbmQgMQoudnBhbmUuZmlsZXMgYWRkIC52cGFuZS5maWxlcy5vdGhlciAtc3RpY2t5IG5zZXcKCiR1aV9pbmRleCB0YWcgY29uZiBpbl9kaWZmIC1mb250IGZvbnRfdWlib2xkCiR1aV9vdGhlciB0YWcgY29uZiBpbl9kaWZmIC1mb250IGZvbnRfdWlib2xkCgojIC0tIERpZmYgYW5kIENvbW1pdCBBcmVhCmZyYW1lIC52cGFuZS5sb3dlciAtaGVpZ2h0IDMwMCAtd2lkdGggNDAwCmZyYW1lIC52cGFuZS5sb3dlci5jb21tYXJlYQpmcmFtZSAudnBhbmUubG93ZXIuZGlmZiAtcmVsaWVmIHN1bmtlbiAtYm9yZGVyd2lkdGggMQpwYWNrIC52cGFuZS5sb3dlci5jb21tYXJlYSAtc2lkZSB0b3AgLWZpbGwgeApwYWNrIC52cGFuZS5sb3dlci5kaWZmIC1zaWRlIGJvdHRvbSAtZmlsbCBib3RoIC1leHBhbmQgMQoudnBhbmUgYWRkIC52cGFuZS5sb3dlciAtc3RpY2sgbnNldwoKIyAtLSBDb21taXQgQXJlYSBCdXR0b25zCmZyYW1lIC52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zCmxhYmVsIC52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zLmwgLXRleHQge30gXAoJLWFuY2hvciB3IFwKCS1qdXN0aWZ5IGxlZnQgXAoJLWZvbnQgZm9udF91aQpwYWNrIC52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zLmwgLXNpZGUgdG9wIC1maWxsIHgKcGFjayAudnBhbmUubG93ZXIuY29tbWFyZWEuYnV0dG9ucyAtc2lkZSBsZWZ0IC1maWxsIHkKCmJ1dHRvbiAudnBhbmUubG93ZXIuY29tbWFyZWEuYnV0dG9ucy5yZXNjYW4gLXRleHQge1Jlc2Nhbn0gXAoJLWNvbW1hbmQgZG9fcmVzY2FuIFwKCS1mb250IGZvbnRfdWkKcGFjayAudnBhbmUubG93ZXIuY29tbWFyZWEuYnV0dG9ucy5yZXNjYW4gLXNpZGUgdG9wIC1maWxsIHgKbGFwcGVuZCBkaXNhYmxlX29uX2xvY2sgXAoJey52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zLnJlc2NhbiBjb25mIC1zdGF0ZX0KCmJ1dHRvbiAudnBhbmUubG93ZXIuY29tbWFyZWEuYnV0dG9ucy5hbWVuZCAtdGV4dCB7QW1lbmQgTGFzdH0gXAoJLWNvbW1hbmQgZG9fYW1lbmRfbGFzdCBcCgktZm9udCBmb250X3VpCnBhY2sgLnZwYW5lLmxvd2VyLmNvbW1hcmVhLmJ1dHRvbnMuYW1lbmQgLXNpZGUgdG9wIC1maWxsIHgKbGFwcGVuZCBkaXNhYmxlX29uX2xvY2sgXAoJey52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zLmFtZW5kIGNvbmYgLXN0YXRlfQoKYnV0dG9uIC52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zLmluY2FsbCAtdGV4dCB7SW5jbHVkZSBBbGx9IFwKCS1jb21tYW5kIGRvX2luY2x1ZGVfYWxsIFwKCS1mb250IGZvbnRfdWkKcGFjayAudnBhbmUubG93ZXIuY29tbWFyZWEuYnV0dG9ucy5pbmNhbGwgLXNpZGUgdG9wIC1maWxsIHgKbGFwcGVuZCBkaXNhYmxlX29uX2xvY2sgXAoJey52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zLmluY2FsbCBjb25mIC1zdGF0ZX0KCmJ1dHRvbiAudnBhbmUubG93ZXIuY29tbWFyZWEuYnV0dG9ucy5zaWdub2ZmIC10ZXh0IHtTaWduIE9mZn0gXAoJLWNvbW1hbmQgZG9fc2lnbm9mZiBcCgktZm9udCBmb250X3VpCnBhY2sgLnZwYW5lLmxvd2VyLmNvbW1hcmVhLmJ1dHRvbnMuc2lnbm9mZiAtc2lkZSB0b3AgLWZpbGwgeAoKYnV0dG9uIC52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zLmNvbW1pdCAtdGV4dCB7Q29tbWl0fSBcCgktY29tbWFuZCBkb19jb21taXQgXAoJLWZvbnQgZm9udF91aQpwYWNrIC52cGFuZS5sb3dlci5jb21tYXJlYS5idXR0b25zLmNvbW1pdCAtc2lkZSB0b3AgLWZpbGwgeApsYXBwZW5kIGRpc2FibGVfb25fbG9jayBcCgl7LnZwYW5lLmxvd2VyLmNvbW1hcmVhLmJ1dHRvbnMuY29tbWl0IGNvbmYgLXN0YXRlfQoKIyAtLSBDb21taXQgTWVzc2FnZSBCdWZmZXIKZnJhbWUgLnZwYW5lLmxvd2VyLmNvbW1hcmVhLmJ1ZmZlcgpzZXQgdWlfY29tbSAudnBhbmUubG93ZXIuY29tbWFyZWEuYnVmZmVyLnQKc2V0IHVpX2NvbWwgLnZwYW5lLmxvd2VyLmNvbW1hcmVhLmJ1ZmZlci5sCmxhYmVsICR1aV9jb21sIC10ZXh0IHtDb21taXQgTWVzc2FnZTp9IFwKCS1hbmNob3IgdyBcCgktanVzdGlmeSBsZWZ0IFwKCS1mb250IGZvbnRfdWkKdHJhY2UgYWRkIHZhcmlhYmxlIGNvbW1pdF90eXBlIHdyaXRlIHt1cGxldmVsICMwIHsKCXN3aXRjaCAtZ2xvYiAkY29tbWl0X3R5cGUgXAoJaW5pdGlhbCB7JHVpX2NvbWwgY29uZiAtdGV4dCB7SW5pdGlhbCBDb21taXQgTWVzc2FnZTp9fSBcCglhbWVuZCAgIHskdWlfY29tbCBjb25mIC10ZXh0IHtBbWVuZGVkIENvbW1pdCBNZXNzYWdlOn19IFwKCW1lcmdlICAgeyR1aV9jb21sIGNvbmYgLXRleHQge01lcmdlIENvbW1pdCBNZXNzYWdlOn19IFwKCSogICAgICAgeyR1aV9jb21sIGNvbmYgLXRleHQge0NvbW1pdCBNZXNzYWdlOn19Cn19CnRleHQgJHVpX2NvbW0gLWJhY2tncm91bmQgd2hpdGUgLWJvcmRlcndpZHRoIDEgXAoJLXVuZG8gdHJ1ZSBcCgktbWF4dW5kbyAyMCBcCgktYXV0b3NlcGFyYXRvcnMgdHJ1ZSBcCgktcmVsaWVmIHN1bmtlbiBcCgktd2lkdGggNzUgLWhlaWdodCA5IC13cmFwIG5vbmUgXAoJLWZvbnQgZm9udF9kaWZmIFwKCS15c2Nyb2xsY29tbWFuZCB7LnZwYW5lLmxvd2VyLmNvbW1hcmVhLmJ1ZmZlci5zYnkgc2V0fQpzY3JvbGxiYXIgLnZwYW5lLmxvd2VyLmNvbW1hcmVhLmJ1ZmZlci5zYnkgXAoJLWNvbW1hbmQgW2xpc3QgJHVpX2NvbW0geXZpZXddCnBhY2sgJHVpX2NvbWwgLXNpZGUgdG9wIC1maWxsIHgKcGFjayAudnBhbmUubG93ZXIuY29tbWFyZWEuYnVmZmVyLnNieSAtc2lkZSByaWdodCAtZmlsbCB5CnBhY2sgJHVpX2NvbW0gLXNpZGUgbGVmdCAtZmlsbCB5CnBhY2sgLnZwYW5lLmxvd2VyLmNvbW1hcmVhLmJ1ZmZlciAtc2lkZSBsZWZ0IC1maWxsIHkKCiMgLS0gQ29tbWl0IE1lc3NhZ2UgQnVmZmVyIENvbnRleHQgTWVudQojCm1lbnUgJHVpX2NvbW0uY3R4bSAtdGVhcm9mZiAwCiR1aV9jb21tLmN0eG0gYWRkIGNvbW1hbmQgLWxhYmVsICJDdXQiIFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQgInRrX3RleHRDdXQgJHVpX2NvbW0iCiR1aV9jb21tLmN0eG0gYWRkIGNvbW1hbmQgLWxhYmVsICJDb3B5IiBcCgktZm9udCBmb250X3VpIFwKCS1jb21tYW5kICJ0a190ZXh0Q29weSAkdWlfY29tbSIKJHVpX2NvbW0uY3R4bSBhZGQgY29tbWFuZCAtbGFiZWwgIlBhc3RlIiBcCgktZm9udCBmb250X3VpIFwKCS1jb21tYW5kICJ0a190ZXh0UGFzdGUgJHVpX2NvbW0iCiR1aV9jb21tLmN0eG0gYWRkIGNvbW1hbmQgLWxhYmVsICJEZWxldGUiIFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQgIiR1aV9jb21tIGRlbGV0ZSBzZWwuZmlyc3Qgc2VsLmxhc3QiCiR1aV9jb21tLmN0eG0gYWRkIHNlcGFyYXRvcgokdWlfY29tbS5jdHhtIGFkZCBjb21tYW5kIC1sYWJlbCAiU2VsZWN0IEFsbCIgXAoJLWZvbnQgZm9udF91aSBcCgktY29tbWFuZCAiJHVpX2NvbW0gdGFnIGFkZCBzZWwgMC4wIGVuZCIKJHVpX2NvbW0uY3R4bSBhZGQgY29tbWFuZCAtbGFiZWwgIkNvcHkgQWxsIiBcCgktZm9udCBmb250X3VpIFwKCS1jb21tYW5kICIKCQkkdWlfY29tbSB0YWcgYWRkIHNlbCAwLjAgZW5kCgkJdGtfdGV4dENvcHkgJHVpX2NvbW0KCQkkdWlfY29tbSB0YWcgcmVtb3ZlIHNlbCAwLjAgZW5kCgkiCiR1aV9jb21tLmN0eG0gYWRkIHNlcGFyYXRvcgokdWlfY29tbS5jdHhtIGFkZCBjb21tYW5kIC1sYWJlbCAiU2lnbiBPZmYiIFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQgZG9fc2lnbm9mZgpiaW5kX2J1dHRvbjMgJHVpX2NvbW0gInRrX3BvcHVwICR1aV9jb21tLmN0eG0gJVggJVkiCgojIC0tIERpZmYgSGVhZGVyCnNldCB1aV9mbmFtZV92YWx1ZSB7fQpzZXQgdWlfZnN0YXR1c192YWx1ZSB7fQpmcmFtZSAudnBhbmUubG93ZXIuZGlmZi5oZWFkZXIgLWJhY2tncm91bmQgb3JhbmdlCmxhYmVsIC52cGFuZS5sb3dlci5kaWZmLmhlYWRlci5sNCBcCgktdGV4dHZhcmlhYmxlIHVpX2ZzdGF0dXNfdmFsdWUgXAoJLWJhY2tncm91bmQgb3JhbmdlIFwKCS13aWR0aCAkbWF4X3N0YXR1c19kZXNjIFwKCS1hbmNob3IgdyBcCgktanVzdGlmeSBsZWZ0IFwKCS1mb250IGZvbnRfdWkKbGFiZWwgLnZwYW5lLmxvd2VyLmRpZmYuaGVhZGVyLmwxIC10ZXh0IHtGaWxlOn0gXAoJLWJhY2tncm91bmQgb3JhbmdlIFwKCS1mb250IGZvbnRfdWkKc2V0IHVpX2ZuYW1lIC52cGFuZS5sb3dlci5kaWZmLmhlYWRlci5sMgp0ZXh0ICR1aV9mbmFtZSBcCgktYmFja2dyb3VuZCBvcmFuZ2UgXAoJLWhlaWdodCAxIFwKCS13cmFwIG5vbmUgXAoJLXJlbGllZiBmbGF0IFwKCS1zdGF0ZSBkaXNhYmxlZCBcCgktZm9udCBmb250X3VpCm1lbnUgJHVpX2ZuYW1lLmN0eG0gLXRlYXJvZmYgMAokdWlfZm5hbWUuY3R4bSBhZGQgY29tbWFuZCAtbGFiZWwgIkNvcHkgT25seSBTZWxlY3Rpb24iIFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQgInRrX3RleHRDb3B5ICR1aV9mbmFtZSIKJHVpX2ZuYW1lLmN0eG0gYWRkIGNvbW1hbmQgLWxhYmVsICJDb3B5IENvbXBsZXRlIE5hbWUiIFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQgIgoJCSR1aV9mbmFtZSB0YWcgYWRkIHNlbCAwLjAge2VuZCAtMWN9CgkJdGtfdGV4dENvcHkgJHVpX2ZuYW1lCgkJJHVpX2ZuYW1lIHRhZyByZW1vdmUgc2VsIDAuMCBlbmQKCSIKYmluZF9idXR0b24zICR1aV9mbmFtZSAidGtfcG9wdXAgJHVpX2ZuYW1lLmN0eG0gJVggJVkiCnRyYWNlIGFkZCB2YXJpYWJsZSB1aV9mbmFtZV92YWx1ZSB3cml0ZSAkdWlfZm5hbWUudXBkYXRlCnByb2MgJHVpX2ZuYW1lLnVwZGF0ZSB7dmFybmFtZSBhcmdzfSB7CglnbG9iYWwgdWlfZm5hbWUgdWlfZm5hbWVfdmFsdWUKCSR1aV9mbmFtZSBjb25maWd1cmUgLXN0YXRlIG5vcm1hbAoJJHVpX2ZuYW1lIGRlbGV0ZSAwLjAgZW5kCgkkdWlfZm5hbWUgaW5zZXJ0IGVuZCBbZXNjYXBlX3BhdGggJHVpX2ZuYW1lX3ZhbHVlXQoJJHVpX2ZuYW1lIGNvbmZpZ3VyZSAtc3RhdGUgZGlzYWJsZWQKfQpwYWNrIC52cGFuZS5sb3dlci5kaWZmLmhlYWRlci5sNCAtc2lkZSBsZWZ0CnBhY2sgLnZwYW5lLmxvd2VyLmRpZmYuaGVhZGVyLmwxIC1zaWRlIGxlZnQKcGFjayAkdWlfZm5hbWUgLWZpbGwgeAoKIyAtLSBEaWZmIEJvZHkKZnJhbWUgLnZwYW5lLmxvd2VyLmRpZmYuYm9keQpzZXQgdWlfZGlmZiAudnBhbmUubG93ZXIuZGlmZi5ib2R5LnQKdGV4dCAkdWlfZGlmZiAtYmFja2dyb3VuZCB3aGl0ZSAtYm9yZGVyd2lkdGggMCBcCgktd2lkdGggODAgLWhlaWdodCAxNSAtd3JhcCBub25lIFwKCS1mb250IGZvbnRfZGlmZiBcCgkteHNjcm9sbGNvbW1hbmQgey52cGFuZS5sb3dlci5kaWZmLmJvZHkuc2J4IHNldH0gXAoJLXlzY3JvbGxjb21tYW5kIHsudnBhbmUubG93ZXIuZGlmZi5ib2R5LnNieSBzZXR9IFwKCS1zdGF0ZSBkaXNhYmxlZApzY3JvbGxiYXIgLnZwYW5lLmxvd2VyLmRpZmYuYm9keS5zYnggLW9yaWVudCBob3Jpem9udGFsIFwKCS1jb21tYW5kIFtsaXN0ICR1aV9kaWZmIHh2aWV3XQpzY3JvbGxiYXIgLnZwYW5lLmxvd2VyLmRpZmYuYm9keS5zYnkgLW9yaWVudCB2ZXJ0aWNhbCBcCgktY29tbWFuZCBbbGlzdCAkdWlfZGlmZiB5dmlld10KcGFjayAudnBhbmUubG93ZXIuZGlmZi5ib2R5LnNieCAtc2lkZSBib3R0b20gLWZpbGwgeApwYWNrIC52cGFuZS5sb3dlci5kaWZmLmJvZHkuc2J5IC1zaWRlIHJpZ2h0IC1maWxsIHkKcGFjayAkdWlfZGlmZiAtc2lkZSBsZWZ0IC1maWxsIGJvdGggLWV4cGFuZCAxCnBhY2sgLnZwYW5lLmxvd2VyLmRpZmYuaGVhZGVyIC1zaWRlIHRvcCAtZmlsbCB4CnBhY2sgLnZwYW5lLmxvd2VyLmRpZmYuYm9keSAtc2lkZSBib3R0b20gLWZpbGwgYm90aCAtZXhwYW5kIDEKCiR1aV9kaWZmIHRhZyBjb25mIGRtIC1mb3JlZ3JvdW5kIHJlZAokdWlfZGlmZiB0YWcgY29uZiBkcCAtZm9yZWdyb3VuZCBibHVlCiR1aV9kaWZmIHRhZyBjb25mIGRpIC1mb3JlZ3JvdW5kIHsjMDBhMDAwfQokdWlfZGlmZiB0YWcgY29uZiBkbmkgLWZvcmVncm91bmQgeyNhMDAwYTB9CiR1aV9kaWZmIHRhZyBjb25mIGRhIC1mb250IGZvbnRfZGlmZmJvbGQKJHVpX2RpZmYgdGFnIGNvbmYgYm9sZCAtZm9udCBmb250X2RpZmZib2xkCgojIC0tIERpZmYgQm9keSBDb250ZXh0IE1lbnUKIwptZW51ICR1aV9kaWZmLmN0eG0gLXRlYXJvZmYgMAokdWlfZGlmZi5jdHhtIGFkZCBjb21tYW5kIC1sYWJlbCAiQ29weSIgXAoJLWZvbnQgZm9udF91aSBcCgktY29tbWFuZCAidGtfdGV4dENvcHkgJHVpX2RpZmYiCiR1aV9kaWZmLmN0eG0gYWRkIGNvbW1hbmQgLWxhYmVsICJTZWxlY3QgQWxsIiBcCgktZm9udCBmb250X3VpIFwKCS1jb21tYW5kICIkdWlfZGlmZiB0YWcgYWRkIHNlbCAwLjAgZW5kIgokdWlfZGlmZi5jdHhtIGFkZCBjb21tYW5kIC1sYWJlbCAiQ29weSBBbGwiIFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQgIgoJCSR1aV9kaWZmIHRhZyBhZGQgc2VsIDAuMCBlbmQKCQl0a190ZXh0Q29weSAkdWlfZGlmZgoJCSR1aV9kaWZmIHRhZyByZW1vdmUgc2VsIDAuMCBlbmQKCSIKJHVpX2RpZmYuY3R4bSBhZGQgc2VwYXJhdG9yCiR1aV9kaWZmLmN0eG0gYWRkIGNvbW1hbmQgLWxhYmVsICJEZWNyZWFzZSBGb250IFNpemUiIFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQge2luY3JfZm9udF9zaXplIGZvbnRfZGlmZiAtMX0KJHVpX2RpZmYuY3R4bSBhZGQgY29tbWFuZCAtbGFiZWwgIkluY3JlYXNlIEZvbnQgU2l6ZSIgXAoJLWZvbnQgZm9udF91aSBcCgktY29tbWFuZCB7aW5jcl9mb250X3NpemUgZm9udF9kaWZmIDF9CiR1aV9kaWZmLmN0eG0gYWRkIHNlcGFyYXRvcgokdWlfZGlmZi5jdHhtIGFkZCBjb21tYW5kIC1sYWJlbCAiU2hvdyBMZXNzIENvbnRleHQiIFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQge2lmIHskdWlfZm5hbWVfdmFsdWUgbmUge30KCQkmJiAkcmVwb19jb25maWcoZ3VpLmRpZmZjb250ZXh0KSA+PSAyfSB7CgkJaW5jciByZXBvX2NvbmZpZyhndWkuZGlmZmNvbnRleHQpIC0xCgkJcmVzaG93X2RpZmYKCX19CiR1aV9kaWZmLmN0eG0gYWRkIGNvbW1hbmQgLWxhYmVsICJTaG93IE1vcmUgQ29udGV4dCIgXAoJLWZvbnQgZm9udF91aSBcCgktY29tbWFuZCB7aWYgeyR1aV9mbmFtZV92YWx1ZSBuZSB7fX0gewoJCWluY3IgcmVwb19jb25maWcoZ3VpLmRpZmZjb250ZXh0KQoJCXJlc2hvd19kaWZmCgl9fQokdWlfZGlmZi5jdHhtIGFkZCBzZXBhcmF0b3IKJHVpX2RpZmYuY3R4bSBhZGQgY29tbWFuZCAtbGFiZWwge09wdGlvbnMuLi59IFwKCS1mb250IGZvbnRfdWkgXAoJLWNvbW1hbmQgZG9fb3B0aW9ucwpiaW5kX2J1dHRvbjMgJHVpX2RpZmYgInRrX3BvcHVwICR1aV9kaWZmLmN0eG0gJVggJVkiCgojIC0tIFN0YXR1cyBCYXIKc2V0IHVpX3N0YXR1c192YWx1ZSB7SW5pdGlhbGl6aW5nLi4ufQpsYWJlbCAuc3RhdHVzIC10ZXh0dmFyaWFibGUgdWlfc3RhdHVzX3ZhbHVlIFwKCS1hbmNob3IgdyBcCgktanVzdGlmeSBsZWZ0IFwKCS1ib3JkZXJ3aWR0aCAxIFwKCS1yZWxpZWYgc3Vua2VuIFwKCS1mb250IGZvbnRfdWkKcGFjayAuc3RhdHVzIC1hbmNob3IgdyAtc2lkZSBib3R0b20gLWZpbGwgeAoKIyAtLSBMb2FkIGdlb21ldHJ5CmNhdGNoIHsKc2V0IGdtICRyZXBvX2NvbmZpZyhndWkuZ2VvbWV0cnkpCndtIGdlb21ldHJ5IC4gW2xpbmRleCAkZ20gMF0KLnZwYW5lIHNhc2ggcGxhY2UgMCBcCglbbGluZGV4IFsudnBhbmUgc2FzaCBjb29yZCAwXSAwXSBcCglbbGluZGV4ICRnbSAxXQoudnBhbmUuZmlsZXMgc2FzaCBwbGFjZSAwIFwKCVtsaW5kZXggJGdtIDJdIFwKCVtsaW5kZXggWy52cGFuZS5maWxlcyBzYXNoIGNvb3JkIDBdIDFdCnVuc2V0IGdtCn0KCiMgLS0gS2V5IEJpbmRpbmdzCmJpbmQgJHVpX2NvbW0gPCRNMUItS2V5LVJldHVybj4ge2RvX2NvbW1pdDticmVha30KYmluZCAkdWlfY29tbSA8JE0xQi1LZXktaT4ge2RvX2luY2x1ZGVfYWxsO2JyZWFrfQpiaW5kICR1aV9jb21tIDwkTTFCLUtleS1JPiB7ZG9faW5jbHVkZV9hbGw7YnJlYWt9CmJpbmQgJHVpX2NvbW0gPCRNMUItS2V5LXg+IHt0a190ZXh0Q3V0ICVXO2JyZWFrfQpiaW5kICR1aV9jb21tIDwkTTFCLUtleS1YPiB7dGtfdGV4dEN1dCAlVzticmVha30KYmluZCAkdWlfY29tbSA8JE0xQi1LZXktYz4ge3RrX3RleHRDb3B5ICVXO2JyZWFrfQpiaW5kICR1aV9jb21tIDwkTTFCLUtleS1DPiB7dGtfdGV4dENvcHkgJVc7YnJlYWt9CmJpbmQgJHVpX2NvbW0gPCRNMUItS2V5LXY+IHt0a190ZXh0UGFzdGUgJVc7ICVXIHNlZSBpbnNlcnQ7IGJyZWFrfQpiaW5kICR1aV9jb21tIDwkTTFCLUtleS1WPiB7dGtfdGV4dFBhc3RlICVXOyAlVyBzZWUgaW5zZXJ0OyBicmVha30KYmluZCAkdWlfY29tbSA8JE0xQi1LZXktYT4geyVXIHRhZyBhZGQgc2VsIDAuMCBlbmQ7YnJlYWt9CmJpbmQgJHVpX2NvbW0gPCRNMUItS2V5LUE+IHslVyB0YWcgYWRkIHNlbCAwLjAgZW5kO2JyZWFrfQoKYmluZCAkdWlfZGlmZiA8JE0xQi1LZXkteD4ge3RrX3RleHRDb3B5ICVXO2JyZWFrfQpiaW5kICR1aV9kaWZmIDwkTTFCLUtleS1YPiB7dGtfdGV4dENvcHkgJVc7YnJlYWt9CmJpbmQgJHVpX2RpZmYgPCRNMUItS2V5LWM+IHt0a190ZXh0Q29weSAlVzticmVha30KYmluZCAkdWlfZGlmZiA8JE0xQi1LZXktQz4ge3RrX3RleHRDb3B5ICVXO2JyZWFrfQpiaW5kICR1aV9kaWZmIDwkTTFCLUtleS12PiB7YnJlYWt9CmJpbmQgJHVpX2RpZmYgPCRNMUItS2V5LVY+IHticmVha30KYmluZCAkdWlfZGlmZiA8JE0xQi1LZXktYT4geyVXIHRhZyBhZGQgc2VsIDAuMCBlbmQ7YnJlYWt9CmJpbmQgJHVpX2RpZmYgPCRNMUItS2V5LUE+IHslVyB0YWcgYWRkIHNlbCAwLjAgZW5kO2JyZWFrfQpiaW5kICR1aV9kaWZmIDxLZXktVXA+ICAgICB7Y2F0Y2ggeyVXIHl2aWV3IHNjcm9sbCAtMSB1bml0c307YnJlYWt9CmJpbmQgJHVpX2RpZmYgPEtleS1Eb3duPiAgIHtjYXRjaCB7JVcgeXZpZXcgc2Nyb2xsICAxIHVuaXRzfTticmVha30KYmluZCAkdWlfZGlmZiA8S2V5LUxlZnQ+ICAge2NhdGNoIHslVyB4dmlldyBzY3JvbGwgLTEgdW5pdHN9O2JyZWFrfQpiaW5kICR1aV9kaWZmIDxLZXktUmlnaHQ+ICB7Y2F0Y2ggeyVXIHh2aWV3IHNjcm9sbCAgMSB1bml0c307YnJlYWt9CgpiaW5kIC4gICA8RGVzdHJveT4gZG9fcXVpdApiaW5kIGFsbCA8S2V5LUY1PiBkb19yZXNjYW4KYmluZCBhbGwgPCRNMUItS2V5LXI+IGRvX3Jlc2NhbgpiaW5kIGFsbCA8JE0xQi1LZXktUj4gZG9fcmVzY2FuCmJpbmQgLiAgIDwkTTFCLUtleS1zPiBkb19zaWdub2ZmCmJpbmQgLiAgIDwkTTFCLUtleS1TPiBkb19zaWdub2ZmCmJpbmQgLiAgIDwkTTFCLUtleS1pPiBkb19pbmNsdWRlX2FsbApiaW5kIC4gICA8JE0xQi1LZXktST4gZG9faW5jbHVkZV9hbGwKYmluZCAuICAgPCRNMUItS2V5LVJldHVybj4gZG9fY29tbWl0CmJpbmQgYWxsIDwkTTFCLUtleS1xPiBkb19xdWl0CmJpbmQgYWxsIDwkTTFCLUtleS1RPiBkb19xdWl0CmJpbmQgYWxsIDwkTTFCLUtleS13PiB7ZGVzdHJveSBbd2luZm8gdG9wbGV2ZWwgJVddfQpiaW5kIGFsbCA8JE0xQi1LZXktVz4ge2Rlc3Ryb3kgW3dpbmZvIHRvcGxldmVsICVXXX0KZm9yZWFjaCBpIFtsaXN0ICR1aV9pbmRleCAkdWlfb3RoZXJdIHsKCWJpbmQgJGkgPEJ1dHRvbi0xPiB7Y2xpY2sgJVcgJXggJXkgMSAlWCAlWTsgYnJlYWt9CgliaW5kICRpIDxCdXR0b25SZWxlYXNlLTE+IHt1bmNsaWNrICVXICV4ICV5OyBicmVha30KCWJpbmRfYnV0dG9uMyAkaSB7Y2xpY2sgJVcgJXggJXkgMyAlWCAlWTsgYnJlYWt9Cn0KdW5zZXQgaQoKc2V0IGZpbGVfbGlzdHMoJHVpX2luZGV4KSBbbGlzdF0Kc2V0IGZpbGVfbGlzdHMoJHVpX290aGVyKSBbbGlzdF0KCndtIHRpdGxlIC4gIiRhcHBuYW1lIChbZmlsZSBub3JtYWxpemUgW2ZpbGUgZGlybmFtZSAkZ2l0ZGlyXV0pIgpmb2N1cyAtZm9yY2UgJHVpX2NvbW0KaWYgeyEkc2luZ2xlX2NvbW1pdH0gewoJbG9hZF9hbGxfcmVtb3RlcwoJcG9wdWxhdGVfcmVtb3RlX21lbnUgLm1iYXIuZmV0Y2ggRnJvbSBmZXRjaF9mcm9tCglwb3B1bGF0ZV9yZW1vdGVfbWVudSAubWJhci5wdXNoIFRvIHB1c2hfdG8KCXBvcHVsYXRlX3B1bGxfbWVudSAubWJhci5wdWxsCn0KYWZ0ZXIgMSB1cGRhdGVfc3RhdHVzCg==",
    "text": "#!/bin/sh\n# Tcl ignores the next line -*- tcl -*- \\\nexec wish \"$0\" -- \"$@\"\n\n# Copyright (C) 2006 Shawn Pearce, Paul Mackerras.  All rights reserved.\n# This program is free software; it may be used, copied, modified\n# and distributed under the terms of the GNU General Public Licence,\n# either version 2, or (at your option) any later version.\n\nset appname [lindex [file split $argv0] end]\nset gitdir {}\n\n######################################################################\n##\n## config\n\nproc is_many_config {name} {\n\tswitch -glob -- $name {\n\tremote.*.fetch -\n\tremote.*.push\n\t\t{return 1}\n\t*\n\t\t{return 0}\n\t}\n}\n\nproc load_config {include_global} {\n\tglobal repo_config global_config default_config\n\n\tarray unset global_config\n\tif {$include_global} {\n\t\tcatch {\n\t\t\tset fd_rc [open \"| git repo-config --global --list\" r]\n\t\t\twhile {[gets $fd_rc line] >= 0} {\n\t\t\t\tif {[regexp {^([^=]+)=(.*)$} $line line name value]} {\n\t\t\t\t\tif {[is_many_config $name]} {\n\t\t\t\t\t\tlappend global_config($name) $value\n\t\t\t\t\t} else {\n\t\t\t\t\t\tset global_config($name) $value\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tclose $fd_rc\n\t\t}\n\t}\n\n\tarray unset repo_config\n\tcatch {\n\t\tset fd_rc [open \"| git repo-config --list\" r]\n\t\twhile {[gets $fd_rc line] >= 0} {\n\t\t\tif {[regexp {^([^=]+)=(.*)$} $line line name value]} {\n\t\t\t\tif {[is_many_config $name]} {\n\t\t\t\t\tlappend repo_config($name) $value\n\t\t\t\t} else {\n\t\t\t\t\tset repo_config($name) $value\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tclose $fd_rc\n\t}\n\n\tforeach name [array names default_config] {\n\t\tif {[catch {set v $global_config($name)}]} {\n\t\t\tset global_config($name) $default_config($name)\n\t\t}\n\t\tif {[catch {set v $repo_config($name)}]} {\n\t\t\tset repo_config($name) $default_config($name)\n\t\t}\n\t}\n}\n\nproc save_config {} {\n\tglobal default_config font_descs\n\tglobal repo_config global_config\n\tglobal repo_config_new global_config_new\n\n\tforeach option $font_descs {\n\t\tset name [lindex $option 0]\n\t\tset font [lindex $option 1]\n\t\tfont configure $font \\\n\t\t\t-family $global_config_new(gui.$font^^family) \\\n\t\t\t-size $global_config_new(gui.$font^^size)\n\t\tfont configure ${font}bold \\\n\t\t\t-family $global_config_new(gui.$font^^family) \\\n\t\t\t-size $global_config_new(gui.$font^^size)\n\t\tset global_config_new(gui.$name) [font configure $font]\n\t\tunset global_config_new(gui.$font^^family)\n\t\tunset global_config_new(gui.$font^^size)\n\t}\n\n\tforeach name [array names default_config] {\n\t\tset value $global_config_new($name)\n\t\tif {$value ne $global_config($name)} {\n\t\t\tif {$value eq $default_config($name)} {\n\t\t\t\tcatch {exec git repo-config --global --unset $name}\n\t\t\t} else {\n\t\t\t\tregsub -all \"\\[{}\\]\" $value {\"} value\n\t\t\t\texec git repo-config --global $name $value\n\t\t\t}\n\t\t\tset global_config($name) $value\n\t\t\tif {$value eq $repo_config($name)} {\n\t\t\t\tcatch {exec git repo-config --unset $name}\n\t\t\t\tset repo_config($name) $value\n\t\t\t}\n\t\t}\n\t}\n\n\tforeach name [array names default_config] {\n\t\tset value $repo_config_new($name)\n\t\tif {$value ne $repo_config($name)} {\n\t\t\tif {$value eq $global_config($name)} {\n\t\t\t\tcatch {exec git repo-config --unset $name}\n\t\t\t} else {\n\t\t\t\tregsub -all \"\\[{}\\]\" $value {\"} value\n\t\t\t\texec git repo-config $name $value\n\t\t\t}\n\t\t\tset repo_config($name) $value\n\t\t}\n\t}\n}\n\nproc error_popup {msg} {\n\tglobal gitdir appname\n\n\tset title $appname\n\tif {$gitdir ne {}} {\n\t\tappend title { (}\n\t\tappend title [lindex \\\n\t\t\t[file split [file normalize [file dirname $gitdir]]] \\\n\t\t\tend]\n\t\tappend title {)}\n\t}\n\ttk_messageBox \\\n\t\t-parent . \\\n\t\t-icon error \\\n\t\t-type ok \\\n\t\t-title \"$title: error\" \\\n\t\t-message $msg\n}\n\nproc info_popup {msg} {\n\tglobal gitdir appname\n\n\tset title $appname\n\tif {$gitdir ne {}} {\n\t\tappend title { (}\n\t\tappend title [lindex \\\n\t\t\t[file split [file normalize [file dirname $gitdir]]] \\\n\t\t\tend]\n\t\tappend title {)}\n\t}\n\ttk_messageBox \\\n\t\t-parent . \\\n\t\t-icon error \\\n\t\t-type ok \\\n\t\t-title $title \\\n\t\t-message $msg\n}\n\n######################################################################\n##\n## repository setup\n\nif {   [catch {set cdup [exec git rev-parse --show-cdup]} err]\n\t|| [catch {set gitdir [exec git rev-parse --git-dir]} err]} {\n\tcatch {wm withdraw .}\n\terror_popup \"Cannot find the git directory:\\n\\n$err\"\n\texit 1\n}\nif {$cdup ne \"\"} {\n\tcd $cdup\n}\nunset cdup\n\nset single_commit 0\nif {$appname eq {git-citool}} {\n\tset single_commit 1\n}\n\n######################################################################\n##\n## task management\n\nset status_active 0\nset diff_active 0\n\nset disable_on_lock [list]\nset index_lock_type none\n\nset HEAD {}\nset PARENT {}\nset commit_type {}\n\nproc lock_index {type} {\n\tglobal index_lock_type disable_on_lock\n\n\tif {$index_lock_type eq {none}} {\n\t\tset index_lock_type $type\n\t\tforeach w $disable_on_lock {\n\t\t\tuplevel #0 $w disabled\n\t\t}\n\t\treturn 1\n\t} elseif {$index_lock_type eq {begin-update} && $type eq {update}} {\n\t\tset index_lock_type $type\n\t\treturn 1\n\t}\n\treturn 0\n}\n\nproc unlock_index {} {\n\tglobal index_lock_type disable_on_lock\n\n\tset index_lock_type none\n\tforeach w $disable_on_lock {\n\t\tuplevel #0 $w normal\n\t}\n}\n\n######################################################################\n##\n## status\n\nproc repository_state {hdvar ctvar} {\n\tglobal gitdir\n\tupvar $hdvar hd $ctvar ct\n\n\tif {[catch {set hd [exec git rev-parse --verify HEAD]}]} {\n\t\tset ct initial\n\t} elseif {[file exists [file join $gitdir MERGE_HEAD]]} {\n\t\tset ct merge\n\t} else {\n\t\tset ct normal\n\t}\n}\n\nproc update_status {{final Ready.}} {\n\tglobal HEAD PARENT commit_type\n\tglobal ui_index ui_other ui_status_value ui_comm\n\tglobal status_active file_states\n\tglobal repo_config\n\n\tif {$status_active || ![lock_index read]} return\n\n\trepository_state new_HEAD new_type\n\tif {$commit_type eq {amend}\n\t\t&& $new_type eq {normal}\n\t\t&& $new_HEAD eq $HEAD} {\n\t} else {\n\t\tset HEAD $new_HEAD\n\t\tset PARENT $new_HEAD\n\t\tset commit_type $new_type\n\t}\n\n\tarray unset file_states\n\n\tif {![$ui_comm edit modified]\n\t\t|| [string trim [$ui_comm get 0.0 end]] eq {}} {\n\t\tif {[load_message GITGUI_MSG]} {\n\t\t} elseif {[load_message MERGE_MSG]} {\n\t\t} elseif {[load_message SQUASH_MSG]} {\n\t\t}\n\t\t$ui_comm edit modified false\n\t\t$ui_comm edit reset\n\t}\n\n\tif {$repo_config(gui.trustmtime) eq {true}} {\n\t\tupdate_status_stage2 {} $final\n\t} else {\n\t\tset status_active 1\n\t\tset ui_status_value {Refreshing file status...}\n\t\tset cmd [list git update-index]\n\t\tlappend cmd -q\n\t\tlappend cmd --unmerged\n\t\tlappend cmd --ignore-missing\n\t\tlappend cmd --refresh\n\t\tset fd_rf [open \"| $cmd\" r]\n\t\tfconfigure $fd_rf -blocking 0 -translation binary\n\t\tfileevent $fd_rf readable \\\n\t\t\t[list update_status_stage2 $fd_rf $final]\n\t}\n}\n\nproc update_status_stage2 {fd final} {\n\tglobal gitdir PARENT commit_type\n\tglobal ui_index ui_other ui_status_value ui_comm\n\tglobal status_active\n\tglobal buf_rdi buf_rdf buf_rlo\n\n\tif {$fd ne {}} {\n\t\tread $fd\n\t\tif {![eof $fd]} return\n\t\tclose $fd\n\t}\n\n\tset ls_others [list | git ls-files --others -z \\\n\t\t--exclude-per-directory=.gitignore]\n\tset info_exclude [file join $gitdir info exclude]\n\tif {[file readable $info_exclude]} {\n\t\tlappend ls_others \"--exclude-from=$info_exclude\"\n\t}\n\n\tset buf_rdi {}\n\tset buf_rdf {}\n\tset buf_rlo {}\n\n\tset status_active 3\n\tset ui_status_value {Scanning for modified files ...}\n\tset fd_di [open \"| git diff-index --cached -z $PARENT\" r]\n\tset fd_df [open \"| git diff-files -z\" r]\n\tset fd_lo [open $ls_others r]\n\n\tfconfigure $fd_di -blocking 0 -translation binary\n\tfconfigure $fd_df -blocking 0 -translation binary\n\tfconfigure $fd_lo -blocking 0 -translation binary\n\tfileevent $fd_di readable [list read_diff_index $fd_di $final]\n\tfileevent $fd_df readable [list read_diff_files $fd_df $final]\n\tfileevent $fd_lo readable [list read_ls_others $fd_lo $final]\n}\n\nproc load_message {file} {\n\tglobal gitdir ui_comm\n\n\tset f [file join $gitdir $file]\n\tif {[file isfile $f]} {\n\t\tif {[catch {set fd [open $f r]}]} {\n\t\t\treturn 0\n\t\t}\n\t\tset content [string trim [read $fd]]\n\t\tclose $fd\n\t\t$ui_comm delete 0.0 end\n\t\t$ui_comm insert end $content\n\t\treturn 1\n\t}\n\treturn 0\n}\n\nproc read_diff_index {fd final} {\n\tglobal buf_rdi\n\n\tappend buf_rdi [read $fd]\n\tset c 0\n\tset n [string length $buf_rdi]\n\twhile {$c < $n} {\n\t\tset z1 [string first \"\\0\" $buf_rdi $c]\n\t\tif {$z1 == -1} break\n\t\tincr z1\n\t\tset z2 [string first \"\\0\" $buf_rdi $z1]\n\t\tif {$z2 == -1} break\n\n\t\tset c $z2\n\t\tincr z2 -1\n\t\tdisplay_file \\\n\t\t\t[string range $buf_rdi $z1 $z2] \\\n\t\t\t[string index $buf_rdi [expr $z1 - 2]]_\n\t\tincr c\n\t}\n\tif {$c < $n} {\n\t\tset buf_rdi [string range $buf_rdi $c end]\n\t} else {\n\t\tset buf_rdi {}\n\t}\n\n\tstatus_eof $fd buf_rdi $final\n}\n\nproc read_diff_files {fd final} {\n\tglobal buf_rdf\n\n\tappend buf_rdf [read $fd]\n\tset c 0\n\tset n [string length $buf_rdf]\n\twhile {$c < $n} {\n\t\tset z1 [string first \"\\0\" $buf_rdf $c]\n\t\tif {$z1 == -1} break\n\t\tincr z1\n\t\tset z2 [string first \"\\0\" $buf_rdf $z1]\n\t\tif {$z2 == -1} break\n\n\t\tset c $z2\n\t\tincr z2 -1\n\t\tdisplay_file \\\n\t\t\t[string range $buf_rdf $z1 $z2] \\\n\t\t\t_[string index $buf_rdf [expr $z1 - 2]]\n\t\tincr c\n\t}\n\tif {$c < $n} {\n\t\tset buf_rdf [string range $buf_rdf $c end]\n\t} else {\n\t\tset buf_rdf {}\n\t}\n\n\tstatus_eof $fd buf_rdf $final\n}\n\nproc read_ls_others {fd final} {\n\tglobal buf_rlo\n\n\tappend buf_rlo [read $fd]\n\tset pck [split $buf_rlo \"\\0\"]\n\tset buf_rlo [lindex $pck end]\n\tforeach p [lrange $pck 0 end-1] {\n\t\tdisplay_file $p _O\n\t}\n\tstatus_eof $fd buf_rlo $final\n}\n\nproc status_eof {fd buf final} {\n\tglobal status_active ui_status_value\n\tupvar $buf to_clear\n\n\tif {[eof $fd]} {\n\t\tset to_clear {}\n\t\tclose $fd\n\n\t\tif {[incr status_active -1] == 0} {\n\t\t\tdisplay_all_files\n\t\t\tunlock_index\n\t\t\treshow_diff\n\t\t\tset ui_status_value $final\n\t\t}\n\t}\n}\n\n######################################################################\n##\n## diff\n\nproc clear_diff {} {\n\tglobal ui_diff ui_fname_value ui_fstatus_value ui_index ui_other\n\n\t$ui_diff conf -state normal\n\t$ui_diff delete 0.0 end\n\t$ui_diff conf -state disabled\n\n\tset ui_fname_value {}\n\tset ui_fstatus_value {}\n\n\t$ui_index tag remove in_diff 0.0 end\n\t$ui_other tag remove in_diff 0.0 end\n}\n\nproc reshow_diff {} {\n\tglobal ui_fname_value ui_status_value file_states\n\n\tif {$ui_fname_value eq {}\n\t\t|| [catch {set s $file_states($ui_fname_value)}]} {\n\t\tclear_diff\n\t} else {\n\t\tshow_diff $ui_fname_value\n\t}\n}\n\nproc handle_empty_diff {} {\n\tglobal ui_fname_value file_states file_lists\n\n\tset path $ui_fname_value\n\tset s $file_states($path)\n\tif {[lindex $s 0] ne {_M}} return\n\n\tinfo_popup \"No differences detected.\n\n[short_path $path] has no changes.\n\nThe modification date of this file was updated by another\napplication and you currently have the Trust File Modification\nTimestamps option enabled, so Git did not automatically detect\nthat there are no content differences in this file.\n\nThis file will now be removed from the modified files list, to\nprevent possible confusion.\n\"\n\tif {[catch {exec git update-index -- $path} err]} {\n\t\terror_popup \"Failed to refresh index:\\n\\n$err\"\n\t}\n\n\tclear_diff\n\tset old_w [mapcol [lindex $file_states($path) 0] $path]\n\tset lno [lsearch -sorted $file_lists($old_w) $path]\n\tif {$lno >= 0} {\n\t\tset file_lists($old_w) \\\n\t\t\t[lreplace $file_lists($old_w) $lno $lno]\n\t\tincr lno\n\t\t$old_w conf -state normal\n\t\t$old_w delete $lno.0 [expr $lno + 1].0\n\t\t$old_w conf -state disabled\n\t}\n}\n\nproc show_diff {path {w {}} {lno {}}} {\n\tglobal file_states file_lists\n\tglobal PARENT diff_3way diff_active repo_config\n\tglobal ui_diff ui_fname_value ui_fstatus_value ui_status_value\n\n\tif {$diff_active || ![lock_index read]} return\n\n\tclear_diff\n\tif {$w eq {} || $lno == {}} {\n\t\tforeach w [array names file_lists] {\n\t\t\tset lno [lsearch -sorted $file_lists($w) $path]\n\t\t\tif {$lno >= 0} {\n\t\t\t\tincr lno\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\tif {$w ne {} && $lno >= 1} {\n\t\t$w tag add in_diff $lno.0 [expr $lno + 1].0\n\t}\n\n\tset s $file_states($path)\n\tset m [lindex $s 0]\n\tset diff_3way 0\n\tset diff_active 1\n\tset ui_fname_value $path\n\tset ui_fstatus_value [mapdesc $m $path]\n\tset ui_status_value \"Loading diff of [escape_path $path]...\"\n\n\tset cmd [list | git diff-index]\n\tlappend cmd --no-color\n\tif {$repo_config(gui.diffcontext) > 0} {\n\t\tlappend cmd \"-U$repo_config(gui.diffcontext)\"\n\t}\n\tlappend cmd -p\n\n\tswitch $m {\n\tMM {\n\t\tlappend cmd -c\n\t}\n\t_O {\n\t\tif {[catch {\n\t\t\t\tset fd [open $path r]\n\t\t\t\tset content [read $fd]\n\t\t\t\tclose $fd\n\t\t\t} err ]} {\n\t\t\tset diff_active 0\n\t\t\tunlock_index\n\t\t\tset ui_status_value \"Unable to display [escape_path $path]\"\n\t\t\terror_popup \"Error loading file:\\n\\n$err\"\n\t\t\treturn\n\t\t}\n\t\t$ui_diff conf -state normal\n\t\t$ui_diff insert end $content\n\t\t$ui_diff conf -state disabled\n\t\tset diff_active 0\n\t\tunlock_index\n\t\tset ui_status_value {Ready.}\n\t\treturn\n\t}\n\t}\n\n\tlappend cmd $PARENT\n\tlappend cmd --\n\tlappend cmd $path\n\n\tif {[catch {set fd [open $cmd r]} err]} {\n\t\tset diff_active 0\n\t\tunlock_index\n\t\tset ui_status_value \"Unable to display [escape_path $path]\"\n\t\terror_popup \"Error loading diff:\\n\\n$err\"\n\t\treturn\n\t}\n\n\tfconfigure $fd -blocking 0 -translation auto\n\tfileevent $fd readable [list read_diff $fd]\n}\n\nproc read_diff {fd} {\n\tglobal ui_diff ui_status_value diff_3way diff_active\n\tglobal repo_config\n\n\twhile {[gets $fd line] >= 0} {\n\t\tif {[string match {diff --git *} $line]} continue\n\t\tif {[string match {diff --combined *} $line]} continue\n\t\tif {[string match {--- *} $line]} continue\n\t\tif {[string match {+++ *} $line]} continue\n\t\tif {[string match index* $line]} {\n\t\t\tif {[string first , $line] >= 0} {\n\t\t\t\tset diff_3way 1\n\t\t\t}\n\t\t}\n\n\t\t$ui_diff conf -state normal\n\t\tif {!$diff_3way} {\n\t\t\tset x [string index $line 0]\n\t\t\tswitch -- $x {\n\t\t\t\"@\" {set tags da}\n\t\t\t\"+\" {set tags dp}\n\t\t\t\"-\" {set tags dm}\n\t\t\tdefault {set tags {}}\n\t\t\t}\n\t\t} else {\n\t\t\tset x [string range $line 0 1]\n\t\t\tswitch -- $x {\n\t\t\tdefault {set tags {}}\n\t\t\t\"@@\" {set tags da}\n\t\t\t\"++\" {set tags dp; set x \" +\"}\n\t\t\t\" +\" {set tags {di bold}; set x \"++\"}\n\t\t\t\"+ \" {set tags dni; set x \"-+\"}\n\t\t\t\"--\" {set tags dm; set x \" -\"}\n\t\t\t\" -\" {set tags {dm bold}; set x \"--\"}\n\t\t\t\"- \" {set tags di; set x \"+-\"}\n\t\t\tdefault {set tags {}}\n\t\t\t}\n\t\t\tset line [string replace $line 0 1 $x]\n\t\t}\n\t\t$ui_diff insert end $line $tags\n\t\t$ui_diff insert end \"\\n\"\n\t\t$ui_diff conf -state disabled\n\t}\n\n\tif {[eof $fd]} {\n\t\tclose $fd\n\t\tset diff_active 0\n\t\tunlock_index\n\t\tset ui_status_value {Ready.}\n\n\t\tif {$repo_config(gui.trustmtime) eq {true}\n\t\t\t&& [$ui_diff index end] eq {2.0}} {\n\t\t\thandle_empty_diff\n\t\t}\n\t}\n}\n\n######################################################################\n##\n## commit\n\nproc load_last_commit {} {\n\tglobal HEAD PARENT commit_type ui_comm\n\n\tif {$commit_type eq {amend}} return\n\tif {$commit_type ne {normal}} {\n\t\terror_popup \"Can't amend a $commit_type commit.\"\n\t\treturn\n\t}\n\n\tset msg {}\n\tset parent {}\n\tset parent_count 0\n\tif {[catch {\n\t\t\tset fd [open \"| git cat-file commit $HEAD\" r]\n\t\t\twhile {[gets $fd line] > 0} {\n\t\t\t\tif {[string match {parent *} $line]} {\n\t\t\t\t\tset parent [string range $line 7 end]\n\t\t\t\t\tincr parent_count\n\t\t\t\t}\n\t\t\t}\n\t\t\tset msg [string trim [read $fd]]\n\t\t\tclose $fd\n\t\t} err]} {\n\t\terror_popup \"Error loading commit data for amend:\\n\\n$err\"\n\t\treturn\n\t}\n\n\tif {$parent_count == 0} {\n\t\tset commit_type amend\n\t\tset HEAD {}\n\t\tset PARENT {}\n\t\tupdate_status\n\t} elseif {$parent_count == 1} {\n\t\tset commit_type amend\n\t\tset PARENT $parent\n\t\t$ui_comm delete 0.0 end\n\t\t$ui_comm insert end $msg\n\t\t$ui_comm edit modified false\n\t\t$ui_comm edit reset\n\t\tupdate_status\n\t} else {\n\t\terror_popup {You can't amend a merge commit.}\n\t\treturn\n\t}\n}\n\nproc commit_tree {} {\n\tglobal tcl_platform HEAD gitdir commit_type file_states\n\tglobal pch_error\n\tglobal ui_status_value ui_comm\n\n\tif {![lock_index update]} return\n\n\t# -- Our in memory state should match the repository.\n\t#\n\trepository_state curHEAD cur_type\n\tif {$commit_type eq {amend}\n\t\t&& $cur_type eq {normal}\n\t\t&& $curHEAD eq $HEAD} {\n\t} elseif {$commit_type ne $cur_type || $HEAD ne $curHEAD} {\n\t\terror_popup {Last scanned state does not match repository state.\n\nIts highly likely that another Git program modified the\nrepository since our last scan.  A rescan is required\nbefore committing.\n}\n\t\tunlock_index\n\t\tupdate_status\n\t\treturn\n\t}\n\n\t# -- At least one file should differ in the index.\n\t#\n\tset files_ready 0\n\tforeach path [array names file_states] {\n\t\tset s $file_states($path)\n\t\tswitch -glob -- [lindex $s 0] {\n\t\t_? {continue}\n\t\tA? -\n\t\tD? -\n\t\tM? {set files_ready 1; break}\n\t\tU? {\n\t\t\terror_popup \"Unmerged files cannot be committed.\n\nFile [short_path $path] has merge conflicts.\nYou must resolve them and include the file before committing.\n\"\n\t\t\tunlock_index\n\t\t\treturn\n\t\t}\n\t\tdefault {\n\t\t\terror_popup \"Unknown file state [lindex $s 0] detected.\n\nFile [short_path $path] cannot be committed by this program.\n\"\n\t\t}\n\t\t}\n\t}\n\tif {!$files_ready} {\n\t\terror_popup {No included files to commit.\n\nYou must include at least 1 file before you can commit.\n}\n\t\tunlock_index\n\t\treturn\n\t}\n\n\t# -- A message is required.\n\t#\n\tset msg [string trim [$ui_comm get 1.0 end]]\n\tif {$msg eq {}} {\n\t\terror_popup {Please supply a commit message.\n\nA good commit message has the following format:\n\n- First line: Describe in one sentance what you did.\n- Second line: Blank\n- Remaining lines: Describe why this change is good.\n}\n\t\tunlock_index\n\t\treturn\n\t}\n\n\t# -- Ask the pre-commit hook for the go-ahead.\n\t#\n\tset pchook [file join $gitdir hooks pre-commit]\n\tif {$tcl_platform(platform) eq {windows} && [file isfile $pchook]} {\n\t\tset pchook [list sh -c [concat \\\n\t\t\t\"if test -x \\\"$pchook\\\";\" \\\n\t\t\t\"then exec \\\"$pchook\\\" 2>&1;\" \\\n\t\t\t\"fi\"]]\n\t} elseif {[file executable $pchook]} {\n\t\tset pchook [list $pchook |& cat]\n\t} else {\n\t\tset pchook {}\n\t}\n\tif {$pchook ne {}} {\n\t\tset ui_status_value {Calling pre-commit hook...}\n\t\tset pch_error {}\n\t\tset fd_ph [open \"| $pchook\" r]\n\t\tfconfigure $fd_ph -blocking 0 -translation binary\n\t\tfileevent $fd_ph readable \\\n\t\t\t[list commit_stage1 $fd_ph $curHEAD $msg]\n\t} else {\n\t\tcommit_stage2 $curHEAD $msg\n\t}\n}\n\nproc commit_stage1 {fd_ph curHEAD msg} {\n\tglobal pch_error ui_status_value\n\n\tappend pch_error [read $fd_ph]\n\tfconfigure $fd_ph -blocking 1\n\tif {[eof $fd_ph]} {\n\t\tif {[catch {close $fd_ph}]} {\n\t\t\tset ui_status_value {Commit declined by pre-commit hook.}\n\t\t\thook_failed_popup pre-commit $pch_error\n\t\t\tunlock_index\n\t\t} else {\n\t\t\tcommit_stage2 $curHEAD $msg\n\t\t}\n\t\tset pch_error {}\n\t} else {\n\t\tfconfigure $fd_ph -blocking 0\n\t}\n}\n\nproc commit_stage2 {curHEAD msg} {\n\tglobal ui_status_value\n\n\t# -- Write the tree in the background.\n\t#\n\tset ui_status_value {Committing changes...}\n\tset fd_wt [open \"| git write-tree\" r]\n\tfileevent $fd_wt readable [list commit_stage3 $fd_wt $curHEAD $msg]\n}\n\nproc commit_stage3 {fd_wt curHEAD msg} {\n\tglobal single_commit gitdir HEAD PARENT commit_type tcl_platform\n\tglobal ui_status_value ui_comm\n\tglobal file_states\n\n\tgets $fd_wt tree_id\n\tif {$tree_id eq {} || [catch {close $fd_wt} err]} {\n\t\terror_popup \"write-tree failed:\\n\\n$err\"\n\t\tset ui_status_value {Commit failed.}\n\t\tunlock_index\n\t\treturn\n\t}\n\n\t# -- Create the commit.\n\t#\n\tset cmd [list git commit-tree $tree_id]\n\tif {$PARENT ne {}} {\n\t\tlappend cmd -p $PARENT\n\t}\n\tif {$commit_type eq {merge}} {\n\t\tif {[catch {\n\t\t\t\tset fd_mh [open [file join $gitdir MERGE_HEAD] r]\n\t\t\t\twhile {[gets $fd_mh merge_head] >= 0} {\n\t\t\t\t\tlappend cmd -p $merge_head\n\t\t\t\t}\n\t\t\t\tclose $fd_mh\n\t\t\t} err]} {\n\t\t\terror_popup \"Loading MERGE_HEAD failed:\\n\\n$err\"\n\t\t\tset ui_status_value {Commit failed.}\n\t\t\tunlock_index\n\t\t\treturn\n\t\t}\n\t}\n\tif {$PARENT eq {}} {\n\t\t# git commit-tree writes to stderr during initial commit.\n\t\tlappend cmd 2>/dev/null\n\t}\n\tlappend cmd << $msg\n\tif {[catch {set cmt_id [eval exec $cmd]} err]} {\n\t\terror_popup \"commit-tree failed:\\n\\n$err\"\n\t\tset ui_status_value {Commit failed.}\n\t\tunlock_index\n\t\treturn\n\t}\n\n\t# -- Update the HEAD ref.\n\t#\n\tset reflogm commit\n\tif {$commit_type ne {normal}} {\n\t\tappend reflogm \" ($commit_type)\"\n\t}\n\tset i [string first \"\\n\" $msg]\n\tif {$i >= 0} {\n\t\tappend reflogm {: } [string range $msg 0 [expr $i - 1]]\n\t} else {\n\t\tappend reflogm {: } $msg\n\t}\n\tset cmd [list git update-ref -m $reflogm HEAD $cmt_id $curHEAD]\n\tif {[catch {eval exec $cmd} err]} {\n\t\terror_popup \"update-ref failed:\\n\\n$err\"\n\t\tset ui_status_value {Commit failed.}\n\t\tunlock_index\n\t\treturn\n\t}\n\n\t# -- Cleanup after ourselves.\n\t#\n\tcatch {file delete [file join $gitdir MERGE_HEAD]}\n\tcatch {file delete [file join $gitdir MERGE_MSG]}\n\tcatch {file delete [file join $gitdir SQUASH_MSG]}\n\tcatch {file delete [file join $gitdir GITGUI_MSG]}\n\n\t# -- Let rerere do its thing.\n\t#\n\tif {[file isdirectory [file join $gitdir rr-cache]]} {\n\t\tcatch {exec git rerere}\n\t}\n\n\t# -- Run the post-commit hook.\n\t#\n\tset pchook [file join $gitdir hooks post-commit]\n\tif {$tcl_platform(platform) eq {windows} && [file isfile $pchook]} {\n\t\tset pchook [list sh -c [concat \\\n\t\t\t\"if test -x \\\"$pchook\\\";\" \\\n\t\t\t\"then exec \\\"$pchook\\\";\" \\\n\t\t\t\"fi\"]]\n\t} elseif {![file executable $pchook]} {\n\t\tset pchook {}\n\t}\n\tif {$pchook ne {}} {\n\t\tcatch {exec $pchook &}\n\t}\n\n\t$ui_comm delete 0.0 end\n\t$ui_comm edit modified false\n\t$ui_comm edit reset\n\n\tif {$single_commit} do_quit\n\n\t# -- Update status without invoking any git commands.\n\t#\n\tset commit_type normal\n\tset HEAD $cmt_id\n\tset PARENT $cmt_id\n\n\tforeach path [array names file_states] {\n\t\tset s $file_states($path)\n\t\tset m [lindex $s 0]\n\t\tswitch -glob -- $m {\n\t\tA? -\n\t\tM? -\n\t\tD? {set m _[string index $m 1]}\n\t\t}\n\n\t\tif {$m eq {__}} {\n\t\t\tunset file_states($path)\n\t\t} else {\n\t\t\tlset file_states($path) 0 $m\n\t\t}\n\t}\n\n\tdisplay_all_files\n\tunlock_index\n\treshow_diff\n\tset ui_status_value \\\n\t\t\"Changes committed as [string range $cmt_id 0 7].\"\n}\n\n######################################################################\n##\n## fetch pull push\n\nproc fetch_from {remote} {\n\tset w [new_console \"fetch $remote\" \\\n\t\t\"Fetching new changes from $remote\"]\n\tset cmd [list git fetch]\n\tlappend cmd $remote\n\tconsole_exec $w $cmd\n}\n\nproc pull_remote {remote branch} {\n\tglobal HEAD commit_type file_states repo_config\n\n\tif {![lock_index update]} return\n\n\t# -- Our in memory state should match the repository.\n\t#\n\trepository_state curHEAD cur_type\n\tif {$commit_type ne $cur_type || $HEAD ne $curHEAD} {\n\t\terror_popup {Last scanned state does not match repository state.\n\nIts highly likely that another Git program modified the\nrepository since our last scan.  A rescan is required\nbefore a pull can be started.\n}\n\t\tunlock_index\n\t\tupdate_status\n\t\treturn\n\t}\n\n\t# -- No differences should exist before a pull.\n\t#\n\tif {[array size file_states] != 0} {\n\t\terror_popup {Uncommitted but modified files are present.\n\nYou should not perform a pull with unmodified files in your working\ndirectory as Git would be unable to recover from an incorrect merge.\n\nCommit or throw away all changes before starting a pull operation.\n}\n\t\tunlock_index\n\t\treturn\n\t}\n\n\tset w [new_console \"pull $remote $branch\" \\\n\t\t\"Pulling new changes from branch $branch in $remote\"]\n\tset cmd [list git pull]\n\tif {$repo_config(gui.pullsummary) eq {false}} {\n\t\tlappend cmd --no-summary\n\t}\n\tlappend cmd $remote\n\tlappend cmd $branch\n\tconsole_exec $w $cmd [list post_pull_remote $remote $branch]\n}\n\nproc post_pull_remote {remote branch success} {\n\tglobal HEAD PARENT commit_type\n\tglobal ui_status_value\n\n\tunlock_index\n\tif {$success} {\n\t\trepository_state HEAD commit_type\n\t\tset PARENT $HEAD\n\t\tset $ui_status_value {Ready.}\n\t} else {\n\t\tupdate_status \\\n\t\t\t\"Conflicts detected while pulling $branch from $remote.\"\n\t}\n}\n\nproc push_to {remote} {\n\tset w [new_console \"push $remote\" \\\n\t\t\"Pushing changes to $remote\"]\n\tset cmd [list git push]\n\tlappend cmd $remote\n\tconsole_exec $w $cmd\n}\n\n######################################################################\n##\n## ui helpers\n\nproc mapcol {state path} {\n\tglobal all_cols ui_other\n\n\tif {[catch {set r $all_cols($state)}]} {\n\t\tputs \"error: no column for state={$state} $path\"\n\t\treturn $ui_other\n\t}\n\treturn $r\n}\n\nproc mapicon {state path} {\n\tglobal all_icons\n\n\tif {[catch {set r $all_icons($state)}]} {\n\t\tputs \"error: no icon for state={$state} $path\"\n\t\treturn file_plain\n\t}\n\treturn $r\n}\n\nproc mapdesc {state path} {\n\tglobal all_descs\n\n\tif {[catch {set r $all_descs($state)}]} {\n\t\tputs \"error: no desc for state={$state} $path\"\n\t\treturn $state\n\t}\n\treturn $r\n}\n\nproc escape_path {path} {\n\tregsub -all \"\\n\" $path \"\\\\n\" path\n\treturn $path\n}\n\nproc short_path {path} {\n\treturn [escape_path [lindex [file split $path] end]]\n}\n\nset next_icon_id 0\n\nproc merge_state {path new_state} {\n\tglobal file_states next_icon_id\n\n\tset s0 [string index $new_state 0]\n\tset s1 [string index $new_state 1]\n\n\tif {[catch {set info $file_states($path)}]} {\n\t\tset state __\n\t\tset icon n[incr next_icon_id]\n\t} else {\n\t\tset state [lindex $info 0]\n\t\tset icon [lindex $info 1]\n\t}\n\n\tif {$s0 eq {_}} {\n\t\tset s0 [string index $state 0]\n\t} elseif {$s0 eq {*}} {\n\t\tset s0 _\n\t}\n\n\tif {$s1 eq {_}} {\n\t\tset s1 [string index $state 1]\n\t} elseif {$s1 eq {*}} {\n\t\tset s1 _\n\t}\n\n\tset file_states($path) [list $s0$s1 $icon]\n\treturn $state\n}\n\nproc display_file {path state} {\n\tglobal file_states file_lists status_active\n\n\tset old_m [merge_state $path $state]\n\tif {$status_active} return\n\n\tset s $file_states($path)\n\tset new_m [lindex $s 0]\n\tset new_w [mapcol $new_m $path] \n\tset old_w [mapcol $old_m $path]\n\tset new_icon [mapicon $new_m $path]\n\n\tif {$new_w ne $old_w} {\n\t\tset lno [lsearch -sorted $file_lists($old_w) $path]\n\t\tif {$lno >= 0} {\n\t\t\tincr lno\n\t\t\t$old_w conf -state normal\n\t\t\t$old_w delete $lno.0 [expr $lno + 1].0\n\t\t\t$old_w conf -state disabled\n\t\t}\n\n\t\tlappend file_lists($new_w) $path\n\t\tset file_lists($new_w) [lsort $file_lists($new_w)]\n\t\tset lno [lsearch -sorted $file_lists($new_w) $path]\n\t\tincr lno\n\t\t$new_w conf -state normal\n\t\t$new_w image create $lno.0 \\\n\t\t\t-align center -padx 5 -pady 1 \\\n\t\t\t-name [lindex $s 1] \\\n\t\t\t-image $new_icon\n\t\t$new_w insert $lno.1 \"[escape_path $path]\\n\"\n\t\t$new_w conf -state disabled\n\t} elseif {$new_icon ne [mapicon $old_m $path]} {\n\t\t$new_w conf -state normal\n\t\t$new_w image conf [lindex $s 1] -image $new_icon\n\t\t$new_w conf -state disabled\n\t}\n}\n\nproc display_all_files {} {\n\tglobal ui_index ui_other file_states file_lists\n\n\t$ui_index conf -state normal\n\t$ui_other conf -state normal\n\n\t$ui_index delete 0.0 end\n\t$ui_other delete 0.0 end\n\n\tset file_lists($ui_index) [list]\n\tset file_lists($ui_other) [list]\n\n\tforeach path [lsort [array names file_states]] {\n\t\tset s $file_states($path)\n\t\tset m [lindex $s 0]\n\t\tset w [mapcol $m $path]\n\t\tlappend file_lists($w) $path\n\t\t$w image create end \\\n\t\t\t-align center -padx 5 -pady 1 \\\n\t\t\t-name [lindex $s 1] \\\n\t\t\t-image [mapicon $m $path]\n\t\t$w insert end \"[escape_path $path]\\n\"\n\t}\n\n\t$ui_index conf -state disabled\n\t$ui_other conf -state disabled\n}\n\nproc update_index {pathList} {\n\tglobal update_index_cp update_index_rsd ui_status_value\n\n\tif {![lock_index update]} return\n\n\tset update_index_cp 0\n\tset update_index_rsd 0\n\tset pathList [lsort $pathList]\n\tset totalCnt [llength $pathList]\n\tset batch [expr {int($totalCnt * .01) + 1}]\n\tif {$batch > 25} {set batch 25}\n\n\tset ui_status_value \"Including files ... 0/$totalCnt 0%\"\n\tset ui_status_value [format \\\n\t\t\"Including files ... %i/%i files (%.2f%%)\" \\\n\t\t$update_index_cp \\\n\t\t$totalCnt \\\n\t\t0.0]\n\tset fd [open \"| git update-index --add --remove -z --stdin\" w]\n\tfconfigure $fd \\\n\t\t-blocking 0 \\\n\t\t-buffering full \\\n\t\t-buffersize 512 \\\n\t\t-translation binary\n\tfileevent $fd writable [list \\\n\t\twrite_update_index \\\n\t\t$fd \\\n\t\t$pathList \\\n\t\t$totalCnt \\\n\t\t$batch \\\n\t\t]\n}\n\nproc write_update_index {fd pathList totalCnt batch} {\n\tglobal update_index_cp update_index_rsd ui_status_value\n\tglobal file_states ui_fname_value\n\n\tif {$update_index_cp >= $totalCnt} {\n\t\tclose $fd\n\t\tunlock_index\n\t\tif {$update_index_rsd} {\n\t\t\treshow_diff\n\t\t} else {\n\t\t\tset ui_status_value {Ready.}\n\t\t}\n\t\treturn\n\t}\n\n\tfor {set i $batch} \\\n\t\t{$update_index_cp < $totalCnt && $i > 0} \\\n\t\t{incr i -1} {\n\t\tset path [lindex $pathList $update_index_cp]\n\t\tincr update_index_cp\n\n\t\tswitch -- [lindex $file_states($path) 0] {\n\t\tAM -\n\t\t_O {set new A*}\n\t\t_M -\n\t\tMM {set new M*}\n\t\tAD -\n\t\t_D {set new D*}\n\t\tdefault {continue}\n\t\t}\n\n\t\tputs -nonewline $fd $path\n\t\tputs -nonewline $fd \"\\0\"\n\t\tdisplay_file $path $new\n\t\tif {$ui_fname_value eq $path} {\n\t\t\tset update_index_rsd 1\n\t\t}\n\t}\n\n\tset ui_status_value [format \\\n\t\t\"Including files ... %i/%i files (%.2f%%)\" \\\n\t\t$update_index_cp \\\n\t\t$totalCnt \\\n\t\t[expr {100.0 * $update_index_cp / $totalCnt}]]\n}\n\n######################################################################\n##\n## remote management\n\nproc load_all_remotes {} {\n\tglobal gitdir all_remotes repo_config\n\n\tset all_remotes [list]\n\tset rm_dir [file join $gitdir remotes]\n\tif {[file isdirectory $rm_dir]} {\n\t\tset all_remotes [concat $all_remotes [glob \\\n\t\t\t-types f \\\n\t\t\t-tails \\\n\t\t\t-nocomplain \\\n\t\t\t-directory $rm_dir *]]\n\t}\n\n\tforeach line [array names repo_config remote.*.url] {\n\t\tif {[regexp ^remote\\.(.*)\\.url\\$ $line line name]} {\n\t\t\tlappend all_remotes $name\n\t\t}\n\t}\n\n\tset all_remotes [lsort -unique $all_remotes]\n}\n\nproc populate_remote_menu {m pfx op} {\n\tglobal all_remotes\n\n\tforeach remote $all_remotes {\n\t\t$m add command -label \"$pfx $remote...\" \\\n\t\t\t-command [list $op $remote] \\\n\t\t\t-font font_ui\n\t}\n}\n\nproc populate_pull_menu {m} {\n\tglobal gitdir repo_config all_remotes disable_on_lock\n\n\tforeach remote $all_remotes {\n\t\tset rb {}\n\t\tif {[array get repo_config remote.$remote.url] ne {}} {\n\t\t\tif {[array get repo_config remote.$remote.fetch] ne {}} {\n\t\t\t\tregexp {^([^:]+):} \\\n\t\t\t\t\t[lindex $repo_config(remote.$remote.fetch) 0] \\\n\t\t\t\t\tline rb\n\t\t\t}\n\t\t} else {\n\t\t\tcatch {\n\t\t\t\tset fd [open [file join $gitdir remotes $remote] r]\n\t\t\t\twhile {[gets $fd line] >= 0} {\n\t\t\t\t\tif {[regexp {^Pull:[ \\t]*([^:]+):} $line line rb]} {\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tclose $fd\n\t\t\t}\n\t\t}\n\n\t\tset rb_short $rb\n\t\tregsub ^refs/heads/ $rb {} rb_short\n\t\tif {$rb_short ne {}} {\n\t\t\t$m add command \\\n\t\t\t\t-label \"Branch $rb_short from $remote...\" \\\n\t\t\t\t-command [list pull_remote $remote $rb] \\\n\t\t\t\t-font font_ui\n\t\t\tlappend disable_on_lock \\\n\t\t\t\t[list $m entryconf [$m index last] -state]\n\t\t}\n\t}\n}\n\n######################################################################\n##\n## icons\n\nset filemask {\n#define mask_width 14\n#define mask_height 15\nstatic unsigned char mask_bits[] = {\n   0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f,\n   0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f,\n   0xfe, 0x1f, 0xfe, 0x1f, 0xfe, 0x1f};\n}\n\nimage create bitmap file_plain -background white -foreground black -data {\n#define plain_width 14\n#define plain_height 15\nstatic unsigned char plain_bits[] = {\n   0xfe, 0x01, 0x02, 0x03, 0x02, 0x05, 0x02, 0x09, 0x02, 0x1f, 0x02, 0x10,\n   0x02, 0x10, 0x02, 0x10, 0x02, 0x10, 0x02, 0x10, 0x02, 0x10, 0x02, 0x10,\n   0x02, 0x10, 0x02, 0x10, 0xfe, 0x1f};\n} -maskdata $filemask\n\nimage create bitmap file_mod -background white -foreground blue -data {\n#define mod_width 14\n#define mod_height 15\nstatic unsigned char mod_bits[] = {\n   0xfe, 0x01, 0x02, 0x03, 0x7a, 0x05, 0x02, 0x09, 0x7a, 0x1f, 0x02, 0x10,\n   0xfa, 0x17, 0x02, 0x10, 0xfa, 0x17, 0x02, 0x10, 0xfa, 0x17, 0x02, 0x10,\n   0xfa, 0x17, 0x02, 0x10, 0xfe, 0x1f};\n} -maskdata $filemask\n\nimage create bitmap file_fulltick -background white -foreground \"#007000\" -data {\n#define file_fulltick_width 14\n#define file_fulltick_height 15\nstatic unsigned char file_fulltick_bits[] = {\n   0xfe, 0x01, 0x02, 0x1a, 0x02, 0x0c, 0x02, 0x0c, 0x02, 0x16, 0x02, 0x16,\n   0x02, 0x13, 0x00, 0x13, 0x86, 0x11, 0x8c, 0x11, 0xd8, 0x10, 0xf2, 0x10,\n   0x62, 0x10, 0x02, 0x10, 0xfe, 0x1f};\n} -maskdata $filemask\n\nimage create bitmap file_parttick -background white -foreground \"#005050\" -data {\n#define parttick_width 14\n#define parttick_height 15\nstatic unsigned char parttick_bits[] = {\n   0xfe, 0x01, 0x02, 0x03, 0x7a, 0x05, 0x02, 0x09, 0x7a, 0x1f, 0x02, 0x10,\n   0x7a, 0x14, 0x02, 0x16, 0x02, 0x13, 0x8a, 0x11, 0xda, 0x10, 0x72, 0x10,\n   0x22, 0x10, 0x02, 0x10, 0xfe, 0x1f};\n} -maskdata $filemask\n\nimage create bitmap file_question -background white -foreground black -data {\n#define file_question_width 14\n#define file_question_height 15\nstatic unsigned char file_question_bits[] = {\n   0xfe, 0x01, 0x02, 0x02, 0xe2, 0x04, 0xf2, 0x09, 0x1a, 0x1b, 0x0a, 0x13,\n   0x82, 0x11, 0xc2, 0x10, 0x62, 0x10, 0x62, 0x10, 0x02, 0x10, 0x62, 0x10,\n   0x62, 0x10, 0x02, 0x10, 0xfe, 0x1f};\n} -maskdata $filemask\n\nimage create bitmap file_removed -background white -foreground red -data {\n#define file_removed_width 14\n#define file_removed_height 15\nstatic unsigned char file_removed_bits[] = {\n   0xfe, 0x01, 0x02, 0x03, 0x02, 0x05, 0x02, 0x09, 0x02, 0x1f, 0x02, 0x10,\n   0x1a, 0x16, 0x32, 0x13, 0xe2, 0x11, 0xc2, 0x10, 0xe2, 0x11, 0x32, 0x13,\n   0x1a, 0x16, 0x02, 0x10, 0xfe, 0x1f};\n} -maskdata $filemask\n\nimage create bitmap file_merge -background white -foreground blue -data {\n#define file_merge_width 14\n#define file_merge_height 15\nstatic unsigned char file_merge_bits[] = {\n   0xfe, 0x01, 0x02, 0x03, 0x62, 0x05, 0x62, 0x09, 0x62, 0x1f, 0x62, 0x10,\n   0xfa, 0x11, 0xf2, 0x10, 0x62, 0x10, 0x02, 0x10, 0xfa, 0x17, 0x02, 0x10,\n   0xfa, 0x17, 0x02, 0x10, 0xfe, 0x1f};\n} -maskdata $filemask\n\nset ui_index .vpane.files.index.list\nset ui_other .vpane.files.other.list\nset max_status_desc 0\nforeach i {\n\t\t{__ i plain    \"Unmodified\"}\n\t\t{_M i mod      \"Modified\"}\n\t\t{M_ i fulltick \"Included in commit\"}\n\t\t{MM i parttick \"Partially included\"}\n\n\t\t{_O o plain    \"Untracked\"}\n\t\t{A_ o fulltick \"Added by commit\"}\n\t\t{AM o parttick \"Partially added\"}\n\t\t{AD o question \"Added (but now gone)\"}\n\n\t\t{_D i question \"Missing\"}\n\t\t{D_ i removed  \"Removed by commit\"}\n\t\t{DD i removed  \"Removed by commit\"}\n\t\t{DO i removed  \"Removed (still exists)\"}\n\n\t\t{UM i merge    \"Merge conflicts\"}\n\t\t{U_ i merge    \"Merge conflicts\"}\n\t} {\n\tif {$max_status_desc < [string length [lindex $i 3]]} {\n\t\tset max_status_desc [string length [lindex $i 3]]\n\t}\n\tif {[lindex $i 1] eq {i}} {\n\t\tset all_cols([lindex $i 0]) $ui_index\n\t} else {\n\t\tset all_cols([lindex $i 0]) $ui_other\n\t}\n\tset all_icons([lindex $i 0]) file_[lindex $i 2]\n\tset all_descs([lindex $i 0]) [lindex $i 3]\n}\nunset filemask i\n\n######################################################################\n##\n## util\n\nproc is_MacOSX {} {\n\tglobal tcl_platform tk_library\n\tif {$tcl_platform(platform) eq {unix}\n\t\t&& $tcl_platform(os) eq {Darwin}\n\t\t&& [string match /Library/Frameworks/* $tk_library]} {\n\t\treturn 1\n\t}\n\treturn 0\n}\n\nproc bind_button3 {w cmd} {\n\tbind $w <Any-Button-3> $cmd\n\tif {[is_MacOSX]} {\n\t\tbind $w <Control-Button-1> $cmd\n\t}\n}\n\nproc incr_font_size {font {amt 1}} {\n\tset sz [font configure $font -size]\n\tincr sz $amt\n\tfont configure $font -size $sz\n\tfont configure ${font}bold -size $sz\n}\n\nproc hook_failed_popup {hook msg} {\n\tglobal gitdir appname\n\n\tset w .hookfail\n\ttoplevel $w\n\n\tframe $w.m\n\tlabel $w.m.l1 -text \"$hook hook failed:\" \\\n\t\t-anchor w \\\n\t\t-justify left \\\n\t\t-font font_uibold\n\ttext $w.m.t \\\n\t\t-background white -borderwidth 1 \\\n\t\t-relief sunken \\\n\t\t-width 80 -height 10 \\\n\t\t-font font_diff \\\n\t\t-yscrollcommand [list $w.m.sby set]\n\tlabel $w.m.l2 \\\n\t\t-text {You must correct the above errors before committing.} \\\n\t\t-anchor w \\\n\t\t-justify left \\\n\t\t-font font_uibold\n\tscrollbar $w.m.sby -command [list $w.m.t yview]\n\tpack $w.m.l1 -side top -fill x\n\tpack $w.m.l2 -side bottom -fill x\n\tpack $w.m.sby -side right -fill y\n\tpack $w.m.t -side left -fill both -expand 1\n\tpack $w.m -side top -fill both -expand 1 -padx 5 -pady 10\n\n\t$w.m.t insert 1.0 $msg\n\t$w.m.t conf -state disabled\n\n\tbutton $w.ok -text OK \\\n\t\t-width 15 \\\n\t\t-font font_ui \\\n\t\t-command \"destroy $w\"\n\tpack $w.ok -side bottom\n\n\tbind $w <Visibility> \"grab $w; focus $w\"\n\tbind $w <Key-Return> \"destroy $w\"\n\twm title $w \"$appname ([lindex [file split \\\n\t\t[file normalize [file dirname $gitdir]]] \\\n\t\tend]): error\"\n\ttkwait window $w\n}\n\nset next_console_id 0\n\nproc new_console {short_title long_title} {\n\tglobal next_console_id console_data\n\tset w .console[incr next_console_id]\n\tset console_data($w) [list $short_title $long_title]\n\treturn [console_init $w]\n}\n\nproc console_init {w} {\n\tglobal console_cr console_data\n\tglobal gitdir appname M1B\n\n\tset console_cr($w) 1.0\n\ttoplevel $w\n\tframe $w.m\n\tlabel $w.m.l1 -text \"[lindex $console_data($w) 1]:\" \\\n\t\t-anchor w \\\n\t\t-justify left \\\n\t\t-font font_uibold\n\ttext $w.m.t \\\n\t\t-background white -borderwidth 1 \\\n\t\t-relief sunken \\\n\t\t-width 80 -height 10 \\\n\t\t-font font_diff \\\n\t\t-state disabled \\\n\t\t-yscrollcommand [list $w.m.sby set]\n\tlabel $w.m.s -anchor w \\\n\t\t-justify left \\\n\t\t-font font_uibold\n\tscrollbar $w.m.sby -command [list $w.m.t yview]\n\tpack $w.m.l1 -side top -fill x\n\tpack $w.m.s -side bottom -fill x\n\tpack $w.m.sby -side right -fill y\n\tpack $w.m.t -side left -fill both -expand 1\n\tpack $w.m -side top -fill both -expand 1 -padx 5 -pady 10\n\n\tmenu $w.ctxm -tearoff 0\n\t$w.ctxm add command -label \"Copy\" \\\n\t\t-font font_ui \\\n\t\t-command \"tk_textCopy $w.m.t\"\n\t$w.ctxm add command -label \"Select All\" \\\n\t\t-font font_ui \\\n\t\t-command \"$w.m.t tag add sel 0.0 end\"\n\t$w.ctxm add command -label \"Copy All\" \\\n\t\t-font font_ui \\\n\t\t-command \"\n\t\t\t$w.m.t tag add sel 0.0 end\n\t\t\ttk_textCopy $w.m.t\n\t\t\t$w.m.t tag remove sel 0.0 end\n\t\t\"\n\n\tbutton $w.ok -text {Running...} \\\n\t\t-width 15 \\\n\t\t-font font_ui \\\n\t\t-state disabled \\\n\t\t-command \"destroy $w\"\n\tpack $w.ok -side bottom\n\n\tbind_button3 $w.m.t \"tk_popup $w.ctxm %X %Y\"\n\tbind $w.m.t <$M1B-Key-a> \"$w.m.t tag add sel 0.0 end;break\"\n\tbind $w.m.t <$M1B-Key-A> \"$w.m.t tag add sel 0.0 end;break\"\n\tbind $w <Visibility> \"focus $w\"\n\twm title $w \"$appname ([lindex [file split \\\n\t\t[file normalize [file dirname $gitdir]]] \\\n\t\tend]): [lindex $console_data($w) 0]\"\n\treturn $w\n}\n\nproc console_exec {w cmd {after {}}} {\n\tglobal tcl_platform\n\n\t# -- Windows tosses the enviroment when we exec our child.\n\t#    But most users need that so we have to relogin. :-(\n\t#\n\tif {$tcl_platform(platform) eq {windows}} {\n\t\tset cmd [list sh --login -c \"cd \\\"[pwd]\\\" && [join $cmd { }]\"]\n\t}\n\n\t# -- Tcl won't let us redirect both stdout and stderr to\n\t#    the same pipe.  So pass it through cat...\n\t#\n\tset cmd [concat | $cmd |& cat]\n\n\tset fd_f [open $cmd r]\n\tfconfigure $fd_f -blocking 0 -translation binary\n\tfileevent $fd_f readable [list console_read $w $fd_f $after]\n}\n\nproc console_read {w fd after} {\n\tglobal console_cr console_data\n\n\tset buf [read $fd]\n\tif {$buf ne {}} {\n\t\tif {![winfo exists $w]} {console_init $w}\n\t\t$w.m.t conf -state normal\n\t\tset c 0\n\t\tset n [string length $buf]\n\t\twhile {$c < $n} {\n\t\t\tset cr [string first \"\\r\" $buf $c]\n\t\t\tset lf [string first \"\\n\" $buf $c]\n\t\t\tif {$cr < 0} {set cr [expr $n + 1]}\n\t\t\tif {$lf < 0} {set lf [expr $n + 1]}\n\n\t\t\tif {$lf < $cr} {\n\t\t\t\t$w.m.t insert end [string range $buf $c $lf]\n\t\t\t\tset console_cr($w) [$w.m.t index {end -1c}]\n\t\t\t\tset c $lf\n\t\t\t\tincr c\n\t\t\t} else {\n\t\t\t\t$w.m.t delete $console_cr($w) end\n\t\t\t\t$w.m.t insert end \"\\n\"\n\t\t\t\t$w.m.t insert end [string range $buf $c $cr]\n\t\t\t\tset c $cr\n\t\t\t\tincr c\n\t\t\t}\n\t\t}\n\t\t$w.m.t conf -state disabled\n\t\t$w.m.t see end\n\t}\n\n\tfconfigure $fd -blocking 1\n\tif {[eof $fd]} {\n\t\tif {[catch {close $fd}]} {\n\t\t\tif {![winfo exists $w]} {console_init $w}\n\t\t\t$w.m.s conf -background red -text {Error: Command Failed}\n\t\t\t$w.ok conf -text Close\n\t\t\t$w.ok conf -state normal\n\t\t\tset ok 0\n\t\t} elseif {[winfo exists $w]} {\n\t\t\t$w.m.s conf -background green -text {Success}\n\t\t\t$w.ok conf -text Close\n\t\t\t$w.ok conf -state normal\n\t\t\tset ok 1\n\t\t}\n\t\tarray unset console_cr $w\n\t\tarray unset console_data $w\n\t\tif {$after ne {}} {\n\t\t\tuplevel #0 $after $ok\n\t\t}\n\t\treturn\n\t}\n\tfconfigure $fd -blocking 0\n}\n\n######################################################################\n##\n## ui commands\n\nset starting_gitk_msg {Please wait... Starting gitk...}\n\nproc do_gitk {} {\n\tglobal tcl_platform ui_status_value starting_gitk_msg\n\n\tset ui_status_value $starting_gitk_msg\n\tafter 10000 {\n\t\tif {$ui_status_value eq $starting_gitk_msg} {\n\t\t\tset ui_status_value {Ready.}\n\t\t}\n\t}\n\n\tif {$tcl_platform(platform) eq {windows}} {\n\t\texec sh -c gitk &\n\t} else {\n\t\texec gitk &\n\t}\n}\n\nproc do_repack {} {\n\tset w [new_console \"repack\" \"Repacking the object database\"]\n\tset cmd [list git repack]\n\tlappend cmd -a\n\tlappend cmd -d\n\tconsole_exec $w $cmd\n}\n\nset is_quitting 0\n\nproc do_quit {} {\n\tglobal gitdir ui_comm is_quitting repo_config\n\n\tif {$is_quitting} return\n\tset is_quitting 1\n\n\t# -- Stash our current commit buffer.\n\t#\n\tset save [file join $gitdir GITGUI_MSG]\n\tset msg [string trim [$ui_comm get 0.0 end]]\n\tif {[$ui_comm edit modified] && $msg ne {}} {\n\t\tcatch {\n\t\t\tset fd [open $save w]\n\t\t\tputs $fd [string trim [$ui_comm get 0.0 end]]\n\t\t\tclose $fd\n\t\t}\n\t} elseif {$msg eq {} && [file exists $save]} {\n\t\tfile delete $save\n\t}\n\n\t# -- Stash our current window geometry into this repository.\n\t#\n\tset cfg_geometry [list]\n\tlappend cfg_geometry [wm geometry .]\n\tlappend cfg_geometry [lindex [.vpane sash coord 0] 1]\n\tlappend cfg_geometry [lindex [.vpane.files sash coord 0] 0]\n\tif {[catch {set rc_geometry $repo_config(gui.geometry)}]} {\n\t\tset rc_geometry {}\n\t}\n\tif {$cfg_geometry ne $rc_geometry} {\n\t\tcatch {exec git repo-config gui.geometry $cfg_geometry}\n\t}\n\n\tdestroy .\n}\n\nproc do_rescan {} {\n\tupdate_status\n}\n\nproc do_include_all {} {\n\tglobal file_states\n\n\tif {![lock_index begin-update]} return\n\n\tset pathList [list]\n\tforeach path [array names file_states] {\n\t\tset s $file_states($path)\n\t\tset m [lindex $s 0]\n\t\tswitch -- $m {\n\t\tAM -\n\t\tMM -\n\t\t_M -\n\t\t_D {lappend pathList $path}\n\t\t}\n\t}\n\tif {$pathList eq {}} {\n\t\tunlock_index\n\t} else {\n\t\tupdate_index $pathList\n\t}\n}\n\nset GIT_COMMITTER_IDENT {}\n\nproc do_signoff {} {\n\tglobal ui_comm GIT_COMMITTER_IDENT\n\n\tif {$GIT_COMMITTER_IDENT eq {}} {\n\t\tif {[catch {set me [exec git var GIT_COMMITTER_IDENT]} err]} {\n\t\t\terror_popup \"Unable to obtain your identity:\\n\\n$err\"\n\t\t\treturn\n\t\t}\n\t\tif {![regexp {^(.*) [0-9]+ [-+0-9]+$} \\\n\t\t\t$me me GIT_COMMITTER_IDENT]} {\n\t\t\terror_popup \"Invalid GIT_COMMITTER_IDENT:\\n\\n$me\"\n\t\t\treturn\n\t\t}\n\t}\n\n\tset sob \"Signed-off-by: $GIT_COMMITTER_IDENT\"\n\tset last [$ui_comm get {end -1c linestart} {end -1c}]\n\tif {$last ne $sob} {\n\t\t$ui_comm edit separator\n\t\tif {$last ne {}\n\t\t\t&& ![regexp {^[A-Z][A-Za-z]*-[A-Za-z-]+: *} $last]} {\n\t\t\t$ui_comm insert end \"\\n\"\n\t\t}\n\t\t$ui_comm insert end \"\\n$sob\"\n\t\t$ui_comm edit separator\n\t\t$ui_comm see end\n\t}\n}\n\nproc do_amend_last {} {\n\tload_last_commit\n}\n\nproc do_commit {} {\n\tcommit_tree\n}\n\nproc do_options {} {\n\tglobal appname gitdir font_descs\n\tglobal repo_config global_config\n\tglobal repo_config_new global_config_new\n\n\tarray unset repo_config_new\n\tarray unset global_config_new\n\tforeach name [array names repo_config] {\n\t\tset repo_config_new($name) $repo_config($name)\n\t}\n\tload_config 1\n\tforeach name [array names repo_config] {\n\t\tswitch -- $name {\n\t\tgui.diffcontext {continue}\n\t\t}\n\t\tset repo_config_new($name) $repo_config($name)\n\t}\n\tforeach name [array names global_config] {\n\t\tset global_config_new($name) $global_config($name)\n\t}\n\tset reponame [lindex [file split \\\n\t\t[file normalize [file dirname $gitdir]]] \\\n\t\tend]\n\n\tset w .options_editor\n\ttoplevel $w\n\twm geometry $w \"+[winfo rootx .]+[winfo rooty .]\"\n\n\tlabel $w.header -text \"$appname Options\" \\\n\t\t-font font_uibold\n\tpack $w.header -side top -fill x\n\n\tframe $w.buttons\n\tbutton $w.buttons.restore -text {Restore Defaults} \\\n\t\t-font font_ui \\\n\t\t-command do_restore_defaults\n\tpack $w.buttons.restore -side left\n\tbutton $w.buttons.save -text Save \\\n\t\t-font font_ui \\\n\t\t-command [list do_save_config $w]\n\tpack $w.buttons.save -side right\n\tbutton $w.buttons.cancel -text {Cancel} \\\n\t\t-font font_ui \\\n\t\t-command [list destroy $w]\n\tpack $w.buttons.cancel -side right\n\tpack $w.buttons -side bottom -fill x -pady 10 -padx 10\n\n\tlabelframe $w.repo -text \"$reponame Repository\" \\\n\t\t-font font_ui \\\n\t\t-relief raised -borderwidth 2\n\tlabelframe $w.global -text {Global (All Repositories)} \\\n\t\t-font font_ui \\\n\t\t-relief raised -borderwidth 2\n\tpack $w.repo -side left -fill both -expand 1 -pady 5 -padx 5\n\tpack $w.global -side right -fill both -expand 1 -pady 5 -padx 5\n\n\tforeach option {\n\t\t{b pullsummary {Show Pull Summary}}\n\t\t{b trustmtime  {Trust File Modification Timestamps}}\n\t\t{i diffcontext {Number of Diff Context Lines}}\n\t\t} {\n\t\tset type [lindex $option 0]\n\t\tset name [lindex $option 1]\n\t\tset text [lindex $option 2]\n\t\tforeach f {repo global} {\n\t\t\tswitch $type {\n\t\t\tb {\n\t\t\t\tcheckbutton $w.$f.$name -text $text \\\n\t\t\t\t\t-variable ${f}_config_new(gui.$name) \\\n\t\t\t\t\t-onvalue true \\\n\t\t\t\t\t-offvalue false \\\n\t\t\t\t\t-font font_ui\n\t\t\t\tpack $w.$f.$name -side top -anchor w\n\t\t\t}\n\t\t\ti {\n\t\t\t\tframe $w.$f.$name\n\t\t\t\tlabel $w.$f.$name.l -text \"$text:\" -font font_ui\n\t\t\t\tpack $w.$f.$name.l -side left -anchor w -fill x\n\t\t\t\tspinbox $w.$f.$name.v \\\n\t\t\t\t\t-textvariable ${f}_config_new(gui.$name) \\\n\t\t\t\t\t-from 1 -to 99 -increment 1 \\\n\t\t\t\t\t-width 3 \\\n\t\t\t\t\t-font font_ui\n\t\t\t\tpack $w.$f.$name.v -side right -anchor e\n\t\t\t\tpack $w.$f.$name -side top -anchor w -fill x\n\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tset all_fonts [lsort [font families]]\n\tforeach option $font_descs {\n\t\tset name [lindex $option 0]\n\t\tset font [lindex $option 1]\n\t\tset text [lindex $option 2]\n\n\t\tset global_config_new(gui.$font^^family) \\\n\t\t\t[font configure $font -family]\n\t\tset global_config_new(gui.$font^^size) \\\n\t\t\t[font configure $font -size]\n\n\t\tframe $w.global.$name\n\t\tlabel $w.global.$name.l -text \"$text:\" -font font_ui\n\t\tpack $w.global.$name.l -side left -anchor w -fill x\n\t\teval tk_optionMenu $w.global.$name.family \\\n\t\t\tglobal_config_new(gui.$font^^family) \\\n\t\t\t$all_fonts\n\t\tspinbox $w.global.$name.size \\\n\t\t\t-textvariable global_config_new(gui.$font^^size) \\\n\t\t\t-from 2 -to 80 -increment 1 \\\n\t\t\t-width 3 \\\n\t\t\t-font font_ui\n\t\tpack $w.global.$name.size -side right -anchor e\n\t\tpack $w.global.$name.family -side right -anchor e\n\t\tpack $w.global.$name -side top -anchor w -fill x\n\t}\n\n\tbind $w <Visibility> \"grab $w; focus $w\"\n\tbind $w <Key-Escape> \"destroy $w\"\n\twm title $w \"$appname ($reponame): Options\"\n\ttkwait window $w\n}\n\nproc do_restore_defaults {} {\n\tglobal font_descs default_config repo_config\n\tglobal repo_config_new global_config_new\n\n\tforeach name [array names default_config] {\n\t\tset repo_config_new($name) $default_config($name)\n\t\tset global_config_new($name) $default_config($name)\n\t}\n\n\tforeach option $font_descs {\n\t\tset name [lindex $option 0]\n\t\tset repo_config(gui.$name) $default_config(gui.$name)\n\t}\n\tapply_config\n\n\tforeach option $font_descs {\n\t\tset name [lindex $option 0]\n\t\tset font [lindex $option 1]\n\t\tset global_config_new(gui.$font^^family) \\\n\t\t\t[font configure $font -family]\n\t\tset global_config_new(gui.$font^^size) \\\n\t\t\t[font configure $font -size]\n\t}\n}\n\nproc do_save_config {w} {\n\tif {[catch {save_config} err]} {\n\t\terror_popup \"Failed to completely save options:\\n\\n$err\"\n\t}\n\treshow_diff\n\tdestroy $w\n}\n\n# shift == 1: left click\n#          3: right click  \nproc click {w x y shift wx wy} {\n\tglobal ui_index ui_other file_lists\n\n\tset pos [split [$w index @$x,$y] .]\n\tset lno [lindex $pos 0]\n\tset col [lindex $pos 1]\n\tset path [lindex $file_lists($w) [expr $lno - 1]]\n\tif {$path eq {}} return\n\n\tif {$col > 0 && $shift == 1} {\n\t\tshow_diff $path $w $lno\n\t}\n}\n\nproc unclick {w x y} {\n\tglobal file_lists\n\n\tset pos [split [$w index @$x,$y] .]\n\tset lno [lindex $pos 0]\n\tset col [lindex $pos 1]\n\tset path [lindex $file_lists($w) [expr $lno - 1]]\n\tif {$path eq {}} return\n\n\tif {$col == 0} {\n\t\tupdate_index [list $path]\n\t}\n}\n\n######################################################################\n##\n## config defaults\n\nset cursor_ptr arrow\nfont create font_diff -family Courier -size 10\nfont create font_ui\ncatch {\n\tlabel .dummy\n\teval font configure font_ui [font actual [.dummy cget -font]]\n\tdestroy .dummy\n}\n\nfont create font_uibold\nfont create font_diffbold\n\nset M1B M1\nset M1T M1\nif {$tcl_platform(platform) eq {windows}} {\n\tset M1B Control\n\tset M1T Ctrl\n} elseif {[is_MacOSX]} {\n\tset M1B M1\n\tset M1T Cmd\n}\n\nproc apply_config {} {\n\tglobal repo_config font_descs\n\n\tforeach option $font_descs {\n\t\tset name [lindex $option 0]\n\t\tset font [lindex $option 1]\n\t\tif {[catch {\n\t\t\tforeach {cn cv} $repo_config(gui.$name) {\n\t\t\t\tfont configure $font $cn $cv\n\t\t\t}\n\t\t\t} err]} {\n\t\t\terror_popup \"Invalid font specified in gui.$name:\\n\\n$err\"\n\t\t}\n\t\tforeach {cn cv} [font configure $font] {\n\t\t\tfont configure ${font}bold $cn $cv\n\t\t}\n\t\tfont configure ${font}bold -weight bold\n\t}\n}\n\nset default_config(gui.trustmtime) false\nset default_config(gui.pullsummary) true\nset default_config(gui.diffcontext) 5\nset default_config(gui.fontui) [font configure font_ui]\nset default_config(gui.fontdiff) [font configure font_diff]\nset font_descs {\n\t{fontui   font_ui   {Main Font}}\n\t{fontdiff font_diff {Diff/Console Font}}\n}\nload_config 0\napply_config\n\n######################################################################\n##\n## ui construction\n\n# -- Menu Bar\nmenu .mbar -tearoff 0\n.mbar add cascade -label Project -menu .mbar.project\n.mbar add cascade -label Edit -menu .mbar.edit\n.mbar add cascade -label Commit -menu .mbar.commit\nif {!$single_commit} {\n\t.mbar add cascade -label Fetch -menu .mbar.fetch\n\t.mbar add cascade -label Pull -menu .mbar.pull\n\t.mbar add cascade -label Push -menu .mbar.push\n}\n. configure -menu .mbar\n\n# -- Project Menu\nmenu .mbar.project\n.mbar.project add command -label Visualize \\\n\t-command do_gitk \\\n\t-font font_ui\nif {!$single_commit} {\n\t.mbar.project add command -label {Repack Database} \\\n\t\t-command do_repack \\\n\t\t-font font_ui\n}\n.mbar.project add command -label Quit \\\n\t-command do_quit \\\n\t-accelerator $M1T-Q \\\n\t-font font_ui\n\n# -- Edit Menu\n#\nmenu .mbar.edit\n.mbar.edit add command -label Undo \\\n\t-command {catch {[focus] edit undo}} \\\n\t-accelerator $M1T-Z \\\n\t-font font_ui\n.mbar.edit add command -label Redo \\\n\t-command {catch {[focus] edit redo}} \\\n\t-accelerator $M1T-Y \\\n\t-font font_ui\n.mbar.edit add separator\n.mbar.edit add command -label Cut \\\n\t-command {catch {tk_textCut [focus]}} \\\n\t-accelerator $M1T-X \\\n\t-font font_ui\n.mbar.edit add command -label Copy \\\n\t-command {catch {tk_textCopy [focus]}} \\\n\t-accelerator $M1T-C \\\n\t-font font_ui\n.mbar.edit add command -label Paste \\\n\t-command {catch {tk_textPaste [focus]; [focus] see insert}} \\\n\t-accelerator $M1T-V \\\n\t-font font_ui\n.mbar.edit add command -label Delete \\\n\t-command {catch {[focus] delete sel.first sel.last}} \\\n\t-accelerator Del \\\n\t-font font_ui\n.mbar.edit add separator\n.mbar.edit add command -label {Select All} \\\n\t-command {catch {[focus] tag add sel 0.0 end}} \\\n\t-accelerator $M1T-A \\\n\t-font font_ui\n.mbar.edit add separator\n.mbar.edit add command -label {Options...} \\\n\t-command do_options \\\n\t-font font_ui\n\n# -- Commit Menu\nmenu .mbar.commit\n.mbar.commit add command -label Rescan \\\n\t-command do_rescan \\\n\t-accelerator F5 \\\n\t-font font_ui\nlappend disable_on_lock \\\n\t[list .mbar.commit entryconf [.mbar.commit index last] -state]\n.mbar.commit add command -label {Amend Last Commit} \\\n\t-command do_amend_last \\\n\t-font font_ui\nlappend disable_on_lock \\\n\t[list .mbar.commit entryconf [.mbar.commit index last] -state]\n.mbar.commit add command -label {Include All Files} \\\n\t-command do_include_all \\\n\t-accelerator $M1T-I \\\n\t-font font_ui\nlappend disable_on_lock \\\n\t[list .mbar.commit entryconf [.mbar.commit index last] -state]\n.mbar.commit add command -label {Sign Off} \\\n\t-command do_signoff \\\n\t-accelerator $M1T-S \\\n\t-font font_ui\n.mbar.commit add command -label Commit \\\n\t-command do_commit \\\n\t-accelerator $M1T-Return \\\n\t-font font_ui\nlappend disable_on_lock \\\n\t[list .mbar.commit entryconf [.mbar.commit index last] -state]\n\nif {!$single_commit} {\n\t# -- Fetch Menu\n\tmenu .mbar.fetch\n\n\t# -- Pull Menu\n\tmenu .mbar.pull\n\n\t# -- Push Menu\n\tmenu .mbar.push\n}\n\n# -- Main Window Layout\npanedwindow .vpane -orient vertical\npanedwindow .vpane.files -orient horizontal\n.vpane add .vpane.files -sticky nsew -height 100 -width 400\npack .vpane -anchor n -side top -fill both -expand 1\n\n# -- Index File List\nframe .vpane.files.index -height 100 -width 400\nlabel .vpane.files.index.title -text {Modified Files} \\\n\t-background green \\\n\t-font font_ui\ntext $ui_index -background white -borderwidth 0 \\\n\t-width 40 -height 10 \\\n\t-font font_ui \\\n\t-cursor $cursor_ptr \\\n\t-yscrollcommand {.vpane.files.index.sb set} \\\n\t-state disabled\nscrollbar .vpane.files.index.sb -command [list $ui_index yview]\npack .vpane.files.index.title -side top -fill x\npack .vpane.files.index.sb -side right -fill y\npack $ui_index -side left -fill both -expand 1\n.vpane.files add .vpane.files.index -sticky nsew\n\n# -- Other (Add) File List\nframe .vpane.files.other -height 100 -width 100\nlabel .vpane.files.other.title -text {Untracked Files} \\\n\t-background red \\\n\t-font font_ui\ntext $ui_other -background white -borderwidth 0 \\\n\t-width 40 -height 10 \\\n\t-font font_ui \\\n\t-cursor $cursor_ptr \\\n\t-yscrollcommand {.vpane.files.other.sb set} \\\n\t-state disabled\nscrollbar .vpane.files.other.sb -command [list $ui_other yview]\npack .vpane.files.other.title -side top -fill x\npack .vpane.files.other.sb -side right -fill y\npack $ui_other -side left -fill both -expand 1\n.vpane.files add .vpane.files.other -sticky nsew\n\n$ui_index tag conf in_diff -font font_uibold\n$ui_other tag conf in_diff -font font_uibold\n\n# -- Diff and Commit Area\nframe .vpane.lower -height 300 -width 400\nframe .vpane.lower.commarea\nframe .vpane.lower.diff -relief sunken -borderwidth 1\npack .vpane.lower.commarea -side top -fill x\npack .vpane.lower.diff -side bottom -fill both -expand 1\n.vpane add .vpane.lower -stick nsew\n\n# -- Commit Area Buttons\nframe .vpane.lower.commarea.buttons\nlabel .vpane.lower.commarea.buttons.l -text {} \\\n\t-anchor w \\\n\t-justify left \\\n\t-font font_ui\npack .vpane.lower.commarea.buttons.l -side top -fill x\npack .vpane.lower.commarea.buttons -side left -fill y\n\nbutton .vpane.lower.commarea.buttons.rescan -text {Rescan} \\\n\t-command do_rescan \\\n\t-font font_ui\npack .vpane.lower.commarea.buttons.rescan -side top -fill x\nlappend disable_on_lock \\\n\t{.vpane.lower.commarea.buttons.rescan conf -state}\n\nbutton .vpane.lower.commarea.buttons.amend -text {Amend Last} \\\n\t-command do_amend_last \\\n\t-font font_ui\npack .vpane.lower.commarea.buttons.amend -side top -fill x\nlappend disable_on_lock \\\n\t{.vpane.lower.commarea.buttons.amend conf -state}\n\nbutton .vpane.lower.commarea.buttons.incall -text {Include All} \\\n\t-command do_include_all \\\n\t-font font_ui\npack .vpane.lower.commarea.buttons.incall -side top -fill x\nlappend disable_on_lock \\\n\t{.vpane.lower.commarea.buttons.incall conf -state}\n\nbutton .vpane.lower.commarea.buttons.signoff -text {Sign Off} \\\n\t-command do_signoff \\\n\t-font font_ui\npack .vpane.lower.commarea.buttons.signoff -side top -fill x\n\nbutton .vpane.lower.commarea.buttons.commit -text {Commit} \\\n\t-command do_commit \\\n\t-font font_ui\npack .vpane.lower.commarea.buttons.commit -side top -fill x\nlappend disable_on_lock \\\n\t{.vpane.lower.commarea.buttons.commit conf -state}\n\n# -- Commit Message Buffer\nframe .vpane.lower.commarea.buffer\nset ui_comm .vpane.lower.commarea.buffer.t\nset ui_coml .vpane.lower.commarea.buffer.l\nlabel $ui_coml -text {Commit Message:} \\\n\t-anchor w \\\n\t-justify left \\\n\t-font font_ui\ntrace add variable commit_type write {uplevel #0 {\n\tswitch -glob $commit_type \\\n\tinitial {$ui_coml conf -text {Initial Commit Message:}} \\\n\tamend   {$ui_coml conf -text {Amended Commit Message:}} \\\n\tmerge   {$ui_coml conf -text {Merge Commit Message:}} \\\n\t*       {$ui_coml conf -text {Commit Message:}}\n}}\ntext $ui_comm -background white -borderwidth 1 \\\n\t-undo true \\\n\t-maxundo 20 \\\n\t-autoseparators true \\\n\t-relief sunken \\\n\t-width 75 -height 9 -wrap none \\\n\t-font font_diff \\\n\t-yscrollcommand {.vpane.lower.commarea.buffer.sby set}\nscrollbar .vpane.lower.commarea.buffer.sby \\\n\t-command [list $ui_comm yview]\npack $ui_coml -side top -fill x\npack .vpane.lower.commarea.buffer.sby -side right -fill y\npack $ui_comm -side left -fill y\npack .vpane.lower.commarea.buffer -side left -fill y\n\n# -- Commit Message Buffer Context Menu\n#\nmenu $ui_comm.ctxm -tearoff 0\n$ui_comm.ctxm add command -label \"Cut\" \\\n\t-font font_ui \\\n\t-command \"tk_textCut $ui_comm\"\n$ui_comm.ctxm add command -label \"Copy\" \\\n\t-font font_ui \\\n\t-command \"tk_textCopy $ui_comm\"\n$ui_comm.ctxm add command -label \"Paste\" \\\n\t-font font_ui \\\n\t-command \"tk_textPaste $ui_comm\"\n$ui_comm.ctxm add command -label \"Delete\" \\\n\t-font font_ui \\\n\t-command \"$ui_comm delete sel.first sel.last\"\n$ui_comm.ctxm add separator\n$ui_comm.ctxm add command -label \"Select All\" \\\n\t-font font_ui \\\n\t-command \"$ui_comm tag add sel 0.0 end\"\n$ui_comm.ctxm add command -label \"Copy All\" \\\n\t-font font_ui \\\n\t-command \"\n\t\t$ui_comm tag add sel 0.0 end\n\t\ttk_textCopy $ui_comm\n\t\t$ui_comm tag remove sel 0.0 end\n\t\"\n$ui_comm.ctxm add separator\n$ui_comm.ctxm add command -label \"Sign Off\" \\\n\t-font font_ui \\\n\t-command do_signoff\nbind_button3 $ui_comm \"tk_popup $ui_comm.ctxm %X %Y\"\n\n# -- Diff Header\nset ui_fname_value {}\nset ui_fstatus_value {}\nframe .vpane.lower.diff.header -background orange\nlabel .vpane.lower.diff.header.l4 \\\n\t-textvariable ui_fstatus_value \\\n\t-background orange \\\n\t-width $max_status_desc \\\n\t-anchor w \\\n\t-justify left \\\n\t-font font_ui\nlabel .vpane.lower.diff.header.l1 -text {File:} \\\n\t-background orange \\\n\t-font font_ui\nset ui_fname .vpane.lower.diff.header.l2\ntext $ui_fname \\\n\t-background orange \\\n\t-height 1 \\\n\t-wrap none \\\n\t-relief flat \\\n\t-state disabled \\\n\t-font font_ui\nmenu $ui_fname.ctxm -tearoff 0\n$ui_fname.ctxm add command -label \"Copy Only Selection\" \\\n\t-font font_ui \\\n\t-command \"tk_textCopy $ui_fname\"\n$ui_fname.ctxm add command -label \"Copy Complete Name\" \\\n\t-font font_ui \\\n\t-command \"\n\t\t$ui_fname tag add sel 0.0 {end -1c}\n\t\ttk_textCopy $ui_fname\n\t\t$ui_fname tag remove sel 0.0 end\n\t\"\nbind_button3 $ui_fname \"tk_popup $ui_fname.ctxm %X %Y\"\ntrace add variable ui_fname_value write $ui_fname.update\nproc $ui_fname.update {varname args} {\n\tglobal ui_fname ui_fname_value\n\t$ui_fname configure -state normal\n\t$ui_fname delete 0.0 end\n\t$ui_fname insert end [escape_path $ui_fname_value]\n\t$ui_fname configure -state disabled\n}\npack .vpane.lower.diff.header.l4 -side left\npack .vpane.lower.diff.header.l1 -side left\npack $ui_fname -fill x\n\n# -- Diff Body\nframe .vpane.lower.diff.body\nset ui_diff .vpane.lower.diff.body.t\ntext $ui_diff -background white -borderwidth 0 \\\n\t-width 80 -height 15 -wrap none \\\n\t-font font_diff \\\n\t-xscrollcommand {.vpane.lower.diff.body.sbx set} \\\n\t-yscrollcommand {.vpane.lower.diff.body.sby set} \\\n\t-state disabled\nscrollbar .vpane.lower.diff.body.sbx -orient horizontal \\\n\t-command [list $ui_diff xview]\nscrollbar .vpane.lower.diff.body.sby -orient vertical \\\n\t-command [list $ui_diff yview]\npack .vpane.lower.diff.body.sbx -side bottom -fill x\npack .vpane.lower.diff.body.sby -side right -fill y\npack $ui_diff -side left -fill both -expand 1\npack .vpane.lower.diff.header -side top -fill x\npack .vpane.lower.diff.body -side bottom -fill both -expand 1\n\n$ui_diff tag conf dm -foreground red\n$ui_diff tag conf dp -foreground blue\n$ui_diff tag conf di -foreground {#00a000}\n$ui_diff tag conf dni -foreground {#a000a0}\n$ui_diff tag conf da -font font_diffbold\n$ui_diff tag conf bold -font font_diffbold\n\n# -- Diff Body Context Menu\n#\nmenu $ui_diff.ctxm -tearoff 0\n$ui_diff.ctxm add command -label \"Copy\" \\\n\t-font font_ui \\\n\t-command \"tk_textCopy $ui_diff\"\n$ui_diff.ctxm add command -label \"Select All\" \\\n\t-font font_ui \\\n\t-command \"$ui_diff tag add sel 0.0 end\"\n$ui_diff.ctxm add command -label \"Copy All\" \\\n\t-font font_ui \\\n\t-command \"\n\t\t$ui_diff tag add sel 0.0 end\n\t\ttk_textCopy $ui_diff\n\t\t$ui_diff tag remove sel 0.0 end\n\t\"\n$ui_diff.ctxm add separator\n$ui_diff.ctxm add command -label \"Decrease Font Size\" \\\n\t-font font_ui \\\n\t-command {incr_font_size font_diff -1}\n$ui_diff.ctxm add command -label \"Increase Font Size\" \\\n\t-font font_ui \\\n\t-command {incr_font_size font_diff 1}\n$ui_diff.ctxm add separator\n$ui_diff.ctxm add command -label \"Show Less Context\" \\\n\t-font font_ui \\\n\t-command {if {$ui_fname_value ne {}\n\t\t&& $repo_config(gui.diffcontext) >= 2} {\n\t\tincr repo_config(gui.diffcontext) -1\n\t\treshow_diff\n\t}}\n$ui_diff.ctxm add command -label \"Show More Context\" \\\n\t-font font_ui \\\n\t-command {if {$ui_fname_value ne {}} {\n\t\tincr repo_config(gui.diffcontext)\n\t\treshow_diff\n\t}}\n$ui_diff.ctxm add separator\n$ui_diff.ctxm add command -label {Options...} \\\n\t-font font_ui \\\n\t-command do_options\nbind_button3 $ui_diff \"tk_popup $ui_diff.ctxm %X %Y\"\n\n# -- Status Bar\nset ui_status_value {Initializing...}\nlabel .status -textvariable ui_status_value \\\n\t-anchor w \\\n\t-justify left \\\n\t-borderwidth 1 \\\n\t-relief sunken \\\n\t-font font_ui\npack .status -anchor w -side bottom -fill x\n\n# -- Load geometry\ncatch {\nset gm $repo_config(gui.geometry)\nwm geometry . [lindex $gm 0]\n.vpane sash place 0 \\\n\t[lindex [.vpane sash coord 0] 0] \\\n\t[lindex $gm 1]\n.vpane.files sash place 0 \\\n\t[lindex $gm 2] \\\n\t[lindex [.vpane.files sash coord 0] 1]\nunset gm\n}\n\n# -- Key Bindings\nbind $ui_comm <$M1B-Key-Return> {do_commit;break}\nbind $ui_comm <$M1B-Key-i> {do_include_all;break}\nbind $ui_comm <$M1B-Key-I> {do_include_all;break}\nbind $ui_comm <$M1B-Key-x> {tk_textCut %W;break}\nbind $ui_comm <$M1B-Key-X> {tk_textCut %W;break}\nbind $ui_comm <$M1B-Key-c> {tk_textCopy %W;break}\nbind $ui_comm <$M1B-Key-C> {tk_textCopy %W;break}\nbind $ui_comm <$M1B-Key-v> {tk_textPaste %W; %W see insert; break}\nbind $ui_comm <$M1B-Key-V> {tk_textPaste %W; %W see insert; break}\nbind $ui_comm <$M1B-Key-a> {%W tag add sel 0.0 end;break}\nbind $ui_comm <$M1B-Key-A> {%W tag add sel 0.0 end;break}\n\nbind $ui_diff <$M1B-Key-x> {tk_textCopy %W;break}\nbind $ui_diff <$M1B-Key-X> {tk_textCopy %W;break}\nbind $ui_diff <$M1B-Key-c> {tk_textCopy %W;break}\nbind $ui_diff <$M1B-Key-C> {tk_textCopy %W;break}\nbind $ui_diff <$M1B-Key-v> {break}\nbind $ui_diff <$M1B-Key-V> {break}\nbind $ui_diff <$M1B-Key-a> {%W tag add sel 0.0 end;break}\nbind $ui_diff <$M1B-Key-A> {%W tag add sel 0.0 end;break}\nbind $ui_diff <Key-Up>     {catch {%W yview scroll -1 units};break}\nbind $ui_diff <Key-Down>   {catch {%W yview scroll  1 units};break}\nbind $ui_diff <Key-Left>   {catch {%W xview scroll -1 units};break}\nbind $ui_diff <Key-Right>  {catch {%W xview scroll  1 units};break}\n\nbind .   <Destroy> do_quit\nbind all <Key-F5> do_rescan\nbind all <$M1B-Key-r> do_rescan\nbind all <$M1B-Key-R> do_rescan\nbind .   <$M1B-Key-s> do_signoff\nbind .   <$M1B-Key-S> do_signoff\nbind .   <$M1B-Key-i> do_include_all\nbind .   <$M1B-Key-I> do_include_all\nbind .   <$M1B-Key-Return> do_commit\nbind all <$M1B-Key-q> do_quit\nbind all <$M1B-Key-Q> do_quit\nbind all <$M1B-Key-w> {destroy [winfo toplevel %W]}\nbind all <$M1B-Key-W> {destroy [winfo toplevel %W]}\nforeach i [list $ui_index $ui_other] {\n\tbind $i <Button-1> {click %W %x %y 1 %X %Y; break}\n\tbind $i <ButtonRelease-1> {unclick %W %x %y; break}\n\tbind_button3 $i {click %W %x %y 3 %X %Y; break}\n}\nunset i\n\nset file_lists($ui_index) [list]\nset file_lists($ui_other) [list]\n\nwm title . \"$appname ([file normalize [file dirname $gitdir]])\"\nfocus -force $ui_comm\nif {!$single_commit} {\n\tload_all_remotes\n\tpopulate_remote_menu .mbar.fetch From fetch_from\n\tpopulate_remote_menu .mbar.push To push_to\n\tpopulate_pull_menu .mbar.pull\n}\nafter 1 update_status\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "00b6cdf28126d6462f3eebec930a265ef7e9722b",
  "sha1_ok": true,
  "size": 62248
}
