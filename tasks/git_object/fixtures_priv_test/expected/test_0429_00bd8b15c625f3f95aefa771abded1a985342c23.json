{
  "content": {
    "base64": "IyEvYmluL3NoCiMKIyBDb3B5cmlnaHQgKGMpIDIwMDUgSnVuaW8gQyBIYW1hbm8KIwoKdGVzdF9kZXNjcmlwdGlvbj0nZ2l0LWFwcGx5IGhhbmRsaW5nIGJpbmFyeSBwYXRjaGVzCgonCi4gLi90ZXN0LWxpYi5zaAoKIyBzZXR1cAoKY2F0ID5maWxlMSA8PEVPRgpBIHF1aWNrIGJyb3duIGZveCBqdW1wcyBvdmVyIHRoZSBsYXp5IGRvZy4KQSB0aW55IGxpdHRsZSBwZW5ndWluIHJ1bnMgYXJvdW5kIGluIGNpcmNsZXMuClRoZXJlIGlzIGEgZmxhZyB3aXRoIExpbnV4IHdyaXR0ZW4gb24gaXQuCkEgc2xvdyBibGFjay1hbmQtd2hpdGUgcGFuZGEganVzdCBzaXRzIHRoZXJlLAptdW5jaGluZyBvbiBoaXMgYmFtYm9vLgpFT0YKY2F0IGZpbGUxID5maWxlMgpjYXQgZmlsZTEgPmZpbGU0CgpnaXQtdXBkYXRlLWluZGV4IC0tYWRkIC0tcmVtb3ZlIGZpbGUxIGZpbGUyIGZpbGU0CmdpdC1jb21taXQgLW0gJ0luaXRpYWwgVmVyc2lvbicgMj4vZGV2L251bGwKCmdpdC1jaGVja291dCAtYiBiaW5hcnkKdHIgJ3gnICdcMCcgPGZpbGUxID5maWxlMwpjYXQgZmlsZTMgPmZpbGU0CmdpdC1hZGQgZmlsZTIKdHIgJ1wwJyAndicgPGZpbGUzID5maWxlMQpybSAtZiBmaWxlMgpnaXQtdXBkYXRlLWluZGV4IC0tYWRkIC0tcmVtb3ZlIGZpbGUxIGZpbGUyIGZpbGUzIGZpbGU0CmdpdC1jb21taXQgLW0gJ1NlY29uZCBWZXJzaW9uJwoKZ2l0LWRpZmYtdHJlZSAtcCBtYXN0ZXIgYmluYXJ5ID5CLmRpZmYKZ2l0LWRpZmYtdHJlZSAtcCAtQyBtYXN0ZXIgYmluYXJ5ID5DLmRpZmYKCmdpdC1kaWZmLXRyZWUgLXAgLS1mdWxsLWluZGV4IG1hc3RlciBiaW5hcnkgPkJGLmRpZmYKZ2l0LWRpZmYtdHJlZSAtcCAtLWZ1bGwtaW5kZXggLUMgbWFzdGVyIGJpbmFyeSA+Q0YuZGlmZgoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc3RhdCBiaW5hcnkgZGlmZiAtLSBzaG91bGQgbm90IGZhaWwuJyBcCgknZ2l0LWNoZWNrb3V0IG1hc3RlcgoJIGdpdC1hcHBseSAtLXN0YXQgLS1zdW1tYXJ5IEIuZGlmZicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3N0YXQgYmluYXJ5IGRpZmYgKGNvcHkpIC0tIHNob3VsZCBub3QgZmFpbC4nIFwKCSdnaXQtY2hlY2tvdXQgbWFzdGVyCgkgZ2l0LWFwcGx5IC0tc3RhdCAtLXN1bW1hcnkgQy5kaWZmJwoKdGVzdF9leHBlY3RfZmFpbHVyZSAnY2hlY2sgYmluYXJ5IGRpZmYgLS0gc2hvdWxkIGZhaWwuJyBcCgknZ2l0LWNoZWNrb3V0IG1hc3RlcgoJIGdpdC1hcHBseSAtLWNoZWNrIEIuZGlmZicKCnRlc3RfZXhwZWN0X2ZhaWx1cmUgJ2NoZWNrIGJpbmFyeSBkaWZmIChjb3B5KSAtLSBzaG91bGQgZmFpbC4nIFwKCSdnaXQtY2hlY2tvdXQgbWFzdGVyCgkgZ2l0LWFwcGx5IC0tY2hlY2sgQy5kaWZmJwoKdGVzdF9leHBlY3RfZmFpbHVyZSAnY2hlY2sgaW5jb21wbGV0ZSBiaW5hcnkgZGlmZiB3aXRoIHJlcGxhY2VtZW50IC0tIHNob3VsZCBmYWlsLicgXAoJJ2dpdC1jaGVja291dCBtYXN0ZXIKCSBnaXQtYXBwbHkgLS1jaGVjayAtLWFsbG93LWJpbmFyeS1yZXBsYWNlbWVudCBCLmRpZmYnCgp0ZXN0X2V4cGVjdF9mYWlsdXJlICdjaGVjayBpbmNvbXBsZXRlIGJpbmFyeSBkaWZmIHdpdGggcmVwbGFjZW1lbnQgKGNvcHkpIC0tIHNob3VsZCBmYWlsLicgXAoJJ2dpdC1jaGVja291dCBtYXN0ZXIKCSBnaXQtYXBwbHkgLS1jaGVjayAtLWFsbG93LWJpbmFyeS1yZXBsYWNlbWVudCBDLmRpZmYnCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdjaGVjayBiaW5hcnkgZGlmZiB3aXRoIHJlcGxhY2VtZW50LicgXAoJJ2dpdC1jaGVja291dCBtYXN0ZXIKCSBnaXQtYXBwbHkgLS1jaGVjayAtLWFsbG93LWJpbmFyeS1yZXBsYWNlbWVudCBCRi5kaWZmJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2hlY2sgYmluYXJ5IGRpZmYgd2l0aCByZXBsYWNlbWVudCAoY29weSkuJyBcCgknZ2l0LWNoZWNrb3V0IG1hc3RlcgoJIGdpdC1hcHBseSAtLWNoZWNrIC0tYWxsb3ctYmluYXJ5LXJlcGxhY2VtZW50IENGLmRpZmYnCgojIE5vdyB3ZSBzdGFydCBhcHBseWluZyB0aGVtLgoKZG9fcmVzZXQgKCkgewoJcm0gLWYgZmlsZT8KCWdpdC1yZXNldCAtLWhhcmQKCWdpdC1jaGVja291dCAtZiBtYXN0ZXIKfQoKdGVzdF9leHBlY3RfZmFpbHVyZSAnYXBwbHkgYmluYXJ5IGRpZmYgLS0gc2hvdWxkIGZhaWwuJyBcCgknZG9fcmVzZXQKCSBnaXQtYXBwbHkgQi5kaWZmJwoKdGVzdF9leHBlY3RfZmFpbHVyZSAnYXBwbHkgYmluYXJ5IGRpZmYgLS0gc2hvdWxkIGZhaWwuJyBcCgknZG9fcmVzZXQKCSBnaXQtYXBwbHkgLS1pbmRleCBCLmRpZmYnCgp0ZXN0X2V4cGVjdF9mYWlsdXJlICdhcHBseSBiaW5hcnkgZGlmZiAoY29weSkgLS0gc2hvdWxkIGZhaWwuJyBcCgknZG9fcmVzZXQKCSBnaXQtYXBwbHkgQy5kaWZmJwoKdGVzdF9leHBlY3RfZmFpbHVyZSAnYXBwbHkgYmluYXJ5IGRpZmYgKGNvcHkpIC0tIHNob3VsZCBmYWlsLicgXAoJJ2RvX3Jlc2V0CgkgZ2l0LWFwcGx5IC0taW5kZXggQy5kaWZmJwoKdGVzdF9leHBlY3RfZmFpbHVyZSAnYXBwbHkgYmluYXJ5IGRpZmYgd2l0aG91dCByZXBsYWNlbWVudCAtLSBzaG91bGQgZmFpbC4nIFwKCSdkb19yZXNldAoJIGdpdC1hcHBseSBCRi5kaWZmJwoKdGVzdF9leHBlY3RfZmFpbHVyZSAnYXBwbHkgYmluYXJ5IGRpZmYgd2l0aG91dCByZXBsYWNlbWVudCAoY29weSkgLS0gc2hvdWxkIGZhaWwuJyBcCgknZG9fcmVzZXQKCSBnaXQtYXBwbHkgQ0YuZGlmZicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2FwcGx5IGJpbmFyeSBkaWZmLicgXAoJJ2RvX3Jlc2V0CgkgZ2l0LWFwcGx5IC0tYWxsb3ctYmluYXJ5LXJlcGxhY2VtZW50IC0taW5kZXggQkYuZGlmZiAmJgoJIHRlc3QgLXogIiQoZ2l0LWRpZmYgLS1uYW1lLXN0YXR1cyBiaW5hcnkpIicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2FwcGx5IGJpbmFyeSBkaWZmIChjb3B5KS4nIFwKCSdkb19yZXNldAoJIGdpdC1hcHBseSAtLWFsbG93LWJpbmFyeS1yZXBsYWNlbWVudCAtLWluZGV4IENGLmRpZmYgJiYKCSB0ZXN0IC16ICIkKGdpdC1kaWZmIC0tbmFtZS1zdGF0dXMgYmluYXJ5KSInCgp0ZXN0X2RvbmUK",
    "text": "#!/bin/sh\n#\n# Copyright (c) 2005 Junio C Hamano\n#\n\ntest_description='git-apply handling binary patches\n\n'\n. ./test-lib.sh\n\n# setup\n\ncat >file1 <<EOF\nA quick brown fox jumps over the lazy dog.\nA tiny little penguin runs around in circles.\nThere is a flag with Linux written on it.\nA slow black-and-white panda just sits there,\nmunching on his bamboo.\nEOF\ncat file1 >file2\ncat file1 >file4\n\ngit-update-index --add --remove file1 file2 file4\ngit-commit -m 'Initial Version' 2>/dev/null\n\ngit-checkout -b binary\ntr 'x' '\\0' <file1 >file3\ncat file3 >file4\ngit-add file2\ntr '\\0' 'v' <file3 >file1\nrm -f file2\ngit-update-index --add --remove file1 file2 file3 file4\ngit-commit -m 'Second Version'\n\ngit-diff-tree -p master binary >B.diff\ngit-diff-tree -p -C master binary >C.diff\n\ngit-diff-tree -p --full-index master binary >BF.diff\ngit-diff-tree -p --full-index -C master binary >CF.diff\n\ntest_expect_success 'stat binary diff -- should not fail.' \\\n\t'git-checkout master\n\t git-apply --stat --summary B.diff'\n\ntest_expect_success 'stat binary diff (copy) -- should not fail.' \\\n\t'git-checkout master\n\t git-apply --stat --summary C.diff'\n\ntest_expect_failure 'check binary diff -- should fail.' \\\n\t'git-checkout master\n\t git-apply --check B.diff'\n\ntest_expect_failure 'check binary diff (copy) -- should fail.' \\\n\t'git-checkout master\n\t git-apply --check C.diff'\n\ntest_expect_failure 'check incomplete binary diff with replacement -- should fail.' \\\n\t'git-checkout master\n\t git-apply --check --allow-binary-replacement B.diff'\n\ntest_expect_failure 'check incomplete binary diff with replacement (copy) -- should fail.' \\\n\t'git-checkout master\n\t git-apply --check --allow-binary-replacement C.diff'\n\ntest_expect_success 'check binary diff with replacement.' \\\n\t'git-checkout master\n\t git-apply --check --allow-binary-replacement BF.diff'\n\ntest_expect_success 'check binary diff with replacement (copy).' \\\n\t'git-checkout master\n\t git-apply --check --allow-binary-replacement CF.diff'\n\n# Now we start applying them.\n\ndo_reset () {\n\trm -f file?\n\tgit-reset --hard\n\tgit-checkout -f master\n}\n\ntest_expect_failure 'apply binary diff -- should fail.' \\\n\t'do_reset\n\t git-apply B.diff'\n\ntest_expect_failure 'apply binary diff -- should fail.' \\\n\t'do_reset\n\t git-apply --index B.diff'\n\ntest_expect_failure 'apply binary diff (copy) -- should fail.' \\\n\t'do_reset\n\t git-apply C.diff'\n\ntest_expect_failure 'apply binary diff (copy) -- should fail.' \\\n\t'do_reset\n\t git-apply --index C.diff'\n\ntest_expect_failure 'apply binary diff without replacement -- should fail.' \\\n\t'do_reset\n\t git-apply BF.diff'\n\ntest_expect_failure 'apply binary diff without replacement (copy) -- should fail.' \\\n\t'do_reset\n\t git-apply CF.diff'\n\ntest_expect_success 'apply binary diff.' \\\n\t'do_reset\n\t git-apply --allow-binary-replacement --index BF.diff &&\n\t test -z \"$(git-diff --name-status binary)\"'\n\ntest_expect_success 'apply binary diff (copy).' \\\n\t'do_reset\n\t git-apply --allow-binary-replacement --index CF.diff &&\n\t test -z \"$(git-diff --name-status binary)\"'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "00bd8b15c625f3f95aefa771abded1a985342c23",
  "sha1_ok": true,
  "size": 3033
}
