{
  "content": {
    "base64": "IyEvYmluL3NoCgp0ZXN0X2Rlc2NyaXB0aW9uPSdzdXBwb3J0IGZvciByZWFkaW5nIGNvbmZpZyBmcm9tIGEgYmxvYicKLiAuL3Rlc3QtbGliLnNoCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdjcmVhdGUgY29uZmlnIGJsb2InICcKCWNhdCA+Y29uZmlnIDw8LVxFT0YgJiYKCVtzb21lXQoJCXZhbHVlID0gMQoJRU9GCglnaXQgYWRkIGNvbmZpZyAmJgoJZ2l0IGNvbW1pdCAtbSBmb28KJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnbGlzdCBjb25maWcgYmxvYiBjb250ZW50cycgJwoJZWNobyBzb21lLnZhbHVlPTEgPmV4cGVjdCAmJgoJZ2l0IGNvbmZpZyAtLWJsb2I9SEVBRDpjb25maWcgLS1saXN0ID5hY3R1YWwgJiYKCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnZmV0Y2ggdmFsdWUgZnJvbSBibG9iJyAnCgllY2hvIHRydWUgPmV4cGVjdCAmJgoJZ2l0IGNvbmZpZyAtLWJsb2I9SEVBRDpjb25maWcgLS1ib29sIHNvbWUudmFsdWUgPmFjdHVhbCAmJgoJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdyZWFkaW5nIG5vbi1leGlzdGluZyB2YWx1ZSBmcm9tIGJsb2IgaXMgYW4gZXJyb3InICcKCXRlc3RfbXVzdF9mYWlsIGdpdCBjb25maWcgLS1ibG9iPUhFQUQ6Y29uZmlnIG5vbi5leGlzdGluZwonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdyZWFkaW5nIGZyb20gYmxvYiBhbmQgZmlsZSBpcyBhbiBlcnJvcicgJwoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNvbmZpZyAtLWJsb2I9SEVBRDpjb25maWcgLS1zeXN0ZW0gLS1saXN0CicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3JlYWRpbmcgZnJvbSBtaXNzaW5nIHJlZiBpcyBhbiBlcnJvcicgJwoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNvbmZpZyAtLWJsb2I9SEVBRDpkb2Vzbm90ZXhpc3QgLS1saXN0CicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3JlYWRpbmcgZnJvbSBub24tYmxvYiBpcyBhbiBlcnJvcicgJwoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNvbmZpZyAtLWJsb2I9SEVBRCAtLWxpc3QKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2V0dGluZyBhIHZhbHVlIGluIGEgYmxvYiBpcyBhbiBlcnJvcicgJwoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNvbmZpZyAtLWJsb2I9SEVBRDpjb25maWcgc29tZS52YWx1ZSBmb28KJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnZGVsZXRpbmcgYSB2YWx1ZSBpbiBhIGJsb2IgaXMgYW4gZXJyb3InICcKCXRlc3RfbXVzdF9mYWlsIGdpdCBjb25maWcgLS1ibG9iPUhFQUQ6Y29uZmlnIC0tdW5zZXQgc29tZS52YWx1ZQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdlZGl0aW5nIGEgYmxvYiBpcyBhbiBlcnJvcicgJwoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNvbmZpZyAtLWJsb2I9SEVBRDpjb25maWcgLS1lZGl0CicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3BhcnNlIGVycm9ycyBpbiBibG9icyBhcmUgcHJvcGVybHkgYXR0cmlidXRlZCcgJwoJY2F0ID5jb25maWcgPDwtXEVPRiAmJgoJW3NvbWVdCgkJdmFsdWUgPSAiCglFT0YKCWdpdCBhZGQgY29uZmlnICYmCglnaXQgY29tbWl0IC1tIGJyb2tlbiAmJgoKCXRlc3RfbXVzdF9mYWlsIGdpdCBjb25maWcgLS1ibG9iPUhFQUQ6Y29uZmlnIHNvbWUudmFsdWUgMj5lcnIgJiYKCXRlc3RfaTE4bmdyZXAgIkhFQUQ6Y29uZmlnIiBlcnIKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY2FuIHBhcnNlIGJsb2IgZW5kaW5nIHdpdGggQ1InICcKCXByaW50ZiAiW3NvbWVda2V5ID0gdmFsdWVcXHIiID5jb25maWcgJiYKCWdpdCBhZGQgY29uZmlnICYmCglnaXQgY29tbWl0IC1tIENSICYmCgllY2hvIHZhbHVlID5leHBlY3QgJiYKCWdpdCBjb25maWcgLS1ibG9iPUhFQUQ6Y29uZmlnIHNvbWUua2V5ID5hY3R1YWwgJiYKCXRlc3RfY21wIGV4cGVjdCBhY3R1YWwKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnY29uZmlnIC0tYmxvYiBvdXRzaWRlIG9mIGEgcmVwb3NpdG9yeSBpcyBhbiBlcnJvcicgJwoJbm9uZ2l0IHRlc3RfbXVzdF9mYWlsIGdpdCBjb25maWcgLS1ibG9iPWZvbyAtLWxpc3QKJwoKdGVzdF9kb25lCg==",
    "text": "#!/bin/sh\n\ntest_description='support for reading config from a blob'\n. ./test-lib.sh\n\ntest_expect_success 'create config blob' '\n\tcat >config <<-\\EOF &&\n\t[some]\n\t\tvalue = 1\n\tEOF\n\tgit add config &&\n\tgit commit -m foo\n'\n\ntest_expect_success 'list config blob contents' '\n\techo some.value=1 >expect &&\n\tgit config --blob=HEAD:config --list >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success 'fetch value from blob' '\n\techo true >expect &&\n\tgit config --blob=HEAD:config --bool some.value >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success 'reading non-existing value from blob is an error' '\n\ttest_must_fail git config --blob=HEAD:config non.existing\n'\n\ntest_expect_success 'reading from blob and file is an error' '\n\ttest_must_fail git config --blob=HEAD:config --system --list\n'\n\ntest_expect_success 'reading from missing ref is an error' '\n\ttest_must_fail git config --blob=HEAD:doesnotexist --list\n'\n\ntest_expect_success 'reading from non-blob is an error' '\n\ttest_must_fail git config --blob=HEAD --list\n'\n\ntest_expect_success 'setting a value in a blob is an error' '\n\ttest_must_fail git config --blob=HEAD:config some.value foo\n'\n\ntest_expect_success 'deleting a value in a blob is an error' '\n\ttest_must_fail git config --blob=HEAD:config --unset some.value\n'\n\ntest_expect_success 'editing a blob is an error' '\n\ttest_must_fail git config --blob=HEAD:config --edit\n'\n\ntest_expect_success 'parse errors in blobs are properly attributed' '\n\tcat >config <<-\\EOF &&\n\t[some]\n\t\tvalue = \"\n\tEOF\n\tgit add config &&\n\tgit commit -m broken &&\n\n\ttest_must_fail git config --blob=HEAD:config some.value 2>err &&\n\ttest_i18ngrep \"HEAD:config\" err\n'\n\ntest_expect_success 'can parse blob ending with CR' '\n\tprintf \"[some]key = value\\\\r\" >config &&\n\tgit add config &&\n\tgit commit -m CR &&\n\techo value >expect &&\n\tgit config --blob=HEAD:config some.key >actual &&\n\ttest_cmp expect actual\n'\n\ntest_expect_success 'config --blob outside of a repository is an error' '\n\tnongit test_must_fail git config --blob=foo --list\n'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "002e6d3388e242c56800da6b9640819c90ed5615",
  "sha1_ok": true,
  "size": 2029
}
