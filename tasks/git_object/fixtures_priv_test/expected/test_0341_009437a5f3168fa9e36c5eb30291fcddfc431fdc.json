{
  "content": {
    "base64": "IyEvYmluL3NoCgp0ZXN0X2Rlc2NyaXB0aW9uPSd0ZXN0IHRoZSBgc2NhbGFyYCBjb21tYW5kJwoKLiAuL3Rlc3QtbGliLnNoCgpHSVRfVEVTVF9NQUlOVF9TQ0hFRFVMRVI9ImNyb250YWI6dGVzdC10b29sIGNyb250YWIgY3Jvbi50eHQsbGF1bmNoY3RsOnRydWUsc2NodGFza3M6dHJ1ZSIKZXhwb3J0IEdJVF9URVNUX01BSU5UX1NDSEVEVUxFUgoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2NhbGFyIHNob3dzIGEgdXNhZ2UnICcKCXRlc3RfZXhwZWN0X2NvZGUgMTI5IHNjYWxhciAtaAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzY2FsYXIgaW52b2tlZCBvbiBlbmxpc3RtZW50IHJvb3QnICcKCXRlc3Rfd2hlbl9maW5pc2hlZCBybSAtcmYgdGVzdCBzcmMgZGVlcGVyICYmCgoJZm9yIGVubGlzdG1lbnRfcm9vdCBpbiB0ZXN0IHNyYyBkZWVwZXIvdGVzdAoJZG8KCQlnaXQgaW5pdCAke2VubGlzdG1lbnRfcm9vdH0vc3JjICYmCgoJCSMgUmVnaXN0ZXIKCQlzY2FsYXIgcmVnaXN0ZXIgJHtlbmxpc3RtZW50X3Jvb3R9ICYmCgkJc2NhbGFyIGxpc3QgPm91dCAmJgoJCWdyZXAgIiQocHdkKS8ke2VubGlzdG1lbnRfcm9vdH0vc3JjXCQiIG91dCAmJgoKCQkjIERlbGV0ZSAoaW5jbHVkaW5nIGVubGlzdG1lbnQgcm9vdCkKCQlzY2FsYXIgZGVsZXRlICRlbmxpc3RtZW50X3Jvb3QgJiYKCQl0ZXN0X3BhdGhfaXNfbWlzc2luZyAkZW5saXN0bWVudF9yb290ICYmCgkJc2NhbGFyIGxpc3QgPm91dCAmJgoJCSEgZ3JlcCAiXiQocHdkKS8ke2VubGlzdG1lbnRfcm9vdH0vc3JjXCQiIG91dCB8fCByZXR1cm4gMQoJZG9uZQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzY2FsYXIgaW52b2tlZCBvbiBlbmxpc3RtZW50IHNyYyByZXBvJyAnCgl0ZXN0X3doZW5fZmluaXNoZWQgcm0gLXJmIHRlc3Qgc3JjIGRlZXBlciAmJgoKCWZvciBlbmxpc3RtZW50X3Jvb3QgaW4gdGVzdCBzcmMgZGVlcGVyL3Rlc3QKCWRvCgkJZ2l0IGluaXQgJHtlbmxpc3RtZW50X3Jvb3R9L3NyYyAmJgoKCQkjIFJlZ2lzdGVyCgkJc2NhbGFyIHJlZ2lzdGVyICR7ZW5saXN0bWVudF9yb290fS9zcmMgJiYKCQlzY2FsYXIgbGlzdCA+b3V0ICYmCgkJZ3JlcCAiJChwd2QpLyR7ZW5saXN0bWVudF9yb290fS9zcmNcJCIgb3V0ICYmCgoJCSMgRGVsZXRlICh3aWxsIG5vdCBpbmNsdWRlIGVubGlzdG1lbnQgcm9vdCkKCQlzY2FsYXIgZGVsZXRlICR7ZW5saXN0bWVudF9yb290fS9zcmMgJiYKCQl0ZXN0X3BhdGhfaXNfZGlyICRlbmxpc3RtZW50X3Jvb3QgJiYKCQlzY2FsYXIgbGlzdCA+b3V0ICYmCgkJISBncmVwICJeJChwd2QpLyR7ZW5saXN0bWVudF9yb290fS9zcmNcJCIgb3V0IHx8IHJldHVybiAxCglkb25lCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NjYWxhciBpbnZva2VkIHdoZW4gZW5saXN0bWVudCByb290IGFuZCByZXBvIGFyZSB0aGUgc2FtZScgJwoJdGVzdF93aGVuX2ZpbmlzaGVkIHJtIC1yZiB0ZXN0IHNyYyBkZWVwZXIgJiYKCglmb3IgZW5saXN0bWVudF9yb290IGluIHRlc3Qgc3JjIGRlZXBlci90ZXN0CglkbwoJCWdpdCBpbml0ICR7ZW5saXN0bWVudF9yb290fSAmJgoKCQkjIFJlZ2lzdGVyCgkJc2NhbGFyIHJlZ2lzdGVyICR7ZW5saXN0bWVudF9yb290fSAmJgoJCXNjYWxhciBsaXN0ID5vdXQgJiYKCQlncmVwICIkKHB3ZCkvJHtlbmxpc3RtZW50X3Jvb3R9XCQiIG91dCAmJgoKCQkjIERlbGV0ZSAod2lsbCBub3QgaW5jbHVkZSBlbmxpc3RtZW50IHJvb3QpCgkJc2NhbGFyIGRlbGV0ZSAke2VubGlzdG1lbnRfcm9vdH0gJiYKCQl0ZXN0X3BhdGhfaXNfbWlzc2luZyAkZW5saXN0bWVudF9yb290ICYmCgkJc2NhbGFyIGxpc3QgPm91dCAmJgoJCSEgZ3JlcCAiXiQocHdkKS8ke2VubGlzdG1lbnRfcm9vdH1cJCIgb3V0ICYmCgoJCSMgTWFrZSBzdXJlIHdlIGRpZCBub3QgYWNjaWRlbnRhbGx5IGRlbGV0ZSB0aGUgdHJhc2ggZGlyCgkJdGVzdF9wYXRoX2lzX2RpciAiJFRSQVNIX0RJUkVDVE9SWSIgfHwgcmV0dXJuIDEKCWRvbmUKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2NhbGFyIHJlcG8gc2VhcmNoIHJlc3BlY3RzIEdJVF9DRUlMSU5HX0RJUkVDVE9SSUVTJyAnCgl0ZXN0X3doZW5fZmluaXNoZWQgcm0gLXJmIHRlc3QgJiYKCglnaXQgaW5pdCB0ZXN0L3NyYyAmJgoJbWtkaXIgLXAgdGVzdC9zcmMvZGVlcCAmJgoJR0lUX0NFSUxJTkdfRElSRUNUT1JJRVM9IiQocHdkKS90ZXN0L3NyYyIgJiYKCSEgc2NhbGFyIHJlZ2lzdGVyIHRlc3Qvc3JjL2RlZXAgMj5lcnIgJiYKCWdyZXAgIm5vdCBhIGdpdCByZXBvc2l0b3J5IiBlcnIKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2NhbGFyIGVubGlzdG1lbnRzIG5lZWQgYSB3b3JrdHJlZScgJwoJdGVzdF93aGVuX2ZpbmlzaGVkIHJtIC1yZiBiYXJlIHRlc3QgJiYKCglnaXQgaW5pdCAtLWJhcmUgYmFyZS9zcmMgJiYKCSEgc2NhbGFyIHJlZ2lzdGVyIGJhcmUvc3JjIDI+ZXJyICYmCglncmVwICJTY2FsYXIgZW5saXN0bWVudHMgcmVxdWlyZSBhIHdvcmt0cmVlIiBlcnIgJiYKCglnaXQgaW5pdCB0ZXN0L3NyYyAmJgoJISBzY2FsYXIgcmVnaXN0ZXIgdGVzdC9zcmMvLmdpdCAyPmVyciAmJgoJZ3JlcCAiU2NhbGFyIGVubGlzdG1lbnRzIHJlcXVpcmUgYSB3b3JrdHJlZSIgZXJyCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgRlNNT05JVE9SX0RBRU1PTiAnc2NhbGFyIHJlZ2lzdGVyIHN0YXJ0cyBmc21vbiBkYWVtb24nICcKCWdpdCBpbml0IHRlc3Qvc3JjICYmCgl0ZXN0X211c3RfZmFpbCBnaXQgLUMgdGVzdC9zcmMgZnNtb25pdG9yLS1kYWVtb24gc3RhdHVzICYmCglzY2FsYXIgcmVnaXN0ZXIgdGVzdC9zcmMgJiYKCWdpdCAtQyB0ZXN0L3NyYyBmc21vbml0b3ItLWRhZW1vbiBzdGF0dXMgJiYKCXRlc3RfY21wX2NvbmZpZyAtQyB0ZXN0L3NyYyB0cnVlIGNvcmUuZnNtb25pdG9yCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NjYWxhciByZWdpc3RlciB3YXJucyB3aGVuIGJhY2tncm91bmQgbWFpbnRlbmFuY2UgZmFpbHMnICcKCWdpdCBpbml0IHJlZ2lzdGVyLXJlcG8gJiYKCUdJVF9URVNUX01BSU5UX1NDSEVEVUxFUj0iY3JvbnRhYjpmYWxzZSxsYXVuY2hjdGw6ZmFsc2Usc2NodGFza3M6ZmFsc2UiIFwKCQlzY2FsYXIgcmVnaXN0ZXIgcmVnaXN0ZXItcmVwbyAyPmVyciAmJgoJZ3JlcCAiY291bGQgbm90IHRvZ2dsZSBtYWludGVuYW5jZSIgZXJyCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NjYWxhciB1bnJlZ2lzdGVyJyAnCglnaXQgaW5pdCB2YW5pc2gvc3JjICYmCglzY2FsYXIgcmVnaXN0ZXIgdmFuaXNoL3NyYyAmJgoJZ2l0IGNvbmZpZyAtLWdldCAtLWdsb2JhbCAtLWZpeGVkLXZhbHVlIFwKCQltYWludGVuYW5jZS5yZXBvICIkKHB3ZCkvdmFuaXNoL3NyYyIgJiYKCXNjYWxhciBsaXN0ID5zY2FsYXIucmVwb3MgJiYKCWdyZXAgLUYgIiQocHdkKS92YW5pc2gvc3JjIiBzY2FsYXIucmVwb3MgJiYKCXJtIC1yZiB2YW5pc2gvc3JjLy5naXQgJiYKCXNjYWxhciB1bnJlZ2lzdGVyIHZhbmlzaCAmJgoJdGVzdF9tdXN0X2ZhaWwgZ2l0IGNvbmZpZyAtLWdldCAtLWdsb2JhbCAtLWZpeGVkLXZhbHVlIFwKCQltYWludGVuYW5jZS5yZXBvICIkKHB3ZCkvdmFuaXNoL3NyYyIgJiYKCXNjYWxhciBsaXN0ID5zY2FsYXIucmVwb3MgJiYKCSEgZ3JlcCAtRiAiJChwd2QpL3ZhbmlzaC9zcmMiIHNjYWxhci5yZXBvcyAmJgoKCSMgc2NhbGFyIHVucmVnaXN0ZXIgc2hvdWxkIGJlIGlkZW1wb3RlbnQKCXNjYWxhciB1bnJlZ2lzdGVyIHZhbmlzaAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzY2FsYXIgcmVnaXN0ZXIgLS1uby1tYWludGVuYW5jZScgJwoJZ2l0IGluaXQgcmVnaXN0ZXItbm8tbWFpbnQgJiYKCWV2ZW50X2xvZz0iJChwd2QpL25vLW1haW50LmV2ZW50IiAmJgoJR0lUX1RFU1RfTUFJTlRfU0NIRURVTEVSPSJjcm9udGFiOmZhbHNlLGxhdW5jaGN0bDpmYWxzZSxzY2h0YXNrczpmYWxzZSIgXAoJR0lUX1RSQUNFMl9FVkVOVD0iJGV2ZW50X2xvZyIgXAoJR0lUX1RSQUNFMl9FVkVOVF9ERVBUSD0xMDAgXAoJCXNjYWxhciByZWdpc3RlciAtLW5vLW1haW50ZW5hbmNlIHJlZ2lzdGVyLW5vLW1haW50IDI+ZXJyICYmCgl0ZXN0X211c3RfYmVfZW1wdHkgZXJyICYmCgl0ZXN0X3N1YmNvbW1hbmQgISBnaXQgbWFpbnRlbmFuY2UgdW5yZWdpc3RlciAtLWZvcmNlIDxuby1tYWludC5ldmVudAonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzZXQgdXAgcmVwb3NpdG9yeSB0byBjbG9uZScgJwoJdGVzdF9jb21taXQgZmlyc3QgJiYKCXRlc3RfY29tbWl0IHNlY29uZCAmJgoJdGVzdF9jb21taXQgdGhpcmQgJiYKCWdpdCBzd2l0Y2ggLWMgcGFyYWxsZWwgZmlyc3QgJiYKCW1rZGlyIC1wIDEvMiAmJgoJdGVzdF9jb21taXQgMS8yLzMgJiYKCWdpdCBjb25maWcgdXBsb2FkUGFjay5hbGxvd0ZpbHRlciB0cnVlICYmCglnaXQgY29uZmlnIHVwbG9hZFBhY2suYWxsb3dBbnlTSEExSW5XYW50IHRydWUKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2NhbGFyIGNsb25lJyAnCglzZWNvbmQ9JChnaXQgcmV2LXBhcnNlIC0tdmVyaWZ5IHNlY29uZDpzZWNvbmQudCkgJiYKCXNjYWxhciBjbG9uZSAiZmlsZTovLyQocHdkKSIgY2xvbmVkIC0tc2luZ2xlLWJyYW5jaCAmJgoJKAoJCWNkIGNsb25lZC9zcmMgJiYKCgkJZ2l0IGNvbmZpZyAtLWdldCAtLWdsb2JhbCAtLWZpeGVkLXZhbHVlIG1haW50ZW5hbmNlLnJlcG8gXAoJCQkiJChwd2QpIiAmJgoKCQlnaXQgZm9yLWVhY2gtcmVmIC0tZm9ybWF0PSIlKHJlZm5hbWUpIiByZWZzL3JlbW90ZXMvb3JpZ2luLyA+YWN0dWFsICYmCgkJZWNobyAicmVmcy9yZW1vdGVzL29yaWdpbi9IRUFEIiA+PmV4cGVjdCAmJgoJCWVjaG8gInJlZnMvcmVtb3Rlcy9vcmlnaW4vcGFyYWxsZWwiID4+ZXhwZWN0ICYmCgkJdGVzdF9jbXAgZXhwZWN0IGFjdHVhbCAmJgoKCQl0ZXN0X3BhdGhfaXNfbWlzc2luZyAxLzIgJiYKCgkJIyBUaGlzIHJlbGllcyBvbiB0aGUgZmFjdCB0aGF0IHRoZSBwcmVzZW5jZSBvZiAiLS1taXNzaW5nIgoJCSMgb24gdGhlIGNvbW1hbmQgbGluZSBmb3JjZXMgbGF6eSBmZXRjaGluZyBvZmYgYmVmb3JlCgkJIyAiJHNlY29uZF57YmxvYn0iIGdldHMgcGFyc2VkLiAgV2l0aG91dCAiXntibG9ifSIsIGEKCQkjIGJhcmUgb2JqZWN0IG5hbWUgIiRzZWNvbmQiIGlzIHRha2VuIGludG8gdGhlIHF1ZXVlIGFuZAoJCSMgdGhlIGNvbW1hbmQgbWF5IG5vdCBmYWlsIHdpdGggYSBmaXhlZCAicmV2LWxpc3QgLS1taXNzaW5nIi4KCQl0ZXN0X211c3RfZmFpbCBnaXQgcmV2LWxpc3QgLS1taXNzaW5nPXByaW50ICIkc2Vjb25kXntibG9ifSIgLS0gJiYKCgkJZ2l0IHJldi1saXN0ICRzZWNvbmQgJiYKCQlnaXQgY2F0LWZpbGUgYmxvYiAkc2Vjb25kID5hY3R1YWwgJiYKCQllY2hvICJzZWNvbmQiID5leHBlY3QgJiYKCQl0ZXN0X2NtcCBleHBlY3QgYWN0dWFsCgkpCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NjYWxhciBjbG9uZSAtLW5vLS4uLiBvcHRzJyAnCgkjIE5vdGU6IHJlZGlyZWN0IHN0ZGVyciBhbHdheXMgdG8gYXZvaWQgaGF2aW5nIGEgdmVyYm9zZSB0ZXN0CgkjIHJ1biByZXN1bHQgaW4gYSBkaWZmZXJlbmNlIGluIHRoZSAtLVtuby1dcHJvZ3Jlc3Mgb3B0aW9uLgoJR0lUX1RSQUNFMl9FVkVOVD0iJChwd2QpL25vLW9wdC10cmFjZSIgc2NhbGFyIGNsb25lIFwKCQktLW5vLXRhZ3MgLS1uby1zcmMgXAoJCSJmaWxlOi8vJChwd2QpIiBuby1vcHRzIC0tc2luZ2xlLWJyYW5jaCAyPi9kZXYvbnVsbCAmJgoKCXRlc3Rfc3ViY29tbWFuZCBnaXQgZmV0Y2ggLS1xdWlldCAtLW5vLXByb2dyZXNzIFwKCQkJb3JpZ2luIC0tbm8tdGFncyA8bm8tb3B0LXRyYWNlICYmCgkoCgkJY2Qgbm8tb3B0cyAmJgoKCQl0ZXN0X2NtcF9jb25maWcgLS1uby10YWdzIHJlbW90ZS5vcmlnaW4udGFnb3B0ICYmCgkJZ2l0IGZvci1lYWNoLXJlZiAtLWZvcm1hdD0iJShyZWZuYW1lKSIgcmVmcy90YWdzLyA+dGFncyAmJgoJCXRlc3RfbGluZV9jb3VudCA9IDAgdGFncwoJKQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzY2FsYXIgcmVjb25maWd1cmUnICcKCWdpdCBpbml0IG9uZS9zcmMgJiYKCXNjYWxhciByZWdpc3RlciBvbmUgJiYKCWdpdCAtQyBvbmUvc3JjIGNvbmZpZyB1bnNldCBndWkuZ2N3YXJuaW5nICYmCglzY2FsYXIgcmVjb25maWd1cmUgb25lICYmCgl0ZXN0IGZhbHNlID0gIiQoZ2l0IC1DIG9uZS9zcmMgY29uZmlnIGd1aS5nY3dhcm5pbmcpIiAmJgoJZ2l0IC1DIG9uZS9zcmMgY29uZmlnIHVuc2V0IGd1aS5nY3dhcm5pbmcgJiYKCXJtIG9uZS9zcmMvY3Jvbi50eHQgJiYKCUdJVF9UUkFDRTJfRVZFTlQ9IiQocHdkKS9yZWNvbmZpZ3VyZSIgc2NhbGFyIHJlY29uZmlndXJlIC1hICYmCgl0ZXN0X3BhdGhfaXNfZmlsZSBvbmUvc3JjL2Nyb24udHh0ICYmCgl0ZXN0IGZhbHNlID0gIiQoZ2l0IC1DIG9uZS9zcmMgY29uZmlnIGd1aS5nY3dhcm5pbmcpIiAmJgoJdGVzdF9ncmVwICJHQ1dhcm5pbmcgPSBmYWxzZSAjIHNldCBieSBzY2FsYXIiIG9uZS9zcmMvLmdpdC9jb25maWcgJiYKCXRlc3RfZ3JlcCAiZXhjbHVkZURlY29yYXRpb24gPSByZWZzL3ByZWZldGNoL1wqICMgc2V0IGJ5IHNjYWxhciIgb25lL3NyYy8uZ2l0L2NvbmZpZyAmJgoKCXRlc3Rfc3ViY29tbWFuZCBnaXQgbWFpbnRlbmFuY2Ugc3RhcnQgPHJlY29uZmlndXJlICYmCgl0ZXN0X3N1YmNvbW1hbmQgISBnaXQgbWFpbnRlbmFuY2UgdW5yZWdpc3RlciAtLWZvcmNlIDxyZWNvbmZpZ3VyZSAmJgoKCUdJVF9UUkFDRTJfRVZFTlQ9IiQocHdkKS9yZWNvbmZpZ3VyZS1tYWludC1kaXNhYmxlIiBcCgkJc2NhbGFyIHJlY29uZmlndXJlIC1hIC0tbWFpbnRlbmFuY2U9ZGlzYWJsZSAmJgoJdGVzdF9zdWJjb21tYW5kICEgZ2l0IG1haW50ZW5hbmNlIHN0YXJ0IDxyZWNvbmZpZ3VyZS1tYWludC1kaXNhYmxlICYmCgl0ZXN0X3N1YmNvbW1hbmQgZ2l0IG1haW50ZW5hbmNlIHVucmVnaXN0ZXIgLS1mb3JjZSA8cmVjb25maWd1cmUtbWFpbnQtZGlzYWJsZSAmJgoKCUdJVF9UUkFDRTJfRVZFTlQ9IiQocHdkKS9yZWNvbmZpZ3VyZS1tYWludC1rZWVwIiBcCgkJc2NhbGFyIHJlY29uZmlndXJlIC0tbWFpbnRlbmFuY2U9a2VlcCAtYSAmJgoJdGVzdF9zdWJjb21tYW5kICEgZ2l0IG1haW50ZW5hbmNlIHN0YXJ0IDxyZWNvbmZpZ3VyZS1tYWludC1rZWVwICYmCgl0ZXN0X3N1YmNvbW1hbmQgISBnaXQgbWFpbnRlbmFuY2UgdW5yZWdpc3RlciAtLWZvcmNlIDxyZWNvbmZpZ3VyZS1tYWludC1rZWVwCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NjYWxhciByZWNvbmZpZ3VyZSAtLWFsbCB3aXRoIGluY2x1ZGVJZi5vbmJyYW5jaCcgJwoJcmVwb3M9InR3byB0aHJlZSBmb3VyIiAmJgoJZm9yIG51bSBpbiAkcmVwb3MKCWRvCgkJZ2l0IGluaXQgJG51bS9zcmMgJiYKCQlzY2FsYXIgcmVnaXN0ZXIgJG51bS9zcmMgJiYKCQlnaXQgLUMgJG51bS9zcmMgY29uZmlnIGluY2x1ZGVpZi4ib25icmFuY2g6Zm9vIi5wYXRoIHNvbWV0aGluZyAmJgoJCWdpdCAtQyAkbnVtL3NyYyBjb25maWcgdW5zZXQgZ3VpLmdjd2FybmluZyB8fCByZXR1cm4gMQoJZG9uZSAmJgoKCXNjYWxhciByZWNvbmZpZ3VyZSAtLWFsbCAmJgoKCWZvciBudW0gaW4gJHJlcG9zCglkbwoJCXRlc3QgZmFsc2UgPSAiJChnaXQgLUMgJG51bS9zcmMgY29uZmlnIGd1aS5nY3dhcm5pbmcpIiB8fCByZXR1cm4gMQoJZG9uZQonCgp0ZXN0X2V4cGVjdF9zdWNjZXNzICdzY2FsYXIgcmVjb25maWd1cmUgLS1hbGwgd2l0aCBkZXRhY2hlZCBIRUFEcycgJwoJIyBUaGlzIHRlc3QgZGVtb25zdHJhdGVzIGFuIGlzc3VlIHdpdGggaW5kZXguc2tpcEhhc2g9dHJ1ZSBhbmQKCSMgdGhpcyB0ZXN0IHZhcmlhYmxlIGZvciB0aGUgc3BsaXQgaW5kZXguIERpc2FibGUgdGhlIHRlc3QgdmFyaWFibGUuCglzYW5lX3Vuc2V0IEdJVF9URVNUX1NQTElUX0lOREVYICYmCgoJcmVwb3M9InR3byB0aHJlZSBmb3VyIiAmJgoJZm9yIG51bSBpbiAkcmVwb3MKCWRvCgkJcm0gLXJmICRudW0vc3JjICYmCgkJZ2l0IGluaXQgJG51bS9zcmMgJiYKCQlzY2FsYXIgcmVnaXN0ZXIgJG51bS9zcmMgJiYKCQlnaXQgLUMgJG51bS9zcmMgY29uZmlnIHVuc2V0IGd1aS5nY3dhcm5pbmcgJiYKCQl0ZXN0X2NvbW1pdCAtQyAkbnVtL3NyYyBpbml0aWFsICYmCgkJZ2l0IC1DICRudW0vc3JjIHN3aXRjaCAtLWRldGFjaCBIRUFEIHx8IHJldHVybiAxCglkb25lICYmCgoJc2NhbGFyIHJlY29uZmlndXJlIC0tYWxsICYmCgoJZm9yIG51bSBpbiAkcmVwb3MKCWRvCgkJdGVzdCBmYWxzZSA9ICIkKGdpdCAtQyAkbnVtL3NyYyBjb25maWcgZ3VpLmdjd2FybmluZykiIHx8IHJldHVybiAxCglkb25lCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2ByZWNvbmZpZ3VyZSAtYWAgcmVtb3ZlcyBzdGFsZSBjb25maWcgZW50cmllcycgJwoJZ2l0IGluaXQgc3RhbGUvc3JjICYmCglzY2FsYXIgcmVnaXN0ZXIgc3RhbGUgJiYKCXNjYWxhciBsaXN0ID5zY2FsYXIucmVwb3MgJiYKCWdyZXAgc3RhbGUgc2NhbGFyLnJlcG9zICYmCgoJZ3JlcCAtdiBzdGFsZSBzY2FsYXIucmVwb3MgPmV4cGVjdCAmJgoKCXJtIC1yZiBzdGFsZSAmJgoJc2NhbGFyIHJlY29uZmlndXJlIC1hICYmCglzY2FsYXIgbGlzdCA+c2NhbGFyLnJlcG9zICYmCgl0ZXN0X2NtcCBleHBlY3Qgc2NhbGFyLnJlcG9zCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ3NjYWxhciBkZWxldGUgd2l0aG91dCBlbmxpc3RtZW50IHNob3dzIGEgdXNhZ2UnICcKCXRlc3RfZXhwZWN0X2NvZGUgMTI5IHNjYWxhciBkZWxldGUKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2NhbGFyIGRlbGV0ZSB3aXRoIGVubGlzdG1lbnQnICcKCXNjYWxhciBkZWxldGUgY2xvbmVkICYmCgl0ZXN0X3BhdGhfaXNfbWlzc2luZyBjbG9uZWQKJwoKdGVzdF9leHBlY3Rfc3VjY2VzcyAnc2NhbGFyIHN1cHBvcnRzIC1jLy1DJyAnCgl0ZXN0X3doZW5fZmluaXNoZWQgInNjYWxhciBkZWxldGUgc3ViIiAmJgoJZ2l0IGluaXQgc3ViICYmCglzY2FsYXIgLUMgc3ViIC1jIHN0YXR1cy5haGVhZEJlaGluZD1ib2d1cyByZWdpc3RlciAmJgoJdGVzdCAteiAiJChnaXQgLUMgc3ViIGNvbmZpZyAtLWxvY2FsIHN0YXR1cy5haGVhZEJlaGluZCkiICYmCgl0ZXN0IGZhbHNlID0gIiQoZ2l0IC1DIHN1YiBjb25maWcgZ3VpLmdjd2FybmluZykiCicKCnRlc3RfZXhwZWN0X3N1Y2Nlc3MgJ2BzY2FsYXIgWy4uLl0gPGRpcj5gIGVycm9ycyBvdXQgd2hlbiBkaXIgaXMgbWlzc2luZycgJwoJISBzY2FsYXIgcnVuIGNvbmZpZyBjbG9uZWQgMj5lcnIgJiYKCWdyZXAgImNsb25lZC4gZG9lcyBub3QgZXhpc3QiIGVycgonCgpTUT0iJyIKdGVzdF9leHBlY3Rfc3VjY2VzcyBVTlpJUCAnc2NhbGFyIGRpYWdub3NlJyAnCglzY2FsYXIgY2xvbmUgImZpbGU6Ly8kKHB3ZCkiIGNsb25lZCAtLXNpbmdsZS1icmFuY2ggJiYKCWdpdCByZXBhY2sgJiYKCWVjaG8gIiQocHdkKS8uZ2l0L29iamVjdHMvIiA+PmNsb25lZC9zcmMvLmdpdC9vYmplY3RzL2luZm8vYWx0ZXJuYXRlcyAmJgoJdGVzdF9jb21taXQgLUMgY2xvbmVkL3NyYyBsb29zZSAmJgoJc2NhbGFyIGRpYWdub3NlIGNsb25lZCA+b3V0IDI+ZXJyICYmCglncmVwICJBdmFpbGFibGUgc3BhY2UiIG91dCAmJgoJc2VkIC1uICJzLy4qJFNRXFwoLipcXC56aXBcXCkkU1EuKi9cXDEvcCIgPGVyciA+emlwX3BhdGggJiYKCXppcF9wYXRoPSQoY2F0IHppcF9wYXRoKSAmJgoJdGVzdCAtbiAiJHppcF9wYXRoIiAmJgoJIiRHSVRfVU5aSVAiIC12ICIkemlwX3BhdGgiICYmCglmb2xkZXI9JHt6aXBfcGF0aCUuemlwfSAmJgoJdGVzdF9wYXRoX2lzX21pc3NpbmcgIiRmb2xkZXIiICYmCgkiJEdJVF9VTlpJUCIgLXAgIiR6aXBfcGF0aCIgZGlhZ25vc3RpY3MubG9nID5vdXQgJiYKCXRlc3RfZmlsZV9ub3RfZW1wdHkgb3V0ICYmCgkiJEdJVF9VTlpJUCIgLXAgIiR6aXBfcGF0aCIgcGFja3MtbG9jYWwudHh0ID5vdXQgJiYKCWdyZXAgIiQocHdkKS8uZ2l0L29iamVjdHMiIG91dCAmJgoJIiRHSVRfVU5aSVAiIC1wICIkemlwX3BhdGgiIG9iamVjdHMtbG9jYWwudHh0ID5vdXQgJiYKCWdyZXAgIl5Ub3RhbDogWzEtOV0iIG91dAonCgp0ZXN0X2RvbmUK",
    "text": "#!/bin/sh\n\ntest_description='test the `scalar` command'\n\n. ./test-lib.sh\n\nGIT_TEST_MAINT_SCHEDULER=\"crontab:test-tool crontab cron.txt,launchctl:true,schtasks:true\"\nexport GIT_TEST_MAINT_SCHEDULER\n\ntest_expect_success 'scalar shows a usage' '\n\ttest_expect_code 129 scalar -h\n'\n\ntest_expect_success 'scalar invoked on enlistment root' '\n\ttest_when_finished rm -rf test src deeper &&\n\n\tfor enlistment_root in test src deeper/test\n\tdo\n\t\tgit init ${enlistment_root}/src &&\n\n\t\t# Register\n\t\tscalar register ${enlistment_root} &&\n\t\tscalar list >out &&\n\t\tgrep \"$(pwd)/${enlistment_root}/src\\$\" out &&\n\n\t\t# Delete (including enlistment root)\n\t\tscalar delete $enlistment_root &&\n\t\ttest_path_is_missing $enlistment_root &&\n\t\tscalar list >out &&\n\t\t! grep \"^$(pwd)/${enlistment_root}/src\\$\" out || return 1\n\tdone\n'\n\ntest_expect_success 'scalar invoked on enlistment src repo' '\n\ttest_when_finished rm -rf test src deeper &&\n\n\tfor enlistment_root in test src deeper/test\n\tdo\n\t\tgit init ${enlistment_root}/src &&\n\n\t\t# Register\n\t\tscalar register ${enlistment_root}/src &&\n\t\tscalar list >out &&\n\t\tgrep \"$(pwd)/${enlistment_root}/src\\$\" out &&\n\n\t\t# Delete (will not include enlistment root)\n\t\tscalar delete ${enlistment_root}/src &&\n\t\ttest_path_is_dir $enlistment_root &&\n\t\tscalar list >out &&\n\t\t! grep \"^$(pwd)/${enlistment_root}/src\\$\" out || return 1\n\tdone\n'\n\ntest_expect_success 'scalar invoked when enlistment root and repo are the same' '\n\ttest_when_finished rm -rf test src deeper &&\n\n\tfor enlistment_root in test src deeper/test\n\tdo\n\t\tgit init ${enlistment_root} &&\n\n\t\t# Register\n\t\tscalar register ${enlistment_root} &&\n\t\tscalar list >out &&\n\t\tgrep \"$(pwd)/${enlistment_root}\\$\" out &&\n\n\t\t# Delete (will not include enlistment root)\n\t\tscalar delete ${enlistment_root} &&\n\t\ttest_path_is_missing $enlistment_root &&\n\t\tscalar list >out &&\n\t\t! grep \"^$(pwd)/${enlistment_root}\\$\" out &&\n\n\t\t# Make sure we did not accidentally delete the trash dir\n\t\ttest_path_is_dir \"$TRASH_DIRECTORY\" || return 1\n\tdone\n'\n\ntest_expect_success 'scalar repo search respects GIT_CEILING_DIRECTORIES' '\n\ttest_when_finished rm -rf test &&\n\n\tgit init test/src &&\n\tmkdir -p test/src/deep &&\n\tGIT_CEILING_DIRECTORIES=\"$(pwd)/test/src\" &&\n\t! scalar register test/src/deep 2>err &&\n\tgrep \"not a git repository\" err\n'\n\ntest_expect_success 'scalar enlistments need a worktree' '\n\ttest_when_finished rm -rf bare test &&\n\n\tgit init --bare bare/src &&\n\t! scalar register bare/src 2>err &&\n\tgrep \"Scalar enlistments require a worktree\" err &&\n\n\tgit init test/src &&\n\t! scalar register test/src/.git 2>err &&\n\tgrep \"Scalar enlistments require a worktree\" err\n'\n\ntest_expect_success FSMONITOR_DAEMON 'scalar register starts fsmon daemon' '\n\tgit init test/src &&\n\ttest_must_fail git -C test/src fsmonitor--daemon status &&\n\tscalar register test/src &&\n\tgit -C test/src fsmonitor--daemon status &&\n\ttest_cmp_config -C test/src true core.fsmonitor\n'\n\ntest_expect_success 'scalar register warns when background maintenance fails' '\n\tgit init register-repo &&\n\tGIT_TEST_MAINT_SCHEDULER=\"crontab:false,launchctl:false,schtasks:false\" \\\n\t\tscalar register register-repo 2>err &&\n\tgrep \"could not toggle maintenance\" err\n'\n\ntest_expect_success 'scalar unregister' '\n\tgit init vanish/src &&\n\tscalar register vanish/src &&\n\tgit config --get --global --fixed-value \\\n\t\tmaintenance.repo \"$(pwd)/vanish/src\" &&\n\tscalar list >scalar.repos &&\n\tgrep -F \"$(pwd)/vanish/src\" scalar.repos &&\n\trm -rf vanish/src/.git &&\n\tscalar unregister vanish &&\n\ttest_must_fail git config --get --global --fixed-value \\\n\t\tmaintenance.repo \"$(pwd)/vanish/src\" &&\n\tscalar list >scalar.repos &&\n\t! grep -F \"$(pwd)/vanish/src\" scalar.repos &&\n\n\t# scalar unregister should be idempotent\n\tscalar unregister vanish\n'\n\ntest_expect_success 'scalar register --no-maintenance' '\n\tgit init register-no-maint &&\n\tevent_log=\"$(pwd)/no-maint.event\" &&\n\tGIT_TEST_MAINT_SCHEDULER=\"crontab:false,launchctl:false,schtasks:false\" \\\n\tGIT_TRACE2_EVENT=\"$event_log\" \\\n\tGIT_TRACE2_EVENT_DEPTH=100 \\\n\t\tscalar register --no-maintenance register-no-maint 2>err &&\n\ttest_must_be_empty err &&\n\ttest_subcommand ! git maintenance unregister --force <no-maint.event\n'\n\ntest_expect_success 'set up repository to clone' '\n\ttest_commit first &&\n\ttest_commit second &&\n\ttest_commit third &&\n\tgit switch -c parallel first &&\n\tmkdir -p 1/2 &&\n\ttest_commit 1/2/3 &&\n\tgit config uploadPack.allowFilter true &&\n\tgit config uploadPack.allowAnySHA1InWant true\n'\n\ntest_expect_success 'scalar clone' '\n\tsecond=$(git rev-parse --verify second:second.t) &&\n\tscalar clone \"file://$(pwd)\" cloned --single-branch &&\n\t(\n\t\tcd cloned/src &&\n\n\t\tgit config --get --global --fixed-value maintenance.repo \\\n\t\t\t\"$(pwd)\" &&\n\n\t\tgit for-each-ref --format=\"%(refname)\" refs/remotes/origin/ >actual &&\n\t\techo \"refs/remotes/origin/HEAD\" >>expect &&\n\t\techo \"refs/remotes/origin/parallel\" >>expect &&\n\t\ttest_cmp expect actual &&\n\n\t\ttest_path_is_missing 1/2 &&\n\n\t\t# This relies on the fact that the presence of \"--missing\"\n\t\t# on the command line forces lazy fetching off before\n\t\t# \"$second^{blob}\" gets parsed.  Without \"^{blob}\", a\n\t\t# bare object name \"$second\" is taken into the queue and\n\t\t# the command may not fail with a fixed \"rev-list --missing\".\n\t\ttest_must_fail git rev-list --missing=print \"$second^{blob}\" -- &&\n\n\t\tgit rev-list $second &&\n\t\tgit cat-file blob $second >actual &&\n\t\techo \"second\" >expect &&\n\t\ttest_cmp expect actual\n\t)\n'\n\ntest_expect_success 'scalar clone --no-... opts' '\n\t# Note: redirect stderr always to avoid having a verbose test\n\t# run result in a difference in the --[no-]progress option.\n\tGIT_TRACE2_EVENT=\"$(pwd)/no-opt-trace\" scalar clone \\\n\t\t--no-tags --no-src \\\n\t\t\"file://$(pwd)\" no-opts --single-branch 2>/dev/null &&\n\n\ttest_subcommand git fetch --quiet --no-progress \\\n\t\t\torigin --no-tags <no-opt-trace &&\n\t(\n\t\tcd no-opts &&\n\n\t\ttest_cmp_config --no-tags remote.origin.tagopt &&\n\t\tgit for-each-ref --format=\"%(refname)\" refs/tags/ >tags &&\n\t\ttest_line_count = 0 tags\n\t)\n'\n\ntest_expect_success 'scalar reconfigure' '\n\tgit init one/src &&\n\tscalar register one &&\n\tgit -C one/src config unset gui.gcwarning &&\n\tscalar reconfigure one &&\n\ttest false = \"$(git -C one/src config gui.gcwarning)\" &&\n\tgit -C one/src config unset gui.gcwarning &&\n\trm one/src/cron.txt &&\n\tGIT_TRACE2_EVENT=\"$(pwd)/reconfigure\" scalar reconfigure -a &&\n\ttest_path_is_file one/src/cron.txt &&\n\ttest false = \"$(git -C one/src config gui.gcwarning)\" &&\n\ttest_grep \"GCWarning = false # set by scalar\" one/src/.git/config &&\n\ttest_grep \"excludeDecoration = refs/prefetch/\\* # set by scalar\" one/src/.git/config &&\n\n\ttest_subcommand git maintenance start <reconfigure &&\n\ttest_subcommand ! git maintenance unregister --force <reconfigure &&\n\n\tGIT_TRACE2_EVENT=\"$(pwd)/reconfigure-maint-disable\" \\\n\t\tscalar reconfigure -a --maintenance=disable &&\n\ttest_subcommand ! git maintenance start <reconfigure-maint-disable &&\n\ttest_subcommand git maintenance unregister --force <reconfigure-maint-disable &&\n\n\tGIT_TRACE2_EVENT=\"$(pwd)/reconfigure-maint-keep\" \\\n\t\tscalar reconfigure --maintenance=keep -a &&\n\ttest_subcommand ! git maintenance start <reconfigure-maint-keep &&\n\ttest_subcommand ! git maintenance unregister --force <reconfigure-maint-keep\n'\n\ntest_expect_success 'scalar reconfigure --all with includeIf.onbranch' '\n\trepos=\"two three four\" &&\n\tfor num in $repos\n\tdo\n\t\tgit init $num/src &&\n\t\tscalar register $num/src &&\n\t\tgit -C $num/src config includeif.\"onbranch:foo\".path something &&\n\t\tgit -C $num/src config unset gui.gcwarning || return 1\n\tdone &&\n\n\tscalar reconfigure --all &&\n\n\tfor num in $repos\n\tdo\n\t\ttest false = \"$(git -C $num/src config gui.gcwarning)\" || return 1\n\tdone\n'\n\ntest_expect_success 'scalar reconfigure --all with detached HEADs' '\n\t# This test demonstrates an issue with index.skipHash=true and\n\t# this test variable for the split index. Disable the test variable.\n\tsane_unset GIT_TEST_SPLIT_INDEX &&\n\n\trepos=\"two three four\" &&\n\tfor num in $repos\n\tdo\n\t\trm -rf $num/src &&\n\t\tgit init $num/src &&\n\t\tscalar register $num/src &&\n\t\tgit -C $num/src config unset gui.gcwarning &&\n\t\ttest_commit -C $num/src initial &&\n\t\tgit -C $num/src switch --detach HEAD || return 1\n\tdone &&\n\n\tscalar reconfigure --all &&\n\n\tfor num in $repos\n\tdo\n\t\ttest false = \"$(git -C $num/src config gui.gcwarning)\" || return 1\n\tdone\n'\n\ntest_expect_success '`reconfigure -a` removes stale config entries' '\n\tgit init stale/src &&\n\tscalar register stale &&\n\tscalar list >scalar.repos &&\n\tgrep stale scalar.repos &&\n\n\tgrep -v stale scalar.repos >expect &&\n\n\trm -rf stale &&\n\tscalar reconfigure -a &&\n\tscalar list >scalar.repos &&\n\ttest_cmp expect scalar.repos\n'\n\ntest_expect_success 'scalar delete without enlistment shows a usage' '\n\ttest_expect_code 129 scalar delete\n'\n\ntest_expect_success 'scalar delete with enlistment' '\n\tscalar delete cloned &&\n\ttest_path_is_missing cloned\n'\n\ntest_expect_success 'scalar supports -c/-C' '\n\ttest_when_finished \"scalar delete sub\" &&\n\tgit init sub &&\n\tscalar -C sub -c status.aheadBehind=bogus register &&\n\ttest -z \"$(git -C sub config --local status.aheadBehind)\" &&\n\ttest false = \"$(git -C sub config gui.gcwarning)\"\n'\n\ntest_expect_success '`scalar [...] <dir>` errors out when dir is missing' '\n\t! scalar run config cloned 2>err &&\n\tgrep \"cloned. does not exist\" err\n'\n\nSQ=\"'\"\ntest_expect_success UNZIP 'scalar diagnose' '\n\tscalar clone \"file://$(pwd)\" cloned --single-branch &&\n\tgit repack &&\n\techo \"$(pwd)/.git/objects/\" >>cloned/src/.git/objects/info/alternates &&\n\ttest_commit -C cloned/src loose &&\n\tscalar diagnose cloned >out 2>err &&\n\tgrep \"Available space\" out &&\n\tsed -n \"s/.*$SQ\\\\(.*\\\\.zip\\\\)$SQ.*/\\\\1/p\" <err >zip_path &&\n\tzip_path=$(cat zip_path) &&\n\ttest -n \"$zip_path\" &&\n\t\"$GIT_UNZIP\" -v \"$zip_path\" &&\n\tfolder=${zip_path%.zip} &&\n\ttest_path_is_missing \"$folder\" &&\n\t\"$GIT_UNZIP\" -p \"$zip_path\" diagnostics.log >out &&\n\ttest_file_not_empty out &&\n\t\"$GIT_UNZIP\" -p \"$zip_path\" packs-local.txt >out &&\n\tgrep \"$(pwd)/.git/objects\" out &&\n\t\"$GIT_UNZIP\" -p \"$zip_path\" objects-local.txt >out &&\n\tgrep \"^Total: [1-9]\" out\n'\n\ntest_done\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "009437a5f3168fa9e36c5eb30291fcddfc431fdc",
  "sha1_ok": true,
  "size": 10038
}
