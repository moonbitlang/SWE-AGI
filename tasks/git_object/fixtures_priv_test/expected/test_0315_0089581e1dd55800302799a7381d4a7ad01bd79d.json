{
  "content": {
    "base64": "I2lmbmRlZiBUUkVFX1dBTEtfSAojZGVmaW5lIFRSRUVfV0FMS19ICgpzdHJ1Y3QgbmFtZV9lbnRyeSB7Cgljb25zdCB1bnNpZ25lZCBjaGFyICpzaGExOwoJY29uc3QgY2hhciAqcGF0aDsKCXVuc2lnbmVkIGludCBtb2RlOwp9OwoKc3RydWN0IHRyZWVfZGVzYyB7Cgljb25zdCB2b2lkICpidWZmZXI7CglzdHJ1Y3QgbmFtZV9lbnRyeSBlbnRyeTsKCXVuc2lnbmVkIGludCBzaXplOwp9OwoKc3RhdGljIGlubGluZSBjb25zdCB1bnNpZ25lZCBjaGFyICp0cmVlX2VudHJ5X2V4dHJhY3Qoc3RydWN0IHRyZWVfZGVzYyAqZGVzYywgY29uc3QgY2hhciAqKnBhdGhwLCB1bnNpZ25lZCBpbnQgKm1vZGVwKQp7CgkqcGF0aHAgPSBkZXNjLT5lbnRyeS5wYXRoOwoJKm1vZGVwID0gY2Fub25fbW9kZShkZXNjLT5lbnRyeS5tb2RlKTsKCXJldHVybiBkZXNjLT5lbnRyeS5zaGExOwp9CgpzdGF0aWMgaW5saW5lIGludCB0cmVlX2VudHJ5X2xlbihjb25zdCBjaGFyICpuYW1lLCBjb25zdCB1bnNpZ25lZCBjaGFyICpzaGExKQp7CglyZXR1cm4gKGNvbnN0IGNoYXIgKilzaGExIC0gbmFtZSAtIDE7Cn0KCnZvaWQgdXBkYXRlX3RyZWVfZW50cnkoc3RydWN0IHRyZWVfZGVzYyAqKTsKdm9pZCBpbml0X3RyZWVfZGVzYyhzdHJ1Y3QgdHJlZV9kZXNjICpkZXNjLCBjb25zdCB2b2lkICpidWYsIHVuc2lnbmVkIGxvbmcgc2l6ZSk7CgovKgogKiBIZWxwZXIgZnVuY3Rpb24gdGhhdCBkb2VzIGJvdGggdHJlZV9lbnRyeV9leHRyYWN0KCkgYW5kIHVwZGF0ZV90cmVlX2VudHJ5KCkKICogYW5kIHJldHVybnMgdHJ1ZSBmb3Igc3VjY2VzcwogKi8KaW50IHRyZWVfZW50cnkoc3RydWN0IHRyZWVfZGVzYyAqLCBzdHJ1Y3QgbmFtZV9lbnRyeSAqKTsKCnZvaWQgKmZpbGxfdHJlZV9kZXNjcmlwdG9yKHN0cnVjdCB0cmVlX2Rlc2MgKmRlc2MsIGNvbnN0IHVuc2lnbmVkIGNoYXIgKnNoYTEpOwoKc3RydWN0IHRyYXZlcnNlX2luZm87CnR5cGVkZWYgaW50ICgqdHJhdmVyc2VfY2FsbGJhY2tfdCkoaW50IG4sIHVuc2lnbmVkIGxvbmcgbWFzaywgdW5zaWduZWQgbG9uZyBkaXJtYXNrLCBzdHJ1Y3QgbmFtZV9lbnRyeSAqZW50cnksIHN0cnVjdCB0cmF2ZXJzZV9pbmZvICopOwppbnQgdHJhdmVyc2VfdHJlZXMoaW50IG4sIHN0cnVjdCB0cmVlX2Rlc2MgKnQsIHN0cnVjdCB0cmF2ZXJzZV9pbmZvICppbmZvKTsKCnN0cnVjdCB0cmF2ZXJzZV9pbmZvIHsKCXN0cnVjdCB0cmF2ZXJzZV9pbmZvICpwcmV2OwoJc3RydWN0IG5hbWVfZW50cnkgbmFtZTsKCWludCBwYXRobGVuOwoJc3RydWN0IHBhdGhzcGVjICpwYXRoc3BlYzsKCgl1bnNpZ25lZCBsb25nIGNvbmZsaWN0czsKCXRyYXZlcnNlX2NhbGxiYWNrX3QgZm47Cgl2b2lkICpkYXRhOwoJaW50IHNob3dfYWxsX2Vycm9yczsKfTsKCmludCBnZXRfdHJlZV9lbnRyeShjb25zdCB1bnNpZ25lZCBjaGFyICosIGNvbnN0IGNoYXIgKiwgdW5zaWduZWQgY2hhciAqLCB1bnNpZ25lZCAqKTsKZXh0ZXJuIGNoYXIgKm1ha2VfdHJhdmVyc2VfcGF0aChjaGFyICpwYXRoLCBjb25zdCBzdHJ1Y3QgdHJhdmVyc2VfaW5mbyAqaW5mbywgY29uc3Qgc3RydWN0IG5hbWVfZW50cnkgKm4pOwpleHRlcm4gdm9pZCBzZXR1cF90cmF2ZXJzZV9pbmZvKHN0cnVjdCB0cmF2ZXJzZV9pbmZvICppbmZvLCBjb25zdCBjaGFyICpiYXNlKTsKCnN0YXRpYyBpbmxpbmUgaW50IHRyYXZlcnNlX3BhdGhfbGVuKGNvbnN0IHN0cnVjdCB0cmF2ZXJzZV9pbmZvICppbmZvLCBjb25zdCBzdHJ1Y3QgbmFtZV9lbnRyeSAqbikKewoJcmV0dXJuIGluZm8tPnBhdGhsZW4gKyB0cmVlX2VudHJ5X2xlbihuLT5wYXRoLCBuLT5zaGExKTsKfQoKZXh0ZXJuIGludCB0cmVlX2VudHJ5X2ludGVyZXN0aW5nKGNvbnN0IHN0cnVjdCBuYW1lX2VudHJ5ICosIHN0cnVjdCBzdHJidWYgKiwgaW50LCBjb25zdCBzdHJ1Y3QgcGF0aHNwZWMgKnBzKTsKCiNlbmRpZgo=",
    "text": "#ifndef TREE_WALK_H\n#define TREE_WALK_H\n\nstruct name_entry {\n\tconst unsigned char *sha1;\n\tconst char *path;\n\tunsigned int mode;\n};\n\nstruct tree_desc {\n\tconst void *buffer;\n\tstruct name_entry entry;\n\tunsigned int size;\n};\n\nstatic inline const unsigned char *tree_entry_extract(struct tree_desc *desc, const char **pathp, unsigned int *modep)\n{\n\t*pathp = desc->entry.path;\n\t*modep = canon_mode(desc->entry.mode);\n\treturn desc->entry.sha1;\n}\n\nstatic inline int tree_entry_len(const char *name, const unsigned char *sha1)\n{\n\treturn (const char *)sha1 - name - 1;\n}\n\nvoid update_tree_entry(struct tree_desc *);\nvoid init_tree_desc(struct tree_desc *desc, const void *buf, unsigned long size);\n\n/*\n * Helper function that does both tree_entry_extract() and update_tree_entry()\n * and returns true for success\n */\nint tree_entry(struct tree_desc *, struct name_entry *);\n\nvoid *fill_tree_descriptor(struct tree_desc *desc, const unsigned char *sha1);\n\nstruct traverse_info;\ntypedef int (*traverse_callback_t)(int n, unsigned long mask, unsigned long dirmask, struct name_entry *entry, struct traverse_info *);\nint traverse_trees(int n, struct tree_desc *t, struct traverse_info *info);\n\nstruct traverse_info {\n\tstruct traverse_info *prev;\n\tstruct name_entry name;\n\tint pathlen;\n\tstruct pathspec *pathspec;\n\n\tunsigned long conflicts;\n\ttraverse_callback_t fn;\n\tvoid *data;\n\tint show_all_errors;\n};\n\nint get_tree_entry(const unsigned char *, const char *, unsigned char *, unsigned *);\nextern char *make_traverse_path(char *path, const struct traverse_info *info, const struct name_entry *n);\nextern void setup_traverse_info(struct traverse_info *info, const char *base);\n\nstatic inline int traverse_path_len(const struct traverse_info *info, const struct name_entry *n)\n{\n\treturn info->pathlen + tree_entry_len(n->path, n->sha1);\n}\n\nextern int tree_entry_interesting(const struct name_entry *, struct strbuf *, int, const struct pathspec *ps);\n\n#endif\n",
    "type": "blob"
  },
  "kind": "blob",
  "oid": "0089581e1dd55800302799a7381d4a7ad01bd79d",
  "sha1_ok": true,
  "size": 1943
}
